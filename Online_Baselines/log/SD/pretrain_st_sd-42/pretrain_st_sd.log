2025-05-26 02:26:22,868 - logger name:log/SD/pretrain_st_sd-42/pretrain_st_sd.log
2025-05-26 02:26:22,868 - params : {'conf': 'conf/SD/pretrain_st_sd.json', 'seed': 42, 'paral': 0, 'gpuid': 2, 'logname': 'pretrain_st_sd', 'method': 'TrafficStream', 'load_first_year': 0, 'first_year_model_path': 'log/SD/trafficstream-42/2019/22.3629.pkl', 'device': device(type='cuda', index=2), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/SD/finaldata/', 'save_data_path': 'data/SD/FastData/', 'graph_path': 'data/SD/graph/', 'model_path': 'log/SD/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'rank': 6, 'train': 1, 'strategy': 'pretrain', 'init': True, 'increase': False, 'num_hops': 0, 'detect': False, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': False, 'path': 'log/SD/pretrain_st_sd-42', 'logger': <Logger utils.initialize (INFO)>}
2025-05-26 02:26:39,048 - [*] Year 2017 load from data/SD/FastData/2017.npz
2025-05-26 02:26:39,318 - [*] Year 2017 Dataset load!
2025-05-26 02:26:39,321 - Total Parameters: 3308
2025-05-26 02:26:39,321 - Trainable Parameters: 3308
2025-05-26 02:26:39,322 - [*] Year 2017 Training start
2025-05-26 02:26:39,773 - node number torch.Size([90240, 12])
2025-05-26 02:26:44,619 - epoch:0, training loss:18180.7709 validation loss:49.8031
2025-05-26 02:26:49,513 - epoch:1, training loss:2851.6175 validation loss:35.2882
2025-05-26 02:26:54,205 - epoch:2, training loss:2227.2044 validation loss:33.5646
2025-05-26 02:26:58,896 - epoch:3, training loss:2138.6287 validation loss:34.8725
2025-05-26 02:27:03,671 - epoch:4, training loss:2108.3498 validation loss:35.1587
2025-05-26 02:27:08,476 - epoch:5, training loss:2056.2845 validation loss:32.7855
2025-05-26 02:27:13,174 - epoch:6, training loss:1987.8954 validation loss:32.9930
2025-05-26 02:27:18,355 - epoch:7, training loss:1949.6523 validation loss:33.3834
2025-05-26 02:27:23,163 - epoch:8, training loss:1951.7061 validation loss:34.9994
2025-05-26 02:27:27,970 - epoch:9, training loss:1935.0494 validation loss:35.8891
2025-05-26 02:27:32,748 - epoch:10, training loss:1943.1483 validation loss:35.6961
2025-05-26 02:27:37,451 - epoch:11, training loss:1925.6423 validation loss:33.4956
2025-05-26 02:27:39,448 - [*] loss:1991.8922
2025-05-26 02:27:39,825 - [*] year 2017, testing
2025-05-26 02:27:44,709 - T:3	MAE	23.9438	RMSE	33.7044	MAPE	18.1451
2025-05-26 02:27:54,181 - T:6	MAE	25.2292	RMSE	36.6673	MAPE	18.7154
2025-05-26 02:28:24,535 - T:12	MAE	29.0428	RMSE	44.2175	MAPE	20.9770
2025-05-26 02:28:24,535 - T:Avg	MAE	25.7522	RMSE	37.5641	MAPE	19.0944
2025-05-26 02:28:24,538 - Finished optimization, total time:30.69 s, best model:log/SD/pretrain_st_sd-42/2017/32.7855.pkl
2025-05-26 02:28:41,090 - [*] Year 2018 load from data/SD/FastData/2018.npz
2025-05-26 02:28:41,126 - [*] load from log/SD/pretrain_st_sd-42/2017/32.7855.pkl
2025-05-26 02:28:43,758 - [*] loss:1950.0430
2025-05-26 02:28:44,133 - [*] year 2018, testing
2025-05-26 02:28:47,996 - T:3	MAE	23.8089	RMSE	33.3337	MAPE	18.3364
2025-05-26 02:28:55,891 - T:6	MAE	25.0551	RMSE	36.2194	MAPE	18.8996
2025-05-26 02:29:23,385 - T:12	MAE	28.7871	RMSE	43.5859	MAPE	21.1334
2025-05-26 02:29:23,385 - T:Avg	MAE	25.5689	RMSE	37.0947	MAPE	19.2727
2025-05-26 02:29:23,388 - [*] No increasing nodes at year 2018, store model of the last year.
2025-05-26 02:29:39,998 - [*] Year 2019 load from data/SD/FastData/2019.npz
2025-05-26 02:29:40,037 - [*] load from log/SD/pretrain_st_sd-42/2018/32.7855.pkl
2025-05-26 02:29:43,663 - [*] loss:1853.9856
2025-05-26 02:29:44,039 - [*] year 2019, testing
2025-05-26 02:29:48,051 - T:3	MAE	21.7501	RMSE	31.9664	MAPE	19.6731
2025-05-26 02:29:56,733 - T:6	MAE	23.5433	RMSE	35.2452	MAPE	21.0262
2025-05-26 02:30:24,493 - T:12	MAE	28.0026	RMSE	42.8843	MAPE	24.6229
2025-05-26 02:30:24,493 - T:Avg	MAE	24.0585	RMSE	36.0350	MAPE	21.4897
2025-05-26 02:30:24,496 - [*] No increasing nodes at year 2019, store model of the last year.
2025-05-26 02:30:40,636 - [*] Year 2020 load from data/SD/FastData/2020.npz
2025-05-26 02:30:40,675 - [*] load from log/SD/pretrain_st_sd-42/2019/32.7855.pkl
2025-05-26 02:30:44,080 - [*] loss:2912.0244
2025-05-26 02:30:44,469 - [*] year 2020, testing
2025-05-26 02:30:48,645 - T:3	MAE	37.0129	RMSE	48.5970	MAPE	45.7992
2025-05-26 02:30:56,185 - T:6	MAE	38.5399	RMSE	50.7219	MAPE	47.9596
2025-05-26 02:31:23,011 - T:12	MAE	41.1307	RMSE	54.4010	MAPE	52.4065
2025-05-26 02:31:23,011 - T:Avg	MAE	38.6779	RMSE	50.8676	MAPE	48.3629
2025-05-26 02:31:23,014 - [*] No increasing nodes at year 2020, store model of the last year.
2025-05-26 02:31:23,014 - 


2025-05-26 02:31:23,014 - 3   	 MAE	     23.94	     23.81	     21.75	     37.01		   26.63
2025-05-26 02:31:23,014 - 3   	RMSE	     33.70	     33.33	     31.97	     48.60		   36.90
2025-05-26 02:31:23,015 - 3   	MAPE	     18.15	     18.34	     19.67	     45.80		   25.49
2025-05-26 02:31:23,015 - 6   	 MAE	     25.23	     25.06	     23.54	     38.54		   28.09
2025-05-26 02:31:23,015 - 6   	RMSE	     36.67	     36.22	     35.25	     50.72		   39.71
2025-05-26 02:31:23,015 - 6   	MAPE	     18.72	     18.90	     21.03	     47.96		   26.65
2025-05-26 02:31:23,015 - 12  	 MAE	     29.04	     28.79	     28.00	     41.13		   31.74
2025-05-26 02:31:23,015 - 12  	RMSE	     44.22	     43.59	     42.88	     54.40		   46.27
2025-05-26 02:31:23,015 - 12  	MAPE	     20.98	     21.13	     24.62	     52.41		   29.78
2025-05-26 02:31:23,015 - Avg 	 MAE	     25.75	     25.57	     24.06	     38.68		   28.51
2025-05-26 02:31:23,015 - Avg 	RMSE	     37.56	     37.09	     36.04	     50.87		   40.39
2025-05-26 02:31:23,015 - Avg 	MAPE	     19.09	     19.27	     21.49	     48.36		   27.05
2025-05-26 02:31:23,015 - year	2017	total_time	   30.6910	average_time	    2.5576	epoch	12
2025-05-26 02:31:23,015 - total time: 30.6910
