2025-06-04 14:28:19,669 - logger name:log/CA/trafficstream-42/trafficstream.log
2025-06-04 14:28:19,669 - params : {'conf': 'conf/CA/trafficstream.json', 'seed': 42, 'paral': 0, 'gpuid': 0, 'logname': 'trafficstream', 'method': 'TrafficStream', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/GBA/dlf-42/2017/30.0695.pkl', 'device': device(type='cuda', index=0), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>, 'DLF': <class 'src.model.model.DLF_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/CA/finaldata/', 'save_data_path': 'data/CA/FastData/', 'graph_path': 'data/CA/graph/', 'model_path': 'log/CA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'rank': 6, 'train': 1, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'replay_num_samples': 300, 'extra_feature': True, 'momentum_type': 'linear', 'memory_size': 32, 'path': 'log/CA/trafficstream-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-04 14:44:22,130 - [*] Year 2017 load from data/CA/FastData/2017.npz
2025-06-04 14:44:23,424 - [*] Year 2017 Dataset load!
2025-06-04 14:44:23,440 - [*] Year 2017 Training start
2025-06-04 14:44:39,357 - node number torch.Size([1049088, 12])
2025-06-04 14:47:36,998 - epoch:0, training loss:17522.3199 validation loss:46.7894
2025-06-04 15:01:03,641 - epoch:1, training loss:2710.6360 validation loss:32.4963
2025-06-04 15:04:15,049 - epoch:2, training loss:2077.8149 validation loss:31.8023
2025-06-04 15:07:28,371 - epoch:3, training loss:1997.3748 validation loss:33.3688
2025-06-04 15:19:09,179 - epoch:4, training loss:1978.4727 validation loss:32.7290
2025-06-04 15:49:04,138 - epoch:5, training loss:1955.2809 validation loss:30.9248
2025-06-04 18:36:13,023 - epoch:6, training loss:1926.7865 validation loss:32.1844
2025-06-04 18:39:23,757 - epoch:7, training loss:1880.7876 validation loss:32.2528
2025-06-04 18:42:38,135 - epoch:8, training loss:1855.7215 validation loss:32.2282
2025-06-04 18:45:49,849 - epoch:9, training loss:1845.6359 validation loss:31.4990
2025-06-04 18:48:58,925 - epoch:10, training loss:1843.4178 validation loss:34.4975
2025-06-04 18:52:11,017 - epoch:11, training loss:1843.0817 validation loss:31.0497
2025-06-04 18:53:19,631 - [*] loss:2066.7861
2025-06-04 19:09:07,822 - [*] year 2017, testing
2025-06-05 00:00:07,782 - T:3	MAE	24.0046	RMSE	34.9756	MAPE	17.4856
2025-06-05 00:03:47,861 - T:6	MAE	25.3250	RMSE	37.7974	MAPE	18.0012
2025-06-05 00:39:16,672 - T:12	MAE	29.1151	RMSE	44.7982	MAPE	20.0028
2025-06-05 00:39:16,672 - T:Avg	MAE	25.8289	RMSE	38.5898	MAPE	18.3226
2025-06-05 00:39:16,749 - Finished optimization, total time:1214.31 s, best model:log/CA/trafficstream-42/2017/30.9248.pkl
2025-06-05 00:43:02,363 - [*] Year 2018 load from data/CA/FastData/2018.npz
2025-06-05 00:43:03,529 - [*] load from log/CA/trafficstream-42/2017/30.9248.pkl
2025-06-05 00:43:44,452 - number of increase nodes:927, nodes after 2 hop:torch.Size([5722]), total nodes this year 8428
2025-06-05 00:44:16,693 - [*] Year 2018 Dataset load!
2025-06-05 00:44:16,693 - [*] load from log/CA/trafficstream-42/2017/30.9248.pkl
2025-06-05 00:44:16,697 - [*] EWC! lambda 0.000100
2025-06-05 00:45:49,838 - [*] Year 2018 Training start
2025-06-05 00:45:53,890 - node number torch.Size([732416, 12])
2025-06-05 00:47:07,271 - epoch:0, training loss:1677.2391 validation loss:31.1730
2025-06-05 00:48:23,693 - epoch:1, training loss:1634.5963 validation loss:28.2126
2025-06-05 00:49:40,222 - epoch:2, training loss:1622.1474 validation loss:28.7819
2025-06-05 00:50:56,724 - epoch:3, training loss:1626.2478 validation loss:26.7613
2025-06-05 00:52:13,143 - epoch:4, training loss:1623.3961 validation loss:29.3006
2025-06-05 00:53:29,459 - epoch:5, training loss:1621.5228 validation loss:29.1686
2025-06-05 00:54:45,884 - epoch:6, training loss:1608.1324 validation loss:29.9786
2025-06-05 00:56:02,945 - epoch:7, training loss:1621.5499 validation loss:31.1434
2025-06-05 00:57:19,931 - epoch:8, training loss:1623.1268 validation loss:31.0307
2025-06-05 00:58:35,841 - epoch:9, training loss:1606.8164 validation loss:27.0859
2025-06-05 00:59:35,998 - [*] loss:1986.6738
2025-06-05 00:59:44,150 - [*] year 2018, testing
2025-06-05 01:00:42,428 - T:3	MAE	21.3056	RMSE	33.1910	MAPE	14.4535
2025-06-05 01:02:33,957 - T:6	MAE	23.3824	RMSE	36.7690	MAPE	15.9592
2025-06-05 01:08:31,519 - T:12	MAE	27.6282	RMSE	43.6966	MAPE	19.6910
2025-06-05 01:08:31,519 - T:Avg	MAE	23.7836	RMSE	37.3348	MAPE	16.4457
2025-06-05 01:08:31,554 - Finished optimization, total time:469.49 s, best model:log/CA/trafficstream-42/2018/26.7613.pkl
2025-06-05 01:11:29,862 - [*] Year 2019 load from data/CA/FastData/2019.npz
2025-06-05 01:11:30,915 - [*] load from log/CA/trafficstream-42/2018/26.7613.pkl
2025-06-05 01:12:11,282 - number of increase nodes:881, nodes after 2 hop:torch.Size([5408]), total nodes this year 8600
2025-06-05 01:12:41,118 - [*] Year 2019 Dataset load!
2025-06-05 01:12:41,118 - [*] load from log/CA/trafficstream-42/2018/26.7613.pkl
2025-06-05 01:12:41,122 - [*] EWC! lambda 0.000100
2025-06-05 01:14:17,844 - [*] Year 2019 Training start
2025-06-05 01:14:22,506 - node number torch.Size([692224, 12])
2025-06-05 01:15:26,399 - epoch:0, training loss:1987.6473 validation loss:28.9961
2025-06-05 01:16:34,085 - epoch:1, training loss:1953.6285 validation loss:27.3629
2025-06-05 01:17:41,530 - epoch:2, training loss:1951.4420 validation loss:28.7626
2025-06-05 01:18:49,392 - epoch:3, training loss:1942.0969 validation loss:28.8622
2025-06-05 01:19:57,122 - epoch:4, training loss:1961.0712 validation loss:32.9421
2025-06-05 01:21:04,043 - epoch:5, training loss:1963.1909 validation loss:29.6101
2025-06-05 01:22:11,959 - epoch:6, training loss:1955.9384 validation loss:29.8623
2025-06-05 01:23:19,021 - epoch:7, training loss:1956.1486 validation loss:27.9680
2025-06-05 01:24:22,162 - [*] loss:1830.0386
2025-06-05 01:24:29,821 - [*] year 2019, testing
2025-06-05 01:25:53,441 - T:3	MAE	21.3822	RMSE	32.1009	MAPE	15.3644
2025-06-05 01:28:12,105 - T:6	MAE	23.3269	RMSE	35.6867	MAPE	16.3469
2025-06-05 05:08:59,785 - logger name:log/CA/trafficstream-42/trafficstream.log
2025-06-05 05:08:59,785 - params : {'conf': 'conf/CA/trafficstream.json', 'seed': 42, 'paral': 0, 'gpuid': 4, 'logname': 'trafficstream', 'method': 'TrafficStream', 'load_first_year': 1, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/CA/trafficstream-42/2019/27.3629.pkl', 'device': device(type='cuda', index=4), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>, 'DLF': <class 'src.model.model.DLF_Model'>}, 'begin_year': 2019, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/CA/finaldata/', 'save_data_path': 'data/CA/FastData/', 'graph_path': 'data/CA/graph/', 'model_path': 'log/CA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'rank': 6, 'train': 1, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'replay_num_samples': 300, 'extra_feature': True, 'momentum_type': 'linear', 'memory_size': 32, 'path': 'log/CA/trafficstream-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-05 05:12:05,927 - [*] Year 2019 load from data/CA/FastData/2019.npz
2025-06-05 05:12:06,817 - [*] load from /home/bd2/ANATS/Online_Baselines/log/CA/trafficstream-42/2019/27.3629.pkl
2025-06-05 05:13:10,633 - [*] loss:1830.0386
2025-06-05 05:13:25,763 - [*] year 2019, testing
2025-06-05 05:14:55,067 - T:3	MAE	21.3822	RMSE	32.1009	MAPE	15.3644
2025-06-05 05:18:44,399 - T:6	MAE	23.3269	RMSE	35.6867	MAPE	16.3469
2025-06-05 05:33:00,304 - T:12	MAE	27.1252	RMSE	42.3708	MAPE	19.1839
2025-06-05 05:33:00,305 - T:Avg	MAE	23.6048	RMSE	36.1160	MAPE	16.7326
2025-06-05 05:38:17,073 - [*] Year 2020 load from data/CA/FastData/2020.npz
2025-06-05 05:38:19,469 - [*] load from /home/bd2/ANATS/Online_Baselines/log/CA/trafficstream-42/2019/27.3629.pkl
2025-06-05 05:38:39,608 - The number of data points in the previous year is greater than the current year, skipping detection and replay.
2025-06-05 05:38:39,610 - The number of data points in the previous year is greater than the current year, skipping replay.
2025-06-05 05:38:42,061 - number of increase nodes:324, nodes after 2 hop:torch.Size([4688]), total nodes this year 8561
2025-06-05 05:39:17,300 - [*] Year 2020 Dataset load!
2025-06-05 05:39:17,300 - [*] load from /home/bd2/ANATS/Online_Baselines/log/CA/trafficstream-42/2019/27.3629.pkl
2025-06-05 05:39:17,304 - [*] EWC! lambda 0.000100
2025-06-05 05:40:51,246 - [*] Year 2020 Training start
2025-06-05 05:40:55,744 - node number torch.Size([600064, 12])
2025-06-05 05:41:45,671 - epoch:0, training loss:1755.1387 validation loss:31.1811
2025-06-05 05:42:38,699 - epoch:1, training loss:1722.6841 validation loss:30.1595
2025-06-05 05:43:31,417 - epoch:2, training loss:1722.8380 validation loss:28.4981
2025-06-05 05:44:24,600 - epoch:3, training loss:1727.6897 validation loss:29.8260
2025-06-05 05:45:17,219 - epoch:4, training loss:1728.6101 validation loss:29.1322
2025-06-05 05:46:09,476 - epoch:5, training loss:1728.5729 validation loss:31.7456
2025-06-05 05:47:01,691 - epoch:6, training loss:1729.9046 validation loss:30.7616
2025-06-05 05:47:53,363 - epoch:7, training loss:1735.3835 validation loss:29.3033
2025-06-05 05:48:44,960 - epoch:8, training loss:1730.7906 validation loss:31.7498
2025-06-05 05:49:49,274 - [*] loss:1991.4788
2025-06-05 05:50:04,133 - [*] year 2020, testing
2025-06-05 05:51:11,126 - T:3	MAE	28.8561	RMSE	39.2949	MAPE	30.9519
2025-06-05 05:53:11,850 - T:6	MAE	29.9031	RMSE	41.0768	MAPE	33.1995
2025-06-05 05:59:41,746 - T:12	MAE	31.9223	RMSE	44.2886	MAPE	38.2605
2025-06-05 05:59:41,747 - T:Avg	MAE	30.0844	RMSE	41.2827	MAPE	33.7517
2025-06-05 05:59:41,778 - Finished optimization, total time:298.36 s, best model:log/CA/trafficstream-42/2020/28.4981.pkl
2025-06-05 05:59:41,858 - 


2025-06-05 05:59:41,858 - 3   	 MAE	     24.00	     21.38	     28.86		   25.12
2025-06-05 05:59:41,858 - 3   	RMSE	     34.97	     32.10	     39.29		   35.70
2025-06-05 05:59:41,858 - 3   	MAPE	     17.48	     15.36	     30.95		   23.16
2025-06-05 05:59:41,858 - 6   	 MAE	     25.33	     23.33	     29.90		   26.62
2025-06-05 05:59:41,858 - 6   	RMSE	     37.79	     35.69	     41.08		   38.38
2025-06-05 05:59:41,858 - 6   	MAPE	     18.01	     16.35	     33.20		   24.77
2025-06-05 05:59:41,859 - 12  	 MAE	     29.12	     27.13	     31.92		   29.52
2025-06-05 05:59:41,859 - 12  	RMSE	     44.80	     42.37	     44.29		   43.33
2025-06-05 05:59:41,859 - 12  	MAPE	     20.00	     19.18	     38.26		   28.72
2025-06-05 05:59:41,859 - Avg 	 MAE	     25.83	     23.60	     30.08		   26.84
2025-06-05 05:59:41,859 - Avg 	RMSE	     38.59	     36.12	     41.28		   38.70
2025-06-05 05:59:41,859 - Avg 	MAPE	     18.32	     16.73	     33.75		   25.24
2025-06-05 05:59:41,859 - year	2020	total_time	  298.3591	average_time	   33.1510	epoch	9
2025-06-05 05:59:41,859 - total time: 298.3591
