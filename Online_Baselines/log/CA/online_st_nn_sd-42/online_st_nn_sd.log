2025-06-04 14:28:19,669 - logger name:log/CA/online_st_nn_sd-42/online_st_nn_sd.log
2025-06-04 14:28:19,669 - params : {'conf': 'conf/CA/online_st_nn.json', 'seed': 42, 'paral': 0, 'gpuid': 2, 'logname': 'online_st_nn_sd', 'method': 'TrafficStream', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/GBA/dlf-42/2017/30.0695.pkl', 'device': device(type='cuda', index=2), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>, 'DLF': <class 'src.model.model.DLF_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/CA/finaldata/', 'save_data_path': 'data/CA/FastData/', 'graph_path': 'data/CA/graph/', 'model_path': 'log/CA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'rank': 6, 'train': 1, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': False, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': False, 'path': 'log/CA/online_st_nn_sd-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-05 11:42:27,199 - logger name:log/CA/online_st_nn_sd-42/online_st_nn_sd.log
2025-06-05 11:42:27,200 - params : {'conf': 'conf/CA/online_st_nn.json', 'seed': 42, 'paral': 0, 'gpuid': 4, 'logname': 'online_st_nn_sd', 'method': 'TrafficStream', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/CA/online_st_an_sd-42/2020/26.5411.pkl', 'device': device(type='cuda', index=4), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>, 'DLF': <class 'src.model.model.DLF_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/CA/finaldata/', 'save_data_path': 'data/CA/FastData/', 'graph_path': 'data/CA/graph/', 'model_path': 'log/CA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'rank': 6, 'train': 1, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': False, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': False, 'path': 'log/CA/online_st_nn_sd-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-05 11:44:19,678 - logger name:log/CA/online_st_nn_sd-42/online_st_nn_sd.log
2025-06-05 11:44:19,695 - params : {'conf': 'conf/CA/online_st_nn.json', 'seed': 42, 'paral': 0, 'gpuid': 4, 'logname': 'online_st_nn_sd', 'method': 'TrafficStream', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/CA/online_st_an_sd-42/2020/26.5411.pkl', 'device': device(type='cuda', index=4), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>, 'DLF': <class 'src.model.model.DLF_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/CA/finaldata/', 'save_data_path': 'data/CA/FastData/', 'graph_path': 'data/CA/graph/', 'model_path': 'log/CA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'rank': 6, 'train': 1, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': False, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': False, 'path': 'log/CA/online_st_nn_sd-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-05 11:56:56,194 - logger name:log/CA/online_st_nn_sd-42/online_st_nn_sd.log
2025-06-05 11:56:56,207 - params : {'conf': 'conf/CA/online_st_nn.json', 'seed': 42, 'paral': 0, 'gpuid': 4, 'logname': 'online_st_nn_sd', 'method': 'TrafficStream', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/CA/online_st_an_sd-42/2020/26.5411.pkl', 'device': device(type='cuda', index=4), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>, 'DLF': <class 'src.model.model.DLF_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/CA/finaldata/', 'save_data_path': 'data/CA/FastData/', 'graph_path': 'data/CA/graph/', 'model_path': 'log/CA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'rank': 6, 'train': 1, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': False, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': False, 'path': 'log/CA/online_st_nn_sd-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-05 11:59:34,260 - [*] Year 2017 load from data/CA/FastData/2017.npz
2025-06-05 12:34:52,659 - [*] Year 2017 Dataset load!
2025-06-05 12:34:52,698 - Total Parameters: 3308
2025-06-05 12:34:52,698 - Trainable Parameters: 3308
2025-06-05 12:34:52,699 - [*] Year 2017 Training start
2025-06-05 12:36:03,030 - node number torch.Size([1049088, 12])
2025-06-05 12:42:35,969 - epoch:0, training loss:17522.3199 validation loss:46.7894
2025-06-05 12:49:37,611 - epoch:1, training loss:2710.6360 validation loss:32.4963
2025-06-05 12:57:38,421 - epoch:2, training loss:2077.8149 validation loss:31.8023
2025-06-05 13:05:09,816 - epoch:3, training loss:1997.3748 validation loss:33.3688
2025-06-05 13:13:15,989 - epoch:4, training loss:1978.4727 validation loss:32.7290
2025-06-05 13:20:23,181 - epoch:5, training loss:1955.2809 validation loss:30.9248
2025-06-05 13:28:31,850 - epoch:6, training loss:1926.7865 validation loss:32.1844
2025-06-05 13:36:01,655 - epoch:7, training loss:1880.7876 validation loss:32.2528
2025-06-05 13:43:23,634 - epoch:8, training loss:1855.7215 validation loss:32.2282
2025-06-05 13:51:19,139 - epoch:9, training loss:1845.6359 validation loss:31.4990
2025-06-05 13:58:53,225 - epoch:10, training loss:1843.4178 validation loss:34.4975
2025-06-05 14:06:48,488 - epoch:11, training loss:1843.0817 validation loss:31.0497
2025-06-05 14:09:51,785 - [*] loss:2066.7861
2025-06-05 14:11:55,614 - [*] year 2017, testing
2025-06-05 14:19:49,371 - T:3	MAE	24.0046	RMSE	34.9756	MAPE	17.4856
2025-06-05 14:26:47,554 - T:6	MAE	25.3250	RMSE	37.7974	MAPE	18.0012
2025-06-05 14:40:40,020 - T:12	MAE	29.1151	RMSE	44.7982	MAPE	20.0028
2025-06-05 14:40:40,021 - T:Avg	MAE	25.8289	RMSE	38.5898	MAPE	18.3226
2025-06-05 14:40:40,081 - Finished optimization, total time:1646.95 s, best model:log/CA/online_st_nn_sd-42/2017/30.9248.pkl
2025-06-05 14:40:45,896 - [*] Year 2018 load from data/CA/FastData/2018.npz
2025-06-05 14:40:49,778 - [*] load from log/CA/online_st_nn_sd-42/2017/30.9248.pkl
2025-06-05 14:41:52,377 - number of increase nodes:232, nodes after 2 hop:torch.Size([600]), total nodes this year 8428
2025-06-05 14:46:10,246 - [*] Year 2018 Dataset load!
2025-06-05 14:46:10,248 - [*] load from log/CA/online_st_nn_sd-42/2017/30.9248.pkl
2025-06-05 14:46:10,279 - Total Parameters: 3308
2025-06-05 14:46:10,279 - Trainable Parameters: 3308
2025-06-05 14:46:10,280 - [*] Year 2018 Training start
2025-06-05 14:46:13,743 - node number torch.Size([76800, 12])
2025-06-05 14:46:23,595 - epoch:0, training loss:1537.3448 validation loss:32.1265
2025-06-05 14:46:35,489 - epoch:1, training loss:1418.8343 validation loss:30.8908
2025-06-05 14:46:47,950 - epoch:2, training loss:1395.7023 validation loss:31.1099
2025-06-05 14:47:00,335 - epoch:3, training loss:1376.0987 validation loss:31.7193
2025-06-05 14:47:13,093 - epoch:4, training loss:1378.0110 validation loss:31.1098
2025-06-05 14:47:25,181 - epoch:5, training loss:1366.8979 validation loss:29.9101
2025-06-05 14:47:37,603 - epoch:6, training loss:1344.4709 validation loss:28.9035
2025-06-05 14:47:50,082 - epoch:7, training loss:1317.7831 validation loss:32.9479
2025-06-05 14:48:02,530 - epoch:8, training loss:1291.8511 validation loss:29.7399
2025-06-05 14:48:14,277 - epoch:9, training loss:1274.4939 validation loss:29.5523
2025-06-05 14:48:28,595 - epoch:10, training loss:1251.3664 validation loss:30.6989
2025-06-05 14:48:40,464 - epoch:11, training loss:1257.1243 validation loss:31.0912
2025-06-05 14:48:52,886 - epoch:12, training loss:1236.4817 validation loss:30.5226
2025-06-05 14:50:00,973 - [*] loss:1969.0869
2025-06-05 14:50:15,664 - [*] year 2018, testing
2025-06-05 14:51:51,661 - T:3	MAE	20.7091	RMSE	32.3750	MAPE	13.4365
2025-06-05 14:54:54,049 - T:6	MAE	23.1397	RMSE	36.2992	MAPE	15.2419
2025-06-05 15:04:46,662 - T:12	MAE	27.7047	RMSE	43.4955	MAPE	19.2209
2025-06-05 15:04:46,662 - T:Avg	MAE	23.4547	RMSE	36.7577	MAPE	15.6514
2025-06-05 15:04:46,689 - Finished optimization, total time:81.14 s, best model:log/CA/online_st_nn_sd-42/2018/28.9035.pkl
2025-06-05 15:04:48,205 - [*] Year 2019 load from data/CA/FastData/2019.npz
2025-06-05 15:04:49,258 - [*] load from log/CA/online_st_nn_sd-42/2018/28.9035.pkl
2025-06-05 15:05:03,987 - number of increase nodes:172, nodes after 2 hop:torch.Size([539]), total nodes this year 8600
2025-06-05 15:06:53,287 - [*] Year 2019 Dataset load!
2025-06-05 15:06:53,287 - [*] load from log/CA/online_st_nn_sd-42/2018/28.9035.pkl
2025-06-05 15:06:53,311 - Total Parameters: 3308
2025-06-05 15:06:53,311 - Trainable Parameters: 3308
2025-06-05 15:06:53,312 - [*] Year 2019 Training start
2025-06-05 15:06:54,725 - node number torch.Size([68992, 12])
2025-06-05 15:06:58,968 - epoch:0, training loss:2649.2486 validation loss:33.3602
2025-06-05 15:07:04,428 - epoch:1, training loss:2522.7329 validation loss:33.5939
2025-06-05 15:07:10,020 - epoch:2, training loss:2497.2037 validation loss:32.8716
2025-06-05 15:07:15,456 - epoch:3, training loss:2499.6830 validation loss:34.2177
2025-06-05 15:07:20,875 - epoch:4, training loss:2488.4886 validation loss:33.8842
2025-06-05 15:07:26,423 - epoch:5, training loss:2443.8038 validation loss:33.5224
2025-06-05 15:07:31,857 - epoch:6, training loss:2454.4893 validation loss:31.4083
2025-06-05 15:07:37,290 - epoch:7, training loss:2420.3900 validation loss:32.5485
2025-06-05 15:07:42,737 - epoch:8, training loss:2423.2125 validation loss:35.7403
2025-06-05 15:07:48,073 - epoch:9, training loss:2431.8784 validation loss:32.2631
2025-06-05 15:07:53,461 - epoch:10, training loss:2408.4652 validation loss:30.7792
2025-06-05 15:07:58,829 - epoch:11, training loss:2400.8607 validation loss:32.7774
2025-06-05 15:08:04,395 - epoch:12, training loss:2391.7636 validation loss:33.9115
2025-06-05 15:08:10,721 - epoch:13, training loss:2389.7781 validation loss:33.7200
2025-06-05 15:08:16,223 - epoch:14, training loss:2392.2502 validation loss:36.8238
2025-06-05 15:08:21,806 - epoch:15, training loss:2403.5360 validation loss:33.1692
2025-06-05 15:08:27,073 - epoch:16, training loss:2374.5316 validation loss:30.8918
2025-06-05 15:09:24,918 - [*] loss:1751.4462
2025-06-05 15:09:32,102 - [*] year 2019, testing
2025-06-05 15:10:32,234 - T:3	MAE	19.8725	RMSE	30.4540	MAPE	13.5477
2025-06-05 15:12:25,770 - T:6	MAE	22.2663	RMSE	34.1423	MAPE	15.2287
2025-06-05 15:18:27,801 - T:12	MAE	27.1070	RMSE	41.4863	MAPE	19.3551
2025-06-05 15:18:27,802 - T:Avg	MAE	22.6720	RMSE	34.7122	MAPE	15.7146
2025-06-05 15:18:27,829 - Finished optimization, total time:53.27 s, best model:log/CA/online_st_nn_sd-42/2019/30.7792.pkl
2025-06-05 15:18:29,775 - [*] Year 2020 load from data/CA/FastData/2020.npz
2025-06-05 15:18:30,836 - [*] load from log/CA/online_st_nn_sd-42/2019/30.7792.pkl
2025-06-05 15:18:51,184 - number of increase nodes:0, nodes after 2 hop:torch.Size([539]), total nodes this year 8561
2025-06-05 15:18:51,184 - [*] load from log/CA/online_st_nn_sd-42/2019/30.7792.pkl
2025-06-05 15:20:32,837 - [*] loss:2157.2949
2025-06-05 15:20:40,087 - [*] year 2020, testing
2025-06-05 15:21:39,441 - T:3	MAE	29.0653	RMSE	40.1198	MAPE	25.9726
2025-06-05 15:23:31,471 - T:6	MAE	29.8315	RMSE	41.9818	MAPE	27.5961
2025-06-05 15:29:30,799 - T:12	MAE	32.1537	RMSE	46.2429	MAPE	31.3788
2025-06-05 15:29:30,799 - T:Avg	MAE	30.1567	RMSE	42.4109	MAPE	27.9637
2025-06-05 15:29:30,826 - [*] No increasing nodes at year 2020, store model of the last year.
2025-06-05 15:29:30,827 - 


2025-06-05 15:29:30,827 - 3   	 MAE	     24.00	     20.71	     19.87	     29.07		   23.41
2025-06-05 15:29:30,827 - 3   	RMSE	     34.98	     32.38	     30.45	     40.12		   34.48
2025-06-05 15:29:30,827 - 3   	MAPE	     17.49	     13.44	     13.55	     25.97		   17.61
2025-06-05 15:29:30,827 - 6   	 MAE	     25.32	     23.14	     22.27	     29.83		   25.14
2025-06-05 15:29:30,827 - 6   	RMSE	     37.80	     36.30	     34.14	     41.98		   37.56
2025-06-05 15:29:30,827 - 6   	MAPE	     18.00	     15.24	     15.23	     27.60		   19.02
2025-06-05 15:29:30,827 - 12  	 MAE	     29.12	     27.70	     27.11	     32.15		   29.02
2025-06-05 15:29:30,827 - 12  	RMSE	     44.80	     43.50	     41.49	     46.24		   44.01
2025-06-05 15:29:30,827 - 12  	MAPE	     20.00	     19.22	     19.36	     31.38		   22.49
2025-06-05 15:29:30,827 - Avg 	 MAE	     25.83	     23.45	     22.67	     30.16		   25.53
2025-06-05 15:29:30,827 - Avg 	RMSE	     38.59	     36.76	     34.71	     42.41		   38.12
2025-06-05 15:29:30,827 - Avg 	MAPE	     18.32	     15.65	     15.71	     27.96		   19.41
2025-06-05 15:29:30,827 - year	2017	total_time	 1646.9507	average_time	  137.2459	epoch	12
2025-06-05 15:29:30,827 - year	2018	total_time	   81.1400	average_time	    6.2416	epoch	13
2025-06-05 15:29:30,827 - year	2019	total_time	   53.2688	average_time	    3.1335	epoch	17
2025-06-05 15:29:30,827 - total time: 1781.3595
