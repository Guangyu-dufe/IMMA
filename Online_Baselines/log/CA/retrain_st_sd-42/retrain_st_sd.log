2025-06-04 14:28:19,669 - logger name:log/CA/retrain_st_sd-42/retrain_st_sd.log
2025-06-04 14:28:19,669 - params : {'conf': 'conf/CA/retrain_st_sd.json', 'seed': 42, 'paral': 0, 'gpuid': 1, 'logname': 'retrain_st_sd', 'method': 'TrafficStream', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/GBA/dlf-42/2017/30.0695.pkl', 'device': device(type='cuda', index=1), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>, 'DLF': <class 'src.model.model.DLF_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/CA/finaldata/', 'save_data_path': 'data/CA/FastData/', 'graph_path': 'data/CA/graph/', 'model_path': 'log/CA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'rank': 6, 'train': 1, 'strategy': 'retrain', 'init': False, 'increase': False, 'num_hops': 0, 'detect': False, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': False, 'path': 'log/CA/retrain_st_sd-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-04 14:44:25,928 - [*] Year 2017 load from data/CA/FastData/2017.npz
2025-06-04 14:44:27,597 - [*] Year 2017 Dataset load!
2025-06-04 14:44:27,613 - Total Parameters: 3308
2025-06-04 14:44:27,613 - Trainable Parameters: 3308
2025-06-04 14:44:27,615 - [*] Year 2017 Training start
2025-06-04 14:44:40,218 - node number torch.Size([1049088, 12])
2025-06-04 14:47:30,883 - epoch:0, training loss:17522.3199 validation loss:46.7894
2025-06-04 15:00:49,180 - epoch:1, training loss:2710.6360 validation loss:32.4963
2025-06-04 15:03:53,234 - epoch:2, training loss:2077.8149 validation loss:31.8023
2025-06-04 15:06:56,088 - epoch:3, training loss:1997.3748 validation loss:33.3688
2025-06-04 15:10:01,350 - epoch:4, training loss:1978.4727 validation loss:32.7290
2025-06-04 15:44:35,121 - epoch:5, training loss:1955.2809 validation loss:30.9248
2025-06-04 17:53:42,174 - epoch:6, training loss:1926.7865 validation loss:32.1844
2025-06-04 18:37:02,329 - epoch:7, training loss:1880.7876 validation loss:32.2528
2025-06-04 18:40:06,397 - epoch:8, training loss:1855.7215 validation loss:32.2282
2025-06-04 18:43:11,518 - epoch:9, training loss:1845.6359 validation loss:31.4990
2025-06-04 18:46:16,054 - epoch:10, training loss:1843.4178 validation loss:34.4975
2025-06-04 18:49:18,457 - epoch:11, training loss:1843.0817 validation loss:31.0497
2025-06-04 18:50:23,010 - [*] loss:2066.7861
2025-06-04 18:50:30,459 - [*] year 2017, testing
2025-06-04 18:51:30,729 - T:3	MAE	24.0046	RMSE	34.9756	MAPE	17.4856
2025-06-04 19:09:07,125 - T:6	MAE	25.3250	RMSE	37.7974	MAPE	18.0012
2025-06-05 00:36:46,064 - T:12	MAE	29.1151	RMSE	44.7982	MAPE	20.0028
2025-06-05 00:36:46,064 - T:Avg	MAE	25.8289	RMSE	38.5898	MAPE	18.3226
2025-06-05 00:36:46,095 - Finished optimization, total time:1149.76 s, best model:log/CA/retrain_st_sd-42/2017/30.9248.pkl
2025-06-05 00:39:46,576 - [*] Year 2018 load from data/CA/FastData/2018.npz
2025-06-05 00:39:47,240 - [*] Year 2018 Dataset load!
2025-06-05 00:39:47,242 - Total Parameters: 3308
2025-06-05 00:39:47,242 - Trainable Parameters: 3308
2025-06-05 00:39:47,242 - [*] Year 2018 Training start
2025-06-05 00:39:50,330 - node number torch.Size([1078784, 12])
2025-06-05 00:42:33,787 - epoch:0, training loss:17117.9252 validation loss:35.0823
2025-06-05 00:45:22,081 - epoch:1, training loss:2043.0305 validation loss:31.6450
2025-06-05 00:48:10,094 - epoch:2, training loss:1964.7254 validation loss:30.4636
2025-06-05 00:50:58,036 - epoch:3, training loss:1899.9901 validation loss:28.5031
2025-06-05 00:53:46,531 - epoch:4, training loss:1850.8848 validation loss:30.5601
2025-06-05 00:56:34,880 - epoch:5, training loss:1822.7568 validation loss:31.0568
2025-06-05 00:59:23,913 - epoch:6, training loss:1813.0183 validation loss:28.5165
2025-06-05 01:02:14,936 - epoch:7, training loss:1807.5246 validation loss:27.0880
2025-06-05 01:05:05,206 - epoch:8, training loss:1795.3875 validation loss:28.5758
2025-06-05 01:07:55,118 - epoch:9, training loss:1788.7718 validation loss:29.0469
2025-06-05 01:10:43,502 - epoch:10, training loss:1780.5963 validation loss:27.9155
2025-06-05 01:13:30,433 - epoch:11, training loss:1779.8080 validation loss:28.3258
2025-06-05 01:16:19,951 - epoch:12, training loss:1770.0362 validation loss:29.1561
2025-06-05 01:19:10,805 - epoch:13, training loss:1765.9611 validation loss:29.0413
2025-06-05 01:20:07,989 - [*] loss:1925.7723
2025-06-05 01:20:15,744 - [*] year 2018, testing
2025-06-05 01:21:16,924 - T:3	MAE	21.8334	RMSE	33.8616	MAPE	14.1302
2025-06-05 01:23:13,221 - T:6	MAE	23.9209	RMSE	37.1172	MAPE	16.1884
2025-06-05 01:30:39,694 - T:12	MAE	27.8841	RMSE	43.0163	MAPE	21.1471
2025-06-05 01:30:39,695 - T:Avg	MAE	24.1823	RMSE	37.4415	MAPE	16.7288
2025-06-05 01:30:39,724 - Finished optimization, total time:1245.77 s, best model:log/CA/retrain_st_sd-42/2018/27.088.pkl
2025-06-06 06:59:59,542 - logger name:log/CA/retrain_st_sd-42/retrain_st_sd.log
2025-06-06 06:59:59,543 - params : {'conf': 'conf/CA/retrain_st_sd.json', 'seed': 42, 'paral': 0, 'gpuid': 4, 'logname': 'retrain_st_sd', 'method': 'TrafficStream', 'load_first_year': 1, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/CA/trafficstream-42/2017/30.9248.pkl', 'device': device(type='cuda', index=4), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>, 'DLF': <class 'src.model.model.DLF_Model'>}, 'begin_year': 2018, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/CA/finaldata/', 'save_data_path': 'data/CA/FastData/', 'graph_path': 'data/CA/graph/', 'model_path': 'log/CA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'rank': 6, 'train': 1, 'strategy': 'retrain', 'init': False, 'increase': False, 'num_hops': 0, 'detect': False, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': False, 'path': 'log/CA/retrain_st_sd-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-06 07:00:00,569 - [*] Year 2018 load from data/CA/FastData/2018.npz
2025-06-06 07:00:01,409 - [*] load from /home/bd2/ANATS/Online_Baselines/log/CA/trafficstream-42/2017/30.9248.pkl
2025-06-06 07:01:20,410 - [*] loss:2010.6511
2025-06-06 07:01:26,605 - [*] year 2018, testing
2025-06-06 07:02:26,301 - T:3	MAE	22.8545	RMSE	34.3953	MAPE	16.6209
2025-06-06 07:04:19,929 - T:6	MAE	24.2659	RMSE	37.2540	MAPE	17.2779
2025-06-06 07:10:48,990 - T:12	MAE	28.1658	RMSE	44.1059	MAPE	19.6508
2025-06-06 07:10:48,991 - T:Avg	MAE	24.7675	RMSE	37.9893	MAPE	17.6448
2025-06-06 07:10:50,111 - [*] Year 2019 load from data/CA/FastData/2019.npz
2025-06-06 07:11:55,355 - [*] Year 2019 Dataset load!
2025-06-06 07:11:55,379 - Total Parameters: 3308
2025-06-06 07:11:55,379 - Trainable Parameters: 3308
2025-06-06 07:11:55,380 - [*] Year 2019 Training start
2025-06-06 07:11:57,689 - node number torch.Size([1100800, 12])
2025-06-06 07:14:50,092 - epoch:0, training loss:16957.7753 validation loss:39.4503
2025-06-06 07:17:47,979 - epoch:1, training loss:2454.3084 validation loss:31.3458
2025-06-06 07:20:45,257 - epoch:2, training loss:2090.3385 validation loss:29.9687
2025-06-06 07:23:51,603 - epoch:3, training loss:2014.1842 validation loss:30.3142
2025-06-06 07:26:49,049 - epoch:4, training loss:1986.1424 validation loss:29.8172
2025-06-06 07:29:46,000 - epoch:5, training loss:1945.7425 validation loss:30.0187
2025-06-06 07:32:41,995 - epoch:6, training loss:1888.9074 validation loss:29.7877
2025-06-06 07:35:38,222 - epoch:7, training loss:1860.3976 validation loss:30.7968
2025-06-06 07:38:34,843 - epoch:8, training loss:1854.6213 validation loss:30.9116
2025-06-06 07:41:36,497 - epoch:9, training loss:1849.7877 validation loss:29.7830
2025-06-06 07:44:43,801 - epoch:10, training loss:1847.7550 validation loss:30.0633
2025-06-06 07:47:42,946 - epoch:11, training loss:1848.7534 validation loss:28.4036
2025-06-06 07:50:52,559 - epoch:12, training loss:1839.5813 validation loss:30.7811
2025-06-06 07:53:52,099 - epoch:13, training loss:1840.2472 validation loss:29.1357
2025-06-06 07:56:51,537 - epoch:14, training loss:1835.2176 validation loss:28.2323
2025-06-06 07:59:51,106 - epoch:15, training loss:1839.5371 validation loss:27.6826
2025-06-06 08:02:48,181 - epoch:16, training loss:1839.3033 validation loss:29.2300
2025-06-06 08:05:45,600 - epoch:17, training loss:1833.6141 validation loss:30.9469
2025-06-06 08:08:43,724 - epoch:18, training loss:1830.1082 validation loss:30.1868
2025-06-06 08:11:43,002 - epoch:19, training loss:1835.2503 validation loss:27.8119
2025-06-06 08:14:40,883 - epoch:20, training loss:1836.5196 validation loss:30.4145
2025-06-06 08:17:40,638 - epoch:21, training loss:1830.7661 validation loss:30.0718
2025-06-06 08:18:43,028 - [*] loss:1683.8768
2025-06-06 08:19:24,853 - [*] year 2019, testing
2025-06-06 08:22:46,652 - T:3	MAE	19.6972	RMSE	30.4080	MAPE	13.4530
2025-06-06 08:27:04,535 - T:6	MAE	21.7771	RMSE	33.9765	MAPE	15.4675
2025-06-06 08:33:27,110 - T:12	MAE	25.9393	RMSE	40.5684	MAPE	21.2143
2025-06-06 08:33:27,111 - T:Avg	MAE	22.1052	RMSE	34.3838	MAPE	16.3156
2025-06-06 08:33:27,143 - Finished optimization, total time:2091.00 s, best model:log/CA/retrain_st_sd-42/2019/27.6826.pkl
2025-06-06 08:33:28,597 - [*] Year 2020 load from data/CA/FastData/2020.npz
2025-06-06 08:35:02,546 - [*] Year 2020 Dataset load!
2025-06-06 08:35:02,569 - Total Parameters: 3308
2025-06-06 08:35:02,569 - Trainable Parameters: 3308
2025-06-06 08:35:02,569 - [*] Year 2020 Training start
2025-06-06 08:35:05,585 - node number torch.Size([1095808, 12])
2025-06-06 08:38:04,441 - epoch:0, training loss:17715.3896 validation loss:31.2607
2025-06-06 08:41:10,431 - epoch:1, training loss:1850.0760 validation loss:29.1779
2025-06-06 08:44:04,609 - epoch:2, training loss:1747.6794 validation loss:28.7185
2025-06-06 08:46:58,174 - epoch:3, training loss:1667.8341 validation loss:28.8331
2025-06-06 08:49:53,896 - epoch:4, training loss:1653.3925 validation loss:31.6940
2025-06-06 08:52:48,345 - epoch:5, training loss:1643.0149 validation loss:29.8194
2025-06-06 08:55:44,077 - epoch:6, training loss:1639.7965 validation loss:26.8949
2025-06-06 08:58:39,479 - epoch:7, training loss:1635.9070 validation loss:27.5151
2025-06-06 09:01:35,427 - epoch:8, training loss:1631.2739 validation loss:31.6111
2025-06-06 09:04:30,569 - epoch:9, training loss:1624.9377 validation loss:29.9721
2025-06-06 09:07:26,534 - epoch:10, training loss:1622.1877 validation loss:28.0003
2025-06-06 09:10:22,333 - epoch:11, training loss:1621.8613 validation loss:28.7997
2025-06-06 09:13:18,166 - epoch:12, training loss:1621.0678 validation loss:32.6986
2025-06-06 09:14:17,240 - [*] loss:1896.2274
2025-06-06 09:14:24,632 - [*] year 2020, testing
2025-06-06 09:15:24,972 - T:3	MAE	28.3602	RMSE	38.8050	MAPE	22.9679
2025-06-06 09:17:21,870 - T:6	MAE	29.1078	RMSE	40.3879	MAPE	23.3964
2025-06-06 09:23:45,565 - T:12	MAE	30.7065	RMSE	43.3252	MAPE	26.1559
2025-06-06 09:23:45,565 - T:Avg	MAE	29.2483	RMSE	40.5552	MAPE	23.9160
2025-06-06 09:23:45,594 - Finished optimization, total time:1218.25 s, best model:log/CA/retrain_st_sd-42/2020/26.8949.pkl
2025-06-06 09:23:45,821 - 


2025-06-06 09:23:45,821 - 3   	 MAE	     22.85	     19.70	     28.36		   23.64
2025-06-06 09:23:45,821 - 3   	RMSE	     34.40	     30.41	     38.80		   34.54
2025-06-06 09:23:45,821 - 3   	MAPE	     16.62	     13.45	     22.97		   17.68
2025-06-06 09:23:45,821 - 6   	 MAE	     24.27	     21.78	     29.11		   25.05
2025-06-06 09:23:45,822 - 6   	RMSE	     37.25	     33.98	     40.39		   37.21
2025-06-06 09:23:45,822 - 6   	MAPE	     17.28	     15.47	     23.40		   18.71
2025-06-06 09:23:45,822 - 12  	 MAE	     28.17	     25.94	     30.71		   28.27
2025-06-06 09:23:45,822 - 12  	RMSE	     44.11	     40.57	     43.33		   42.67
2025-06-06 09:23:45,822 - 12  	MAPE	     19.65	     21.21	     26.16		   22.34
2025-06-06 09:23:45,822 - Avg 	 MAE	     24.77	     22.11	     29.25		   25.37
2025-06-06 09:23:45,822 - Avg 	RMSE	     37.99	     34.38	     40.56		   37.64
2025-06-06 09:23:45,822 - Avg 	MAPE	     17.64	     16.32	     23.92		   19.29
2025-06-06 09:23:45,822 - year	2019	total_time	 2090.9990	average_time	   95.0454	epoch	22
2025-06-06 09:23:45,822 - year	2020	total_time	 1218.2452	average_time	   93.7112	epoch	13
2025-06-06 09:23:45,822 - total time: 3309.2442
