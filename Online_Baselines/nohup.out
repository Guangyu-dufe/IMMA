2025-05-26 02:14:48,181 - logger name:log/SD/oneline_st_nn_sd-42/oneline_st_nn_sd.log
2025-05-26 02:14:48,181 - params : {'conf': 'conf/SD/online_st_nn.json', 'seed': 42, 'paral': 0, 'gpuid': 2, 'logname': 'oneline_st_nn_sd', 'method': 'TrafficStream', 'load_first_year': 0, 'first_year_model_path': 'log/SD/trafficstream-42/2019/22.3629.pkl', 'device': device(type='cuda', index=2), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/SD/finaldata/', 'save_data_path': 'data/SD/FastData/', 'graph_path': 'data/SD/graph/', 'model_path': 'log/SD/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'rank': 6, 'train': 1, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': False, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': False, 'path': 'log/SD/oneline_st_nn_sd-42', 'logger': <Logger utils.initialize (INFO)>}

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 862061.80it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 889265.03it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1049212.32it/s]
2025-05-26 02:15:04,307 - [*] Year 2017 load from data/SD/FastData/2017.npz
2025-05-26 02:15:04,586 - [*] Year 2017 Dataset load!
2025-05-26 02:15:04,589 - Total Parameters: 3308
2025-05-26 02:15:04,589 - Trainable Parameters: 3308
2025-05-26 02:15:04,589 - [*] Year 2017 Training start
2025-05-26 02:15:04,913 - node number torch.Size([90240, 12])
2025-05-26 02:15:09,743 - epoch:0, training loss:18180.7709 validation loss:49.8031
2025-05-26 02:15:14,379 - epoch:1, training loss:2851.6175 validation loss:35.2882
2025-05-26 02:15:19,128 - epoch:2, training loss:2227.2044 validation loss:33.5646
2025-05-26 02:15:23,818 - epoch:3, training loss:2138.6287 validation loss:34.8725
2025-05-26 02:15:28,443 - epoch:4, training loss:2108.3498 validation loss:35.1587
2025-05-26 02:15:33,215 - epoch:5, training loss:2056.2845 validation loss:32.7855
2025-05-26 02:15:38,043 - epoch:6, training loss:1987.8954 validation loss:32.9930
2025-05-26 02:15:42,970 - epoch:7, training loss:1949.6523 validation loss:33.3834
2025-05-26 02:15:47,742 - epoch:8, training loss:1951.7061 validation loss:34.9994
2025-05-26 02:15:52,621 - epoch:9, training loss:1935.0494 validation loss:35.8891
2025-05-26 02:15:57,376 - epoch:10, training loss:1943.1483 validation loss:35.6961
2025-05-26 02:16:02,225 - epoch:11, training loss:1925.6423 validation loss:33.4956
2025-05-26 02:16:04,421 - [*] loss:1991.8922
2025-05-26 02:16:04,947 - [*] year 2017, testing
2025-05-26 02:16:09,891 - T:3	MAE	23.9438	RMSE	33.7044	MAPE	18.1451
2025-05-26 02:16:19,483 - T:6	MAE	25.2292	RMSE	36.6673	MAPE	18.7154
2025-05-26 02:16:50,326 - T:12	MAE	29.0428	RMSE	44.2175	MAPE	20.9770
2025-05-26 02:16:50,326 - T:Avg	MAE	25.7522	RMSE	37.5641	MAPE	19.0944
2025-05-26 02:16:50,329 - Finished optimization, total time:30.47 s, best model:log/SD/oneline_st_nn_sd-42/2017/32.7855.pkl

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 954997.76it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 986505.86it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 995707.32it/s]
2025-05-26 02:17:06,933 - [*] Year 2018 load from data/SD/FastData/2018.npz
2025-05-26 02:17:06,973 - [*] load from log/SD/oneline_st_nn_sd-42/2017/32.7855.pkl
2025-05-26 02:17:07,860 - number of increase nodes:3, nodes after 2 hop:torch.Size([20]), total nodes this year 708
2025-05-26 02:17:07,960 - [*] Year 2018 Dataset load!
2025-05-26 02:17:07,960 - [*] load from log/SD/oneline_st_nn_sd-42/2017/32.7855.pkl
2025-05-26 02:17:07,963 - Total Parameters: 3308
2025-05-26 02:17:07,963 - Trainable Parameters: 3308
2025-05-26 02:17:07,963 - [*] Year 2018 Training start
2025-05-26 02:17:08,768 - node number torch.Size([2560, 12])
2025-05-26 02:17:11,918 - epoch:0, training loss:402.0954 validation loss:12.9358
2025-05-26 02:17:15,438 - epoch:1, training loss:345.2542 validation loss:13.9766
2025-05-26 02:17:18,587 - epoch:2, training loss:345.1395 validation loss:16.2838
2025-05-26 02:17:22,228 - epoch:3, training loss:344.1805 validation loss:15.4469
2025-05-26 02:17:25,475 - epoch:4, training loss:342.1581 validation loss:22.6723
2025-05-26 02:17:28,468 - epoch:5, training loss:344.1001 validation loss:17.4834
2025-05-26 02:17:31,736 - epoch:6, training loss:344.6253 validation loss:16.5306
2025-05-26 02:17:34,209 - [*] loss:2174.6890
2025-05-26 02:17:34,579 - [*] year 2018, testing
2025-05-26 02:17:38,438 - T:3	MAE	20.9406	RMSE	31.2304	MAPE	14.9745
2025-05-26 02:17:45,940 - T:6	MAE	23.7356	RMSE	35.8792	MAPE	16.8609
2025-05-26 02:18:12,724 - T:12	MAE	29.8716	RMSE	46.1223	MAPE	20.8344
2025-05-26 02:18:12,724 - T:Avg	MAE	24.3275	RMSE	36.8873	MAPE	17.2057
2025-05-26 02:18:12,727 - Finished optimization, total time:13.75 s, best model:log/SD/oneline_st_nn_sd-42/2018/12.9358.pkl

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 958298.23it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1039184.14it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1059105.09it/s]
2025-05-26 02:18:29,093 - [*] Year 2019 load from data/SD/FastData/2019.npz
2025-05-26 02:18:29,139 - [*] load from log/SD/oneline_st_nn_sd-42/2018/12.9358.pkl
2025-05-26 02:18:30,060 - number of increase nodes:8, nodes after 2 hop:torch.Size([54]), total nodes this year 716
2025-05-26 02:18:30,322 - [*] Year 2019 Dataset load!
2025-05-26 02:18:30,322 - [*] load from log/SD/oneline_st_nn_sd-42/2018/12.9358.pkl
2025-05-26 02:18:30,325 - Total Parameters: 3308
2025-05-26 02:18:30,325 - Trainable Parameters: 3308
2025-05-26 02:18:30,326 - [*] Year 2019 Training start
2025-05-26 02:18:31,437 - node number torch.Size([6912, 12])
2025-05-26 02:18:34,731 - epoch:0, training loss:505.0802 validation loss:14.8691
2025-05-26 02:18:38,602 - epoch:1, training loss:497.6128 validation loss:14.6718
2025-05-26 02:18:42,874 - epoch:2, training loss:487.8237 validation loss:14.7424
2025-05-26 02:18:47,006 - epoch:3, training loss:488.6302 validation loss:14.8976
2025-05-26 02:18:51,007 - epoch:4, training loss:485.4686 validation loss:16.5373
2025-05-26 02:18:54,985 - epoch:5, training loss:490.1910 validation loss:16.8476
2025-05-26 02:18:59,158 - epoch:6, training loss:512.0275 validation loss:15.7198
2025-05-26 02:19:03,151 - epoch:7, training loss:485.3146 validation loss:15.0226
2025-05-26 02:19:06,039 - [*] loss:2236.8862
2025-05-26 02:19:06,458 - [*] year 2019, testing
2025-05-26 02:19:10,988 - T:3	MAE	23.2672	RMSE	33.7225	MAPE	21.2728
2025-05-26 02:19:20,032 - T:6	MAE	26.2879	RMSE	38.4292	MAPE	23.5339
2025-05-26 02:19:50,416 - T:12	MAE	31.5213	RMSE	47.0798	MAPE	27.4172
2025-05-26 02:19:50,416 - T:Avg	MAE	26.5334	RMSE	38.9405	MAPE	23.7296
2025-05-26 02:19:50,419 - Finished optimization, total time:18.60 s, best model:log/SD/oneline_st_nn_sd-42/2019/14.6718.pkl

  0%|          | 0/21080 [00:00<?, ?it/s]
100%|██████████| 21080/21080 [00:00<00:00, 955692.90it/s]

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 986545.45it/s]

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 1024388.84it/s]
2025-05-26 02:20:06,977 - [*] Year 2020 load from data/SD/FastData/2020.npz
2025-05-26 02:20:07,017 - [*] load from log/SD/oneline_st_nn_sd-42/2019/14.6718.pkl
2025-05-26 02:20:08,005 - number of increase nodes:0, nodes after 2 hop:torch.Size([54]), total nodes this year 697
2025-05-26 02:20:08,005 - [*] load from log/SD/oneline_st_nn_sd-42/2019/14.6718.pkl
2025-05-26 02:20:11,678 - [*] loss:3929.6252
2025-05-26 02:20:12,045 - [*] year 2020, testing
2025-05-26 02:20:16,102 - T:3	MAE	47.7425	RMSE	58.6549	MAPE	53.9550
2025-05-26 02:20:23,545 - T:6	MAE	49.3436	RMSE	61.1777	MAPE	56.0941
2025-05-26 02:20:49,325 - T:12	MAE	49.9964	RMSE	63.2355	MAPE	58.7244
2025-05-26 02:20:49,326 - T:Avg	MAE	48.9066	RMSE	60.7422	MAPE	55.9981
2025-05-26 02:20:49,328 - [*] No increasing nodes at year 2020, store model of the last year.
2025-05-26 02:20:49,329 - 


2025-05-26 02:20:49,329 - 3   	 MAE	     23.94	     20.94	     23.27	     47.74		   28.97
2025-05-26 02:20:49,329 - 3   	RMSE	     33.70	     31.23	     33.72	     58.65		   39.33
2025-05-26 02:20:49,329 - 3   	MAPE	     18.15	     14.97	     21.27	     53.96		   27.09
2025-05-26 02:20:49,329 - 6   	 MAE	     25.23	     23.74	     26.29	     49.34		   31.15
2025-05-26 02:20:49,329 - 6   	RMSE	     36.67	     35.88	     38.43	     61.18		   43.04
2025-05-26 02:20:49,329 - 6   	MAPE	     18.72	     16.86	     23.53	     56.09		   28.80
2025-05-26 02:20:49,329 - 12  	 MAE	     29.04	     29.87	     31.52	     50.00		   35.11
2025-05-26 02:20:49,329 - 12  	RMSE	     44.22	     46.12	     47.08	     63.24		   50.16
2025-05-26 02:20:49,329 - 12  	MAPE	     20.98	     20.83	     27.42	     58.72		   31.99
2025-05-26 02:20:49,329 - Avg 	 MAE	     25.75	     24.33	     26.53	     48.91		   31.38
2025-05-26 02:20:49,329 - Avg 	RMSE	     37.56	     36.89	     38.94	     60.74		   43.53
2025-05-26 02:20:49,329 - Avg 	MAPE	     19.09	     17.21	     23.73	     56.00		   29.01
2025-05-26 02:20:49,329 - year	2017	total_time	   30.4654	average_time	    2.5388	epoch	12
2025-05-26 02:20:49,329 - year	2018	total_time	   13.7492	average_time	    1.9642	epoch	7
2025-05-26 02:20:49,330 - year	2019	total_time	   18.5999	average_time	    2.3250	epoch	8
2025-05-26 02:20:49,330 - total time: 62.8145
2025-05-29 02:20:48,493 - logger name:log/SD/pecpm-42/pecpm.log
2025-05-29 02:20:48,493 - params : {'conf': 'conf/SD/pecpm.json', 'seed': 42, 'paral': 0, 'gpuid': 2, 'logname': 'pecpm', 'method': 'PECPM', 'load_first_year': 0, 'first_year_model_path': 'log/SD/pecpm-42/2017/31.5668.pkl', 'device': device(type='cuda', index=2), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'PECPM': <class 'src.model.model.PECPM_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'beita': 1.0, 'cluster': 32, 'raw_data_path': 'data/SD/finaldata/', 'save_data_path': 'data/SD/FastData/', 'graph_path': 'data/SD/graph/', 'model_path': 'log/SD/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'train': 1, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'adp_adj': False, 'skip_dim': 64, 'end_dim': 64, 'hidden_channels': 32, 'dilation_channels': 64, 'residual_channels': 64, 'input_dim': 1, 'output_dim': 1, 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 300, 'path': 'log/SD/pecpm-42', 'logger': <Logger utils.initialize (INFO)>}
2025-05-29 02:20:48,540 - [*] Year 2017 load from data/SD/FastData/2017.npz
2025-05-29 02:21:01,504 - [*] Year 2017 Dataset load!
2025-05-29 02:21:01,508 - [*] Year 2017 Training start
2025-05-29 02:21:03,310 - node number torch.Size([90240, 12])
2025-05-29 02:21:09,510 - epoch:0, training loss:18116.4573 validation loss:48.7356
2025-05-29 02:21:16,180 - epoch:1, training loss:2853.1238 validation loss:36.2958
2025-05-29 02:21:22,652 - epoch:2, training loss:2221.4153 validation loss:34.4193
2025-05-29 02:21:29,421 - epoch:3, training loss:2140.8676 validation loss:35.3845
2025-05-29 02:21:36,089 - epoch:4, training loss:2095.6261 validation loss:34.4393
2025-05-29 02:21:43,097 - epoch:5, training loss:2042.8313 validation loss:34.6641
2025-05-29 02:21:49,781 - epoch:6, training loss:1975.2769 validation loss:35.4132
2025-05-29 02:21:56,305 - epoch:7, training loss:1949.2893 validation loss:32.9056
2025-05-29 02:22:02,917 - epoch:8, training loss:1931.3821 validation loss:33.6320
2025-05-29 02:22:09,566 - epoch:9, training loss:1925.1775 validation loss:33.2861
2025-05-29 02:22:16,274 - epoch:10, training loss:1926.4316 validation loss:31.6286
2025-05-29 02:22:23,139 - epoch:11, training loss:1902.6118 validation loss:35.3045
2025-05-29 02:22:29,712 - epoch:12, training loss:1895.4016 validation loss:32.1190
2025-05-29 02:22:36,412 - epoch:13, training loss:1908.2196 validation loss:31.9693
2025-05-29 02:22:42,697 - epoch:14, training loss:1884.6085 validation loss:32.5072
2025-05-29 02:22:49,331 - epoch:15, training loss:1887.4055 validation loss:32.9792
2025-05-29 02:22:55,944 - epoch:16, training loss:1880.3362 validation loss:33.9163
2025-05-29 02:22:58,731 - [*] loss:1856.0039
2025-05-29 02:22:59,106 - [*] year 2017, testing
2025-05-29 02:23:03,931 - T:3	MAE	22.0811	RMSE	31.4733	MAPE	15.7790
2025-05-29 02:23:13,226 - T:6	MAE	23.9858	RMSE	35.1588	MAPE	16.8380
2025-05-29 02:23:43,048 - T:12	MAE	28.0770	RMSE	42.6223	MAPE	20.3057
2025-05-29 02:23:43,048 - T:Avg	MAE	24.3363	RMSE	35.7310	MAPE	17.4045
2025-05-29 02:23:43,051 - Finished optimization, total time:55.79 s, best model:log/SD/pecpm-42/2017/31.6286.pkl
2025-05-29 02:23:43,126 - [*] Year 2018 load from data/SD/FastData/2018.npz
2025-05-29 02:23:43,154 - [*] load from log/SD/pecpm-42/2017/31.5668.pkl
2025-05-29 02:23:43,162 - [*] detect strategy feature
2025-05-29 02:23:44,770 - number of increase nodes:72, nodes after 2 hop:torch.Size([562]), total nodes this year 708
2025-05-29 02:24:27,664 - [*] Year 2018 Dataset load!
2025-05-29 02:24:27,664 - [*] load from log/SD/pecpm-42/2017/31.5668.pkl
2025-05-29 02:24:27,668 - [*] EWC! lambda 0.000100
2025-05-29 02:24:36,452 - [*] Year 2018 Training start
2025-05-29 02:24:40,166 - node number torch.Size([71936, 12])
2025-05-29 02:24:48,575 - epoch:0, training loss:1991.7770 validation loss:28.5345
2025-05-29 02:24:58,034 - epoch:1, training loss:1930.8792 validation loss:28.4678
2025-05-29 02:25:07,552 - epoch:2, training loss:1929.8499 validation loss:31.7958
2025-05-29 02:25:18,306 - epoch:3, training loss:1915.8881 validation loss:28.0249
2025-05-29 02:25:29,374 - epoch:4, training loss:1878.4091 validation loss:30.4537
2025-05-29 02:25:40,311 - epoch:5, training loss:1890.0546 validation loss:28.3654
2025-05-29 02:25:51,272 - epoch:6, training loss:1877.7323 validation loss:29.3239
2025-05-29 02:26:02,197 - epoch:7, training loss:1862.8350 validation loss:28.3130
2025-05-29 02:26:13,887 - epoch:8, training loss:1857.7369 validation loss:28.5585
2025-05-29 02:26:22,472 - epoch:9, training loss:1869.1283 validation loss:29.3014
2025-05-29 02:26:26,444 - [*] loss:1829.6702
2025-05-29 02:26:26,483 - [*] year 2018, testing
2025-05-29 02:26:26,911 - T:3	MAE	19.8727	RMSE	29.2953	MAPE	14.4779
2025-05-29 02:26:27,759 - T:6	MAE	22.1685	RMSE	33.0390	MAPE	16.6409
2025-05-29 02:26:30,538 - T:12	MAE	26.5282	RMSE	40.1759	MAPE	20.7708
2025-05-29 02:26:30,539 - T:Avg	MAE	22.4643	RMSE	33.5151	MAPE	16.9623
2025-05-29 02:26:30,539 - Finished optimization, total time:60.77 s, best model:log/SD/pecpm-42/2018/28.0249.pkl
2025-05-29 02:26:30,704 - [*] Year 2019 load from data/SD/FastData/2019.npz
2025-05-29 02:26:30,710 - [*] load from log/SD/pecpm-42/2018/28.0249.pkl
2025-05-29 02:26:30,725 - [*] detect strategy feature
2025-05-29 02:26:32,822 - number of increase nodes:79, nodes after 2 hop:torch.Size([587]), total nodes this year 716
2025-05-29 02:27:18,483 - [*] Year 2019 Dataset load!
2025-05-29 02:27:18,484 - [*] load from log/SD/pecpm-42/2018/28.0249.pkl
2025-05-29 02:27:18,488 - [*] EWC! lambda 0.000100
2025-05-29 02:27:27,265 - [*] Year 2019 Training start
2025-05-29 02:27:31,420 - node number torch.Size([75136, 12])
2025-05-29 02:27:41,026 - epoch:0, training loss:1970.5410 validation loss:29.4730
2025-05-29 02:27:50,865 - epoch:1, training loss:1932.7118 validation loss:28.4102
2025-05-29 02:28:02,361 - epoch:2, training loss:1932.4293 validation loss:28.1091
2025-05-29 02:28:12,119 - epoch:3, training loss:1928.6549 validation loss:28.0385
2025-05-29 02:28:20,380 - epoch:4, training loss:1922.8941 validation loss:29.4981
2025-05-29 02:28:28,918 - epoch:5, training loss:1942.2327 validation loss:28.1857
2025-05-29 02:28:39,024 - epoch:6, training loss:1930.9373 validation loss:28.2773
2025-05-29 02:28:48,523 - epoch:7, training loss:1928.0461 validation loss:29.3281
2025-05-29 02:28:59,048 - epoch:8, training loss:1921.9390 validation loss:29.5778
2025-05-29 02:29:09,555 - epoch:9, training loss:1926.1555 validation loss:28.9543
2025-05-29 02:29:13,336 - [*] loss:1848.2471
2025-05-29 02:29:13,499 - [*] year 2019, testing
2025-05-29 02:29:14,233 - T:3	MAE	20.9140	RMSE	31.0161	MAPE	16.7194
2025-05-29 02:29:16,980 - T:6	MAE	23.0909	RMSE	34.4828	MAPE	18.6198
2025-05-29 02:29:28,472 - T:12	MAE	27.4059	RMSE	41.2785	MAPE	22.5347
2025-05-29 02:29:28,473 - T:Avg	MAE	23.4218	RMSE	34.9757	MAPE	18.9653
2025-05-29 02:29:28,475 - Finished optimization, total time:57.44 s, best model:log/SD/pecpm-42/2019/28.0385.pkl
2025-05-29 02:29:28,643 - [*] Year 2020 load from data/SD/FastData/2020.npz
2025-05-29 02:29:28,654 - [*] load from log/SD/pecpm-42/2019/28.0385.pkl
2025-05-29 02:29:28,664 - [*] detect strategy feature
2025-05-29 02:29:30,387 - number of increase nodes:65, nodes after 2 hop:torch.Size([578]), total nodes this year 697
2025-05-29 02:30:12,185 - [*] Year 2020 Dataset load!
2025-05-29 02:30:12,186 - [*] load from log/SD/pecpm-42/2019/28.0385.pkl
2025-05-29 02:30:12,190 - [*] EWC! lambda 0.000100
2025-05-29 02:30:20,843 - [*] Year 2020 Training start
2025-05-29 02:30:23,297 - node number torch.Size([73984, 12])
2025-05-29 02:30:31,318 - epoch:0, training loss:1821.0969 validation loss:37.1670
2025-05-29 02:30:41,508 - epoch:1, training loss:1772.5882 validation loss:34.5862
2025-05-29 02:30:50,084 - epoch:2, training loss:1771.2748 validation loss:33.3430
2025-05-29 02:30:58,558 - epoch:3, training loss:1765.6560 validation loss:33.5241
2025-05-29 02:31:07,077 - epoch:4, training loss:1777.2841 validation loss:35.7127
2025-05-29 02:31:16,167 - epoch:5, training loss:1768.0659 validation loss:33.3349
2025-05-29 02:31:25,188 - epoch:6, training loss:1764.8791 validation loss:36.4794
2025-05-29 02:31:34,347 - epoch:7, training loss:1772.5122 validation loss:36.1998
2025-05-29 02:31:44,972 - epoch:8, training loss:1766.8204 validation loss:33.9192
2025-05-29 02:31:55,589 - epoch:9, training loss:1776.3634 validation loss:38.7947
2025-05-29 02:32:04,753 - epoch:10, training loss:1769.2178 validation loss:33.9215
2025-05-29 02:32:19,984 - epoch:11, training loss:1766.8376 validation loss:37.7438
2025-05-29 02:32:24,379 - [*] loss:2931.2944
2025-05-29 02:32:24,447 - [*] year 2020, testing
2025-05-29 02:32:24,863 - T:3	MAE	42.2826	RMSE	50.3731	MAPE	47.2463
2025-05-29 02:32:26,484 - T:6	MAE	42.5178	RMSE	51.4402	MAPE	48.1182
2025-05-29 02:32:33,087 - T:12	MAE	43.3924	RMSE	53.7057	MAPE	49.9750
2025-05-29 02:32:33,087 - T:Avg	MAE	42.6032	RMSE	51.5589	MAPE	48.2385
2025-05-29 02:32:33,088 - Finished optimization, total time:66.15 s, best model:log/SD/pecpm-42/2020/33.3349.pkl
2025-05-29 02:32:33,224 - 


2025-05-29 02:32:33,225 - 3   	 MAE	     22.08	     19.87	     20.91	     42.28		   26.29
2025-05-29 02:32:33,225 - 3   	RMSE	     31.47	     29.30	     31.02	     50.37		   35.54
2025-05-29 02:32:33,225 - 3   	MAPE	     15.78	     14.48	     16.72	     47.25		   23.56
2025-05-29 02:32:33,225 - 6   	 MAE	     23.99	     22.17	     23.09	     42.52		   27.94
2025-05-29 02:32:33,225 - 6   	RMSE	     35.16	     33.04	     34.48	     51.44		   38.53
2025-05-29 02:32:33,225 - 6   	MAPE	     16.84	     16.64	     18.62	     48.12		   25.05
2025-05-29 02:32:33,225 - 12  	 MAE	     28.08	     26.53	     27.41	     43.39		   31.35
2025-05-29 02:32:33,225 - 12  	RMSE	     42.62	     40.18	     41.28	     53.71		   44.45
2025-05-29 02:32:33,225 - 12  	MAPE	     20.31	     20.77	     22.53	     49.98		   28.40
2025-05-29 02:32:33,225 - Avg 	 MAE	     24.34	     22.46	     23.42	     42.60		   28.21
2025-05-29 02:32:33,225 - Avg 	RMSE	     35.73	     33.52	     34.98	     51.56		   38.95
2025-05-29 02:32:33,225 - Avg 	MAPE	     17.40	     16.96	     18.97	     48.24		   25.39
2025-05-29 02:32:33,225 - year	2017	total_time	   55.7861	average_time	    3.2815	epoch	17
2025-05-29 02:32:33,225 - year	2018	total_time	   60.7689	average_time	    6.0769	epoch	10
2025-05-29 02:32:33,226 - year	2019	total_time	   57.4389	average_time	    5.7439	epoch	10
2025-05-29 02:32:33,226 - year	2020	total_time	   66.1503	average_time	    5.5125	epoch	12
2025-05-29 02:32:33,226 - total time: 240.1442
Traceback (most recent call last):
  File "/home/bd2/ANATS/Oline_Baselines/main.py", line 8, in <module>
    from torch_geometric.loader import DataLoader
  File "/home/bd2/miniconda3/lib/python3.12/site-packages/torch_geometric/__init__.py", line 4, in <module>
    import torch_geometric.typing
  File "/home/bd2/miniconda3/lib/python3.12/site-packages/torch_geometric/typing.py", line 10, in <module>
    from torch import Tensor
ImportError: cannot import name 'Tensor' from 'torch' (unknown location)
2025-05-29 11:28:40,950 - logger name:log/SD/team-42/team.log
2025-05-29 11:28:40,950 - params : {'conf': 'conf/SD/team.json', 'seed': 42, 'paral': 0, 'gpuid': 2, 'logname': 'team', 'method': 'TEAM', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/Oline_Baselines/log/SD/TEAM-42/2017/51.0326.pkl', 'device': device(type='cuda', index=2), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 16, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'n_heads': 3, 'in_channels': 1, 'K': 3, 'nb_block': 1, 'nb_chev_filter': 64, 'nb_time_filter': 64, 'num_of_hours': 1, 'missing_value': 0.0, 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/SD/finaldata/', 'save_data_path': 'data/SD/FastData/', 'graph_path': 'data/SD/graph', 'model_path': 'log/SD/', 'strategy': 'incremental', 'init': True, 'increase': True, 'decrease': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'original', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.001, 'replay': True, 'replay_strategy': 'distribution', 'replay_num_samples': 100, 'path': 'log/SD/team-42', 'logger': <Logger utils.initialize (INFO)>}
2025-05-29 11:28:40,978 - [*] Year 2017 load from data/SD/FastData/2017.npz
2025-05-29 11:28:46,495 - [*] Year 2017 Dataset load!
2025-05-29 11:28:46,568 - Total Parameters: 71948
2025-05-29 11:28:46,568 - Trainable Parameters: 71948
2025-05-29 11:28:46,568 - [*] Year 2017 Training start
2025-05-29 11:28:46,917 - node number torch.Size([11280, 12])
2025-05-29 11:31:13,604 - epoch:0, training loss:5221.2297 validation loss:62.2977
2025-05-29 11:33:44,051 - epoch:1, training loss:5152.2649 validation loss:55.9722
2025-05-29 11:36:10,851 - epoch:2, training loss:6155.5198 validation loss:54.0785
2025-05-29 11:38:38,102 - epoch:3, training loss:5561.1589 validation loss:46.2101
2025-05-29 11:41:04,703 - epoch:4, training loss:4482.9777 validation loss:41.9492
2025-05-29 11:43:30,038 - epoch:5, training loss:4375.5569 validation loss:48.1124
2025-05-29 11:45:54,732 - epoch:6, training loss:3954.6944 validation loss:46.2101
2025-05-29 11:48:19,460 - epoch:7, training loss:3636.2873 validation loss:43.5587
2025-05-29 11:50:42,612 - epoch:8, training loss:3351.9523 validation loss:38.8605
2025-05-29 11:53:06,669 - epoch:9, training loss:3135.8678 validation loss:38.6019
2025-05-29 11:55:31,092 - epoch:10, training loss:4061.1279 validation loss:40.5328
2025-05-29 11:57:59,033 - epoch:11, training loss:5728.8047 validation loss:59.0892
2025-05-29 12:00:25,088 - epoch:12, training loss:10225.2986 validation loss:69.0253
2025-05-29 12:02:50,199 - epoch:13, training loss:9814.0702 validation loss:62.7199
2025-05-29 12:05:15,114 - epoch:14, training loss:11397.2299 validation loss:74.0670
2025-05-29 12:07:40,256 - epoch:15, training loss:9920.8961 validation loss:66.3954
2025-05-29 12:08:30,686 - [*] loss:2691.3208
2025-05-29 12:08:31,959 - [*] year 2017, testing
2025-05-29 12:08:39,410 - T:3	MAE	28.9929	RMSE	42.6369	MAPE	26.8138
2025-05-29 12:08:58,930 - T:6	MAE	30.7783	RMSE	45.4074	MAPE	26.6165
2025-05-29 12:10:10,070 - T:12	MAE	34.7907	RMSE	51.4867	MAPE	27.7377
2025-05-29 12:10:10,070 - T:Avg	MAE	31.1610	RMSE	45.9624	MAPE	26.9632
2025-05-29 12:10:10,073 - Finished optimization, total time:1526.87 s, best model:log/SD/team-42/2017/38.6019.pkl
2025-05-29 12:10:10,122 - [*] Year 2018 load from data/SD/FastData/2018.npz
2025-05-29 12:10:10,156 - [*] load from log/SD/team-42/2017/38.6019.pkl
2025-05-29 12:10:12,585 - number of increase nodes:137, nodes after 2 hop:torch.Size([620]), total nodes this year 708
2025-05-29 12:10:26,866 - [*] Year 2018 Dataset load!
2025-05-29 12:10:26,867 - [*] load from log/SD/team-42/2017/38.6019.pkl
2025-05-29 12:10:26,876 - [*] EWC! lambda 0.001000
Traceback (most recent call last):
  File "/home/bd2/ANATS/Oline_Baselines/main.py", line 199, in <module>
  File "/home/bd2/ANATS/Oline_Baselines/main.py", line 149, in main
  File "/home/bd2/ANATS/Oline_Baselines/src/trainer/default_trainer.py", line 60, in train
  File "/home/bd2/ANATS/Oline_Baselines/src/model/ewc.py", line 69, in register_ewc_params
  File "/home/bd2/ANATS/Oline_Baselines/src/model/ewc.py", line 35, in _update_fisher_params
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/autograd/__init__.py", line 502, in grad
    result = _engine_run_backward(
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/autograd/graph.py", line 824, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: One of the differentiated Tensors appears to not have been used in the graph. Set allow_unused=True if this is the desired behavior.
2025-06-01 23:39:12,331 - logger name:log/SD/team-42/team.log
2025-06-01 23:39:12,331 - params : {'conf': 'conf/SD/team.json', 'seed': 42, 'paral': 0, 'gpuid': 2, 'logname': 'team', 'method': 'TEAM', 'load_first_year': 1, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/SD/team-42/2017/38.6019.pkl', 'device': device(type='cuda', index=2), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 16, 'epoch': 1, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'n_heads': 3, 'in_channels': 1, 'K': 3, 'nb_block': 1, 'nb_chev_filter': 64, 'nb_time_filter': 64, 'num_of_hours': 1, 'missing_value': 0.0, 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/SD/finaldata/', 'save_data_path': 'data/SD/FastData/', 'graph_path': 'data/SD/graph', 'model_path': 'log/SD/', 'strategy': 'incremental', 'init': True, 'increase': True, 'decrease': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'original', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.001, 'replay': True, 'replay_strategy': 'distribution', 'replay_num_samples': 100, 'path': 'log/SD/team-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-01 23:39:12,359 - [*] Year 2017 load from data/SD/FastData/2017.npz
2025-06-01 23:39:12,622 - [*] load from /home/bd2/ANATS/Online_Baselines/log/SD/team-42/2017/38.6019.pkl
2025-06-01 23:39:14,469 - [*] Year 2018 load from data/SD/FastData/2018.npz
2025-06-01 23:39:14,480 - [*] load from /home/bd2/ANATS/Online_Baselines/log/SD/team-42/2017/38.6019.pkl
2025-06-01 23:39:15,938 - number of increase nodes:137, nodes after 2 hop:torch.Size([620]), total nodes this year 708
2025-06-01 23:39:24,049 - [*] Year 2018 Dataset load!
2025-06-01 23:39:24,049 - [*] load from /home/bd2/ANATS/Online_Baselines/log/SD/team-42/2017/38.6019.pkl
2025-06-01 23:39:24,057 - [*] EWC! lambda 0.001000
2025-06-01 23:41:00,160 - Total Parameters: 71948
2025-06-01 23:41:00,160 - Trainable Parameters: 71948
2025-06-01 23:41:00,160 - [*] Year 2018 Training start
2025-06-01 23:41:00,892 - node number torch.Size([9920, 12])
2025-06-01 23:43:09,889 - epoch:0, training loss:11812.6313 validation loss:34.3456
2025-06-01 23:43:58,930 - [*] loss:2546.6331
2025-06-01 23:43:59,569 - [*] year 2018, testing
2025-06-01 23:44:03,608 - T:3	MAE	26.3986	RMSE	41.4928	MAPE	21.8376
2025-06-01 23:44:12,047 - T:6	MAE	28.3897	RMSE	44.0994	MAPE	23.5138
2025-06-01 23:44:40,036 - T:12	MAE	32.8177	RMSE	50.0077	MAPE	28.3374
2025-06-01 23:44:40,037 - T:Avg	MAE	28.8164	RMSE	44.6904	MAPE	24.1563
2025-06-01 23:44:40,040 - Finished optimization, total time:88.39 s, best model:log/SD/team-42/2018/34.3456.pkl
2025-06-01 23:44:40,095 - [*] Year 2019 load from data/SD/FastData/2019.npz
2025-06-01 23:44:40,126 - [*] load from log/SD/team-42/2018/32.915.pkl
2025-06-01 23:44:41,828 - number of increase nodes:142, nodes after 2 hop:torch.Size([584]), total nodes this year 716
2025-06-01 23:44:52,859 - [*] Year 2019 Dataset load!
2025-06-01 23:44:52,859 - [*] load from log/SD/team-42/2018/32.915.pkl
2025-06-01 23:44:52,867 - [*] EWC! lambda 0.001000
2025-06-01 23:46:05,421 - logger name:log/SD/team-42/team.log
2025-06-01 23:46:05,421 - params : {'conf': 'conf/SD/team.json', 'seed': 42, 'paral': 0, 'gpuid': 2, 'logname': 'team', 'method': 'TEAM', 'load_first_year': 1, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/SD/team-42/2017/38.6019.pkl', 'device': device(type='cuda', index=2), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 16, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'n_heads': 3, 'in_channels': 1, 'K': 3, 'nb_block': 1, 'nb_chev_filter': 64, 'nb_time_filter': 64, 'num_of_hours': 1, 'missing_value': 0.0, 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/SD/finaldata/', 'save_data_path': 'data/SD/FastData/', 'graph_path': 'data/SD/graph', 'model_path': 'log/SD/', 'strategy': 'incremental', 'init': True, 'increase': True, 'decrease': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'original', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.001, 'replay': True, 'replay_strategy': 'distribution', 'replay_num_samples': 100, 'path': 'log/SD/team-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-01 23:46:05,450 - [*] Year 2017 load from data/SD/FastData/2017.npz
2025-06-01 23:46:05,710 - [*] load from /home/bd2/ANATS/Online_Baselines/log/SD/team-42/2017/38.6019.pkl
2025-06-01 23:46:57,006 - [*] loss:2691.3208
2025-06-01 23:46:57,624 - [*] year 2017, testing
2025-06-01 23:47:02,111 - T:3	MAE	28.9929	RMSE	42.6369	MAPE	26.8138
2025-06-01 23:47:11,088 - T:6	MAE	30.7783	RMSE	45.4074	MAPE	26.6165
2025-06-01 23:47:40,309 - T:12	MAE	34.7907	RMSE	51.4867	MAPE	27.7377
2025-06-01 23:47:40,310 - T:Avg	MAE	31.1610	RMSE	45.9624	MAPE	26.9632
2025-06-01 23:47:40,340 - [*] Year 2018 load from data/SD/FastData/2018.npz
2025-06-01 23:47:40,370 - [*] load from /home/bd2/ANATS/Online_Baselines/log/SD/team-42/2017/38.6019.pkl
2025-06-01 23:47:41,825 - number of increase nodes:137, nodes after 2 hop:torch.Size([620]), total nodes this year 708
2025-06-01 23:47:49,706 - [*] Year 2018 Dataset load!
2025-06-01 23:47:49,706 - [*] load from /home/bd2/ANATS/Online_Baselines/log/SD/team-42/2017/38.6019.pkl
2025-06-01 23:47:49,713 - [*] EWC! lambda 0.001000
2025-06-01 23:49:24,254 - Total Parameters: 71948
2025-06-01 23:49:24,255 - Trainable Parameters: 71948
2025-06-01 23:49:24,256 - [*] Year 2018 Training start
2025-06-01 23:49:25,806 - node number torch.Size([9920, 12])
2025-06-01 23:51:47,993 - epoch:0, training loss:8716.7875 validation loss:33.2417
2025-06-01 23:54:10,902 - epoch:1, training loss:8678.1395 validation loss:35.8867
2025-06-01 23:56:36,689 - epoch:2, training loss:11024.7211 validation loss:35.2883
2025-06-01 23:58:58,447 - epoch:3, training loss:15807.2635 validation loss:35.8144
2025-06-02 00:01:22,472 - epoch:4, training loss:9075.0189 validation loss:34.4341
2025-06-02 00:03:47,894 - epoch:5, training loss:16531.8675 validation loss:33.9845
2025-06-02 00:06:11,510 - epoch:6, training loss:13182.3248 validation loss:34.0297
2025-06-02 00:07:01,416 - [*] loss:2581.0906
2025-06-02 00:07:02,193 - [*] year 2018, testing
2025-06-02 00:07:07,000 - T:3	MAE	27.3490	RMSE	41.6368	MAPE	33.7161
2025-06-02 00:07:15,877 - T:6	MAE	29.8069	RMSE	44.6147	MAPE	36.5239
2025-06-02 00:07:45,622 - T:12	MAE	34.2764	RMSE	50.3339	MAPE	42.0114
2025-06-02 00:07:45,623 - T:Avg	MAE	30.0401	RMSE	44.9832	MAPE	36.8189
2025-06-02 00:07:45,626 - Finished optimization, total time:692.36 s, best model:log/SD/team-42/2018/33.2417.pkl
2025-06-02 00:07:45,686 - [*] Year 2019 load from data/SD/FastData/2019.npz
2025-06-02 00:07:45,731 - [*] load from log/SD/team-42/2018/32.915.pkl
2025-06-02 00:07:47,238 - number of increase nodes:142, nodes after 2 hop:torch.Size([584]), total nodes this year 716
2025-06-02 00:07:55,314 - [*] Year 2019 Dataset load!
2025-06-02 00:07:55,314 - [*] load from log/SD/team-42/2018/32.915.pkl
2025-06-02 00:07:55,325 - [*] EWC! lambda 0.001000
2025-06-02 00:09:29,322 - Total Parameters: 71948
2025-06-02 00:09:29,322 - Trainable Parameters: 71948
2025-06-02 00:09:29,322 - [*] Year 2019 Training start
2025-06-02 00:09:30,617 - node number torch.Size([9344, 12])
2025-06-02 00:11:44,914 - epoch:0, training loss:10669.2158 validation loss:37.4776
2025-06-02 00:13:05,563 - logger name:log/SD/dlf-42/dlf.log
2025-06-02 00:13:05,563 - params : {'conf': 'conf/SD/dlf.json', 'seed': 42, 'paral': 0, 'gpuid': 3, 'logname': 'dlf', 'method': 'DLF', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/SD/dlf-42/2017/31.671.pkl', 'device': device(type='cuda', index=3), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>, 'DLF': <class 'src.model.model.DLF_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 1, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/SD/finaldata/', 'save_data_path': 'data/SD/FastData/', 'graph_path': 'data/SD/graph/', 'model_path': 'log/SD/', 'hidden_channels': 64, 'dilation_channels': 32, 'skip_channels': 32, 'end_channels': 32, 'supports_len': 2, 'kernel_size': 2, 'blocks': 4, 'layers': 2, 'rank': 6, 'train': 1, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'replay_num_samples': 300, 'extra_feature': True, 'momentum_type': 'linear', 'memory_size': 32, 'path': 'log/SD/dlf-42', 'logger': <Logger utils.initialize (INFO)>}

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 818149.24it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1041467.09it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1031404.73it/s]
2025-06-02 00:13:21,868 - [*] Year 2017 load from data/SD/FastData/2017.npz
2025-06-02 00:13:22,142 - [*] Year 2017 Dataset load!
2025-06-02 00:13:22,149 - Total Parameters: 65356
2025-06-02 00:13:22,149 - Trainable Parameters: 65356
2025-06-02 00:13:22,149 - [*] Year 2017 Training start
2025-06-02 00:13:22,661 - node number torch.Size([90240, 12])
2025-06-02 00:14:03,353 - epoch:1, training loss:8999.3940 validation loss:34.1728
2025-06-02 00:14:45,576 - epoch:0, training loss:7196.6323 validation loss:31.6710
2025-06-02 00:15:08,225 - [*] loss:2247.4675
2025-06-02 00:15:08,823 - [*] year 2017, testing
2025-06-02 00:15:13,735 - T:3	MAE	23.5428	RMSE	34.1038	MAPE	18.4450
2025-06-02 00:15:23,186 - T:6	MAE	26.4065	RMSE	38.4616	MAPE	20.9504
2025-06-02 00:15:53,609 - T:12	MAE	32.0533	RMSE	47.0150	MAPE	25.9530
2025-06-02 00:15:53,610 - T:Avg	MAE	26.8866	RMSE	39.1409	MAPE	21.4446
2025-06-02 00:15:53,613 - Finished optimization, total time:59.79 s, best model:log/SD/dlf-42/2017/31.671.pkl

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 954790.94it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 973770.35it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 998096.70it/s]
2025-06-02 00:16:08,391 - [*] Year 2018 load from data/SD/FastData/2018.npz
2025-06-02 00:16:08,425 - [*] load from log/SD/dlf-42/2017/31.671.pkl
2025-06-02 00:16:13,341 - number of increase nodes:259, nodes after 2 hop:torch.Size([675]), total nodes this year 708
2025-06-02 00:16:16,569 - [*] Year 2018 Dataset load!
2025-06-02 00:16:16,570 - [*] load from log/SD/dlf-42/2017/31.671.pkl
2025-06-02 00:16:16,587 - [*] EWC! lambda 0.000100
2025-06-02 00:16:23,573 - epoch:2, training loss:8622.9266 validation loss:34.5657
2025-06-02 00:17:14,984 - Total Parameters: 65356
2025-06-02 00:17:14,984 - Trainable Parameters: 65356
2025-06-02 00:17:14,985 - [*] Year 2018 Training start
2025-06-02 00:17:16,085 - node number torch.Size([86400, 12])
2025-06-02 00:18:31,930 - epoch:0, training loss:2940.8485 validation loss:28.6843
2025-06-02 00:18:42,676 - epoch:3, training loss:7890.2277 validation loss:37.1485
2025-06-02 00:18:55,008 - [*] loss:1965.9445
2025-06-02 00:18:55,612 - [*] year 2018, testing
2025-06-02 00:18:59,964 - T:3	MAE	22.0456	RMSE	32.2007	MAPE	14.5897
2025-06-02 00:19:09,023 - T:6	MAE	24.7186	RMSE	36.4195	MAPE	16.5017
2025-06-02 00:19:37,815 - T:12	MAE	29.5722	RMSE	43.7775	MAPE	21.0761
2025-06-02 00:19:37,815 - T:Avg	MAE	25.0111	RMSE	36.7961	MAPE	16.9936
2025-06-02 00:19:37,818 - Finished optimization, total time:57.11 s, best model:log/SD/dlf-42/2018/28.6843.pkl

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 969221.37it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1090771.20it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 947852.83it/s]
2025-06-02 00:19:53,151 - [*] Year 2019 load from data/SD/FastData/2019.npz
2025-06-02 00:19:53,184 - [*] load from log/SD/dlf-42/2018/28.6843.pkl
2025-06-02 00:19:58,973 - number of increase nodes:281, nodes after 2 hop:torch.Size([704]), total nodes this year 716
2025-06-02 00:20:02,366 - [*] Year 2019 Dataset load!
2025-06-02 00:20:02,366 - [*] load from log/SD/dlf-42/2018/28.6843.pkl
2025-06-02 00:20:02,373 - [*] EWC! lambda 0.000100
2025-06-02 00:20:59,980 - epoch:4, training loss:12499.0181 validation loss:34.0450
2025-06-02 00:21:02,044 - Total Parameters: 65356
2025-06-02 00:21:02,044 - Trainable Parameters: 65356
2025-06-02 00:21:02,044 - [*] Year 2019 Training start
2025-06-02 00:21:03,485 - node number torch.Size([90112, 12])
2025-06-02 00:22:21,874 - epoch:0, training loss:2508.2504 validation loss:31.5853
2025-06-02 00:22:46,402 - [*] loss:1855.5870
2025-06-02 00:22:47,036 - [*] year 2019, testing
2025-06-02 00:22:51,364 - T:3	MAE	22.4008	RMSE	32.5677	MAPE	20.7584
2025-06-02 00:23:00,451 - T:6	MAE	24.6466	RMSE	36.3151	MAPE	21.7902
2025-06-02 00:23:17,592 - epoch:5, training loss:26816.4019 validation loss:34.4858
2025-06-02 00:23:30,361 - T:12	MAE	28.7462	RMSE	43.0584	MAPE	23.9216
2025-06-02 00:23:30,361 - T:Avg	MAE	24.9042	RMSE	36.7078	MAPE	21.9676
2025-06-02 00:23:30,364 - Finished optimization, total time:58.60 s, best model:log/SD/dlf-42/2019/31.5853.pkl

  0%|          | 0/21080 [00:00<?, ?it/s]
100%|██████████| 21080/21080 [00:00<00:00, 914284.97it/s]

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 1037770.51it/s]

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 1064123.17it/s]
2025-06-02 00:23:44,674 - [*] Year 2020 load from data/SD/FastData/2020.npz
2025-06-02 00:23:44,705 - [*] load from log/SD/dlf-42/2019/31.5853.pkl
2025-06-02 00:23:45,537 - The number of data points in the previous year is greater than the current year, skipping detection and replay.
2025-06-02 00:23:45,606 - number of increase nodes:238, nodes after 2 hop:torch.Size([653]), total nodes this year 697
2025-06-02 00:23:48,506 - [*] Year 2020 Dataset load!
2025-06-02 00:23:48,506 - [*] load from log/SD/dlf-42/2019/31.5853.pkl
2025-06-02 00:23:48,514 - [*] EWC! lambda 0.000100
2025-06-02 00:24:47,284 - Total Parameters: 65356
2025-06-02 00:24:47,284 - Trainable Parameters: 65356
2025-06-02 00:24:47,284 - [*] Year 2020 Training start
2025-06-02 00:24:48,687 - node number torch.Size([83584, 12])
2025-06-02 00:25:38,197 - epoch:6, training loss:8871.6293 validation loss:35.9058
2025-06-02 00:26:04,865 - logger name:log/SD/dlf-42/dlf.log
2025-06-02 00:26:04,865 - params : {'conf': 'conf/SD/dlf.json', 'seed': 42, 'paral': 0, 'gpuid': 3, 'logname': 'dlf', 'method': 'DLF', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/SD/dlf-42/2017/31.671.pkl', 'device': device(type='cuda', index=3), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>, 'DLF': <class 'src.model.model.DLF_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/SD/finaldata/', 'save_data_path': 'data/SD/FastData/', 'graph_path': 'data/SD/graph/', 'model_path': 'log/SD/', 'hidden_channels': 64, 'dilation_channels': 32, 'skip_channels': 32, 'end_channels': 32, 'supports_len': 2, 'kernel_size': 2, 'blocks': 4, 'layers': 2, 'rank': 6, 'train': 1, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'replay_num_samples': 300, 'extra_feature': True, 'momentum_type': 'linear', 'memory_size': 32, 'path': 'log/SD/dlf-42', 'logger': <Logger utils.initialize (INFO)>}

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 879964.60it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 640540.85it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 888047.02it/s]
2025-06-02 00:26:19,806 - [*] Year 2017 load from data/SD/FastData/2017.npz
2025-06-02 00:26:20,098 - [*] Year 2017 Dataset load!
2025-06-02 00:26:20,110 - Total Parameters: 65356
2025-06-02 00:26:20,110 - Trainable Parameters: 65356
2025-06-02 00:26:20,110 - [*] Year 2017 Training start
2025-06-02 00:26:20,728 - node number torch.Size([90240, 12])
2025-06-02 00:27:44,237 - epoch:0, training loss:7196.6323 validation loss:31.6710
2025-06-02 00:27:44,493 - epoch:7, training loss:20488.7161 validation loss:35.0383
2025-06-02 00:29:08,223 - epoch:1, training loss:2104.6924 validation loss:40.4166
2025-06-02 00:30:00,893 - epoch:8, training loss:49244.4796 validation loss:36.0437
2025-06-02 00:30:32,636 - epoch:2, training loss:1930.7860 validation loss:31.7446
2025-06-02 00:31:56,983 - epoch:3, training loss:1844.0051 validation loss:28.2482
2025-06-02 00:32:15,843 - epoch:9, training loss:7689.8473 validation loss:37.2409
2025-06-02 00:33:21,478 - epoch:4, training loss:1800.9172 validation loss:45.2169
2025-06-02 00:34:34,162 - epoch:10, training loss:5708.3640 validation loss:36.5760
2025-06-02 00:34:45,785 - epoch:5, training loss:1792.4544 validation loss:30.6545
2025-06-02 00:35:22,007 - [*] loss:2696.8413
2025-06-02 00:35:22,620 - [*] year 2019, testing
2025-06-02 00:35:27,396 - T:3	MAE	26.8033	RMSE	42.6574	MAPE	20.8304
2025-06-02 00:35:36,839 - T:6	MAE	28.8644	RMSE	45.4132	MAPE	21.7880
2025-06-02 00:36:08,131 - T:12	MAE	33.1820	RMSE	51.3457	MAPE	24.3252
2025-06-02 00:36:08,131 - T:Avg	MAE	29.2325	RMSE	45.9412	MAPE	22.0985
2025-06-02 00:36:08,134 - Finished optimization, total time:1031.57 s, best model:log/SD/team-42/2019/34.045.pkl
2025-06-02 00:36:08,187 - [*] Year 2020 load from data/SD/FastData/2020.npz
2025-06-02 00:36:08,208 - [*] load from log/SD/team-42/2019/34.045.pkl
2025-06-02 00:36:09,044 - The number of data points in the previous year is greater than the current year, skipping detection and replay.
Traceback (most recent call last):
  File "/home/bd2/ANATS/Online_Baselines/main.py", line 199, in <module>
    main(args)
  File "/home/bd2/ANATS/Online_Baselines/main.py", line 98, in main
    replay_node_list = replay.replay_node_selection(args,influence_node_score,topk, pre_data, cur_data, pre_graph, cur_graph)  # Select the replay node
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/ANATS/Online_Baselines/src/model/replay.py", line 16, in replay_node_selection
    return select_stablest_node(args, pre_data, cur_data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/ANATS/Online_Baselines/src/model/replay.py", line 81, in select_stablest_node
    max_val = max(max(pre_data[:,node]), max(cur_data[:,node]))
                                             ~~~~~~~~^^^^^^^^
IndexError: index 697 is out of bounds for axis 1 with size 697
2025-06-02 00:36:10,737 - epoch:6, training loss:1777.4417 validation loss:31.5215
2025-06-02 00:37:35,134 - epoch:7, training loss:1743.9149 validation loss:34.0433
2025-06-02 00:38:59,622 - epoch:8, training loss:1705.0685 validation loss:33.6474
2025-06-02 00:40:24,262 - epoch:9, training loss:1705.7145 validation loss:56.2629
2025-06-02 00:40:47,620 - [*] loss:1847.6704
2025-06-02 00:40:48,268 - [*] year 2017, testing
2025-06-02 00:40:53,326 - T:3	MAE	22.1317	RMSE	32.4090	MAPE	14.4053
2025-06-02 00:41:03,054 - T:6	MAE	24.2099	RMSE	36.0276	MAPE	15.3224
2025-06-02 00:41:33,608 - T:12	MAE	28.1551	RMSE	42.5165	MAPE	17.5778
2025-06-02 00:41:33,609 - T:Avg	MAE	24.4584	RMSE	36.3658	MAPE	15.5460
2025-06-02 00:41:33,612 - Finished optimization, total time:606.53 s, best model:log/SD/dlf-42/2017/28.2482.pkl

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 952244.12it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 998797.65it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1018879.09it/s]
2025-06-02 00:41:50,532 - [*] Year 2018 load from data/SD/FastData/2018.npz
2025-06-02 00:41:50,562 - [*] load from log/SD/dlf-42/2017/28.2482.pkl
2025-06-02 00:41:55,953 - number of increase nodes:257, nodes after 2 hop:torch.Size([672]), total nodes this year 708
2025-06-02 00:41:59,338 - [*] Year 2018 Dataset load!
2025-06-02 00:41:59,338 - [*] load from log/SD/dlf-42/2017/28.2482.pkl
2025-06-02 00:41:59,344 - [*] EWC! lambda 0.000100
2025-06-02 00:42:57,987 - Total Parameters: 65356
2025-06-02 00:42:57,987 - Trainable Parameters: 65356
2025-06-02 00:42:57,988 - [*] Year 2018 Training start
2025-06-02 00:42:59,365 - node number torch.Size([86016, 12])
2025-06-02 00:44:14,073 - epoch:0, training loss:2509.0505 validation loss:30.4772
2025-06-02 00:45:29,840 - epoch:1, training loss:1851.7660 validation loss:30.9340
2025-06-02 00:46:45,833 - epoch:2, training loss:1881.0195 validation loss:28.9639
2025-06-02 00:48:01,634 - epoch:3, training loss:1869.9861 validation loss:30.9686
2025-06-02 00:49:17,199 - epoch:4, training loss:1873.2658 validation loss:27.6727
2025-06-02 00:50:32,925 - epoch:5, training loss:1845.5599 validation loss:30.7919
2025-06-02 00:51:48,586 - epoch:6, training loss:1851.0169 validation loss:31.2532
2025-06-02 00:53:04,701 - epoch:7, training loss:1884.0265 validation loss:30.0359
2025-06-02 00:54:21,270 - epoch:8, training loss:1814.3454 validation loss:27.9502
2025-06-02 00:55:37,966 - epoch:9, training loss:1833.7571 validation loss:31.7728
2025-06-02 00:56:54,757 - epoch:10, training loss:1850.3220 validation loss:26.9738
2025-06-02 00:58:11,198 - epoch:11, training loss:1827.5216 validation loss:37.4960
2025-06-02 00:59:27,279 - epoch:12, training loss:1852.1778 validation loss:33.8409
2025-06-02 01:00:43,286 - epoch:13, training loss:1838.3743 validation loss:28.1975
2025-06-02 01:01:59,747 - epoch:14, training loss:1816.2119 validation loss:26.6384
2025-06-02 01:03:16,723 - epoch:15, training loss:1807.5202 validation loss:33.1939
2025-06-02 01:04:33,210 - epoch:16, training loss:1778.6210 validation loss:27.2122
2025-06-02 01:05:49,819 - epoch:17, training loss:1791.6584 validation loss:49.5714
2025-06-02 01:07:06,117 - epoch:18, training loss:1949.7983 validation loss:28.7293
2025-06-02 01:08:22,631 - epoch:19, training loss:1841.0365 validation loss:38.0953
2025-06-02 01:09:38,853 - epoch:20, training loss:1831.3413 validation loss:34.2402
2025-06-02 01:10:02,333 - [*] loss:1884.7456
2025-06-02 01:10:03,036 - [*] year 2018, testing
2025-06-02 01:10:08,084 - T:3	MAE	23.1710	RMSE	32.6413	MAPE	15.6562
2025-06-02 01:10:17,789 - T:6	MAE	25.1825	RMSE	36.1195	MAPE	16.4318
2025-06-02 01:10:48,208 - T:12	MAE	29.2605	RMSE	42.8137	MAPE	18.2449
2025-06-02 01:10:48,208 - T:Avg	MAE	25.5626	RMSE	36.6578	MAPE	16.6565
2025-06-02 01:10:48,211 - Finished optimization, total time:1184.66 s, best model:log/SD/dlf-42/2018/26.6384.pkl

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 884972.13it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1053587.59it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 930626.42it/s]
2025-06-02 01:11:03,256 - [*] Year 2019 load from data/SD/FastData/2019.npz
2025-06-02 01:11:03,288 - [*] load from log/SD/dlf-42/2018/26.6384.pkl
2025-06-02 01:11:08,735 - number of increase nodes:278, nodes after 2 hop:torch.Size([705]), total nodes this year 716
2025-06-02 01:11:12,167 - [*] Year 2019 Dataset load!
2025-06-02 01:11:12,167 - [*] load from log/SD/dlf-42/2018/26.6384.pkl
2025-06-02 01:11:12,175 - [*] EWC! lambda 0.000100
2025-06-02 01:12:11,927 - Total Parameters: 65356
2025-06-02 01:12:11,927 - Trainable Parameters: 65356
2025-06-02 01:12:11,928 - [*] Year 2019 Training start
2025-06-02 01:12:13,195 - node number torch.Size([90240, 12])
2025-06-02 01:13:33,574 - epoch:0, training loss:2113.3819 validation loss:29.9758
2025-06-02 01:14:55,208 - epoch:1, training loss:1653.3108 validation loss:26.5892
2025-06-02 01:16:16,871 - epoch:2, training loss:1599.9435 validation loss:27.4907
2025-06-02 01:17:38,425 - epoch:3, training loss:1635.6971 validation loss:30.1147
2025-06-02 01:19:00,083 - epoch:4, training loss:1618.4038 validation loss:30.3949
2025-06-02 01:20:21,838 - epoch:5, training loss:1642.9984 validation loss:26.2347
2025-06-02 01:21:43,530 - epoch:6, training loss:1601.1373 validation loss:27.5474
2025-06-02 01:23:05,291 - epoch:7, training loss:1579.9563 validation loss:29.8453
2025-06-02 01:23:52,544 - logger name:log/SD/team-42/team.log
2025-06-02 01:23:52,544 - params : {'conf': 'conf/SD/team.json', 'seed': 42, 'paral': 0, 'gpuid': 1, 'logname': 'team', 'method': 'TEAM', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/SD/team-42/2019/34.045.pkl', 'device': device(type='cuda', index=1), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>, 'DLF': <class 'src.model.model.DLF_Model'>}, 'begin_year': 2019, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.001, 'batch_size': 16, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'n_heads': 3, 'in_channels': 1, 'K': 3, 'nb_block': 1, 'nb_chev_filter': 64, 'nb_time_filter': 64, 'num_of_hours': 1, 'missing_value': 0.0, 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/SD/finaldata/', 'save_data_path': 'data/SD/FastData/', 'graph_path': 'data/SD/graph', 'model_path': 'log/SD/', 'strategy': 'incremental', 'init': True, 'increase': True, 'decrease': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'original', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.001, 'replay': True, 'replay_strategy': 'distribution', 'replay_num_samples': 100, 'path': 'log/SD/team-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-02 01:23:52,572 - [*] Year 2019 load from data/SD/FastData/2019.npz
2025-06-02 01:23:58,480 - [*] Year 2019 Dataset load!
2025-06-02 01:23:58,550 - Total Parameters: 71948
2025-06-02 01:23:58,550 - Trainable Parameters: 71948
2025-06-02 01:23:58,550 - [*] Year 2019 Training start
2025-06-02 01:23:58,879 - node number torch.Size([11456, 12])
2025-06-02 01:24:21,589 - logger name:log/SD/team-42/team.log
2025-06-02 01:24:21,589 - params : {'conf': 'conf/SD/team.json', 'seed': 42, 'paral': 0, 'gpuid': 1, 'logname': 'team', 'method': 'TEAM', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/SD/team-42/2019/34.045.pkl', 'device': device(type='cuda', index=1), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>, 'DLF': <class 'src.model.model.DLF_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.001, 'batch_size': 16, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'n_heads': 3, 'in_channels': 1, 'K': 3, 'nb_block': 1, 'nb_chev_filter': 64, 'nb_time_filter': 64, 'num_of_hours': 1, 'missing_value': 0.0, 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/SD/finaldata/', 'save_data_path': 'data/SD/FastData/', 'graph_path': 'data/SD/graph', 'model_path': 'log/SD/', 'strategy': 'incremental', 'init': True, 'increase': True, 'decrease': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'original', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.001, 'replay': True, 'replay_strategy': 'distribution', 'replay_num_samples': 100, 'path': 'log/SD/team-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-02 01:24:21,617 - [*] Year 2017 load from data/SD/FastData/2017.npz
2025-06-02 01:24:27,025 - epoch:8, training loss:1580.5638 validation loss:26.8440
2025-06-02 01:24:27,699 - [*] Year 2017 Dataset load!
2025-06-02 01:24:27,769 - Total Parameters: 71948
2025-06-02 01:24:27,769 - Trainable Parameters: 71948
2025-06-02 01:24:27,769 - [*] Year 2017 Training start
2025-06-02 01:24:28,234 - node number torch.Size([11280, 12])
2025-06-02 01:25:48,579 - epoch:9, training loss:1563.3874 validation loss:26.5572
2025-06-02 01:26:54,276 - epoch:0, training loss:4979.5676 validation loss:33.0177
2025-06-02 01:27:10,336 - epoch:10, training loss:1601.8382 validation loss:25.4796
2025-06-02 01:28:31,981 - epoch:11, training loss:1620.8848 validation loss:29.5006
2025-06-02 01:29:21,442 - epoch:1, training loss:1998.6516 validation loss:36.3522
2025-06-02 01:29:53,842 - epoch:12, training loss:1615.1679 validation loss:26.8030
2025-06-02 01:31:15,701 - epoch:13, training loss:1568.7212 validation loss:28.0253
2025-06-02 01:31:47,504 - epoch:2, training loss:1955.6941 validation loss:31.9118
2025-06-02 01:32:37,534 - epoch:14, training loss:1529.8779 validation loss:26.3450
2025-06-02 01:33:59,418 - epoch:15, training loss:1566.8313 validation loss:26.4343
2025-06-02 01:34:15,630 - epoch:3, training loss:1946.0439 validation loss:32.3946
2025-06-02 01:35:21,139 - epoch:16, training loss:1620.7155 validation loss:27.7142
2025-06-02 01:35:45,640 - [*] loss:1927.9308
2025-06-02 01:35:46,291 - [*] year 2019, testing
2025-06-02 01:35:51,356 - T:3	MAE	22.3071	RMSE	32.7992	MAPE	15.1691
2025-06-02 01:36:01,024 - T:6	MAE	24.7901	RMSE	36.7774	MAPE	16.4047
2025-06-02 01:36:32,325 - T:12	MAE	29.1893	RMSE	43.7997	MAPE	19.0613
2025-06-02 01:36:32,326 - T:Avg	MAE	25.0117	RMSE	37.1242	MAPE	16.6733
2025-06-02 01:36:32,329 - Finished optimization, total time:1028.87 s, best model:log/SD/dlf-42/2019/25.4796.pkl

  0%|          | 0/21080 [00:00<?, ?it/s]
100%|██████████| 21080/21080 [00:00<00:00, 838805.09it/s]

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 1122567.13it/s]

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 1034867.60it/s]
2025-06-02 01:36:42,166 - epoch:4, training loss:1917.2070 validation loss:32.2744
2025-06-02 01:36:47,621 - [*] Year 2020 load from data/SD/FastData/2020.npz
2025-06-02 01:36:47,663 - [*] load from log/SD/dlf-42/2019/25.4796.pkl
2025-06-02 01:36:48,518 - The number of data points in the previous year is greater than the current year, skipping detection and replay.
2025-06-02 01:36:48,573 - number of increase nodes:238, nodes after 2 hop:torch.Size([653]), total nodes this year 697
2025-06-02 01:36:51,647 - [*] Year 2020 Dataset load!
2025-06-02 01:36:51,648 - [*] load from log/SD/dlf-42/2019/25.4796.pkl
2025-06-02 01:36:51,657 - [*] EWC! lambda 0.000100
2025-06-02 01:37:50,277 - Total Parameters: 65356
2025-06-02 01:37:50,277 - Trainable Parameters: 65356
2025-06-02 01:37:50,277 - [*] Year 2020 Training start
2025-06-02 01:37:51,615 - node number torch.Size([83584, 12])
2025-06-02 01:39:04,289 - epoch:0, training loss:2314.4644 validation loss:38.5985
2025-06-02 01:39:04,671 - epoch:5, training loss:1904.9939 validation loss:38.6732
2025-06-02 01:40:19,071 - epoch:1, training loss:1793.0200 validation loss:31.9612
2025-06-02 01:41:32,167 - epoch:6, training loss:1893.2596 validation loss:34.0369
2025-06-02 01:41:33,927 - epoch:2, training loss:1752.7867 validation loss:37.7423
2025-06-02 01:42:49,169 - epoch:3, training loss:1800.2883 validation loss:33.0579
2025-06-02 01:43:55,815 - epoch:7, training loss:1884.8124 validation loss:34.2177
2025-06-02 01:44:04,472 - epoch:4, training loss:1750.2913 validation loss:29.2194
2025-06-02 01:45:19,807 - epoch:5, training loss:1790.9523 validation loss:37.1418
2025-06-02 01:46:24,601 - epoch:8, training loss:1868.5500 validation loss:34.8974
2025-06-02 01:46:35,086 - epoch:6, training loss:1731.8607 validation loss:35.4781
2025-06-02 01:47:14,081 - [*] loss:1852.3949
2025-06-02 01:47:14,747 - [*] year 2017, testing
2025-06-02 01:47:19,136 - T:3	MAE	22.9463	RMSE	32.4929	MAPE	16.5591
2025-06-02 01:47:27,811 - T:6	MAE	24.6977	RMSE	35.7780	MAPE	16.9448
2025-06-02 01:47:50,590 - epoch:7, training loss:1739.1734 validation loss:30.4070
2025-06-02 01:47:56,610 - T:12	MAE	28.6516	RMSE	42.5720	MAPE	18.2432
2025-06-02 01:47:56,611 - T:Avg	MAE	25.0682	RMSE	36.3078	MAPE	17.1384
2025-06-02 01:47:56,613 - Finished optimization, total time:863.27 s, best model:log/SD/team-42/2017/31.9118.pkl
2025-06-02 01:47:56,789 - [*] Year 2018 load from data/SD/FastData/2018.npz
2025-06-02 01:47:56,820 - [*] load from log/SD/team-42/2017/31.9118.pkl
2025-06-02 01:47:58,285 - number of increase nodes:137, nodes after 2 hop:torch.Size([620]), total nodes this year 708
2025-06-02 01:48:06,785 - [*] Year 2018 Dataset load!
2025-06-02 01:48:06,785 - [*] load from log/SD/team-42/2017/31.9118.pkl
2025-06-02 01:48:06,793 - [*] EWC! lambda 0.001000
2025-06-02 01:49:05,850 - epoch:8, training loss:1762.5835 validation loss:49.5665
2025-06-02 01:49:39,770 - Total Parameters: 71948
2025-06-02 01:49:39,771 - Trainable Parameters: 71948
2025-06-02 01:49:39,771 - [*] Year 2018 Training start
2025-06-02 01:49:40,966 - node number torch.Size([9920, 12])
2025-06-02 01:50:20,842 - epoch:9, training loss:1725.2193 validation loss:36.3240
2025-06-02 01:51:35,868 - epoch:10, training loss:1682.9189 validation loss:34.0991
2025-06-02 01:51:49,554 - epoch:0, training loss:1888.7280 validation loss:29.9726
2025-06-02 01:52:00,529 - [*] loss:3518.0488
2025-06-02 01:52:01,169 - [*] year 2020, testing
2025-06-02 01:52:06,133 - T:3	MAE	42.3264	RMSE	53.4463	MAPE	46.3636
2025-06-02 01:52:15,664 - T:6	MAE	43.4221	RMSE	55.3639	MAPE	48.4725
2025-06-02 01:52:46,063 - T:12	MAE	45.9162	RMSE	59.3954	MAPE	53.2939
2025-06-02 01:52:46,064 - T:Avg	MAE	43.6753	RMSE	55.7285	MAPE	48.8355
2025-06-02 01:52:46,066 - Finished optimization, total time:610.40 s, best model:log/SD/dlf-42/2020/29.2194.pkl
2025-06-02 01:52:46,079 - 


2025-06-02 01:52:46,079 - 3   	 MAE	     22.13	     23.17	     22.31	     42.33		   27.48
2025-06-02 01:52:46,079 - 3   	RMSE	     32.41	     32.64	     32.80	     53.45		   37.82
2025-06-02 01:52:46,079 - 3   	MAPE	     14.41	     15.66	     15.17	     46.36		   22.90
2025-06-02 01:52:46,079 - 6   	 MAE	     24.21	     25.18	     24.79	     43.42		   29.40
2025-06-02 01:52:46,079 - 6   	RMSE	     36.03	     36.12	     36.78	     55.36		   41.07
2025-06-02 01:52:46,079 - 6   	MAPE	     15.32	     16.43	     16.40	     48.47		   24.16
2025-06-02 01:52:46,079 - 12  	 MAE	     28.16	     29.26	     29.19	     45.92		   33.13
2025-06-02 01:52:46,079 - 12  	RMSE	     42.52	     42.81	     43.80	     59.40		   47.13
2025-06-02 01:52:46,080 - 12  	MAPE	     17.58	     18.24	     19.06	     53.29		   27.04
2025-06-02 01:52:46,080 - Avg 	 MAE	     24.46	     25.56	     25.01	     43.68		   29.68
2025-06-02 01:52:46,080 - Avg 	RMSE	     36.37	     36.66	     37.12	     55.73		   41.47
2025-06-02 01:52:46,080 - Avg 	MAPE	     15.55	     16.66	     16.67	     48.84		   24.43
2025-06-02 01:52:46,080 - year	2017	total_time	  606.5290	average_time	   60.6529	epoch	10
2025-06-02 01:52:46,080 - year	2018	total_time	 1184.6645	average_time	   56.4126	epoch	21
2025-06-02 01:52:46,080 - year	2019	total_time	 1028.8709	average_time	   60.5218	epoch	17
2025-06-02 01:52:46,080 - year	2020	total_time	  610.4007	average_time	   55.4910	epoch	11
2025-06-02 01:52:46,080 - total time: 3430.4651
2025-06-02 01:54:06,500 - epoch:1, training loss:1885.8443 validation loss:30.5649
2025-06-02 01:56:25,525 - epoch:2, training loss:1885.4710 validation loss:29.5849
2025-06-02 01:58:49,020 - epoch:3, training loss:1895.4948 validation loss:34.9627
2025-06-02 02:01:11,803 - epoch:4, training loss:1888.2290 validation loss:32.8229
2025-06-02 02:03:33,596 - epoch:5, training loss:1893.6034 validation loss:30.7962
2025-06-02 02:05:55,161 - epoch:6, training loss:1894.1057 validation loss:29.8961
2025-06-02 02:08:13,659 - epoch:7, training loss:1898.6815 validation loss:29.7115
2025-06-02 02:10:36,679 - epoch:8, training loss:1882.4778 validation loss:28.1663
2025-06-02 02:12:59,912 - epoch:9, training loss:1887.0993 validation loss:31.4377
2025-06-02 02:15:09,296 - epoch:10, training loss:1892.4514 validation loss:30.2745
2025-06-02 02:17:30,789 - epoch:11, training loss:1896.5536 validation loss:30.8891
2025-06-02 02:19:53,804 - epoch:12, training loss:1884.3618 validation loss:30.1356
2025-06-02 02:22:08,571 - epoch:13, training loss:1885.4121 validation loss:30.8773
2025-06-02 02:24:30,821 - epoch:14, training loss:1885.4688 validation loss:29.9249
2025-06-02 02:25:22,766 - [*] loss:1781.0991
2025-06-02 02:25:23,681 - [*] year 2018, testing
2025-06-02 02:25:27,789 - T:3	MAE	20.7501	RMSE	30.6542	MAPE	16.8863
2025-06-02 02:25:36,295 - T:6	MAE	23.0402	RMSE	34.4722	MAPE	18.2991
2025-06-02 02:26:04,100 - T:12	MAE	27.5590	RMSE	41.5984	MAPE	21.9250
2025-06-02 02:26:04,100 - T:Avg	MAE	23.3649	RMSE	34.9121	MAPE	18.7178
2025-06-02 02:26:04,103 - Finished optimization, total time:1440.12 s, best model:log/SD/team-42/2018/28.1663.pkl
2025-06-02 02:26:04,157 - [*] Year 2019 load from data/SD/FastData/2019.npz
2025-06-02 02:26:04,185 - [*] load from log/SD/team-42/2018/28.1663.pkl
2025-06-02 02:26:05,669 - number of increase nodes:142, nodes after 2 hop:torch.Size([584]), total nodes this year 716
2025-06-02 02:26:14,059 - [*] Year 2019 Dataset load!
2025-06-02 02:26:14,059 - [*] load from log/SD/team-42/2018/28.1663.pkl
2025-06-02 02:26:14,067 - [*] EWC! lambda 0.001000
2025-06-02 02:27:46,109 - Total Parameters: 71948
2025-06-02 02:27:46,109 - Trainable Parameters: 71948
2025-06-02 02:27:46,109 - [*] Year 2019 Training start
2025-06-02 02:27:47,404 - node number torch.Size([9344, 12])
2025-06-02 02:29:54,552 - epoch:0, training loss:1750.2411 validation loss:29.0250
2025-06-02 02:32:14,852 - epoch:1, training loss:1732.8620 validation loss:28.6144
2025-06-02 02:34:30,599 - epoch:2, training loss:1735.8886 validation loss:29.5773
2025-06-02 02:36:47,338 - epoch:3, training loss:1740.7890 validation loss:28.7907
2025-06-02 02:39:06,093 - epoch:4, training loss:1735.7045 validation loss:32.0419
2025-06-02 02:41:17,197 - epoch:5, training loss:1744.9143 validation loss:29.2988
2025-06-02 02:43:26,407 - epoch:6, training loss:1735.5141 validation loss:30.1184
2025-06-02 02:45:44,618 - epoch:7, training loss:1744.1471 validation loss:29.0988
2025-06-02 02:46:32,835 - [*] loss:1854.1050
2025-06-02 02:46:33,598 - [*] year 2019, testing
2025-06-02 02:46:37,784 - T:3	MAE	21.3695	RMSE	31.4780	MAPE	16.2417
2025-06-02 02:46:46,526 - T:6	MAE	23.9712	RMSE	35.4467	MAPE	18.3083
2025-06-02 02:47:14,233 - T:12	MAE	29.0106	RMSE	42.9614	MAPE	22.8440
2025-06-02 02:47:14,234 - T:Avg	MAE	24.3518	RMSE	35.9675	MAPE	18.7397
2025-06-02 02:47:14,236 - Finished optimization, total time:737.10 s, best model:log/SD/team-42/2019/28.6144.pkl
2025-06-02 02:47:14,284 - [*] Year 2020 load from data/SD/FastData/2020.npz
2025-06-02 02:47:14,315 - [*] load from log/SD/team-42/2019/28.6144.pkl
2025-06-02 02:47:15,117 - The number of data points in the previous year is greater than the current year, skipping detection and replay.
2025-06-02 02:47:15,117 - The number of data points in the previous year is greater than the current year, skipping replay.
2025-06-02 02:47:15,172 - number of increase nodes:91, nodes after 2 hop:torch.Size([591]), total nodes this year 697
2025-06-02 02:47:23,167 - [*] Year 2020 Dataset load!
2025-06-02 02:47:23,167 - [*] load from log/SD/team-42/2019/28.6144.pkl
2025-06-02 02:47:23,175 - [*] EWC! lambda 0.001000
2025-06-02 02:48:56,010 - Total Parameters: 71948
2025-06-02 02:48:56,010 - Trainable Parameters: 71948
2025-06-02 02:48:56,010 - [*] Year 2020 Training start
2025-06-02 02:48:57,381 - node number torch.Size([9456, 12])
2025-06-02 02:51:18,523 - epoch:0, training loss:1955.9299 validation loss:31.0646
2025-06-02 02:53:32,442 - epoch:1, training loss:1960.4324 validation loss:40.8191
2025-06-02 02:55:51,774 - epoch:2, training loss:1975.5691 validation loss:34.3476
2025-06-02 02:58:08,845 - epoch:3, training loss:1950.5559 validation loss:45.0986
2025-06-02 03:00:26,730 - epoch:4, training loss:1966.4090 validation loss:45.5159
2025-06-02 03:02:45,291 - epoch:5, training loss:1958.9281 validation loss:47.4049
2025-06-02 03:05:05,062 - epoch:6, training loss:1945.7691 validation loss:36.5958
2025-06-02 03:05:53,691 - [*] loss:3450.6313
2025-06-02 03:05:54,384 - [*] year 2020, testing
2025-06-02 03:05:59,444 - T:3	MAE	45.3529	RMSE	56.2832	MAPE	46.1551
2025-06-02 03:06:08,789 - T:6	MAE	45.9451	RMSE	57.6292	MAPE	47.3197
2025-06-02 03:06:37,754 - T:12	MAE	46.4781	RMSE	59.3995	MAPE	49.9741
2025-06-02 03:06:37,754 - T:Avg	MAE	46.0437	RMSE	57.7519	MAPE	47.7208
2025-06-02 03:06:37,757 - Finished optimization, total time:668.11 s, best model:log/SD/team-42/2020/31.0646.pkl
2025-06-02 03:06:37,777 - 


2025-06-02 03:06:37,778 - 3   	 MAE	     22.95	     20.75	     21.37	     45.35		   27.60
2025-06-02 03:06:37,778 - 3   	RMSE	     32.49	     30.65	     31.48	     56.28		   37.73
2025-06-02 03:06:37,778 - 3   	MAPE	     16.56	     16.89	     16.24	     46.16		   23.96
2025-06-02 03:06:37,778 - 6   	 MAE	     24.70	     23.04	     23.97	     45.95		   29.41
2025-06-02 03:06:37,778 - 6   	RMSE	     35.78	     34.47	     35.45	     57.63		   40.83
2025-06-02 03:06:37,778 - 6   	MAPE	     16.94	     18.30	     18.31	     47.32		   25.22
2025-06-02 03:06:37,778 - 12  	 MAE	     28.65	     27.56	     29.01	     46.48		   32.92
2025-06-02 03:06:37,778 - 12  	RMSE	     42.57	     41.60	     42.96	     59.40		   46.63
2025-06-02 03:06:37,778 - 12  	MAPE	     18.24	     21.92	     22.84	     49.97		   28.25
2025-06-02 03:06:37,778 - Avg 	 MAE	     25.07	     23.36	     24.35	     46.04		   29.71
2025-06-02 03:06:37,778 - Avg 	RMSE	     36.31	     34.91	     35.97	     57.75		   41.23
2025-06-02 03:06:37,778 - Avg 	MAPE	     17.14	     18.72	     18.74	     47.72		   25.58
2025-06-02 03:06:37,778 - year	2017	total_time	  863.2677	average_time	   95.9186	epoch	9
2025-06-02 03:06:37,778 - year	2018	total_time	 1440.1246	average_time	   96.0083	epoch	15
2025-06-02 03:06:37,778 - year	2019	total_time	  737.1050	average_time	   92.1381	epoch	8
2025-06-02 03:06:37,778 - year	2020	total_time	  668.1076	average_time	   95.4440	epoch	7
2025-06-02 03:06:37,778 - total time: 3708.6049
usage: stkec_main.py [-h] [--conf CONF] [--seed SEED] [--paral PARAL]
                     [--gpuid GPUID] [--logname LOGNAME] [--method METHOD]
                     [--load_first_year LOAD_FIRST_YEAR]
                     [--first_year_model_path FIRST_YEAR_MODEL_PATH]
stkec_main.py: error: argument --gpuid: expected one argument
Processing year 2017
input data shape: (105120, 705)
attention label shape: (74109600, 32)
saved attention label for year 2017
Processing year 2018
input data shape: (105120, 708)
attention label shape: (74424960, 32)
saved attention label for year 2018
Processing year 2019
input data shape: (105120, 716)
attention label shape: (75265920, 32)
saved attention label for year 2019
Processing year 2020
input data shape: (105408, 697)
attention label shape: (73469376, 32)
saved attention label for year 2020
Processing year 2017
input data shape: (105120, 1820)
attention label shape: (191318400, 32)
saved attention label for year 2017
Processing year 2018
input data shape: (105120, 1843)
attention label shape: (193736160, 32)
saved attention label for year 2018
Processing year 2019
input data shape: (105120, 1859)
attention label shape: (195418080, 32)
saved attention label for year 2019
Processing year 2020
input data shape: (105408, 1859)
attention label shape: (195953472, 32)
saved attention label for year 2020
Processing year 2017
input data shape: (105120, 2294)
attention label shape: (241145280, 32)
saved attention label for year 2017
Processing year 2018
input data shape: (105120, 2321)
attention label shape: (243983520, 32)
saved attention label for year 2018
Processing year 2019
input data shape: (105120, 2352)
attention label shape: (247242240, 32)
saved attention label for year 2019
Processing year 2020
input data shape: (105408, 2352)
attention label shape: (247919616, 32)
saved attention label for year 2020
2025-06-03 11:04:23,261 - logger name:log/GBA/pecpm-42/pecpm.log
2025-06-03 11:04:23,261 - params : {'conf': 'conf/GBA/pecpm.json', 'seed': 42, 'paral': 0, 'gpuid': 2, 'logname': 'pecpm', 'method': 'PECPM', 'load_first_year': 0, 'first_year_model_path': 'log/SD/pecpm-42/2017/31.5668.pkl', 'device': device(type='cuda', index=2), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'PECPM': <class 'src.model.model.PECPM_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'beita': 1.0, 'cluster': 32, 'raw_data_path': 'data/GBA/finaldata/', 'save_data_path': 'data/GBA/FastData/', 'graph_path': 'data/GBA/graph/', 'model_path': 'log/GBA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'train': 1, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'adp_adj': False, 'skip_dim': 64, 'end_dim': 64, 'hidden_channels': 32, 'dilation_channels': 64, 'residual_channels': 64, 'input_dim': 1, 'output_dim': 1, 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 300, 'path': 'log/GBA/pecpm-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-03 11:04:23,432 - [*] Year 2017 load from data/GBA/FastData/2017.npz
2025-06-03 11:05:38,065 - [*] Year 2017 Dataset load!
2025-06-03 11:05:38,088 - [*] Year 2017 Training start
2025-06-03 11:05:39,708 - node number torch.Size([293632, 12])
2025-06-03 11:06:03,045 - epoch:0, training loss:16297.9711 validation loss:47.3568
2025-06-03 11:06:32,059 - epoch:1, training loss:2731.8491 validation loss:35.4225
2025-06-03 11:07:00,001 - epoch:2, training loss:2192.1989 validation loss:34.1115
2025-06-03 11:07:23,377 - epoch:3, training loss:2111.0851 validation loss:33.6715
2025-06-03 11:07:47,716 - epoch:4, training loss:2070.7521 validation loss:32.8859
2025-06-03 11:08:11,426 - epoch:5, training loss:2039.1799 validation loss:33.9986
2025-06-03 11:08:35,060 - epoch:6, training loss:1991.3371 validation loss:34.0391
2025-06-03 11:08:58,672 - epoch:7, training loss:1959.7822 validation loss:34.2119
2025-06-03 11:09:22,831 - epoch:8, training loss:1942.9786 validation loss:32.5714
2025-06-03 11:09:46,710 - epoch:9, training loss:1929.5139 validation loss:33.4588
2025-06-03 11:10:09,866 - epoch:10, training loss:1923.0684 validation loss:32.9024
2025-06-03 11:10:32,766 - epoch:11, training loss:1917.5733 validation loss:33.2847
2025-06-03 11:10:55,643 - epoch:12, training loss:1910.2363 validation loss:33.9718
2025-06-03 11:11:18,664 - epoch:13, training loss:1916.4586 validation loss:31.5250
2025-06-03 11:11:47,447 - epoch:14, training loss:1905.3863 validation loss:33.3967
2025-06-03 11:12:14,945 - epoch:15, training loss:1904.5709 validation loss:33.7890
2025-06-03 11:12:37,965 - epoch:16, training loss:1896.9191 validation loss:31.7083
2025-06-03 11:13:01,157 - epoch:17, training loss:1885.1481 validation loss:33.0564
2025-06-03 11:13:24,057 - epoch:18, training loss:1889.5045 validation loss:32.0698
2025-06-03 11:13:47,053 - epoch:19, training loss:1880.0384 validation loss:36.1060
2025-06-03 11:13:55,447 - [*] loss:1930.4246
2025-06-03 11:13:56,672 - [*] year 2017, testing
2025-06-03 11:14:12,632 - T:3	MAE	23.0697	RMSE	34.4113	MAPE	15.5372
2025-06-03 11:14:43,053 - T:6	MAE	24.8948	RMSE	37.4570	MAPE	16.8814
2025-06-03 11:16:20,701 - T:12	MAE	28.8689	RMSE	43.7158	MAPE	21.0003
2025-06-03 11:16:20,702 - T:Avg	MAE	25.2560	RMSE	37.9761	MAPE	17.5003
2025-06-03 11:16:20,710 - Finished optimization, total time:255.48 s, best model:log/GBA/pecpm-42/2017/31.525.pkl
2025-06-03 11:16:20,999 - [*] Year 2018 load from data/GBA/FastData/2018.npz
2025-06-03 11:16:21,064 - [*] load from log/GBA/pecpm-42/2017/31.525.pkl
2025-06-03 11:16:21,113 - [*] detect strategy feature
2025-06-03 11:16:26,884 - number of increase nodes:252, nodes after 2 hop:torch.Size([2012]), total nodes this year 2321
2025-06-03 11:21:00,459 - [*] Year 2018 Dataset load!
2025-06-03 11:21:00,460 - [*] load from log/GBA/pecpm-42/2017/31.525.pkl
2025-06-03 11:21:00,464 - [*] EWC! lambda 0.000100
2025-06-03 11:21:32,767 - [*] Year 2018 Training start
2025-06-03 11:21:39,622 - node number torch.Size([257536, 12])
2025-06-03 11:22:00,474 - epoch:0, training loss:2039.7569 validation loss:29.4180
2025-06-03 11:22:30,470 - epoch:1, training loss:2006.2362 validation loss:33.2591
2025-06-03 11:22:54,825 - epoch:2, training loss:2017.0454 validation loss:29.8663
2025-06-03 11:23:17,869 - epoch:3, training loss:2015.2480 validation loss:29.7486
2025-06-03 11:23:40,801 - epoch:4, training loss:2006.1188 validation loss:28.6042
2025-06-03 11:24:03,618 - epoch:5, training loss:1996.6691 validation loss:29.1250
2025-06-03 11:24:31,261 - epoch:6, training loss:1993.8103 validation loss:29.1416
2025-06-03 11:25:01,075 - epoch:7, training loss:1985.0958 validation loss:29.9206
2025-06-03 11:25:39,533 - epoch:8, training loss:1976.1074 validation loss:31.3242
2025-06-03 11:26:07,191 - epoch:9, training loss:1980.4205 validation loss:28.8727
2025-06-03 11:26:34,765 - epoch:10, training loss:1964.0160 validation loss:30.1243
2025-06-03 11:26:45,805 - [*] loss:2337.5889
2025-06-03 11:26:46,753 - [*] year 2018, testing
2025-06-03 11:26:51,005 - T:3	MAE	23.9071	RMSE	36.6925	MAPE	16.5566
2025-06-03 11:27:01,708 - T:6	MAE	25.8711	RMSE	39.7350	MAPE	19.0586
2025-06-03 11:27:27,448 - T:12	MAE	29.9725	RMSE	45.7670	MAPE	24.4936
2025-06-03 11:27:27,449 - T:Avg	MAE	26.2364	RMSE	40.1986	MAPE	19.6138
2025-06-03 11:27:27,452 - Finished optimization, total time:177.11 s, best model:log/GBA/pecpm-42/2018/28.6042.pkl
2025-06-03 11:27:28,174 - [*] Year 2019 load from data/GBA/FastData/2019.npz
2025-06-03 11:27:28,251 - [*] load from log/GBA/pecpm-42/2018/28.6042.pkl
2025-06-03 11:27:28,315 - [*] detect strategy feature
2025-06-03 11:27:34,961 - number of increase nodes:263, nodes after 2 hop:torch.Size([2050]), total nodes this year 2352
2025-06-03 11:30:35,783 - [*] Year 2019 Dataset load!
2025-06-03 11:30:35,783 - [*] load from log/GBA/pecpm-42/2018/28.6042.pkl
2025-06-03 11:30:35,790 - [*] EWC! lambda 0.000100
2025-06-03 11:31:04,256 - [*] Year 2019 Training start
2025-06-03 11:31:09,561 - node number torch.Size([262400, 12])
2025-06-03 11:31:29,474 - epoch:0, training loss:1882.0405 validation loss:30.9588
2025-06-03 11:31:54,198 - epoch:1, training loss:1853.4477 validation loss:28.9594
2025-06-03 11:32:19,051 - epoch:2, training loss:1852.9950 validation loss:30.1564
2025-06-03 11:32:43,387 - epoch:3, training loss:1852.5880 validation loss:29.5315
2025-06-03 11:32:55,183 - logger name:log/GBA/stkec-42/stkec.log
2025-06-03 11:32:55,183 - params : {'conf': 'conf/GBA/stkec.json', 'seed': 42, 'paral': 0, 'gpuid': 2, 'logname': 'stkec', 'method': 'STKEC', 'load_first_year': 0, 'first_year_model_path': 'log/PEMS3/trafficStream-42/2011/16.6936.pkl', 'device': device(type='cuda', index=2), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 0, 'influe_length': 168, 'batch_influ_size': 4, 'beita': 1, 'cluster': 24, 'auto_test': 1, 'raw_data_path': 'data/GBA/finaldata/', 'save_data_path': 'data/GBA/FastData/', 'graph_path': 'data/GBA/graph/', 'model_path': 'log/GBA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'rank': 6, 'train': 1, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'detect_infl_strategy': True, 'infl_topk': 10, 'adp_adj': False, 'skip_dim': 64, 'end_dim': 64, 'hidden_channels': 32, 'dilation_channels': 64, 'residual_channels': 64, 'input_dim': 1, 'output_dim': 1, 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'replay_num_samples': 300, 'extra_feature': True, 'momentum_type': 'linear', 'memory_size': 32, 'path': 'log/GBA/stkec-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-03 11:32:55,308 - [*] Year 2017 load from data/GBA/FastData/2017.npz
2025-06-03 11:33:06,826 - epoch:4, training loss:1857.4321 validation loss:30.3760
2025-06-03 11:33:14,068 - [*] Year 2017 Dataset load!
2025-06-03 11:33:14,102 - [*] Year 2017 Training start
2025-06-03 11:33:15,437 - node number torch.Size([293632, 12])
/home/bd2/ANATS/Online_Baselines/utils/common_tools.py:63: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  tensor = torch.tensor(matrix)
2025-06-03 11:33:37,031 - epoch:5, training loss:1852.6690 validation loss:29.3976
2025-06-03 11:33:40,054 - epoch:0, training loss:11683.3376 validation loss:41.2888
2025-06-03 11:34:08,302 - epoch:1, training loss:2275.5668 validation loss:34.0305
2025-06-03 11:34:08,386 - logger name:log/GBA/team-42/team.log
2025-06-03 11:34:08,387 - params : {'conf': 'conf/GBA/team.json', 'seed': 42, 'paral': 0, 'gpuid': 6, 'logname': 'team', 'method': 'TEAM', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/GBA/trafficstream-42/2017/32.2186.pkl', 'device': device(type='cuda', index=6), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>, 'DLF': <class 'src.model.model.DLF_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.001, 'batch_size': 16, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'n_heads': 3, 'in_channels': 1, 'K': 3, 'nb_block': 1, 'nb_chev_filter': 64, 'nb_time_filter': 64, 'num_of_hours': 1, 'missing_value': 0.0, 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/GBA/finaldata/', 'save_data_path': 'data/GBA/FastData/', 'graph_path': 'data/GBA/graph', 'model_path': 'log/GBA/', 'strategy': 'incremental', 'init': True, 'increase': True, 'decrease': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'original', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.001, 'replay': True, 'replay_strategy': 'distribution', 'replay_num_samples': 100, 'path': 'log/GBA/team-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-03 11:34:08,519 - [*] Year 2017 load from data/GBA/FastData/2017.npz
2025-06-03 11:34:11,918 - epoch:6, training loss:1854.5979 validation loss:28.5630
2025-06-03 11:34:26,485 - [*] Year 2017 Dataset load!
2025-06-03 11:34:26,570 - Total Parameters: 71948
2025-06-03 11:34:26,570 - Trainable Parameters: 71948
2025-06-03 11:34:26,570 - [*] Year 2017 Training start
2025-06-03 11:34:27,301 - node number torch.Size([36704, 12])
2025-06-03 11:34:33,837 - epoch:2, training loss:2040.8881 validation loss:32.8076
2025-06-03 11:34:45,181 - epoch:7, training loss:1859.5369 validation loss:30.8510
2025-06-03 11:35:00,932 - epoch:3, training loss:1988.6867 validation loss:36.4517
2025-06-03 11:35:17,166 - epoch:8, training loss:1859.3141 validation loss:30.2310
2025-06-03 11:35:24,408 - epoch:4, training loss:1958.7395 validation loss:32.5718
2025-06-03 11:35:50,149 - epoch:9, training loss:1876.9220 validation loss:29.1179
2025-06-03 11:35:52,752 - epoch:5, training loss:1931.5809 validation loss:33.5667
2025-06-03 11:36:20,648 - epoch:6, training loss:1885.9933 validation loss:35.4202
2025-06-03 11:36:24,809 - epoch:10, training loss:1864.3837 validation loss:32.1251
2025-06-03 11:36:47,877 - epoch:7, training loss:1862.7292 validation loss:38.2871
2025-06-03 11:36:58,903 - epoch:11, training loss:1851.6412 validation loss:31.4541
2025-06-03 11:37:15,125 - epoch:8, training loss:1854.8007 validation loss:34.4765
2025-06-03 11:37:31,203 - epoch:12, training loss:1854.8269 validation loss:28.9389
2025-06-03 11:37:39,927 - epoch:9, training loss:1846.0252 validation loss:31.7964
2025-06-03 11:37:44,864 - [*] loss:1892.8137
2025-06-03 11:37:45,080 - [*] year 2019, testing
2025-06-03 11:37:47,003 - T:3	MAE	20.2537	RMSE	31.0426	MAPE	14.9916
2025-06-03 11:37:50,567 - T:6	MAE	22.1416	RMSE	34.1881	MAPE	16.0410
2025-06-03 11:38:01,052 - epoch:10, training loss:1835.6321 validation loss:35.3636
2025-06-03 11:38:02,232 - T:12	MAE	25.8562	RMSE	39.9664	MAPE	19.4777
2025-06-03 11:38:02,232 - T:Avg	MAE	22.4123	RMSE	34.5327	MAPE	16.5722
2025-06-03 11:38:02,234 - Finished optimization, total time:235.43 s, best model:log/GBA/pecpm-42/2019/28.563.pkl
2025-06-03 11:38:02,922 - [*] Year 2020 load from data/GBA/FastData/2020.npz
2025-06-03 11:38:02,985 - [*] load from log/GBA/pecpm-42/2019/28.563.pkl
2025-06-03 11:38:03,123 - [*] detect strategy feature
2025-06-03 11:38:10,751 - number of increase nodes:235, nodes after 2 hop:torch.Size([1938]), total nodes this year 2352
2025-06-03 11:38:21,876 - epoch:11, training loss:1822.1738 validation loss:30.8536
2025-06-03 11:38:42,091 - epoch:12, training loss:1818.1390 validation loss:33.6854
2025-06-03 11:39:04,109 - epoch:13, training loss:1832.4610 validation loss:31.6657
2025-06-03 11:39:24,779 - epoch:14, training loss:1821.6750 validation loss:34.6222
2025-06-03 11:39:45,959 - epoch:15, training loss:1824.5184 validation loss:31.3168
2025-06-03 11:40:06,963 - epoch:16, training loss:1809.9057 validation loss:31.1437
2025-06-03 11:40:15,767 - epoch:0, training loss:4653.5454 validation loss:34.2145
2025-06-03 11:40:29,020 - epoch:17, training loss:1810.0454 validation loss:31.4379
2025-06-03 11:40:36,242 - [*] loss:1832.4797
2025-06-03 11:40:38,167 - [*] year 2017, testing
2025-06-03 11:40:54,988 - T:3	MAE	21.9616	RMSE	33.8113	MAPE	14.1791
2025-06-03 11:41:07,275 - [*] Year 2020 Dataset load!
2025-06-03 11:41:07,275 - [*] load from log/GBA/pecpm-42/2019/28.563.pkl
2025-06-03 11:41:07,279 - [*] EWC! lambda 0.000100
2025-06-03 11:41:27,407 - T:6	MAE	24.0304	RMSE	36.8348	MAPE	16.0647
2025-06-03 11:41:28,715 - [*] Year 2020 Training start
2025-06-03 11:41:33,587 - node number torch.Size([248064, 12])
2025-06-03 11:41:52,146 - epoch:0, training loss:1806.4919 validation loss:32.7448
2025-06-03 11:42:15,296 - epoch:1, training loss:1756.9437 validation loss:29.6809
2025-06-03 11:42:38,323 - epoch:2, training loss:1758.8096 validation loss:30.9596
2025-06-03 11:43:02,297 - epoch:3, training loss:1754.5228 validation loss:28.4737
2025-06-03 11:43:13,986 - T:12	MAE	28.0967	RMSE	42.6161	MAPE	20.2105
2025-06-03 11:43:13,986 - T:Avg	MAE	24.3475	RMSE	37.2432	MAPE	16.4712
2025-06-03 11:43:13,994 - Finished optimization, total time:266.51 s, best model:log/GBA/stkec-42/2017/30.8536.pkl
2025-06-03 11:43:14,285 - [*] Year 2018 load from data/GBA/FastData/2018.npz
2025-06-03 11:43:14,332 - [*] load from log/GBA/stkec-42/2017/30.8536.pkl
2025-06-03 11:43:14,422 - [*] detect strategy feature
2025-06-03 11:43:24,960 - epoch:4, training loss:1749.5293 validation loss:29.9244
2025-06-03 11:43:27,871 - number of increase nodes:306, nodes after 2 hop:torch.Size([2077]), total nodes this year 2321
2025-06-03 11:43:47,509 - epoch:5, training loss:1749.5319 validation loss:27.6538
2025-06-03 11:44:10,490 - epoch:6, training loss:1751.3989 validation loss:34.2465
2025-06-03 11:44:21,745 - [*] Year 2018 Dataset load!
2025-06-03 11:44:21,746 - [*] load from log/GBA/stkec-42/2017/30.8536.pkl
2025-06-03 11:44:21,771 - [*] EWC! lambda 0.000100
2025-06-03 11:44:34,401 - epoch:7, training loss:1746.5062 validation loss:30.1435
2025-06-03 11:44:53,227 - [*] Year 2018 Training start
2025-06-03 11:44:55,288 - node number torch.Size([265856, 12])
2025-06-03 11:45:07,768 - epoch:8, training loss:1749.5795 validation loss:32.0037
2025-06-03 11:45:13,084 - epoch:0, training loss:1894.2764 validation loss:27.1258
2025-06-03 11:45:38,984 - epoch:1, training loss:1674.2818 validation loss:29.5308
2025-06-03 11:45:40,293 - epoch:9, training loss:1746.6232 validation loss:31.5597
2025-06-03 11:46:01,966 - epoch:2, training loss:1682.0733 validation loss:26.8011
2025-06-03 11:46:07,499 - epoch:1, training loss:2028.9564 validation loss:33.2244
2025-06-03 11:46:13,605 - epoch:10, training loss:1743.1865 validation loss:33.6154
2025-06-03 11:46:26,547 - epoch:3, training loss:1686.1122 validation loss:28.0806
2025-06-03 11:46:43,118 - epoch:11, training loss:1758.1516 validation loss:35.0852
2025-06-03 11:46:46,389 - epoch:4, training loss:1685.8518 validation loss:26.9536
2025-06-03 11:46:56,520 - [*] loss:1710.8350
2025-06-03 11:46:56,731 - [*] year 2020, testing
2025-06-03 11:46:58,283 - T:3	MAE	27.4154	RMSE	35.5226	MAPE	25.2627
2025-06-03 11:47:01,330 - T:6	MAE	28.1107	RMSE	37.1240	MAPE	26.3734
2025-06-03 11:47:07,191 - epoch:5, training loss:1698.5538 validation loss:26.7426
2025-06-03 11:47:12,096 - T:12	MAE	29.6860	RMSE	40.3475	MAPE	28.7578
2025-06-03 11:47:12,097 - T:Avg	MAE	28.2900	RMSE	37.3927	MAPE	26.6122
2025-06-03 11:47:12,098 - Finished optimization, total time:190.70 s, best model:log/GBA/pecpm-42/2020/27.6538.pkl
2025-06-03 11:47:12,558 - 


2025-06-03 11:47:12,559 - 3   	 MAE	     23.07	     23.91	     20.25	     27.42		   23.66
2025-06-03 11:47:12,559 - 3   	RMSE	     34.41	     36.69	     31.04	     35.52		   34.42
2025-06-03 11:47:12,559 - 3   	MAPE	     15.54	     16.56	     14.99	     25.26		   18.09
2025-06-03 11:47:12,559 - 6   	 MAE	     24.89	     25.87	     22.14	     28.11		   25.25
2025-06-03 11:47:12,559 - 6   	RMSE	     37.46	     39.74	     34.19	     37.12		   37.13
2025-06-03 11:47:12,559 - 6   	MAPE	     16.88	     19.06	     16.04	     26.37		   19.59
2025-06-03 11:47:12,559 - 12  	 MAE	     28.87	     29.97	     25.86	     29.69		   28.60
2025-06-03 11:47:12,559 - 12  	RMSE	     43.72	     45.77	     39.97	     40.35		   42.45
2025-06-03 11:47:12,559 - 12  	MAPE	     21.00	     24.49	     19.48	     28.76		   23.43
2025-06-03 11:47:12,559 - Avg 	 MAE	     25.26	     26.24	     22.41	     28.29		   25.55
2025-06-03 11:47:12,559 - Avg 	RMSE	     37.98	     40.20	     34.53	     37.39		   37.53
2025-06-03 11:47:12,559 - Avg 	MAPE	     17.50	     19.61	     16.57	     26.61		   20.07
2025-06-03 11:47:12,559 - year	2017	total_time	  255.4833	average_time	   12.7742	epoch	20
2025-06-03 11:47:12,559 - year	2018	total_time	  177.1131	average_time	   16.1012	epoch	11
2025-06-03 11:47:12,559 - year	2019	total_time	  235.4266	average_time	   18.1098	epoch	13
2025-06-03 11:47:12,559 - year	2020	total_time	  190.7005	average_time	   15.8917	epoch	12
2025-06-03 11:47:12,559 - total time: 858.7235
2025-06-03 11:47:25,112 - epoch:6, training loss:1687.5042 validation loss:27.5770
2025-06-03 11:47:42,327 - epoch:7, training loss:1712.2042 validation loss:27.1849
2025-06-03 11:47:59,506 - epoch:8, training loss:1695.4079 validation loss:26.6172
2025-06-03 11:48:16,642 - epoch:9, training loss:1691.8933 validation loss:34.0483
2025-06-03 11:48:33,970 - epoch:10, training loss:1706.2378 validation loss:30.9994
2025-06-03 11:48:51,188 - epoch:11, training loss:1685.3019 validation loss:32.1459
2025-06-03 11:49:08,412 - epoch:12, training loss:1699.3936 validation loss:26.5960
2025-06-03 11:49:25,749 - epoch:13, training loss:1689.8491 validation loss:32.1799
2025-06-03 11:49:42,937 - epoch:14, training loss:1705.3482 validation loss:27.2986
2025-06-03 11:50:00,440 - epoch:15, training loss:1694.9447 validation loss:28.0287
2025-06-03 11:50:18,294 - epoch:16, training loss:1713.7159 validation loss:27.5363
2025-06-03 11:50:35,742 - epoch:17, training loss:1697.6166 validation loss:30.2730
2025-06-03 11:50:53,290 - epoch:18, training loss:1688.4737 validation loss:28.5343
2025-06-03 11:51:02,018 - [*] loss:2126.2852
2025-06-03 11:51:03,309 - [*] year 2018, testing
2025-06-03 11:51:17,607 - T:3	MAE	22.6546	RMSE	35.6351	MAPE	16.2216
2025-06-03 11:51:46,186 - T:6	MAE	24.8179	RMSE	38.8373	MAPE	18.2797
2025-06-03 11:51:59,617 - epoch:2, training loss:1996.9332 validation loss:32.3071
2025-06-03 11:53:23,062 - T:12	MAE	29.0797	RMSE	44.8776	MAPE	22.6158
2025-06-03 11:53:23,062 - T:Avg	MAE	25.1538	RMSE	39.2522	MAPE	18.6759
2025-06-03 11:53:23,071 - Finished optimization, total time:230.50 s, best model:log/GBA/stkec-42/2018/26.596.pkl
2025-06-03 11:53:23,375 - [*] Year 2019 load from data/GBA/FastData/2019.npz
2025-06-03 11:53:23,441 - [*] load from log/GBA/stkec-42/2018/26.596.pkl
2025-06-03 11:53:23,504 - [*] detect strategy feature
2025-06-03 11:53:38,857 - number of increase nodes:315, nodes after 2 hop:torch.Size([2070]), total nodes this year 2352
2025-06-03 11:54:22,014 - [*] Year 2019 Dataset load!
2025-06-03 11:54:22,014 - [*] load from log/GBA/stkec-42/2018/26.596.pkl
2025-06-03 11:54:22,019 - [*] EWC! lambda 0.000100
2025-06-03 11:54:41,456 - [*] Year 2019 Training start
2025-06-03 11:54:45,048 - node number torch.Size([264960, 12])
2025-06-03 11:55:01,529 - epoch:0, training loss:2075.4838 validation loss:32.1322
2025-06-03 11:55:21,150 - epoch:1, training loss:1928.1019 validation loss:31.0701
2025-06-03 11:55:40,726 - epoch:2, training loss:1914.1864 validation loss:29.3366
2025-06-03 11:56:00,296 - epoch:3, training loss:1917.6996 validation loss:31.8149
2025-06-03 11:56:20,269 - epoch:4, training loss:1916.6976 validation loss:42.0708
2025-06-03 11:56:40,117 - epoch:5, training loss:1945.2457 validation loss:27.7046
2025-06-03 11:57:00,869 - epoch:6, training loss:1927.6907 validation loss:31.5420
2025-06-03 11:57:20,914 - epoch:7, training loss:1938.1377 validation loss:28.5557
2025-06-03 11:57:40,774 - epoch:8, training loss:1929.3901 validation loss:28.1508
2025-06-03 11:57:49,578 - epoch:3, training loss:1981.8873 validation loss:31.2148
2025-06-03 11:58:00,476 - epoch:9, training loss:1919.9826 validation loss:37.1792
2025-06-03 11:58:20,146 - epoch:10, training loss:1930.4104 validation loss:28.3237
2025-06-03 11:58:40,030 - epoch:11, training loss:1937.1087 validation loss:31.1705
2025-06-03 11:58:50,257 - [*] loss:1783.1316
2025-06-03 11:58:51,534 - [*] year 2019, testing
2025-06-03 11:59:07,649 - T:3	MAE	20.7821	RMSE	32.5465	MAPE	13.0889
2025-06-03 11:59:39,184 - T:6	MAE	22.8684	RMSE	35.7640	MAPE	14.5550
2025-06-03 12:01:21,812 - T:12	MAE	26.9163	RMSE	41.7179	MAPE	18.0410
2025-06-03 12:01:21,812 - T:Avg	MAE	23.1603	RMSE	36.1297	MAPE	14.9350
2025-06-03 12:01:21,820 - Finished optimization, total time:145.40 s, best model:log/GBA/stkec-42/2019/27.7046.pkl
2025-06-03 12:01:22,054 - [*] Year 2020 load from data/GBA/FastData/2020.npz
2025-06-03 12:01:22,131 - [*] load from log/GBA/stkec-42/2019/27.7046.pkl
2025-06-03 12:01:22,179 - [*] detect strategy feature
2025-06-03 12:01:39,918 - number of increase nodes:286, nodes after 2 hop:torch.Size([2069]), total nodes this year 2352
2025-06-03 12:02:27,123 - [*] Year 2020 Dataset load!
2025-06-03 12:02:27,123 - [*] load from log/GBA/stkec-42/2019/27.7046.pkl
2025-06-03 12:02:27,128 - [*] EWC! lambda 0.000100
2025-06-03 12:02:47,599 - [*] Year 2020 Training start
2025-06-03 12:02:51,857 - node number torch.Size([264832, 12])
2025-06-03 12:03:08,986 - epoch:0, training loss:2145.5864 validation loss:31.3493
2025-06-03 12:03:30,448 - epoch:1, training loss:1751.5439 validation loss:29.4004
2025-06-03 12:03:37,396 - epoch:4, training loss:1954.3687 validation loss:32.3090
2025-06-03 12:03:52,021 - epoch:2, training loss:1744.7325 validation loss:32.4923
2025-06-03 12:04:13,034 - epoch:3, training loss:1745.4098 validation loss:32.8626
2025-06-03 12:04:34,109 - epoch:4, training loss:1744.2639 validation loss:34.0392
2025-06-03 12:04:55,434 - epoch:5, training loss:1742.8470 validation loss:27.8290
2025-06-03 12:05:16,929 - epoch:6, training loss:1747.3494 validation loss:32.1993
2025-06-03 12:05:38,244 - epoch:7, training loss:1763.0607 validation loss:33.6287
2025-06-03 12:05:59,376 - epoch:8, training loss:1765.5781 validation loss:27.3486
2025-06-03 12:06:20,851 - epoch:9, training loss:1735.9365 validation loss:33.7739
2025-06-03 12:06:41,972 - epoch:10, training loss:1751.8122 validation loss:34.8674
2025-06-03 12:07:03,233 - epoch:11, training loss:1752.7128 validation loss:30.7496
2025-06-03 12:07:24,626 - epoch:12, training loss:1741.1437 validation loss:30.8590
2025-06-03 12:07:46,022 - epoch:13, training loss:1734.3969 validation loss:31.4694
2025-06-03 12:08:07,537 - epoch:14, training loss:1739.7286 validation loss:32.7726
2025-06-03 12:08:20,650 - [*] loss:1733.0695
2025-06-03 12:08:22,242 - [*] year 2020, testing
2025-06-03 12:08:37,401 - T:3	MAE	26.3152	RMSE	37.1450	MAPE	16.3459
2025-06-03 12:09:07,821 - T:6	MAE	26.8841	RMSE	38.3368	MAPE	17.2426
2025-06-03 12:09:25,201 - epoch:5, training loss:1941.5733 validation loss:35.6766
2025-06-03 12:10:45,466 - T:12	MAE	28.6688	RMSE	41.4073	MAPE	19.3825
2025-06-03 12:10:45,466 - T:Avg	MAE	27.1175	RMSE	38.6582	MAPE	17.4595
2025-06-03 12:10:45,477 - Finished optimization, total time:193.25 s, best model:log/GBA/stkec-42/2020/27.3486.pkl
2025-06-03 12:10:45,543 - 


2025-06-03 12:10:45,544 - 3   	 MAE	     21.96	     22.65	     20.78	     26.32		   22.93
2025-06-03 12:10:45,544 - 3   	RMSE	     33.81	     35.64	     32.55	     37.14		   34.78
2025-06-03 12:10:45,544 - 3   	MAPE	     14.18	     16.22	     13.09	     16.35		   14.96
2025-06-03 12:10:45,544 - 6   	 MAE	     24.03	     24.82	     22.87	     26.88		   24.65
2025-06-03 12:10:45,544 - 6   	RMSE	     36.83	     38.84	     35.76	     38.34		   37.44
2025-06-03 12:10:45,544 - 6   	MAPE	     16.06	     18.28	     14.55	     17.24		   16.54
2025-06-03 12:10:45,544 - 12  	 MAE	     28.10	     29.08	     26.92	     28.67		   28.19
2025-06-03 12:10:45,544 - 12  	RMSE	     42.62	     44.88	     41.72	     41.41		   42.65
2025-06-03 12:10:45,544 - 12  	MAPE	     20.21	     22.62	     18.04	     19.38		   20.06
2025-06-03 12:10:45,544 - Avg 	 MAE	     24.35	     25.15	     23.16	     27.12		   24.94
2025-06-03 12:10:45,544 - Avg 	RMSE	     37.24	     39.25	     36.13	     38.66		   37.82
2025-06-03 12:10:45,544 - Avg 	MAPE	     16.47	     18.68	     14.93	     17.46		   16.89
2025-06-03 12:10:45,544 - year	2017	total_time	  266.5077	average_time	   14.8060	epoch	18
2025-06-03 12:10:45,544 - year	2018	total_time	  230.4952	average_time	   12.1313	epoch	19
2025-06-03 12:10:45,544 - year	2019	total_time	  145.4047	average_time	   12.1171	epoch	12
2025-06-03 12:10:45,544 - year	2020	total_time	  193.2508	average_time	   12.8834	epoch	15
2025-06-03 12:10:45,544 - total time: 835.6584
2025-06-03 12:15:18,284 - epoch:6, training loss:1932.5489 validation loss:34.3907
2025-06-03 12:21:14,615 - epoch:7, training loss:1925.7989 validation loss:33.8743
2025-06-03 12:27:06,907 - epoch:8, training loss:1909.6547 validation loss:32.5735
2025-06-03 12:33:00,852 - epoch:9, training loss:1912.8071 validation loss:32.5191
2025-06-03 12:34:45,221 - [*] loss:1935.1356
2025-06-03 12:34:47,340 - [*] year 2017, testing
2025-06-03 12:35:01,549 - T:3	MAE	22.1467	RMSE	34.2260	MAPE	14.1982
2025-06-03 12:35:30,146 - T:6	MAE	24.3196	RMSE	37.4220	MAPE	15.5432
2025-06-03 12:37:04,305 - T:12	MAE	28.7249	RMSE	43.7794	MAPE	18.6402
2025-06-03 12:37:04,306 - T:Avg	MAE	24.6824	RMSE	37.9176	MAPE	15.8438
2025-06-03 12:37:04,314 - Finished optimization, total time:2427.73 s, best model:log/GBA/team-42/2017/31.2148.pkl
2025-06-03 12:37:04,555 - [*] Year 2018 load from data/GBA/FastData/2018.npz
2025-06-03 12:37:04,654 - [*] load from log/GBA/team-42/2017/31.2148.pkl
2025-06-03 12:37:12,117 - number of increase nodes:243, nodes after 2 hop:torch.Size([1609]), total nodes this year 2321
2025-06-03 12:37:54,249 - [*] Year 2018 Dataset load!
2025-06-03 12:37:54,249 - [*] load from log/GBA/team-42/2017/31.2148.pkl
2025-06-03 12:37:54,258 - [*] EWC! lambda 0.001000
2025-06-03 12:41:43,862 - Total Parameters: 71948
2025-06-03 12:41:43,863 - Trainable Parameters: 71948
2025-06-03 12:41:43,863 - [*] Year 2018 Training start
2025-06-03 12:41:46,248 - node number torch.Size([25744, 12])
2025-06-03 12:45:36,769 - epoch:0, training loss:1568.2785 validation loss:26.4957
2025-06-03 12:49:30,881 - epoch:1, training loss:1565.6387 validation loss:25.3581
2025-06-03 12:53:28,254 - epoch:2, training loss:1568.0131 validation loss:29.3814
2025-06-03 12:57:22,304 - epoch:3, training loss:1572.8457 validation loss:28.5898
2025-06-03 13:01:16,667 - epoch:4, training loss:1570.7727 validation loss:26.7793
2025-06-03 13:05:11,638 - epoch:5, training loss:1564.4505 validation loss:26.3333
2025-06-03 13:09:06,264 - epoch:6, training loss:1568.3695 validation loss:25.3838
2025-06-03 13:13:02,383 - epoch:7, training loss:1567.4157 validation loss:26.2920
2025-06-03 13:14:39,335 - [*] loss:2547.5039
2025-06-03 13:14:41,590 - [*] year 2018, testing
2025-06-03 13:14:55,991 - T:3	MAE	25.1029	RMSE	38.6163	MAPE	17.0098
2025-06-03 13:15:23,197 - T:6	MAE	27.8700	RMSE	42.6632	MAPE	18.4934
2025-06-03 13:16:54,202 - T:12	MAE	32.5284	RMSE	49.3538	MAPE	21.5314
2025-06-03 13:16:54,203 - T:Avg	MAE	28.1212	RMSE	42.9877	MAPE	18.7493
2025-06-03 13:16:54,211 - Finished optimization, total time:1315.23 s, best model:log/GBA/team-42/2018/25.3581.pkl
2025-06-03 13:16:54,471 - [*] Year 2019 load from data/GBA/FastData/2019.npz
2025-06-03 13:16:54,576 - [*] load from log/GBA/team-42/2018/25.3581.pkl
2025-06-03 13:16:59,798 - number of increase nodes:248, nodes after 2 hop:torch.Size([1647]), total nodes this year 2352
2025-06-03 13:17:37,172 - [*] Year 2019 Dataset load!
2025-06-03 13:17:37,172 - [*] load from log/GBA/team-42/2018/25.3581.pkl
2025-06-03 13:17:37,184 - [*] EWC! lambda 0.001000
2025-06-03 13:21:28,521 - Total Parameters: 71948
2025-06-03 13:21:28,521 - Trainable Parameters: 71948
2025-06-03 13:21:28,521 - [*] Year 2019 Training start
2025-06-03 13:21:30,873 - node number torch.Size([26352, 12])
2025-06-03 13:25:30,282 - epoch:0, training loss:2276.8492 validation loss:31.9650
2025-06-03 13:29:31,972 - epoch:1, training loss:2271.5036 validation loss:34.7178
2025-06-03 13:33:34,310 - epoch:2, training loss:2278.1116 validation loss:35.9084
2025-06-03 13:37:36,121 - epoch:3, training loss:2276.0618 validation loss:35.3209
2025-06-03 13:41:37,193 - epoch:4, training loss:2277.4422 validation loss:34.6852
2025-06-03 13:45:38,462 - epoch:5, training loss:2270.7337 validation loss:30.6188
2025-06-03 13:49:40,239 - epoch:6, training loss:2285.9520 validation loss:30.0073
2025-06-03 13:53:41,803 - epoch:7, training loss:2282.8516 validation loss:33.7182
2025-06-03 13:57:42,513 - epoch:8, training loss:2270.8261 validation loss:32.5223
2025-06-03 14:01:43,303 - epoch:9, training loss:2274.4690 validation loss:34.4256
2025-06-03 14:05:44,370 - epoch:10, training loss:2271.5517 validation loss:34.1221
2025-06-03 14:09:49,020 - epoch:11, training loss:2272.5568 validation loss:34.2255
2025-06-03 14:13:48,471 - epoch:12, training loss:2276.0819 validation loss:32.0889
2025-06-03 14:15:30,779 - [*] loss:1963.4635
2025-06-03 14:15:33,312 - [*] year 2019, testing
2025-06-03 14:15:47,785 - T:3	MAE	22.3685	RMSE	34.1232	MAPE	14.1315
2025-06-03 14:16:17,323 - T:6	MAE	24.4221	RMSE	37.4058	MAPE	15.3923
2025-06-03 14:17:53,250 - T:12	MAE	28.8031	RMSE	43.8342	MAPE	18.4090
2025-06-03 14:17:53,251 - T:Avg	MAE	24.7956	RMSE	37.8567	MAPE	15.7107
2025-06-03 14:17:53,259 - Finished optimization, total time:2203.14 s, best model:log/GBA/team-42/2019/30.0073.pkl
2025-06-03 14:17:53,517 - [*] Year 2020 load from data/GBA/FastData/2020.npz
2025-06-03 14:17:53,613 - [*] load from log/GBA/team-42/2019/30.0073.pkl
2025-06-03 14:18:00,204 - number of increase nodes:216, nodes after 2 hop:torch.Size([1237]), total nodes this year 2352
2025-06-03 14:18:53,670 - [*] Year 2020 Dataset load!
2025-06-03 14:18:53,670 - [*] load from log/GBA/team-42/2019/30.0073.pkl
2025-06-03 14:18:53,677 - [*] EWC! lambda 0.001000
2025-06-03 14:22:47,279 - Total Parameters: 71948
2025-06-03 14:22:47,279 - Trainable Parameters: 71948
2025-06-03 14:22:47,279 - [*] Year 2020 Training start
2025-06-03 14:22:49,559 - node number torch.Size([19792, 12])
2025-06-03 14:26:00,897 - epoch:0, training loss:907.3139 validation loss:27.4207
2025-06-03 14:29:19,756 - epoch:1, training loss:902.6170 validation loss:22.3391
2025-06-03 14:32:39,170 - epoch:2, training loss:902.5539 validation loss:27.9611
2025-06-03 14:35:53,829 - epoch:3, training loss:904.4896 validation loss:25.2098
2025-06-03 14:39:07,730 - epoch:4, training loss:899.9335 validation loss:29.9719
2025-06-03 14:42:22,527 - epoch:5, training loss:905.3131 validation loss:36.2064
2025-06-03 14:45:37,827 - epoch:6, training loss:903.3682 validation loss:34.9140
2025-06-03 14:48:54,108 - epoch:7, training loss:898.2841 validation loss:27.5221
2025-06-03 14:50:41,434 - [*] loss:2095.6758
2025-06-03 14:50:43,964 - [*] year 2020, testing
2025-06-03 14:50:58,172 - T:3	MAE	32.6996	RMSE	41.4166	MAPE	27.8641
2025-06-03 14:51:26,858 - T:6	MAE	32.9813	RMSE	42.5062	MAPE	28.7369
2025-06-03 14:53:03,364 - T:12	MAE	34.5417	RMSE	45.5751	MAPE	31.6586
2025-06-03 14:53:03,364 - T:Avg	MAE	33.3693	RMSE	42.9873	MAPE	29.2300
2025-06-03 14:53:03,374 - Finished optimization, total time:1075.17 s, best model:log/GBA/team-42/2020/22.3391.pkl
2025-06-03 14:53:03,427 - 


2025-06-03 14:53:03,428 - 3   	 MAE	     22.15	     25.10	     22.37	     32.70		   25.58
2025-06-03 14:53:03,428 - 3   	RMSE	     34.23	     38.62	     34.12	     41.42		   37.10
2025-06-03 14:53:03,428 - 3   	MAPE	     14.20	     17.01	     14.13	     27.86		   18.30
2025-06-03 14:53:03,428 - 6   	 MAE	     24.32	     27.87	     24.42	     32.98		   27.40
2025-06-03 14:53:03,428 - 6   	RMSE	     37.42	     42.66	     37.41	     42.51		   40.00
2025-06-03 14:53:03,428 - 6   	MAPE	     15.54	     18.49	     15.39	     28.74		   19.54
2025-06-03 14:53:03,428 - 12  	 MAE	     28.72	     32.53	     28.80	     34.54		   31.15
2025-06-03 14:53:03,428 - 12  	RMSE	     43.78	     49.35	     43.83	     45.58		   45.64
2025-06-03 14:53:03,428 - 12  	MAPE	     18.64	     21.53	     18.41	     31.66		   22.56
2025-06-03 14:53:03,428 - Avg 	 MAE	     24.68	     28.12	     24.80	     33.37		   27.74
2025-06-03 14:53:03,428 - Avg 	RMSE	     37.92	     42.99	     37.86	     42.99		   40.44
2025-06-03 14:53:03,428 - Avg 	MAPE	     15.84	     18.75	     15.71	     29.23		   19.88
2025-06-03 14:53:03,428 - year	2017	total_time	 2427.7266	average_time	  242.7727	epoch	10
2025-06-03 14:53:03,428 - year	2018	total_time	 1315.2311	average_time	  164.4039	epoch	8
2025-06-03 14:53:03,428 - year	2019	total_time	 2203.1358	average_time	  169.4720	epoch	13
2025-06-03 14:53:03,428 - year	2020	total_time	 1075.1686	average_time	  134.3961	epoch	8
2025-06-03 14:53:03,428 - total time: 7021.2621
2025-06-04 04:51:08,322 - logger name:log/GBA/dlf-42/dlf.log
2025-06-04 04:51:08,323 - params : {'conf': 'conf/GBA/dlf.json', 'seed': 42, 'paral': 0, 'gpuid': 1, 'logname': 'dlf', 'method': 'DLF', 'load_first_year': 1, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/GBA/dlf-42/2017/30.0695.pkl', 'device': device(type='cuda', index=1), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>, 'DLF': <class 'src.model.model.DLF_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 16, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/GBA/finaldata/', 'save_data_path': 'data/GBA/FastData/', 'graph_path': 'data/GBA/graph/', 'model_path': 'log/GBA/', 'hidden_channels': 64, 'dilation_channels': 32, 'skip_channels': 32, 'end_channels': 32, 'supports_len': 2, 'kernel_size': 2, 'blocks': 4, 'layers': 2, 'rank': 6, 'train': 1, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'replay_num_samples': 300, 'extra_feature': True, 'momentum_type': 'linear', 'memory_size': 32, 'path': 'log/GBA/dlf-42', 'logger': <Logger utils.initialize (INFO)>}

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 858896.13it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 867839.70it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 931964.12it/s]
2025-06-04 04:51:58,418 - [*] Year 2017 load from data/GBA/FastData/2017.npz
2025-06-04 04:51:58,717 - [*] load from /home/bd2/ANATS/Online_Baselines/log/GBA/dlf-42/2017/30.0695.pkl
2025-06-04 04:53:52,106 - [*] loss:1923.5203
2025-06-04 04:53:54,192 - [*] year 2017, testing
2025-06-04 04:54:11,418 - T:3	MAE	23.8208	RMSE	35.7048	MAPE	16.7951
2025-06-04 04:54:44,190 - T:6	MAE	25.4665	RMSE	38.2380	MAPE	17.6569
2025-06-04 04:56:24,331 - T:12	MAE	29.0247	RMSE	43.6011	MAPE	20.0185
2025-06-04 04:56:24,331 - T:Avg	MAE	25.7595	RMSE	38.6506	MAPE	17.9599

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 967318.15it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1001440.69it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 958777.54it/s]
2025-06-04 04:57:14,251 - [*] Year 2018 load from data/GBA/FastData/2018.npz
2025-06-04 04:57:14,350 - [*] load from /home/bd2/ANATS/Online_Baselines/log/GBA/dlf-42/2017/30.0695.pkl
Traceback (most recent call last):
  File "/home/bd2/ANATS/Online_Baselines/main.py", line 204, in <module>
    main(args)
  File "/home/bd2/ANATS/Online_Baselines/main.py", line 91, in main
    influence_node_score = detect_default.influence_node_selection(model, args, pre_data, cur_data, pre_graph, cur_graph)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/ANATS/Online_Baselines/src/model/detect_default.py", line 66, in influence_node_selection
    pre_data = get_feature(pre_data, pre_graph, args, model, pre_adj)   # Use the model to extract features from previous and current data, the feature dimension is [num_nodes, batch_size, feature_dim]
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/ANATS/Online_Baselines/src/model/detect_default.py", line 20, in get_feature
    feature, _ = to_dense_batch(model.feature(data, adj), batch=data.batch)  # Use the model to extract features from the data and convert it into a dense batch format, with the shape of `feature` being [batch_size, num_nodes, feature_dim]
                                ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/ANATS/Online_Baselines/src/model/model.py", line 676, in feature
    output = self.dlf_model(x, [adj]).permute(0,2,1,3).squeeze(-1) # [batch_size,T, N, 1]
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/ANATS/Online_Baselines/src/model/dlf_model.py", line 76, in forward
    season=self.seasontrans(season)+season_res#b, c, n, t
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/ANATS/Online_Baselines/src/model/dlf_model.py", line 118, in forward
    x = attn(x) + x
        ^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/ANATS/Online_Baselines/src/model/dlf_model.py", line 152, in forward
    qkv = self.qkv(x).reshape(B, -1, 3, self.num_heads, C //
          ^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.31 GiB. GPU 1 has a total capacity of 23.57 GiB of which 2.99 GiB is free. Including non-PyTorch memory, this process has 20.56 GiB memory in use. Of the allocated memory 20.05 GiB is allocated by PyTorch, and 209.49 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-06-04 05:01:16,946 - logger name:log/GBA/dlf-42/dlf.log
2025-06-04 05:01:16,947 - params : {'conf': 'conf/GBA/dlf.json', 'seed': 42, 'paral': 0, 'gpuid': 1, 'logname': 'dlf', 'method': 'DLF', 'load_first_year': 1, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/GBA/dlf-42/2017/30.0695.pkl', 'device': device(type='cuda', index=1), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>, 'DLF': <class 'src.model.model.DLF_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 4, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/GBA/finaldata/', 'save_data_path': 'data/GBA/FastData/', 'graph_path': 'data/GBA/graph/', 'model_path': 'log/GBA/', 'hidden_channels': 64, 'dilation_channels': 32, 'skip_channels': 32, 'end_channels': 32, 'supports_len': 2, 'kernel_size': 2, 'blocks': 4, 'layers': 2, 'rank': 6, 'train': 1, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'replay_num_samples': 300, 'extra_feature': True, 'momentum_type': 'linear', 'memory_size': 32, 'path': 'log/GBA/dlf-42', 'logger': <Logger utils.initialize (INFO)>}

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 873834.12it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 927454.96it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 942765.45it/s]
2025-06-04 05:02:04,629 - [*] Year 2017 load from data/GBA/FastData/2017.npz
2025-06-04 05:02:04,917 - [*] load from /home/bd2/ANATS/Online_Baselines/log/GBA/dlf-42/2017/30.0695.pkl
2025-06-04 05:03:47,320 - [*] loss:1924.0813
2025-06-04 05:03:49,438 - [*] year 2017, testing
2025-06-04 05:04:04,603 - T:3	MAE	23.8208	RMSE	35.7048	MAPE	16.7951
2025-06-04 05:04:34,673 - T:6	MAE	25.4665	RMSE	38.2380	MAPE	17.6569
2025-06-04 05:06:11,868 - T:12	MAE	29.0247	RMSE	43.6011	MAPE	20.0185
2025-06-04 05:06:11,868 - T:Avg	MAE	25.7595	RMSE	38.6506	MAPE	17.9599

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 889893.26it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 973899.41it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 938820.66it/s]
2025-06-04 05:07:21,356 - [*] Year 2018 load from data/GBA/FastData/2018.npz
2025-06-04 05:07:21,457 - [*] load from /home/bd2/ANATS/Online_Baselines/log/GBA/dlf-42/2017/30.0695.pkl
Traceback (most recent call last):
  File "/home/bd2/ANATS/Online_Baselines/main.py", line 204, in <module>
    main(args)
  File "/home/bd2/ANATS/Online_Baselines/main.py", line 91, in main
    influence_node_score = detect_default.influence_node_selection(model, args, pre_data, cur_data, pre_graph, cur_graph)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/ANATS/Online_Baselines/src/model/detect_default.py", line 66, in influence_node_selection
    pre_data = get_feature(pre_data, pre_graph, args, model, pre_adj)   # Use the model to extract features from previous and current data, the feature dimension is [num_nodes, batch_size, feature_dim]
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/ANATS/Online_Baselines/src/model/detect_default.py", line 20, in get_feature
    feature, _ = to_dense_batch(model.feature(data, adj), batch=data.batch)  # Use the model to extract features from the data and convert it into a dense batch format, with the shape of `feature` being [batch_size, num_nodes, feature_dim]
                                ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/ANATS/Online_Baselines/src/model/model.py", line 676, in feature
    output = self.dlf_model(x, [adj]).permute(0,2,1,3).squeeze(-1) # [batch_size,T, N, 1]
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/ANATS/Online_Baselines/src/model/dlf_model.py", line 76, in forward
    season=self.seasontrans(season)+season_res#b, c, n, t
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/ANATS/Online_Baselines/src/model/dlf_model.py", line 118, in forward
    x = attn(x) + x
        ^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/ANATS/Online_Baselines/src/model/dlf_model.py", line 152, in forward
    qkv = self.qkv(x).reshape(B, -1, 3, self.num_heads, C //
          ^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.31 GiB. GPU 1 has a total capacity of 23.57 GiB of which 2.97 GiB is free. Including non-PyTorch memory, this process has 20.58 GiB memory in use. Of the allocated memory 20.05 GiB is allocated by PyTorch, and 233.91 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-06-04 05:22:15,033 - logger name:log/GLA/team-42/team.log
2025-06-04 05:22:15,034 - params : {'conf': 'conf/GLA/team.json', 'seed': 42, 'paral': 0, 'gpuid': 7, 'logname': 'team', 'method': 'TEAM', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/GBA/dlf-42/2017/30.0695.pkl', 'device': device(type='cuda', index=7), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>, 'DLF': <class 'src.model.model.DLF_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.001, 'batch_size': 16, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'n_heads': 3, 'in_channels': 1, 'K': 3, 'nb_block': 1, 'nb_chev_filter': 64, 'nb_time_filter': 64, 'num_of_hours': 1, 'missing_value': 0.0, 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/GLA/finaldata/', 'save_data_path': 'data/GLA/FastData/', 'graph_path': 'data/GLA/graph', 'model_path': 'log/GLA/', 'strategy': 'incremental', 'init': True, 'increase': True, 'decrease': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'original', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.001, 'replay': True, 'replay_strategy': 'distribution', 'replay_num_samples': 100, 'path': 'log/GLA/team-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-04 05:22:15,145 - [*] Year 2017 load from data/GLA/FastData/2017.npz
2025-06-04 05:22:15,426 - logger name:log/GLA/eac-42/eac.log
2025-06-04 05:22:15,426 - params : {'conf': 'conf/GLA/eac.json', 'seed': 42, 'paral': 0, 'gpuid': 6, 'logname': 'eac', 'method': 'EAC', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/GBA/dlf-42/2017/30.0695.pkl', 'device': device(type='cuda', index=6), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>, 'DLF': <class 'src.model.model.DLF_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/GLA/finaldata/', 'save_data_path': 'data/GLA/FastData/', 'graph_path': 'data/GLA/graph/', 'model_path': 'log/GLA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'rank': 6, 'train': 1, 'strategy': 'retrain', 'init': True, 'increase': True, 'num_hops': 2, 'detect': False, 'detect_strategy': 'feature', 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': False, 'replay_strategy': 'random', 'repaly_num_samples': 300, 'extra_feature': True, 'momentum_type': 'linear', 'memory_size': 32, 'path': 'log/GLA/eac-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-04 05:22:15,576 - logger name:log/GLA/online_st_an_sd-42/online_st_an_sd.log
2025-06-04 05:22:15,576 - params : {'conf': 'conf/GLA/online_st_an.json', 'seed': 42, 'paral': 0, 'gpuid': 3, 'logname': 'online_st_an_sd', 'method': 'TrafficStream', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/GBA/dlf-42/2017/30.0695.pkl', 'device': device(type='cuda', index=3), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>, 'DLF': <class 'src.model.model.DLF_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/GLA/finaldata/', 'save_data_path': 'data/GLA/FastData/', 'graph_path': 'data/GLA/graph/', 'model_path': 'log/GLA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'rank': 6, 'train': 1, 'strategy': 'retrain', 'init': True, 'increase': True, 'num_hops': 2, 'detect': False, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': False, 'path': 'log/GLA/online_st_an_sd-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-04 05:22:15,649 - logger name:log/GLA/retrain_st_sd-42/retrain_st_sd.log
2025-06-04 05:22:15,649 - params : {'conf': 'conf/GLA/retrain_st_sd.json', 'seed': 42, 'paral': 0, 'gpuid': 4, 'logname': 'retrain_st_sd', 'method': 'TrafficStream', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/GBA/dlf-42/2017/30.0695.pkl', 'device': device(type='cuda', index=4), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>, 'DLF': <class 'src.model.model.DLF_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/GLA/finaldata/', 'save_data_path': 'data/GLA/FastData/', 'graph_path': 'data/GLA/graph/', 'model_path': 'log/GLA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'rank': 6, 'train': 1, 'strategy': 'retrain', 'init': True, 'increase': False, 'num_hops': 0, 'detect': False, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': False, 'path': 'log/GLA/retrain_st_sd-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-04 05:22:15,652 - logger name:log/GLA/online_st_nn_sd-42/online_st_nn_sd.log
2025-06-04 05:22:15,652 - params : {'conf': 'conf/GLA/online_st_nn.json', 'seed': 42, 'paral': 0, 'gpuid': 2, 'logname': 'online_st_nn_sd', 'method': 'TrafficStream', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/GBA/dlf-42/2017/30.0695.pkl', 'device': device(type='cuda', index=2), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>, 'DLF': <class 'src.model.model.DLF_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/GLA/finaldata/', 'save_data_path': 'data/GLA/FastData/', 'graph_path': 'data/GLA/graph/', 'model_path': 'log/GLA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'rank': 6, 'train': 1, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': False, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': False, 'path': 'log/GLA/online_st_nn_sd-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-04 05:22:15,690 - logger name:log/GLA/trafficstream-42/trafficstream.log
2025-06-04 05:22:15,690 - params : {'conf': 'conf/GLA/trafficstream.json', 'seed': 42, 'paral': 0, 'gpuid': 1, 'logname': 'trafficstream', 'method': 'TrafficStream', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/GBA/dlf-42/2017/30.0695.pkl', 'device': device(type='cuda', index=1), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>, 'DLF': <class 'src.model.model.DLF_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/GLA/finaldata/', 'save_data_path': 'data/GLA/FastData/', 'graph_path': 'data/GLA/graph/', 'model_path': 'log/GLA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'rank': 6, 'train': 1, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'replay_num_samples': 300, 'extra_feature': True, 'momentum_type': 'linear', 'memory_size': 32, 'path': 'log/GLA/trafficstream-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-04 05:22:15,701 - logger name:log/GLA/pretrain_st_sd-42/pretrain_st_sd.log
2025-06-04 05:22:15,701 - params : {'conf': 'conf/GLA/pretrain_st_sd.json', 'seed': 42, 'paral': 0, 'gpuid': 5, 'logname': 'pretrain_st_sd', 'method': 'TrafficStream', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/GBA/dlf-42/2017/30.0695.pkl', 'device': device(type='cuda', index=5), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>, 'DLF': <class 'src.model.model.DLF_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/GLA/finaldata/', 'save_data_path': 'data/GLA/FastData/', 'graph_path': 'data/GLA/graph/', 'model_path': 'log/GLA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'rank': 6, 'train': 1, 'strategy': 'pretrain', 'init': True, 'increase': False, 'num_hops': 0, 'detect': False, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': False, 'path': 'log/GLA/pretrain_st_sd-42', 'logger': <Logger utils.initialize (INFO)>}

  0%|          | 0/21023 [00:00<?, ?it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 860564.23it/s]

100%|██████████| 21023/21023 [00:00<00:00, 893590.74it/s]

100%|██████████| 21023/21023 [00:00<00:00, 883031.26it/s]

100%|██████████| 21023/21023 [00:00<00:00, 876396.22it/s]

100%|██████████| 21023/21023 [00:00<00:00, 873167.83it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 874380.02it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1060047.28it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1029237.71it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1044514.30it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1011005.34it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1036838.02it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1049899.42it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1060519.01it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1021191.85it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1025324.17it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1034162.75it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1015406.13it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 991787.52it/s]
2025-06-04 05:22:31,153 - [*] Year 2017 Dataset load!
2025-06-04 05:22:31,247 - Total Parameters: 71948
2025-06-04 05:22:31,248 - Trainable Parameters: 71948
2025-06-04 05:22:31,248 - [*] Year 2017 Training start
2025-06-04 05:22:32,238 - node number torch.Size([29120, 12])
2025-06-04 05:23:19,428 - [*] Year 2017 load from data/GLA/FastData/2017.npz
2025-06-04 05:23:19,693 - [*] Year 2017 Dataset load!
2025-06-04 05:23:19,697 - Total Parameters: 3308
2025-06-04 05:23:19,697 - Trainable Parameters: 3308
2025-06-04 05:23:19,698 - [*] Year 2017 Training start
2025-06-04 05:23:21,600 - node number torch.Size([232960, 12])
2025-06-04 05:23:21,700 - [*] Year 2017 load from data/GLA/FastData/2017.npz
2025-06-04 05:23:22,004 - [*] Year 2017 Dataset load!
2025-06-04 05:23:22,007 - [*] Year 2017 Training start
2025-06-04 05:23:22,098 - [*] Year 2017 load from data/GLA/FastData/2017.npz
2025-06-04 05:23:22,237 - [*] Year 2017 load from data/GLA/FastData/2017.npz
2025-06-04 05:23:22,328 - [*] Year 2017 load from data/GLA/FastData/2017.npz
2025-06-04 05:23:22,328 - [*] Year 2017 load from data/GLA/FastData/2017.npz
2025-06-04 05:23:22,359 - [*] Year 2017 Dataset load!
2025-06-04 05:23:22,363 - Total Parameters: 3308
2025-06-04 05:23:22,363 - Trainable Parameters: 3308
2025-06-04 05:23:22,364 - [*] Year 2017 Training start
2025-06-04 05:23:22,635 - [*] Year 2017 Dataset load!
2025-06-04 05:23:22,640 - Total Parameters: 3308
2025-06-04 05:23:22,640 - Trainable Parameters: 3308
2025-06-04 05:23:22,640 - [*] Year 2017 Training start
2025-06-04 05:23:22,750 - [*] Year 2017 Dataset load!
2025-06-04 05:23:22,753 - Total Parameters: 3308
2025-06-04 05:23:22,753 - Trainable Parameters: 3308
2025-06-04 05:23:22,753 - [*] Year 2017 Training start
2025-06-04 05:23:22,761 - [*] Year 2017 Dataset load!
2025-06-04 05:23:22,764 - Total Parameters: 14300
2025-06-04 05:23:22,764 - Trainable Parameters: 14300
2025-06-04 05:23:22,764 - [*] Year 2017 Training start
2025-06-04 05:23:24,207 - node number torch.Size([232960, 12])
2025-06-04 05:23:24,303 - node number torch.Size([232960, 12])
2025-06-04 05:23:24,320 - node number torch.Size([232960, 12])
2025-06-04 05:23:24,634 - node number torch.Size([232960, 12])
2025-06-04 05:23:24,644 - node number torch.Size([232960, 12])
2025-06-04 05:23:38,396 - epoch:0, training loss:27562.5982 validation loss:53.7139
2025-06-04 05:23:38,502 - epoch:0, training loss:27562.5982 validation loss:53.7139
2025-06-04 05:23:38,533 - epoch:0, training loss:27562.5982 validation loss:53.7139
2025-06-04 05:23:38,567 - epoch:0, training loss:27562.5982 validation loss:53.7139
2025-06-04 05:23:38,596 - epoch:0, training loss:27562.5982 validation loss:53.7139
2025-06-04 05:23:39,748 - epoch:0, training loss:23829.4461 validation loss:45.6611
2025-06-04 05:23:53,113 - epoch:1, training loss:4025.2004 validation loss:39.1351
2025-06-04 05:23:53,218 - epoch:1, training loss:4025.2004 validation loss:39.1351
2025-06-04 05:23:53,249 - epoch:1, training loss:4025.2004 validation loss:39.1351
2025-06-04 05:23:53,350 - epoch:1, training loss:4025.2004 validation loss:39.1351
2025-06-04 05:23:55,664 - epoch:1, training loss:3376.7548 validation loss:38.6842
2025-06-04 05:23:56,271 - epoch:1, training loss:4025.2004 validation loss:39.1351
2025-06-04 05:24:07,840 - epoch:2, training loss:3110.2453 validation loss:35.3929
2025-06-04 05:24:07,925 - epoch:2, training loss:3110.2453 validation loss:35.3929
2025-06-04 05:24:08,046 - epoch:2, training loss:3110.2453 validation loss:35.3929
2025-06-04 05:24:10,220 - epoch:2, training loss:3110.2453 validation loss:35.3929
2025-06-04 05:24:10,729 - epoch:2, training loss:3110.2453 validation loss:35.3929
2025-06-04 05:24:11,992 - epoch:2, training loss:2914.7556 validation loss:39.1863
2025-06-04 05:24:22,349 - epoch:3, training loss:2923.6204 validation loss:35.5533
2025-06-04 05:24:22,682 - epoch:3, training loss:2923.6204 validation loss:35.5533
2025-06-04 05:24:23,020 - epoch:3, training loss:2923.6204 validation loss:35.5533
2025-06-04 05:24:23,682 - epoch:3, training loss:2923.6204 validation loss:35.5533
2025-06-04 05:24:27,503 - epoch:3, training loss:2771.4090 validation loss:40.1052
2025-06-04 05:24:28,260 - epoch:3, training loss:2923.6204 validation loss:35.5533
2025-06-04 05:24:37,101 - epoch:4, training loss:2856.6721 validation loss:35.1633
2025-06-04 05:24:37,523 - epoch:4, training loss:2856.6721 validation loss:35.1633
2025-06-04 05:24:37,690 - epoch:4, training loss:2856.6721 validation loss:35.1633
2025-06-04 05:24:40,300 - epoch:4, training loss:2856.6721 validation loss:35.1633
2025-06-04 05:24:43,191 - epoch:4, training loss:2681.1625 validation loss:34.1643
2025-06-04 05:24:45,132 - epoch:4, training loss:2856.6721 validation loss:35.1633
2025-06-04 05:24:51,720 - epoch:5, training loss:2807.8297 validation loss:34.4115
2025-06-04 05:24:52,093 - epoch:5, training loss:2807.8297 validation loss:34.4115
2025-06-04 05:24:52,248 - epoch:5, training loss:2807.8297 validation loss:34.4115
2025-06-04 05:24:57,432 - epoch:5, training loss:2807.8297 validation loss:34.4115
2025-06-04 05:24:59,457 - epoch:5, training loss:2595.4569 validation loss:34.5852
2025-06-04 05:25:02,743 - epoch:5, training loss:2807.8297 validation loss:34.4115
2025-06-04 05:25:05,998 - epoch:6, training loss:2761.4823 validation loss:34.3460
2025-06-04 05:25:06,245 - epoch:6, training loss:2761.4823 validation loss:34.3460
2025-06-04 05:25:07,602 - epoch:6, training loss:2761.4823 validation loss:34.3460
2025-06-04 05:25:15,326 - epoch:6, training loss:2540.8995 validation loss:34.1770
2025-06-04 05:25:15,778 - epoch:6, training loss:2761.4823 validation loss:34.3460
2025-06-04 05:25:19,794 - epoch:6, training loss:2761.4823 validation loss:34.3460
2025-06-04 05:25:20,333 - epoch:7, training loss:2703.2010 validation loss:34.8162
2025-06-04 05:25:20,578 - epoch:7, training loss:2703.2010 validation loss:34.8162
2025-06-04 05:25:22,339 - epoch:7, training loss:2703.2010 validation loss:34.8162
2025-06-04 05:25:30,882 - epoch:7, training loss:2530.6556 validation loss:35.2494
2025-06-04 05:25:34,299 - epoch:7, training loss:2703.2010 validation loss:34.8162
2025-06-04 05:25:34,468 - epoch:8, training loss:2679.7735 validation loss:35.8320
2025-06-04 05:25:34,671 - epoch:8, training loss:2679.7735 validation loss:35.8320
2025-06-04 05:25:36,674 - epoch:8, training loss:2679.7735 validation loss:35.8320
2025-06-04 05:25:37,728 - epoch:7, training loss:2703.2010 validation loss:34.8162
2025-06-04 05:25:46,722 - epoch:8, training loss:2501.5335 validation loss:37.7137
2025-06-04 05:25:48,554 - epoch:9, training loss:2670.0497 validation loss:34.0532
2025-06-04 05:25:49,159 - epoch:9, training loss:2670.0497 validation loss:34.0532
2025-06-04 05:25:51,172 - epoch:9, training loss:2670.0497 validation loss:34.0532
2025-06-04 05:25:52,476 - epoch:8, training loss:2679.7735 validation loss:35.8320
2025-06-04 05:25:55,001 - epoch:8, training loss:2679.7735 validation loss:35.8320
2025-06-04 05:26:02,806 - epoch:10, training loss:2659.0799 validation loss:36.7194
2025-06-04 05:26:03,028 - epoch:9, training loss:2492.3233 validation loss:36.2332
2025-06-04 05:26:03,685 - epoch:10, training loss:2659.0799 validation loss:36.7194
2025-06-04 05:26:05,994 - epoch:10, training loss:2659.0799 validation loss:36.7194
2025-06-04 05:26:10,776 - epoch:9, training loss:2670.0497 validation loss:34.0532
2025-06-04 05:26:12,115 - epoch:9, training loss:2670.0497 validation loss:34.0532
2025-06-04 05:26:17,042 - epoch:11, training loss:2666.1964 validation loss:34.1698
2025-06-04 05:26:18,338 - epoch:11, training loss:2666.1964 validation loss:34.1698
2025-06-04 05:26:18,986 - epoch:10, training loss:2493.3291 validation loss:33.6267
2025-06-04 05:26:20,443 - epoch:11, training loss:2666.1964 validation loss:34.1698
2025-06-04 05:26:29,102 - epoch:10, training loss:2659.0799 validation loss:36.7194
2025-06-04 05:26:29,658 - epoch:10, training loss:2659.0799 validation loss:36.7194
2025-06-04 05:26:31,293 - epoch:12, training loss:2651.7370 validation loss:33.9747
2025-06-04 05:26:32,951 - epoch:12, training loss:2651.7370 validation loss:33.9747
2025-06-04 05:26:34,922 - epoch:11, training loss:2489.2134 validation loss:38.2983
2025-06-04 05:26:35,155 - epoch:12, training loss:2651.7370 validation loss:33.9747
2025-06-04 05:26:45,171 - epoch:13, training loss:2644.9780 validation loss:32.9984
2025-06-04 05:26:47,066 - epoch:11, training loss:2666.1964 validation loss:34.1698
2025-06-04 05:26:47,293 - epoch:13, training loss:2644.9780 validation loss:32.9984
2025-06-04 05:26:47,597 - epoch:11, training loss:2666.1964 validation loss:34.1698
2025-06-04 05:26:50,147 - epoch:13, training loss:2644.9780 validation loss:32.9984
2025-06-04 05:26:50,575 - epoch:12, training loss:2486.2864 validation loss:33.5831
2025-06-04 05:26:59,032 - epoch:14, training loss:2639.3696 validation loss:33.6781
2025-06-04 05:27:01,926 - epoch:14, training loss:2639.3696 validation loss:33.6781
2025-06-04 05:27:04,918 - epoch:12, training loss:2651.7370 validation loss:33.9747
2025-06-04 05:27:04,992 - epoch:14, training loss:2639.3696 validation loss:33.6781
2025-06-04 05:27:06,299 - epoch:12, training loss:2651.7370 validation loss:33.9747
2025-06-04 05:27:06,305 - epoch:13, training loss:2465.9814 validation loss:36.2889
2025-06-04 05:27:11,723 - epoch:0, training loss:7022.9722 validation loss:34.4723
2025-06-04 05:27:12,893 - epoch:15, training loss:2643.7436 validation loss:32.7259
2025-06-04 05:27:16,043 - epoch:15, training loss:2643.7436 validation loss:32.7259
2025-06-04 05:27:19,653 - epoch:15, training loss:2643.7436 validation loss:32.7259
2025-06-04 05:27:22,002 - epoch:13, training loss:2644.9780 validation loss:32.9984
2025-06-04 05:27:22,319 - epoch:14, training loss:2464.9078 validation loss:35.9333
2025-06-04 05:27:24,646 - epoch:13, training loss:2644.9780 validation loss:32.9984
2025-06-04 05:27:26,811 - epoch:16, training loss:2633.3074 validation loss:32.9443
2025-06-04 05:27:30,098 - epoch:16, training loss:2633.3074 validation loss:32.9443
2025-06-04 05:27:34,236 - epoch:16, training loss:2633.3074 validation loss:32.9443
2025-06-04 05:27:38,024 - epoch:15, training loss:2453.1078 validation loss:37.7496
2025-06-04 05:27:39,417 - epoch:14, training loss:2639.3696 validation loss:33.6781
2025-06-04 05:27:40,630 - epoch:17, training loss:2636.8075 validation loss:33.2857
2025-06-04 05:27:42,988 - epoch:14, training loss:2639.3696 validation loss:33.6781
2025-06-04 05:27:44,997 - epoch:17, training loss:2636.8075 validation loss:33.2857
2025-06-04 05:27:48,570 - epoch:17, training loss:2636.8075 validation loss:33.2857
2025-06-04 05:27:54,760 - epoch:16, training loss:2490.0528 validation loss:33.1954
2025-06-04 05:27:54,919 - epoch:18, training loss:2636.5434 validation loss:33.4225
2025-06-04 05:27:56,992 - epoch:15, training loss:2643.7436 validation loss:32.7259
2025-06-04 05:27:59,217 - epoch:18, training loss:2636.5434 validation loss:33.4225
2025-06-04 05:28:01,161 - epoch:15, training loss:2643.7436 validation loss:32.7259
2025-06-04 05:28:03,358 - epoch:18, training loss:2636.5434 validation loss:33.4225
2025-06-04 05:28:08,829 - epoch:19, training loss:2632.4780 validation loss:35.8333
2025-06-04 05:28:10,586 - epoch:17, training loss:2458.6913 validation loss:35.4882
2025-06-04 05:28:13,790 - epoch:19, training loss:2632.4780 validation loss:35.8333
2025-06-04 05:28:14,454 - epoch:16, training loss:2633.3074 validation loss:32.9443
2025-06-04 05:28:17,904 - epoch:19, training loss:2632.4780 validation loss:35.8333
2025-06-04 05:28:19,269 - epoch:16, training loss:2633.3074 validation loss:32.9443
2025-06-04 05:28:22,803 - epoch:20, training loss:2627.8545 validation loss:33.1632
2025-06-04 05:28:26,533 - epoch:18, training loss:2454.1532 validation loss:32.9821
2025-06-04 05:28:28,343 - epoch:20, training loss:2627.8545 validation loss:33.1632
2025-06-04 05:28:31,903 - epoch:17, training loss:2636.8075 validation loss:33.2857
2025-06-04 05:28:32,406 - epoch:20, training loss:2627.8545 validation loss:33.1632
2025-06-04 05:28:36,724 - epoch:21, training loss:2627.0005 validation loss:33.2578
2025-06-04 05:28:37,271 - epoch:17, training loss:2636.8075 validation loss:33.2857
2025-06-04 05:28:42,341 - epoch:19, training loss:2449.3798 validation loss:32.8967
2025-06-04 05:28:42,432 - [*] loss:2616.6538
2025-06-04 05:28:42,711 - epoch:21, training loss:2627.0005 validation loss:33.2578
2025-06-04 05:28:47,316 - epoch:21, training loss:2627.0005 validation loss:33.2578
2025-06-04 05:28:48,437 - [*] loss:2616.6538
2025-06-04 05:28:48,987 - [*] year 2017, testing
2025-06-04 05:28:49,078 - epoch:18, training loss:2636.5434 validation loss:33.4225
2025-06-04 05:28:50,282 - [*] year 2017, testing
2025-06-04 05:28:52,956 - [*] loss:2616.6538
2025-06-04 05:28:55,489 - epoch:18, training loss:2636.5434 validation loss:33.4225
2025-06-04 05:28:58,086 - epoch:20, training loss:2465.3154 validation loss:38.3596
2025-06-04 05:28:58,488 - [*] year 2017, testing
2025-06-04 05:29:05,028 - T:3	MAE	23.2157	RMSE	36.1582	MAPE	10.5783
2025-06-04 05:29:06,209 - epoch:19, training loss:2632.4780 validation loss:35.8333
2025-06-04 05:29:13,375 - epoch:19, training loss:2632.4780 validation loss:35.8333
2025-06-04 05:29:13,929 - epoch:21, training loss:2444.3175 validation loss:34.0510
2025-06-04 05:29:23,298 - epoch:20, training loss:2627.8545 validation loss:33.1632
2025-06-04 05:29:23,554 - T:3	MAE	23.2157	RMSE	36.1582	MAPE	10.5783
2025-06-04 05:29:24,003 - T:3	MAE	23.2157	RMSE	36.1582	MAPE	10.5783
2025-06-04 05:29:29,784 - epoch:22, training loss:2449.5358 validation loss:35.1315
2025-06-04 05:29:31,972 - epoch:20, training loss:2627.8545 validation loss:33.1632
2025-06-04 05:29:33,546 - T:6	MAE	25.9340	RMSE	40.3616	MAPE	12.2427
2025-06-04 05:29:40,286 - epoch:21, training loss:2627.0005 validation loss:33.2578
2025-06-04 05:29:45,655 - epoch:23, training loss:2441.2808 validation loss:35.5054
2025-06-04 05:29:45,968 - [*] loss:2616.6538
2025-06-04 05:29:47,757 - [*] year 2017, testing
2025-06-04 05:29:50,814 - epoch:21, training loss:2627.0005 validation loss:33.2578
2025-06-04 05:29:56,532 - [*] loss:2616.6538
2025-06-04 05:29:58,008 - [*] year 2017, testing
2025-06-04 05:29:59,450 - T:6	MAE	25.9340	RMSE	40.3616	MAPE	12.2427
2025-06-04 05:30:01,713 - epoch:24, training loss:2441.7790 validation loss:33.8723
2025-06-04 05:30:07,772 - T:3	MAE	23.2157	RMSE	36.1582	MAPE	10.5783
2025-06-04 05:30:15,022 - T:3	MAE	23.2157	RMSE	36.1582	MAPE	10.5783
2025-06-04 05:30:18,030 - epoch:25, training loss:2428.2592 validation loss:38.2144
2025-06-04 05:30:24,250 - [*] loss:2840.7627
2025-06-04 05:30:31,022 - [*] year 2017, testing
2025-06-04 05:30:45,625 - T:6	MAE	25.9340	RMSE	40.3616	MAPE	12.2427
2025-06-04 05:30:46,918 - T:3	MAE	25.5883	RMSE	40.8392	MAPE	12.0996
2025-06-04 05:30:53,080 - T:6	MAE	25.9340	RMSE	40.3616	MAPE	12.2427
2025-06-04 05:30:57,079 - T:6	MAE	25.9340	RMSE	40.3616	MAPE	12.2427
2025-06-04 05:31:17,699 - T:6	MAE	28.0635	RMSE	44.2753	MAPE	13.4097
2025-06-04 05:31:28,778 - T:12	MAE	31.1949	RMSE	48.2748	MAPE	15.8555
2025-06-04 05:31:28,779 - T:Avg	MAE	26.3024	RMSE	40.8509	MAPE	12.6073
2025-06-04 05:31:28,787 - Finished optimization, total time:165.76 s, best model:log/GLA/retrain_st_sd-42/2017/32.7259.pkl

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 827741.82it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 962345.74it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 696329.12it/s]
2025-06-04 05:31:58,813 - epoch:1, training loss:2655.8493 validation loss:35.8051
2025-06-04 05:32:02,833 - T:12	MAE	31.1949	RMSE	48.2748	MAPE	15.8555
2025-06-04 05:32:02,833 - T:Avg	MAE	26.3024	RMSE	40.8509	MAPE	12.6073
2025-06-04 05:32:02,842 - Finished optimization, total time:170.40 s, best model:log/GLA/online_st_nn_sd-42/2017/32.7259.pkl

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 808376.07it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 962808.09it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 962125.23it/s]
2025-06-04 05:32:27,030 - [*] Year 2018 load from data/GLA/FastData/2018.npz
2025-06-04 05:32:27,095 - [*] Year 2018 Dataset load!
2025-06-04 05:32:27,096 - [*] load from log/GLA/retrain_st_sd-42/2017/32.7259.pkl
2025-06-04 05:32:27,100 - Total Parameters: 3308
2025-06-04 05:32:27,100 - Trainable Parameters: 3308
2025-06-04 05:32:27,101 - [*] Year 2018 Training start
2025-06-04 05:32:29,789 - node number torch.Size([235904, 12])
2025-06-04 05:32:44,968 - epoch:0, training loss:2729.0351 validation loss:34.2944
2025-06-04 05:32:48,451 - T:12	MAE	31.1949	RMSE	48.2748	MAPE	15.8555
2025-06-04 05:32:48,452 - T:Avg	MAE	26.3024	RMSE	40.8509	MAPE	12.6073
2025-06-04 05:32:48,460 - Finished optimization, total time:165.50 s, best model:log/GLA/trafficstream-42/2017/32.7259.pkl

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 954212.33it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1013468.80it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 747147.49it/s]
2025-06-04 05:32:55,372 - T:12	MAE	31.1949	RMSE	48.2748	MAPE	15.8555
2025-06-04 05:32:55,373 - T:Avg	MAE	26.3024	RMSE	40.8509	MAPE	12.6073
2025-06-04 05:32:55,381 - Finished optimization, total time:166.29 s, best model:log/GLA/pretrain_st_sd-42/2017/32.7259.pkl

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 880105.13it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1011515.64it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1016248.72it/s]
2025-06-04 05:33:01,934 - [*] Year 2018 load from data/GLA/FastData/2018.npz
2025-06-04 05:33:02,032 - [*] load from log/GLA/online_st_nn_sd-42/2017/32.7259.pkl
2025-06-04 05:33:02,488 - epoch:1, training loss:2662.9901 validation loss:35.0207
2025-06-04 05:33:04,862 - number of increase nodes:23, nodes after 2 hop:torch.Size([257]), total nodes this year 1843
2025-06-04 05:33:06,991 - [*] Year 2018 Dataset load!
2025-06-04 05:33:06,992 - [*] load from log/GLA/online_st_nn_sd-42/2017/32.7259.pkl
2025-06-04 05:33:06,999 - Total Parameters: 3308
2025-06-04 05:33:06,999 - Trainable Parameters: 3308
2025-06-04 05:33:07,000 - [*] Year 2018 Training start
2025-06-04 05:33:09,906 - node number torch.Size([32896, 12])
2025-06-04 05:33:14,830 - epoch:0, training loss:779.1546 validation loss:35.7547
2025-06-04 05:33:19,521 - epoch:2, training loss:2662.6282 validation loss:33.2079
2025-06-04 05:33:22,048 - epoch:1, training loss:733.2444 validation loss:38.4469
2025-06-04 05:33:22,680 - T:12	MAE	32.8650	RMSE	50.8711	MAPE	16.1197
2025-06-04 05:33:22,681 - T:Avg	MAE	28.3932	RMSE	44.6989	MAPE	13.6488
2025-06-04 05:33:22,688 - Finished optimization, total time:226.41 s, best model:log/GLA/eac-42/2017/32.8967.pkl

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 922274.84it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1003926.28it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1026004.20it/s]
2025-06-04 05:33:29,183 - epoch:2, training loss:723.9687 validation loss:36.8953
2025-06-04 05:33:36,359 - epoch:3, training loss:718.6708 validation loss:37.2602
2025-06-04 05:33:36,733 - epoch:3, training loss:2662.1752 validation loss:33.9006
2025-06-04 05:33:36,803 - [*] Year 2018 load from data/GLA/FastData/2018.npz
2025-06-04 05:33:36,874 - [*] load from log/GLA/trafficstream-42/2017/32.7259.pkl
2025-06-04 05:33:39,332 - [*] Year 2018 load from data/GLA/FastData/2018.npz
2025-06-04 05:33:39,400 - [*] load from log/GLA/pretrain_st_sd-42/2017/32.7259.pkl
2025-06-04 05:33:43,014 - epoch:4, training loss:720.3161 validation loss:34.5482
2025-06-04 05:33:46,744 - [*] loss:2498.6086
2025-06-04 05:33:47,907 - [*] year 2018, testing
2025-06-04 05:33:48,667 - number of increase nodes:373, nodes after 2 hop:torch.Size([1682]), total nodes this year 1843
2025-06-04 05:33:50,720 - epoch:5, training loss:722.3095 validation loss:40.8443
2025-06-04 05:33:53,934 - epoch:4, training loss:2664.6773 validation loss:36.0349
2025-06-04 05:33:57,921 - epoch:6, training loss:719.5098 validation loss:37.2787
2025-06-04 05:33:59,159 - [*] Year 2018 Dataset load!
2025-06-04 05:33:59,159 - [*] load from log/GLA/trafficstream-42/2017/32.7259.pkl
2025-06-04 05:33:59,164 - [*] EWC! lambda 0.000100
2025-06-04 05:34:00,733 - T:3	MAE	24.1836	RMSE	36.2215	MAPE	10.8913
2025-06-04 05:34:05,026 - epoch:7, training loss:719.5649 validation loss:34.0225
2025-06-04 05:34:08,185 - [*] Year 2018 Training start
2025-06-04 05:34:10,631 - [*] Year 2018 load from data/GLA/FastData/2018.npz
2025-06-04 05:34:10,683 - [*] Year 2018 Dataset load!
2025-06-04 05:34:10,683 - [*] load from log/GLA/eac-42/2017/32.8967.pkl
2025-06-04 05:34:10,691 - Total Parameters: 14438
2025-06-04 05:34:10,691 - Trainable Parameters: 11130
2025-06-04 05:34:10,691 - [*] Year 2018 Training start
2025-06-04 05:34:10,766 - node number torch.Size([215296, 12])
2025-06-04 05:34:11,129 - epoch:5, training loss:2652.8117 validation loss:35.5270
2025-06-04 05:34:12,296 - epoch:8, training loss:719.2458 validation loss:34.9374
2025-06-04 05:34:14,291 - node number torch.Size([235904, 12])
2025-06-04 05:34:20,490 - epoch:9, training loss:724.3727 validation loss:34.5349
2025-06-04 05:34:22,419 - epoch:0, training loss:3128.0935 validation loss:35.8685
2025-06-04 05:34:27,280 - T:6	MAE	26.7646	RMSE	40.3202	MAPE	12.3987
2025-06-04 05:34:28,645 - epoch:0, training loss:2642.3898 validation loss:34.1738
2025-06-04 05:34:28,654 - epoch:10, training loss:713.8832 validation loss:34.0754
2025-06-04 05:34:29,292 - epoch:6, training loss:2651.2965 validation loss:36.8865
2025-06-04 05:34:35,476 - epoch:11, training loss:711.5381 validation loss:35.6877
2025-06-04 05:34:36,794 - epoch:1, training loss:3059.0009 validation loss:36.6228
2025-06-04 05:34:42,563 - epoch:12, training loss:710.7519 validation loss:37.3832
2025-06-04 05:34:45,378 - epoch:1, training loss:2511.4844 validation loss:35.2086
2025-06-04 05:34:46,451 - epoch:7, training loss:2656.9349 validation loss:34.5154
2025-06-04 05:34:49,527 - epoch:13, training loss:708.5672 validation loss:40.6441
2025-06-04 05:34:51,077 - epoch:2, training loss:3055.6034 validation loss:36.9570
2025-06-04 05:34:57,273 - [*] loss:2798.5837
2025-06-04 05:35:02,834 - epoch:2, training loss:2495.7313 validation loss:35.1536
2025-06-04 05:35:03,548 - [*] year 2018, testing
2025-06-04 05:35:03,879 - epoch:8, training loss:2653.5227 validation loss:36.1310
2025-06-04 05:35:05,427 - epoch:3, training loss:3049.1879 validation loss:35.5170
2025-06-04 05:35:11,134 - [*] loss:2521.3772
2025-06-04 05:35:12,327 - [*] year 2018, testing
2025-06-04 05:35:20,538 - epoch:3, training loss:2484.6646 validation loss:34.2949
2025-06-04 05:35:20,755 - epoch:4, training loss:3069.4539 validation loss:38.7741
2025-06-04 05:35:20,978 - T:12	MAE	31.1949	RMSE	48.2748	MAPE	15.8555
2025-06-04 05:35:20,979 - T:Avg	MAE	26.3024	RMSE	40.8509	MAPE	12.6073
2025-06-04 05:35:20,987 - Finished optimization, total time:162.60 s, best model:log/GLA/online_st_an_sd-42/2017/32.7259.pkl
2025-06-04 05:35:21,996 - T:3	MAE	25.1596	RMSE	37.4749	MAPE	13.2341

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 788081.41it/s]
2025-06-04 05:35:25,262 - T:3	MAE	24.5458	RMSE	36.5876	MAPE	11.0914

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 977884.83it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 719605.44it/s]
2025-06-04 05:35:35,228 - epoch:5, training loss:3066.2630 validation loss:33.7244
2025-06-04 05:35:38,430 - epoch:4, training loss:2480.7268 validation loss:35.0829
2025-06-04 05:35:49,779 - epoch:6, training loss:3069.2929 validation loss:36.0382
2025-06-04 05:35:53,121 - T:6	MAE	27.0638	RMSE	40.6668	MAPE	12.5205
2025-06-04 05:35:55,358 - epoch:5, training loss:2469.3200 validation loss:35.3906
2025-06-04 05:35:57,726 - T:6	MAE	28.0604	RMSE	41.8581	MAPE	15.1893
2025-06-04 05:35:59,464 - T:12	MAE	31.7961	RMSE	48.0467	MAPE	15.8556
2025-06-04 05:35:59,464 - T:Avg	MAE	27.1233	RMSE	40.8073	MAPE	12.7804
2025-06-04 05:35:59,472 - [*] No increasing nodes at year 2018, store model of the last year.

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 554191.49it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 947771.32it/s]
2025-06-04 05:36:04,557 - epoch:7, training loss:3055.9395 validation loss:34.4627

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 952172.14it/s]
2025-06-04 05:36:12,748 - epoch:6, training loss:2470.7448 validation loss:34.2001
2025-06-04 05:36:19,484 - epoch:8, training loss:3053.6120 validation loss:34.9124
2025-06-04 05:36:21,104 - [*] loss:2655.5535
2025-06-04 05:36:22,455 - [*] year 2018, testing
2025-06-04 05:36:33,973 - epoch:9, training loss:3063.7250 validation loss:35.0948
2025-06-04 05:36:36,642 - T:3	MAE	26.5600	RMSE	39.5040	MAPE	13.5518
2025-06-04 05:36:38,371 - [*] Year 2018 load from data/GLA/FastData/2018.npz
2025-06-04 05:36:38,450 - [*] Year 2018 Dataset load!
2025-06-04 05:36:38,451 - [*] load from log/GLA/online_st_an_sd-42/2017/32.7259.pkl
2025-06-04 05:36:38,455 - Total Parameters: 3308
2025-06-04 05:36:38,456 - Trainable Parameters: 3308
2025-06-04 05:36:38,456 - [*] Year 2018 Training start
2025-06-04 05:36:40,197 - epoch:2, training loss:2616.2374 validation loss:34.3760
2025-06-04 05:36:41,464 - node number torch.Size([235904, 12])
2025-06-04 05:36:42,103 - [*] Year 2019 load from data/GLA/FastData/2019.npz
2025-06-04 05:36:42,164 - [*] load from log/GLA/pretrain_st_sd-42/2018/32.7259.pkl
2025-06-04 05:36:48,715 - epoch:10, training loss:3066.5500 validation loss:37.0470
2025-06-04 05:36:52,415 - [*] loss:2283.8237
2025-06-04 05:36:53,644 - [*] year 2019, testing
2025-06-04 05:36:56,960 - epoch:0, training loss:2729.0351 validation loss:34.2944
2025-06-04 05:37:00,027 - T:6	MAE	29.0312	RMSE	43.0730	MAPE	15.2911
2025-06-04 05:37:04,127 - epoch:11, training loss:3065.0751 validation loss:34.2667
2025-06-04 05:37:06,045 - T:3	MAE	22.5730	RMSE	34.3386	MAPE	10.9100
2025-06-04 05:37:12,363 - [*] loss:2506.4236
2025-06-04 05:37:13,479 - [*] year 2018, testing
2025-06-04 05:37:14,544 - epoch:1, training loss:2662.9901 validation loss:35.0207
2025-06-04 05:37:22,991 - T:12	MAE	32.0047	RMSE	48.2539	MAPE	16.0551
2025-06-04 05:37:22,991 - T:Avg	MAE	27.4186	RMSE	41.1180	MAPE	12.9537
2025-06-04 05:37:22,998 - Finished optimization, total time:80.90 s, best model:log/GLA/retrain_st_sd-42/2018/33.2079.pkl

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 877084.90it/s]
2025-06-04 05:37:25,687 - T:3	MAE	23.9936	RMSE	36.1177	MAPE	11.7604

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1046535.00it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 962934.26it/s]
2025-06-04 05:37:31,593 - T:12	MAE	33.5922	RMSE	50.6096	MAPE	18.9411
2025-06-04 05:37:31,593 - T:Avg	MAE	28.4463	RMSE	42.5213	MAPE	15.4577
2025-06-04 05:37:31,601 - Finished optimization, total time:55.51 s, best model:log/GLA/online_st_nn_sd-42/2018/34.0225.pkl
2025-06-04 05:37:32,929 - T:6	MAE	25.2834	RMSE	38.4827	MAPE	12.8796

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 463500.79it/s]
2025-06-04 05:37:33,033 - epoch:2, training loss:2662.6282 validation loss:33.2079

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1067193.38it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 929086.93it/s]
2025-06-04 05:37:50,963 - T:6	MAE	26.8219	RMSE	40.2770	MAPE	13.8685
2025-06-04 05:37:51,493 - epoch:3, training loss:2662.1752 validation loss:33.9006
2025-06-04 05:38:09,619 - epoch:4, training loss:2664.6773 validation loss:36.0349
2025-06-04 05:38:14,867 - [*] Year 2019 load from data/GLA/FastData/2019.npz
2025-06-04 05:38:14,870 - [*] Year 2019 load from data/GLA/FastData/2019.npz
2025-06-04 05:38:14,941 - [*] Year 2019 Dataset load!
2025-06-04 05:38:14,941 - [*] load from log/GLA/retrain_st_sd-42/2018/33.2079.pkl
2025-06-04 05:38:14,946 - Total Parameters: 3308
2025-06-04 05:38:14,946 - Trainable Parameters: 3308
2025-06-04 05:38:14,946 - [*] Year 2019 Training start
2025-06-04 05:38:14,949 - [*] load from log/GLA/online_st_nn_sd-42/2018/34.0225.pkl
2025-06-04 05:38:17,623 - number of increase nodes:16, nodes after 2 hop:torch.Size([211]), total nodes this year 1859
2025-06-04 05:38:18,646 - node number torch.Size([237952, 12])
2025-06-04 05:38:19,187 - [*] Year 2019 Dataset load!
2025-06-04 05:38:19,187 - [*] load from log/GLA/online_st_nn_sd-42/2018/34.0225.pkl
2025-06-04 05:38:19,191 - Total Parameters: 3308
2025-06-04 05:38:19,191 - Trainable Parameters: 3308
2025-06-04 05:38:19,191 - [*] Year 2019 Training start
2025-06-04 05:38:23,308 - node number torch.Size([27008, 12])
2025-06-04 05:38:23,390 - T:12	MAE	33.8829	RMSE	49.9777	MAPE	18.8240
2025-06-04 05:38:23,390 - T:Avg	MAE	29.3905	RMSE	43.5447	MAPE	15.6088
2025-06-04 05:38:23,398 - Finished optimization, total time:58.18 s, best model:log/GLA/eac-42/2018/34.1738.pkl

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 585733.14it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1010715.63it/s]
2025-06-04 05:38:27,390 - epoch:5, training loss:2652.8117 validation loss:35.5270

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1027199.42it/s]
2025-06-04 05:38:29,466 - epoch:0, training loss:1697.9912 validation loss:28.4724
2025-06-04 05:38:34,872 - epoch:0, training loss:2466.4548 validation loss:34.0075
2025-06-04 05:38:39,867 - epoch:1, training loss:1643.7146 validation loss:28.7779
2025-06-04 05:38:45,918 - epoch:6, training loss:2651.2965 validation loss:36.8865
2025-06-04 05:38:50,004 - epoch:2, training loss:1643.9712 validation loss:26.4099
2025-06-04 05:38:53,904 - epoch:1, training loss:2404.7442 validation loss:32.3034
2025-06-04 05:38:59,897 - epoch:3, training loss:1627.3859 validation loss:31.5858
2025-06-04 05:39:01,835 - T:12	MAE	30.5253	RMSE	46.3436	MAPE	17.0392
2025-06-04 05:39:01,836 - T:Avg	MAE	25.6585	RMSE	39.0011	MAPE	13.2843
2025-06-04 05:39:01,844 - [*] No increasing nodes at year 2019, store model of the last year.
2025-06-04 05:39:03,680 - epoch:7, training loss:2656.9349 validation loss:34.5154

  0%|          | 0/21080 [00:00<?, ?it/s]
100%|██████████| 21080/21080 [00:00<00:00, 916455.16it/s]
2025-06-04 05:39:07,660 - [*] Year 2019 load from data/GLA/FastData/2019.npz
2025-06-04 05:39:07,719 - [*] Year 2019 Dataset load!
2025-06-04 05:39:07,719 - [*] load from log/GLA/eac-42/2018/34.1738.pkl
2025-06-04 05:39:07,724 - Total Parameters: 14534
2025-06-04 05:39:07,725 - Trainable Parameters: 11226
2025-06-04 05:39:07,725 - [*] Year 2019 Training start

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 939250.71it/s]

  0%|          | 0/21081 [00:00<?, ?it/s]2025-06-04 05:39:10,273 - epoch:4, training loss:1643.5476 validation loss:31.4512

100%|██████████| 21081/21081 [00:00<00:00, 931679.62it/s]
2025-06-04 05:39:12,204 - node number torch.Size([237952, 12])
2025-06-04 05:39:12,890 - epoch:2, training loss:2414.1696 validation loss:32.4056
2025-06-04 05:39:13,582 - T:12	MAE	32.2085	RMSE	48.1085	MAPE	18.2225
2025-06-04 05:39:13,582 - T:Avg	MAE	27.1925	RMSE	40.7780	MAPE	14.2626
2025-06-04 05:39:13,590 - Finished optimization, total time:105.82 s, best model:log/GLA/trafficstream-42/2018/33.7244.pkl

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 701810.33it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 993721.16it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 985998.42it/s]
2025-06-04 05:39:20,299 - epoch:5, training loss:1609.1933 validation loss:27.0227
2025-06-04 05:39:21,954 - epoch:8, training loss:2653.5227 validation loss:36.1310
2025-06-04 05:39:27,186 - epoch:0, training loss:2347.1542 validation loss:32.2365
2025-06-04 05:39:29,715 - [*] loss:2521.3772
2025-06-04 05:39:30,481 - epoch:6, training loss:1610.6768 validation loss:34.6576
2025-06-04 05:39:32,299 - epoch:3, training loss:2414.6027 validation loss:33.1582
2025-06-04 05:39:35,696 - [*] year 2018, testing
2025-06-04 05:39:40,739 - epoch:7, training loss:1614.2283 validation loss:28.4695
2025-06-04 05:39:43,946 - epoch:1, training loss:2252.7699 validation loss:32.3466
2025-06-04 05:39:44,387 - [*] Year 2020 load from data/GLA/FastData/2020.npz
2025-06-04 05:39:44,454 - [*] load from log/GLA/pretrain_st_sd-42/2019/32.7259.pkl
2025-06-04 05:39:50,708 - epoch:8, training loss:1601.1553 validation loss:27.1102
2025-06-04 05:39:51,688 - epoch:4, training loss:2407.3714 validation loss:30.9789
2025-06-04 05:39:53,837 - T:3	MAE	24.5458	RMSE	36.5876	MAPE	11.0914
2025-06-04 05:39:53,869 - [*] loss:3022.8169
2025-06-04 05:39:55,169 - [*] year 2020, testing
2025-06-04 05:40:00,888 - epoch:2, training loss:2243.4234 validation loss:32.8825
2025-06-04 05:40:02,084 - [*] loss:2684.9465
2025-06-04 05:40:03,312 - [*] year 2019, testing
2025-06-04 05:40:07,809 - T:3	MAE	37.2095	RMSE	46.7488	MAPE	30.2950
2025-06-04 05:40:11,648 - epoch:5, training loss:2412.2439 validation loss:33.4844
2025-06-04 05:40:18,953 - epoch:3, training loss:2230.2813 validation loss:32.0269
2025-06-04 05:40:19,446 - T:3	MAE	23.8284	RMSE	35.4738	MAPE	18.0822
2025-06-04 05:40:28,212 - T:6	MAE	27.0638	RMSE	40.6668	MAPE	12.5205
2025-06-04 05:40:31,262 - epoch:6, training loss:2394.3271 validation loss:32.5906
2025-06-04 05:40:31,577 - [*] Year 2019 load from data/GLA/FastData/2019.npz
2025-06-04 05:40:31,663 - [*] load from log/GLA/trafficstream-42/2018/33.7244.pkl
2025-06-04 05:40:35,057 - T:6	MAE	38.8474	RMSE	49.1754	MAPE	32.6746
2025-06-04 05:40:36,537 - epoch:4, training loss:2220.9137 validation loss:32.9761
2025-06-04 05:40:48,081 - number of increase nodes:372, nodes after 2 hop:torch.Size([1731]), total nodes this year 1859
2025-06-04 05:40:51,321 - epoch:7, training loss:2406.6376 validation loss:33.8381
2025-06-04 05:40:52,303 - T:6	MAE	27.3566	RMSE	40.4439	MAPE	22.1796
2025-06-04 05:40:54,741 - epoch:5, training loss:2223.7147 validation loss:31.9381
2025-06-04 05:41:06,727 - [*] Year 2019 Dataset load!
2025-06-04 05:41:06,728 - [*] load from log/GLA/trafficstream-42/2018/33.7244.pkl
2025-06-04 05:41:06,737 - [*] EWC! lambda 0.000100
2025-06-04 05:41:11,679 - epoch:8, training loss:2398.4213 validation loss:33.0105
2025-06-04 05:41:13,140 - epoch:6, training loss:2220.2493 validation loss:32.9331
2025-06-04 05:41:17,600 - [*] Year 2019 Training start
2025-06-04 05:41:20,778 - epoch:3, training loss:2594.5052 validation loss:33.5342
2025-06-04 05:41:22,324 - node number torch.Size([221568, 12])
2025-06-04 05:41:31,577 - epoch:7, training loss:2211.0328 validation loss:32.3072
2025-06-04 05:41:31,729 - epoch:9, training loss:2388.9093 validation loss:32.7303
2025-06-04 05:41:35,470 - epoch:0, training loss:2084.9981 validation loss:29.9587
2025-06-04 05:41:50,075 - epoch:8, training loss:2214.1226 validation loss:32.8929
2025-06-04 05:41:51,762 - epoch:10, training loss:2365.2497 validation loss:32.0611
2025-06-04 05:41:52,251 - epoch:1, training loss:2066.8615 validation loss:30.5276
2025-06-04 05:42:01,279 - [*] loss:2329.1255
2025-06-04 05:42:02,526 - [*] year 2019, testing
2025-06-04 05:42:06,599 - T:12	MAE	42.1382	RMSE	53.9584	MAPE	37.3570
2025-06-04 05:42:06,599 - T:Avg	MAE	39.1363	RMSE	49.5363	MAPE	33.0869
2025-06-04 05:42:06,608 - [*] No increasing nodes at year 2020, store model of the last year.
2025-06-04 05:42:06,608 - 


2025-06-04 05:42:06,608 - 3   	 MAE	     23.22	     24.18	     22.57	     37.21		   26.80
2025-06-04 05:42:06,608 - 3   	RMSE	     36.16	     36.22	     34.34	     46.75		   38.37
2025-06-04 05:42:06,608 - 3   	MAPE	     10.58	     10.89	     10.91	     30.30		   15.67
2025-06-04 05:42:06,608 - 6   	 MAE	     25.93	     26.76	     25.28	     38.85		   29.21
2025-06-04 05:42:06,608 - 6   	RMSE	     40.36	     40.32	     38.48	     49.18		   42.09
2025-06-04 05:42:06,609 - 6   	MAPE	     12.24	     12.40	     12.88	     32.67		   17.55
2025-06-04 05:42:06,609 - 12  	 MAE	     31.19	     31.80	     30.53	     42.14		   33.91
2025-06-04 05:42:06,609 - 12  	RMSE	     48.27	     48.05	     46.34	     53.96		   49.16
2025-06-04 05:42:06,609 - 12  	MAPE	     15.86	     15.86	     17.04	     37.36		   21.53
2025-06-04 05:42:06,609 - Avg 	 MAE	     26.30	     27.12	     25.66	     39.14		   29.56
2025-06-04 05:42:06,609 - Avg 	RMSE	     40.85	     40.81	     39.00	     49.54		   42.55
2025-06-04 05:42:06,609 - Avg 	MAPE	     12.61	     12.78	     13.28	     33.09		   17.94
2025-06-04 05:42:06,609 - year	2017	total_time	  166.2855	average_time	    7.5584	epoch	22
2025-06-04 05:42:06,609 - total time: 166.2855
2025-06-04 05:42:07,389 - epoch:9, training loss:2214.2685 validation loss:32.4288
2025-06-04 05:42:08,824 - epoch:2, training loss:2075.2179 validation loss:30.5538
2025-06-04 05:42:10,688 - T:12	MAE	32.0047	RMSE	48.2539	MAPE	16.0551
2025-06-04 05:42:10,688 - T:Avg	MAE	27.4186	RMSE	41.1180	MAPE	12.9537
2025-06-04 05:42:10,698 - Finished optimization, total time:83.74 s, best model:log/GLA/online_st_an_sd-42/2018/33.2079.pkl

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 849889.19it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 872209.12it/s]
2025-06-04 05:42:15,274 - T:3	MAE	23.0182	RMSE	34.8405	MAPE	10.5344

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 987898.46it/s]
2025-06-04 05:42:24,280 - epoch:10, training loss:2214.2295 validation loss:31.9781
2025-06-04 05:42:25,249 - epoch:3, training loss:2067.0208 validation loss:29.6114
2025-06-04 05:42:31,142 - T:12	MAE	34.0233	RMSE	50.1154	MAPE	30.3939
2025-06-04 05:42:31,143 - T:Avg	MAE	27.8405	RMSE	41.1777	MAPE	22.8897
2025-06-04 05:42:31,150 - Finished optimization, total time:48.15 s, best model:log/GLA/online_st_nn_sd-42/2019/26.4099.pkl

  0%|          | 0/21080 [00:00<?, ?it/s]
100%|██████████| 21080/21080 [00:00<00:00, 881031.62it/s]

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 955924.22it/s]

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 929642.13it/s]
2025-06-04 05:42:40,604 - T:6	MAE	25.6289	RMSE	38.9218	MAPE	12.4425
2025-06-04 05:42:41,913 - epoch:4, training loss:2070.9898 validation loss:30.1276
2025-06-04 05:42:41,956 - epoch:11, training loss:2211.5867 validation loss:31.6145
2025-06-04 05:42:57,765 - [*] Year 2019 load from data/GLA/FastData/2019.npz
2025-06-04 05:42:57,828 - [*] Year 2019 Dataset load!
2025-06-04 05:42:57,828 - [*] load from log/GLA/online_st_an_sd-42/2018/33.2079.pkl
2025-06-04 05:42:57,834 - Total Parameters: 3308
2025-06-04 05:42:57,834 - Trainable Parameters: 3308
2025-06-04 05:42:57,834 - [*] Year 2019 Training start
2025-06-04 05:42:58,707 - epoch:5, training loss:2072.8573 validation loss:30.3994
2025-06-04 05:42:59,706 - epoch:12, training loss:2210.1858 validation loss:31.5726
2025-06-04 05:43:01,348 - node number torch.Size([237952, 12])
2025-06-04 05:43:15,284 - epoch:6, training loss:2070.6384 validation loss:33.8276
2025-06-04 05:43:16,873 - epoch:0, training loss:2466.4548 validation loss:34.0075
2025-06-04 05:43:16,910 - [*] Year 2020 load from data/GLA/FastData/2020.npz
2025-06-04 05:43:17,018 - [*] load from log/GLA/online_st_nn_sd-42/2019/26.4099.pkl
2025-06-04 05:43:17,039 - epoch:13, training loss:2211.4988 validation loss:32.3801
2025-06-04 05:43:20,010 - number of increase nodes:0, nodes after 2 hop:torch.Size([211]), total nodes this year 1859
2025-06-04 05:43:20,010 - [*] load from log/GLA/online_st_nn_sd-42/2019/26.4099.pkl
2025-06-04 05:43:30,952 - [*] loss:3680.8157
2025-06-04 05:43:31,953 - epoch:7, training loss:2071.0455 validation loss:30.3449
2025-06-04 05:43:32,430 - [*] year 2020, testing
2025-06-04 05:43:34,602 - epoch:14, training loss:2210.6175 validation loss:33.0674
2025-06-04 05:43:35,956 - epoch:1, training loss:2404.7442 validation loss:32.3034
2025-06-04 05:43:46,222 - T:3	MAE	39.7777	RMSE	49.3100	MAPE	35.6601
2025-06-04 05:43:48,829 - epoch:8, training loss:2066.0240 validation loss:31.5838
2025-06-04 05:43:51,565 - epoch:15, training loss:2209.6313 validation loss:32.3077
2025-06-04 05:43:54,174 - epoch:2, training loss:2414.1696 validation loss:32.4056
2025-06-04 05:44:05,738 - epoch:9, training loss:2079.7104 validation loss:33.7432
2025-06-04 05:44:05,954 - T:12	MAE	30.8723	RMSE	46.7650	MAPE	16.9834
2025-06-04 05:44:05,954 - T:Avg	MAE	26.0483	RMSE	39.4691	MAPE	12.9793
2025-06-04 05:44:05,962 - Finished optimization, total time:111.34 s, best model:log/GLA/retrain_st_sd-42/2019/30.9789.pkl

  0%|          | 0/21080 [00:00<?, ?it/s]
100%|██████████| 21080/21080 [00:00<00:00, 900870.43it/s]

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 564789.93it/s]
2025-06-04 05:44:09,376 - epoch:16, training loss:2205.5535 validation loss:32.7943

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 979181.87it/s]
2025-06-04 05:44:14,599 - T:6	MAE	42.7690	RMSE	53.3553	MAPE	40.3742
2025-06-04 05:44:14,775 - epoch:3, training loss:2414.6027 validation loss:33.1582
2025-06-04 05:44:15,131 - [*] loss:2318.5676
2025-06-04 05:44:20,406 - [*] year 2019, testing
2025-06-04 05:44:26,018 - epoch:17, training loss:2207.5798 validation loss:32.1673
2025-06-04 05:44:33,582 - epoch:4, training loss:2407.3714 validation loss:30.9789
2025-06-04 05:44:40,002 - T:3	MAE	22.7057	RMSE	34.6411	MAPE	10.5204
2025-06-04 05:44:42,879 - epoch:18, training loss:2206.1178 validation loss:32.4168
2025-06-04 05:44:50,648 - [*] loss:2480.7297
2025-06-04 05:44:51,580 - [*] Year 2020 load from data/GLA/FastData/2020.npz
2025-06-04 05:44:51,644 - [*] Year 2020 Dataset load!
2025-06-04 05:44:51,644 - [*] load from log/GLA/retrain_st_sd-42/2019/30.9789.pkl
2025-06-04 05:44:51,649 - Total Parameters: 3308
2025-06-04 05:44:51,649 - Trainable Parameters: 3308
2025-06-04 05:44:51,649 - [*] Year 2020 Training start
2025-06-04 05:44:52,015 - [*] year 2019, testing
2025-06-04 05:44:52,168 - epoch:5, training loss:2412.2439 validation loss:33.4844
2025-06-04 05:44:55,712 - node number torch.Size([237952, 12])
2025-06-04 05:45:04,757 - T:3	MAE	24.3534	RMSE	39.3335	MAPE	11.8829
2025-06-04 05:45:12,152 - epoch:6, training loss:2394.3271 validation loss:32.5906
2025-06-04 05:45:12,198 - epoch:0, training loss:2300.7200 validation loss:39.2030
2025-06-04 05:45:12,574 - T:6	MAE	25.4604	RMSE	38.9175	MAPE	12.2237
2025-06-04 05:45:30,516 - T:6	MAE	26.7608	RMSE	42.5617	MAPE	13.3042
2025-06-04 05:45:32,454 - epoch:1, training loss:2230.7110 validation loss:37.1151
2025-06-04 05:45:32,581 - epoch:7, training loss:2406.6376 validation loss:33.8381
2025-06-04 05:45:52,121 - T:12	MAE	46.9667	RMSE	59.5954	MAPE	49.0914
2025-06-04 05:45:52,121 - T:Avg	MAE	42.8122	RMSE	53.5339	MAPE	40.9817
2025-06-04 05:45:52,129 - [*] No increasing nodes at year 2020, store model of the last year.
2025-06-04 05:45:52,129 - 


2025-06-04 05:45:52,129 - 3   	 MAE	     23.22	     25.16	     23.83	     39.78		   28.00
2025-06-04 05:45:52,129 - 3   	RMSE	     36.16	     37.47	     35.47	     49.31		   39.60
2025-06-04 05:45:52,129 - 3   	MAPE	     10.58	     13.23	     18.08	     35.66		   19.39
2025-06-04 05:45:52,130 - 6   	 MAE	     25.93	     28.06	     27.36	     42.77		   31.03
2025-06-04 05:45:52,130 - 6   	RMSE	     40.36	     41.86	     40.44	     53.36		   44.00
2025-06-04 05:45:52,130 - 6   	MAPE	     12.24	     15.19	     22.18	     40.37		   22.50
2025-06-04 05:45:52,130 - 12  	 MAE	     31.19	     33.59	     34.02	     46.97		   36.44
2025-06-04 05:45:52,130 - 12  	RMSE	     48.27	     50.61	     50.12	     59.60		   52.15
2025-06-04 05:45:52,130 - 12  	MAPE	     15.86	     18.94	     30.39	     49.09		   28.57
2025-06-04 05:45:52,130 - Avg 	 MAE	     26.30	     28.45	     27.84	     42.81		   31.35
2025-06-04 05:45:52,130 - Avg 	RMSE	     40.85	     42.52	     41.18	     53.53		   44.52
2025-06-04 05:45:52,130 - Avg 	MAPE	     12.61	     15.46	     22.89	     40.98		   22.98
2025-06-04 05:45:52,130 - year	2017	total_time	  170.3966	average_time	    7.7453	epoch	22
2025-06-04 05:45:52,130 - year	2018	total_time	   55.5076	average_time	    3.9648	epoch	14
2025-06-04 05:45:52,130 - year	2019	total_time	   48.1514	average_time	    5.3502	epoch	9
2025-06-04 05:45:52,130 - total time: 274.0556
2025-06-04 05:45:52,455 - epoch:8, training loss:2398.4213 validation loss:33.0105
2025-06-04 05:45:52,989 - epoch:2, training loss:2234.8916 validation loss:37.7089
2025-06-04 05:46:03,289 - epoch:4, training loss:2560.2508 validation loss:33.6350
2025-06-04 05:46:13,136 - epoch:9, training loss:2388.9093 validation loss:32.7303
2025-06-04 05:46:13,215 - epoch:3, training loss:2239.3600 validation loss:40.6566
2025-06-04 05:46:32,937 - epoch:10, training loss:2365.2497 validation loss:32.0611
2025-06-04 05:46:33,327 - epoch:4, training loss:2238.2140 validation loss:36.8782
2025-06-04 05:46:42,707 - [*] loss:2329.1255
2025-06-04 05:46:43,589 - T:12	MAE	30.5155	RMSE	46.6855	MAPE	15.7299
2025-06-04 05:46:43,590 - T:Avg	MAE	25.7572	RMSE	39.3534	MAPE	12.5342
2025-06-04 05:46:43,600 - Finished optimization, total time:100.38 s, best model:log/GLA/trafficstream-42/2019/29.6114.pkl
2025-06-04 05:46:44,024 - [*] year 2019, testing

  0%|          | 0/21080 [00:00<?, ?it/s]
100%|██████████| 21080/21080 [00:00<00:00, 880294.79it/s]

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 1010504.14it/s]

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 965727.98it/s]
2025-06-04 05:46:53,079 - epoch:5, training loss:2215.6269 validation loss:42.2058
2025-06-04 05:46:57,369 - T:12	MAE	31.3538	RMSE	48.7315	MAPE	16.1851
2025-06-04 05:46:57,369 - T:Avg	MAE	27.0658	RMSE	42.9693	MAPE	13.5456
2025-06-04 05:46:57,378 - Finished optimization, total time:160.08 s, best model:log/GLA/eac-42/2019/31.5726.pkl

  0%|          | 0/21080 [00:00<?, ?it/s]
100%|██████████| 21080/21080 [00:00<00:00, 801086.60it/s]
2025-06-04 05:46:59,039 - T:3	MAE	23.0182	RMSE	34.8405	MAPE	10.5344

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 961663.20it/s]

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 982970.06it/s]
2025-06-04 05:47:13,696 - epoch:6, training loss:2168.0424 validation loss:37.1427
2025-06-04 05:47:28,858 - T:6	MAE	25.6289	RMSE	38.9218	MAPE	12.4425
2025-06-04 05:47:33,636 - epoch:7, training loss:2142.7558 validation loss:34.2300
2025-06-04 05:47:34,836 - [*] Year 2020 load from data/GLA/FastData/2020.npz
2025-06-04 05:47:34,922 - [*] load from log/GLA/trafficstream-42/2019/29.6114.pkl
2025-06-04 05:47:41,212 - [*] Year 2020 load from data/GLA/FastData/2020.npz
2025-06-04 05:47:41,264 - [*] Year 2020 Dataset load!
2025-06-04 05:47:41,264 - [*] load from log/GLA/eac-42/2019/31.5726.pkl
2025-06-04 05:47:41,269 - Total Parameters: 14534
2025-06-04 05:47:41,269 - Trainable Parameters: 11226
2025-06-04 05:47:41,269 - [*] Year 2020 Training start
2025-06-04 05:47:45,208 - node number torch.Size([237952, 12])
2025-06-04 05:47:48,964 - number of increase nodes:355, nodes after 2 hop:torch.Size([1696]), total nodes this year 1859
2025-06-04 05:47:53,524 - epoch:8, training loss:2124.3668 validation loss:36.6809
2025-06-04 05:47:59,769 - [*] Year 2020 Dataset load!
2025-06-04 05:47:59,769 - [*] load from log/GLA/trafficstream-42/2019/29.6114.pkl
2025-06-04 05:47:59,773 - [*] EWC! lambda 0.000100
2025-06-04 05:48:00,709 - epoch:0, training loss:2136.9673 validation loss:36.6095
2025-06-04 05:48:10,477 - [*] Year 2020 Training start
2025-06-04 05:48:13,333 - epoch:9, training loss:2120.1762 validation loss:35.9014
2025-06-04 05:48:14,666 - node number torch.Size([217088, 12])
2025-06-04 05:48:19,281 - epoch:1, training loss:2070.7607 validation loss:36.6436
2025-06-04 05:48:26,497 - epoch:0, training loss:2355.8438 validation loss:35.6084
2025-06-04 05:48:32,855 - epoch:10, training loss:2094.4296 validation loss:36.7765
2025-06-04 05:48:37,726 - epoch:2, training loss:2068.1616 validation loss:39.4720
2025-06-04 05:48:40,989 - epoch:1, training loss:2324.5334 validation loss:38.9429
2025-06-04 05:48:52,756 - epoch:11, training loss:2083.9150 validation loss:37.4060
2025-06-04 05:48:55,549 - epoch:2, training loss:2318.1693 validation loss:36.6812
2025-06-04 05:48:57,529 - epoch:3, training loss:2064.3929 validation loss:37.2954
2025-06-04 05:49:07,594 - T:12	MAE	30.8723	RMSE	46.7650	MAPE	16.9834
2025-06-04 05:49:07,595 - T:Avg	MAE	26.0483	RMSE	39.4691	MAPE	12.9793
2025-06-04 05:49:07,615 - Finished optimization, total time:109.63 s, best model:log/GLA/online_st_an_sd-42/2019/30.9789.pkl
2025-06-04 05:49:09,974 - epoch:3, training loss:2334.4380 validation loss:38.2555

  0%|          | 0/21080 [00:00<?, ?it/s]
100%|██████████| 21080/21080 [00:00<00:00, 250501.28it/s]
2025-06-04 05:49:12,709 - epoch:12, training loss:2082.2804 validation loss:37.2308

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 966783.91it/s]

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 942926.70it/s]
2025-06-04 05:49:16,573 - epoch:4, training loss:2061.7573 validation loss:36.9137
2025-06-04 05:49:24,401 - epoch:4, training loss:2328.2273 validation loss:37.0481
2025-06-04 05:49:32,811 - epoch:13, training loss:2071.5279 validation loss:34.7560
2025-06-04 05:49:35,956 - epoch:5, training loss:2058.3874 validation loss:37.5673
2025-06-04 05:49:39,109 - epoch:5, training loss:2322.8590 validation loss:39.1046
2025-06-04 05:49:42,546 - [*] loss:2757.4688
2025-06-04 05:49:43,855 - [*] year 2020, testing
2025-06-04 05:49:53,658 - epoch:6, training loss:2324.3831 validation loss:40.3276
2025-06-04 05:49:55,497 - epoch:6, training loss:2059.5147 validation loss:35.2428
2025-06-04 05:49:57,160 - T:3	MAE	36.7630	RMSE	45.4300	MAPE	31.1044
2025-06-04 05:50:01,490 - [*] loss:3309.3269
2025-06-04 05:50:02,610 - [*] year 2020, testing
2025-06-04 05:50:07,399 - [*] Year 2020 load from data/GLA/FastData/2020.npz
2025-06-04 05:50:07,498 - [*] Year 2020 Dataset load!
2025-06-04 05:50:07,498 - [*] load from log/GLA/online_st_an_sd-42/2019/30.9789.pkl
2025-06-04 05:50:07,510 - Total Parameters: 3308
2025-06-04 05:50:07,510 - Trainable Parameters: 3308
2025-06-04 05:50:07,510 - [*] Year 2020 Training start
2025-06-04 05:50:11,503 - node number torch.Size([237952, 12])
2025-06-04 05:50:15,005 - T:3	MAE	39.4422	RMSE	50.5738	MAPE	25.5599
2025-06-04 05:50:15,634 - epoch:7, training loss:2059.7651 validation loss:39.8885
2025-06-04 05:50:24,241 - T:6	MAE	38.0187	RMSE	47.6500	MAPE	32.3594
2025-06-04 05:50:27,588 - epoch:0, training loss:2300.7200 validation loss:39.2030
2025-06-04 05:50:35,320 - epoch:8, training loss:2058.5605 validation loss:38.9716
2025-06-04 05:50:39,411 - T:6	MAE	40.7817	RMSE	52.6790	MAPE	27.7748
2025-06-04 05:50:40,572 - epoch:5, training loss:2549.0412 validation loss:36.3164
2025-06-04 05:50:47,077 - epoch:1, training loss:2230.7110 validation loss:37.1151
2025-06-04 05:50:54,371 - epoch:9, training loss:2052.2604 validation loss:35.9309
2025-06-04 05:51:05,085 - epoch:2, training loss:2234.8916 validation loss:37.7089
2025-06-04 05:51:12,893 - epoch:10, training loss:2055.7432 validation loss:35.9061
2025-06-04 05:51:24,709 - epoch:3, training loss:2239.3600 validation loss:40.6566
2025-06-04 05:51:32,451 - epoch:11, training loss:2053.7318 validation loss:36.4840
2025-06-04 05:51:43,747 - epoch:4, training loss:2238.2140 validation loss:36.8782
2025-06-04 05:51:51,447 - epoch:12, training loss:2053.0056 validation loss:38.3427
2025-06-04 05:51:51,622 - T:12	MAE	40.1746	RMSE	51.4495	MAPE	34.9442
2025-06-04 05:51:51,623 - T:Avg	MAE	38.1128	RMSE	47.8060	MAPE	32.5620
2025-06-04 05:51:51,630 - Finished optimization, total time:144.94 s, best model:log/GLA/retrain_st_sd-42/2020/34.23.pkl
2025-06-04 05:51:51,631 - 


2025-06-04 05:51:51,631 - 3   	 MAE	     23.22	     24.55	     23.02	     36.76		   26.89
2025-06-04 05:51:51,631 - 3   	RMSE	     36.16	     36.59	     34.84	     45.43		   38.25
2025-06-04 05:51:51,631 - 3   	MAPE	     10.58	     11.09	     10.53	     31.10		   15.83
2025-06-04 05:51:51,631 - 6   	 MAE	     25.93	     27.06	     25.63	     38.02		   29.16
2025-06-04 05:51:51,631 - 6   	RMSE	     40.36	     40.67	     38.92	     47.65		   41.90
2025-06-04 05:51:51,631 - 6   	MAPE	     12.24	     12.52	     12.44	     32.36		   17.39
2025-06-04 05:51:51,632 - 12  	 MAE	     31.19	     32.00	     30.87	     40.17		   33.56
2025-06-04 05:51:51,632 - 12  	RMSE	     48.27	     48.25	     46.76	     51.45		   48.69
2025-06-04 05:51:51,632 - 12  	MAPE	     15.86	     16.06	     16.98	     34.94		   20.96
2025-06-04 05:51:51,632 - Avg 	 MAE	     26.30	     27.42	     26.05	     38.11		   29.47
2025-06-04 05:51:51,632 - Avg 	RMSE	     40.85	     41.12	     39.47	     47.81		   42.31
2025-06-04 05:51:51,632 - Avg 	MAPE	     12.61	     12.95	     12.98	     32.56		   17.78
2025-06-04 05:51:51,632 - year	2017	total_time	  165.7587	average_time	    7.5345	epoch	22
2025-06-04 05:51:51,632 - year	2018	total_time	   80.9035	average_time	    8.9893	epoch	9
2025-06-04 05:51:51,632 - year	2019	total_time	  111.3429	average_time	   10.1221	epoch	11
2025-06-04 05:51:51,632 - year	2020	total_time	  144.9404	average_time	   10.3529	epoch	14
2025-06-04 05:51:51,632 - total time: 502.9456
2025-06-04 05:52:00,893 - [*] loss:2900.4836
2025-06-04 05:52:01,780 - epoch:5, training loss:2215.6269 validation loss:42.2058
2025-06-04 05:52:02,001 - [*] year 2020, testing
2025-06-04 05:52:04,129 - T:12	MAE	43.2725	RMSE	56.5134	MAPE	32.0930
2025-06-04 05:52:04,129 - T:Avg	MAE	41.0400	RMSE	52.9881	MAPE	28.1547
2025-06-04 05:52:04,136 - Finished optimization, total time:63.16 s, best model:log/GLA/trafficstream-42/2020/35.6084.pkl
2025-06-04 05:52:04,174 - 


2025-06-04 05:52:04,174 - 3   	 MAE	     23.22	     23.99	     22.71	     39.44		   27.34
2025-06-04 05:52:04,174 - 3   	RMSE	     36.16	     36.12	     34.64	     50.57		   39.37
2025-06-04 05:52:04,174 - 3   	MAPE	     10.58	     11.76	     10.52	     25.56		   14.60
2025-06-04 05:52:04,174 - 6   	 MAE	     25.93	     26.82	     25.46	     40.78		   29.75
2025-06-04 05:52:04,174 - 6   	RMSE	     40.36	     40.28	     38.92	     52.68		   43.06
2025-06-04 05:52:04,174 - 6   	MAPE	     12.24	     13.87	     12.22	     27.77		   16.53
2025-06-04 05:52:04,174 - 12  	 MAE	     31.19	     32.21	     30.52	     43.27		   34.30
2025-06-04 05:52:04,174 - 12  	RMSE	     48.27	     48.11	     46.69	     56.51		   49.90
2025-06-04 05:52:04,174 - 12  	MAPE	     15.86	     18.22	     15.73	     32.09		   20.48
2025-06-04 05:52:04,175 - Avg 	 MAE	     26.30	     27.19	     25.76	     41.04		   30.07
2025-06-04 05:52:04,175 - Avg 	RMSE	     40.85	     40.78	     39.35	     52.99		   43.49
2025-06-04 05:52:04,175 - Avg 	MAPE	     12.61	     14.26	     12.53	     28.15		   16.89
2025-06-04 05:52:04,175 - year	2017	total_time	  165.4968	average_time	    7.5226	epoch	22
2025-06-04 05:52:04,175 - year	2018	total_time	  105.8231	average_time	    8.8186	epoch	12
2025-06-04 05:52:04,175 - year	2019	total_time	  100.3806	average_time	   10.0381	epoch	10
2025-06-04 05:52:04,175 - year	2020	total_time	   63.1575	average_time	    9.0225	epoch	7
2025-06-04 05:52:04,175 - total time: 434.8581
2025-06-04 05:52:14,931 - T:3	MAE	37.6831	RMSE	47.4646	MAPE	27.9384
2025-06-04 05:52:22,504 - epoch:6, training loss:2168.0424 validation loss:37.1427
2025-06-04 05:52:40,980 - T:6	MAE	38.8706	RMSE	49.3848	MAPE	29.2895
2025-06-04 05:52:42,210 - epoch:7, training loss:2142.7558 validation loss:34.2300
2025-06-04 05:53:02,069 - epoch:8, training loss:2124.3668 validation loss:36.6809
2025-06-04 05:53:20,221 - epoch:9, training loss:2120.1762 validation loss:35.9014
2025-06-04 05:53:40,081 - epoch:10, training loss:2094.4296 validation loss:36.7765
2025-06-04 05:53:58,891 - epoch:11, training loss:2083.9150 validation loss:37.4060
2025-06-04 05:54:04,930 - T:12	MAE	41.1620	RMSE	53.0377	MAPE	31.9022
2025-06-04 05:54:04,930 - T:Avg	MAE	38.9662	RMSE	49.5438	MAPE	29.4463
2025-06-04 05:54:04,938 - Finished optimization, total time:120.04 s, best model:log/GLA/eac-42/2020/35.2428.pkl
2025-06-04 05:54:04,939 - 


2025-06-04 05:54:04,939 - 3   	 MAE	     25.59	     26.56	     24.35	     37.68		   28.55
2025-06-04 05:54:04,939 - 3   	RMSE	     40.84	     39.50	     39.33	     47.46		   41.79
2025-06-04 05:54:04,939 - 3   	MAPE	     12.10	     13.55	     11.88	     27.94		   16.37
2025-06-04 05:54:04,939 - 6   	 MAE	     28.06	     29.03	     26.76	     38.87		   30.68
2025-06-04 05:54:04,939 - 6   	RMSE	     44.28	     43.07	     42.56	     49.38		   44.82
2025-06-04 05:54:04,939 - 6   	MAPE	     13.41	     15.29	     13.30	     29.29		   17.82
2025-06-04 05:54:04,939 - 12  	 MAE	     32.87	     33.88	     31.35	     41.16		   34.82
2025-06-04 05:54:04,939 - 12  	RMSE	     50.87	     49.98	     48.73	     53.04		   50.65
2025-06-04 05:54:04,939 - 12  	MAPE	     16.12	     18.82	     16.19	     31.90		   20.76
2025-06-04 05:54:04,940 - Avg 	 MAE	     28.39	     29.39	     27.07	     38.97		   30.95
2025-06-04 05:54:04,940 - Avg 	RMSE	     44.70	     43.54	     42.97	     49.54		   45.19
2025-06-04 05:54:04,940 - Avg 	MAPE	     13.65	     15.61	     13.55	     29.45		   18.06
2025-06-04 05:54:04,940 - year	2017	total_time	  226.4122	average_time	    8.7082	epoch	26
2025-06-04 05:54:04,940 - year	2018	total_time	   58.1784	average_time	    8.3112	epoch	7
2025-06-04 05:54:04,940 - year	2019	total_time	  160.0754	average_time	    8.4250	epoch	19
2025-06-04 05:54:04,940 - year	2020	total_time	  120.0439	average_time	    9.2342	epoch	13
2025-06-04 05:54:04,940 - total time: 564.7099
2025-06-04 05:54:16,753 - epoch:12, training loss:2082.2804 validation loss:37.2308
2025-06-04 05:54:34,677 - epoch:13, training loss:2071.5279 validation loss:34.7560
2025-06-04 05:54:42,173 - [*] loss:2757.4688
2025-06-04 05:54:43,337 - [*] year 2020, testing
2025-06-04 05:54:56,545 - T:3	MAE	36.7630	RMSE	45.4300	MAPE	31.1044
2025-06-04 05:55:22,816 - T:6	MAE	38.0187	RMSE	47.6500	MAPE	32.3594
2025-06-04 05:55:26,080 - epoch:6, training loss:2545.2320 validation loss:36.5235
2025-06-04 05:56:44,195 - T:12	MAE	40.1746	RMSE	51.4495	MAPE	34.9442
2025-06-04 05:56:44,195 - T:Avg	MAE	38.1128	RMSE	47.8060	MAPE	32.5620
2025-06-04 05:56:44,203 - Finished optimization, total time:138.76 s, best model:log/GLA/online_st_an_sd-42/2020/34.23.pkl
2025-06-04 05:56:44,203 - 


2025-06-04 05:56:44,204 - 3   	 MAE	     23.22	     24.55	     23.02	     36.76		   26.89
2025-06-04 05:56:44,204 - 3   	RMSE	     36.16	     36.59	     34.84	     45.43		   38.25
2025-06-04 05:56:44,204 - 3   	MAPE	     10.58	     11.09	     10.53	     31.10		   15.83
2025-06-04 05:56:44,204 - 6   	 MAE	     25.93	     27.06	     25.63	     38.02		   29.16
2025-06-04 05:56:44,204 - 6   	RMSE	     40.36	     40.67	     38.92	     47.65		   41.90
2025-06-04 05:56:44,204 - 6   	MAPE	     12.24	     12.52	     12.44	     32.36		   17.39
2025-06-04 05:56:44,204 - 12  	 MAE	     31.19	     32.00	     30.87	     40.17		   33.56
2025-06-04 05:56:44,204 - 12  	RMSE	     48.27	     48.25	     46.76	     51.45		   48.69
2025-06-04 05:56:44,204 - 12  	MAPE	     15.86	     16.06	     16.98	     34.94		   20.96
2025-06-04 05:56:44,204 - Avg 	 MAE	     26.30	     27.42	     26.05	     38.11		   29.47
2025-06-04 05:56:44,204 - Avg 	RMSE	     40.85	     41.12	     39.47	     47.81		   42.31
2025-06-04 05:56:44,204 - Avg 	MAPE	     12.61	     12.95	     12.98	     32.56		   17.78
2025-06-04 05:56:44,204 - year	2017	total_time	  162.5953	average_time	    7.3907	epoch	22
2025-06-04 05:56:44,204 - year	2018	total_time	   83.7424	average_time	    9.3047	epoch	9
2025-06-04 05:56:44,204 - year	2019	total_time	  109.6251	average_time	    9.9659	epoch	11
2025-06-04 05:56:44,204 - year	2020	total_time	  138.7619	average_time	    9.9116	epoch	14
2025-06-04 05:56:44,204 - total time: 494.7247
2025-06-04 06:00:12,787 - epoch:7, training loss:2535.4782 validation loss:34.6595
2025-06-04 06:02:46,250 - logger name:log/GLA/retrain_st_sd-42/retrain_st_sd.log
2025-06-04 06:02:46,251 - params : {'conf': 'conf/GLA/retrain_st_sd.json', 'seed': 42, 'paral': 0, 'gpuid': 4, 'logname': 'retrain_st_sd', 'method': 'TrafficStream', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/GBA/dlf-42/2017/30.0695.pkl', 'device': device(type='cuda', index=4), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>, 'DLF': <class 'src.model.model.DLF_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/GLA/finaldata/', 'save_data_path': 'data/GLA/FastData/', 'graph_path': 'data/GLA/graph/', 'model_path': 'log/GLA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'rank': 6, 'train': 1, 'strategy': 'retrain', 'init': False, 'increase': False, 'num_hops': 0, 'detect': False, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': False, 'path': 'log/GLA/retrain_st_sd-42', 'logger': <Logger utils.initialize (INFO)>}

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 810680.00it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 999442.94it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 959132.13it/s]
2025-06-04 06:03:08,638 - logger name:log/GBA/retrain_st_sd-42/retrain_st_sd.log
2025-06-04 06:03:08,639 - params : {'conf': 'conf/GBA/retrain_st_sd.json', 'seed': 42, 'paral': 0, 'gpuid': 1, 'logname': 'retrain_st_sd', 'method': 'TrafficStream', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/GBA/dlf-42/2017/30.0695.pkl', 'device': device(type='cuda', index=1), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>, 'DLF': <class 'src.model.model.DLF_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/GBA/finaldata/', 'save_data_path': 'data/GBA/FastData/', 'graph_path': 'data/GBA/graph/', 'model_path': 'log/GBA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'rank': 6, 'train': 1, 'strategy': 'retrain', 'init': False, 'increase': False, 'num_hops': 0, 'detect': False, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': False, 'path': 'log/GBA/retrain_st_sd-42', 'logger': <Logger utils.initialize (INFO)>}

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 852526.86it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 840387.83it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 936447.71it/s]
2025-06-04 06:04:03,566 - [*] Year 2017 load from data/GBA/FastData/2017.npz
2025-06-04 06:04:03,871 - [*] Year 2017 Dataset load!
2025-06-04 06:04:03,878 - Total Parameters: 3308
2025-06-04 06:04:03,878 - Trainable Parameters: 3308
2025-06-04 06:04:03,878 - [*] Year 2017 Training start
2025-06-04 06:04:06,170 - node number torch.Size([293632, 12])
2025-06-04 06:04:07,457 - [*] Year 2017 load from data/GLA/FastData/2017.npz
2025-06-04 06:04:07,729 - [*] Year 2017 Dataset load!
2025-06-04 06:04:07,732 - Total Parameters: 3308
2025-06-04 06:04:07,732 - Trainable Parameters: 3308
2025-06-04 06:04:07,733 - [*] Year 2017 Training start
2025-06-04 06:04:09,876 - node number torch.Size([232960, 12])
2025-06-04 06:04:25,844 - epoch:0, training loss:16396.3282 validation loss:47.9856
2025-06-04 06:04:26,963 - epoch:0, training loss:27562.5982 validation loss:53.7139
2025-06-04 06:04:44,834 - epoch:1, training loss:4025.2004 validation loss:39.1351
2025-06-04 06:04:46,633 - epoch:1, training loss:2738.1846 validation loss:35.2383
2025-06-04 06:04:56,516 - epoch:8, training loss:2521.1093 validation loss:34.0647
2025-06-04 06:04:58,411 - epoch:2, training loss:3110.2453 validation loss:35.3929
2025-06-04 06:05:07,533 - epoch:2, training loss:2198.9132 validation loss:33.4468
2025-06-04 06:05:12,633 - epoch:3, training loss:2923.6204 validation loss:35.5533
2025-06-04 06:05:26,389 - epoch:4, training loss:2856.6721 validation loss:35.1633
2025-06-04 06:05:28,656 - epoch:3, training loss:2114.3922 validation loss:34.4024
2025-06-04 06:05:40,220 - epoch:5, training loss:2807.8297 validation loss:34.4115
2025-06-04 06:05:49,907 - epoch:4, training loss:2083.2391 validation loss:35.0049
2025-06-04 06:05:54,619 - epoch:6, training loss:2761.4823 validation loss:34.3460
2025-06-04 06:06:08,474 - epoch:7, training loss:2703.2010 validation loss:34.8162
2025-06-04 06:06:10,540 - epoch:5, training loss:2039.5095 validation loss:32.2186
2025-06-04 06:06:22,459 - epoch:8, training loss:2679.7735 validation loss:35.8320
2025-06-04 06:06:31,363 - epoch:6, training loss:1997.3384 validation loss:33.0389
2025-06-04 06:06:36,281 - epoch:9, training loss:2670.0497 validation loss:34.0532
2025-06-04 06:06:50,220 - epoch:10, training loss:2659.0799 validation loss:36.7194
2025-06-04 06:06:52,469 - epoch:7, training loss:1962.1166 validation loss:33.1921
2025-06-04 06:07:03,961 - epoch:11, training loss:2666.1964 validation loss:34.1698
2025-06-04 06:07:12,629 - epoch:8, training loss:1953.7240 validation loss:33.5607
2025-06-04 06:07:18,269 - epoch:12, training loss:2651.7370 validation loss:33.9747
2025-06-04 06:07:32,357 - epoch:13, training loss:2644.9780 validation loss:32.9984
2025-06-04 06:07:32,731 - epoch:9, training loss:1947.6575 validation loss:33.2057
2025-06-04 06:07:46,273 - epoch:14, training loss:2639.3696 validation loss:33.6781
2025-06-04 06:07:52,971 - epoch:10, training loss:1946.4764 validation loss:35.2369
2025-06-04 06:08:00,034 - epoch:15, training loss:2643.7436 validation loss:32.7259
2025-06-04 06:08:13,806 - epoch:11, training loss:1943.0056 validation loss:32.3416
2025-06-04 06:08:14,270 - epoch:16, training loss:2633.3074 validation loss:32.9443
2025-06-04 06:08:20,974 - [*] loss:2038.3776
2025-06-04 06:08:22,339 - [*] year 2017, testing
2025-06-04 06:08:28,133 - epoch:17, training loss:2636.8075 validation loss:33.2857
2025-06-04 06:08:40,430 - T:3	MAE	24.0150	RMSE	35.6573	MAPE	18.0147
2025-06-04 06:08:42,434 - epoch:18, training loss:2636.5434 validation loss:33.4225
2025-06-04 06:08:56,691 - epoch:19, training loss:2632.4780 validation loss:35.8333
2025-06-04 06:09:10,834 - epoch:20, training loss:2627.8545 validation loss:33.1632
2025-06-04 06:09:14,062 - T:6	MAE	25.4486	RMSE	38.3750	MAPE	18.8558
2025-06-04 06:09:25,188 - epoch:21, training loss:2627.0005 validation loss:33.2578
2025-06-04 06:09:30,717 - [*] loss:2616.6538
2025-06-04 06:09:31,713 - [*] year 2017, testing
2025-06-04 06:09:40,233 - epoch:9, training loss:2524.2295 validation loss:34.3581
2025-06-04 06:09:44,996 - T:3	MAE	23.2157	RMSE	36.1582	MAPE	10.5783
2025-06-04 06:10:11,712 - T:6	MAE	25.9340	RMSE	40.3616	MAPE	12.2427
2025-06-04 06:11:01,601 - T:12	MAE	29.4858	RMSE	45.0165	MAPE	21.8401
2025-06-04 06:11:01,601 - T:Avg	MAE	25.9958	RMSE	39.1326	MAPE	19.3291
2025-06-04 06:11:01,609 - Finished optimization, total time:119.83 s, best model:log/GBA/retrain_st_sd-42/2017/32.2186.pkl

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 983688.49it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1005196.62it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1062486.93it/s]
2025-06-04 06:11:12,642 - [*] loss:2527.7002
2025-06-04 06:11:14,357 - [*] year 2017, testing
2025-06-04 06:11:26,907 - T:3	MAE	23.7759	RMSE	36.7401	MAPE	10.3493
2025-06-04 06:11:37,029 - T:12	MAE	31.1949	RMSE	48.2748	MAPE	15.8555
2025-06-04 06:11:37,029 - T:Avg	MAE	26.3024	RMSE	40.8509	MAPE	12.6073
2025-06-04 06:11:37,036 - Finished optimization, total time:165.02 s, best model:log/GLA/retrain_st_sd-42/2017/32.7259.pkl

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 954026.50it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1023978.69it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1033302.31it/s]
2025-06-04 06:11:49,459 - [*] Year 2018 load from data/GBA/FastData/2018.npz
2025-06-04 06:11:49,535 - [*] Year 2018 Dataset load!
2025-06-04 06:11:49,537 - Total Parameters: 3308
2025-06-04 06:11:49,537 - Trainable Parameters: 3308
2025-06-04 06:11:49,537 - [*] Year 2018 Training start
2025-06-04 06:11:51,911 - T:6	MAE	26.4620	RMSE	40.7234	MAPE	11.3583
2025-06-04 06:11:52,243 - node number torch.Size([297088, 12])
2025-06-04 06:12:10,790 - epoch:0, training loss:16040.3041 validation loss:33.2756
2025-06-04 06:12:19,018 - [*] Year 2018 load from data/GLA/FastData/2018.npz
2025-06-04 06:12:19,075 - [*] Year 2018 Dataset load!
2025-06-04 06:12:19,077 - Total Parameters: 3308
2025-06-04 06:12:19,077 - Trainable Parameters: 3308
2025-06-04 06:12:19,077 - [*] Year 2018 Training start
2025-06-04 06:12:21,175 - node number torch.Size([235904, 12])
2025-06-04 06:12:32,060 - epoch:1, training loss:2202.2005 validation loss:30.3466
2025-06-04 06:12:35,073 - epoch:0, training loss:27049.8099 validation loss:55.8957
2025-06-04 06:12:40,376 - logger name:log/GLA/stkec-42/stkec.log
2025-06-04 06:12:40,376 - params : {'conf': 'conf/GLA/stkec.json', 'seed': 42, 'paral': 0, 'gpuid': 2, 'logname': 'stkec', 'method': 'STKEC', 'load_first_year': 0, 'first_year_model_path': 'log/PEMS3/trafficStream-42/2011/16.6936.pkl', 'device': device(type='cuda', index=2), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 0, 'influe_length': 168, 'batch_influ_size': 4, 'beita': 1, 'cluster': 24, 'auto_test': 1, 'raw_data_path': 'data/GLA/finaldata/', 'save_data_path': 'data/GLA/FastData/', 'graph_path': 'data/GLA/graph/', 'model_path': 'log/GLA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'rank': 6, 'train': 1, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'detect_infl_strategy': True, 'infl_topk': 10, 'adp_adj': False, 'skip_dim': 64, 'end_dim': 64, 'hidden_channels': 32, 'dilation_channels': 64, 'residual_channels': 64, 'input_dim': 1, 'output_dim': 1, 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'replay_num_samples': 300, 'extra_feature': True, 'momentum_type': 'linear', 'memory_size': 32, 'path': 'log/GLA/stkec-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-04 06:12:40,473 - [*] Year 2017 load from data/GLA/FastData/2017.npz
2025-06-04 06:12:46,115 - logger name:log/GLA/pecpm-42/pecpm.log
2025-06-04 06:12:46,115 - params : {'conf': 'conf/GLA/pecpm.json', 'seed': 42, 'paral': 0, 'gpuid': 3, 'logname': 'pecpm', 'method': 'PECPM', 'load_first_year': 0, 'first_year_model_path': 'log/SD/pecpm-42/2017/31.5668.pkl', 'device': device(type='cuda', index=3), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'PECPM': <class 'src.model.model.PECPM_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 32, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'beita': 1.0, 'cluster': 32, 'raw_data_path': 'data/GLA/finaldata/', 'save_data_path': 'data/GLA/FastData/', 'graph_path': 'data/GLA/graph/', 'model_path': 'log/GLA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'train': 1, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'adp_adj': False, 'skip_dim': 64, 'end_dim': 64, 'hidden_channels': 32, 'dilation_channels': 64, 'residual_channels': 64, 'input_dim': 1, 'output_dim': 1, 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 300, 'path': 'log/GLA/pecpm-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-04 06:12:46,242 - [*] Year 2017 load from data/GLA/FastData/2017.npz
2025-06-04 06:12:51,654 - epoch:1, training loss:4220.9862 validation loss:39.0689
2025-06-04 06:12:53,314 - epoch:2, training loss:2127.0995 validation loss:31.3866
2025-06-04 06:12:56,808 - [*] Year 2017 Dataset load!
2025-06-04 06:12:56,821 - [*] Year 2017 Training start
2025-06-04 06:12:58,356 - node number torch.Size([232960, 12])
/home/bd2/ANATS/Online_Baselines/utils/common_tools.py:63: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  tensor = torch.tensor(matrix)
2025-06-04 06:13:07,747 - epoch:2, training loss:3162.4939 validation loss:35.3353
2025-06-04 06:13:14,003 - epoch:0, training loss:18864.3751 validation loss:50.5711
2025-06-04 06:13:15,300 - T:12	MAE	31.5594	RMSE	47.9640	MAPE	13.4458
2025-06-04 06:13:15,301 - T:Avg	MAE	26.7867	RMSE	41.1064	MAPE	11.5249
2025-06-04 06:13:15,314 - Finished optimization, total time:1912.66 s, best model:log/GLA/team-42/2017/33.5342.pkl
2025-06-04 06:13:15,322 - epoch:3, training loss:2068.8721 validation loss:30.5028
2025-06-04 06:13:15,480 - [*] Year 2018 load from data/GLA/FastData/2018.npz
2025-06-04 06:13:15,546 - [*] load from log/GLA/team-42/2017/33.5342.pkl
2025-06-04 06:13:19,958 - number of increase nodes:214, nodes after 2 hop:torch.Size([1208]), total nodes this year 1843
2025-06-04 06:13:24,317 - epoch:3, training loss:2960.4475 validation loss:35.4204
2025-06-04 06:13:29,722 - epoch:1, training loss:3327.3655 validation loss:34.7986
2025-06-04 06:13:38,071 - epoch:4, training loss:2024.5482 validation loss:30.6288
2025-06-04 06:13:40,836 - epoch:4, training loss:2881.4340 validation loss:35.3524
2025-06-04 06:13:42,225 - [*] Year 2018 Dataset load!
2025-06-04 06:13:42,225 - [*] load from log/GLA/team-42/2017/33.5342.pkl
2025-06-04 06:13:42,235 - [*] EWC! lambda 0.001000
2025-06-04 06:13:45,714 - epoch:2, training loss:2753.9502 validation loss:34.7176
2025-06-04 06:13:57,460 - epoch:5, training loss:2812.2616 validation loss:35.7390
2025-06-04 06:14:00,486 - epoch:5, training loss:2011.2143 validation loss:30.3637
2025-06-04 06:14:01,734 - epoch:3, training loss:2666.5810 validation loss:35.9406
2025-06-04 06:14:15,010 - epoch:6, training loss:2744.6054 validation loss:34.5630
2025-06-04 06:14:17,687 - epoch:4, training loss:2621.5847 validation loss:33.8289
2025-06-04 06:14:22,368 - epoch:6, training loss:1996.5142 validation loss:29.1373
2025-06-04 06:14:31,741 - epoch:7, training loss:2715.0932 validation loss:34.9300
2025-06-04 06:14:34,088 - epoch:5, training loss:2578.1291 validation loss:34.7713
2025-06-04 06:14:44,102 - epoch:7, training loss:1997.6539 validation loss:28.2941
2025-06-04 06:14:48,527 - epoch:8, training loss:2700.3962 validation loss:35.1826
2025-06-04 06:14:50,807 - epoch:6, training loss:2529.7834 validation loss:33.4454
2025-06-04 06:15:05,370 - epoch:9, training loss:2689.1421 validation loss:33.6430
2025-06-04 06:15:06,777 - epoch:7, training loss:2491.7854 validation loss:37.0733
2025-06-04 06:15:07,033 - epoch:8, training loss:1987.4707 validation loss:28.6986
Traceback (most recent call last):
  File "/home/bd2/ANATS/Online_Baselines/pecpm_main.py", line 169, in <module>
    main(args) 
    ^^^^^^^^^^
  File "/home/bd2/ANATS/Online_Baselines/pecpm_main.py", line 120, in main
    train(inputs, args)
  File "/home/bd2/ANATS/Online_Baselines/src/trainer/pecpm_trainer.py", line 37, in train
    attention = attention.reshape(-1, N, C)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: cannot reshape array of size 7716648960 into shape (1820,32)
2025-06-04 06:15:21,656 - epoch:10, training loss:2685.6516 validation loss:34.8118
2025-06-04 06:15:21,661 - epoch:8, training loss:2468.1499 validation loss:33.0073
2025-06-04 06:15:28,529 - epoch:9, training loss:1977.9033 validation loss:28.6387
2025-06-04 06:15:37,373 - epoch:9, training loss:2461.0960 validation loss:34.2513
2025-06-04 06:15:38,175 - epoch:11, training loss:2678.5020 validation loss:34.4469
2025-06-04 06:15:50,217 - epoch:10, training loss:1980.6852 validation loss:28.9035
2025-06-04 06:15:52,961 - epoch:10, training loss:2435.4599 validation loss:33.4041
2025-06-04 06:15:54,736 - epoch:12, training loss:2663.5296 validation loss:34.0898
2025-06-04 06:16:08,644 - epoch:11, training loss:2427.5242 validation loss:32.4404
2025-06-04 06:16:11,286 - epoch:13, training loss:2662.8002 validation loss:34.4854
2025-06-04 06:16:11,559 - epoch:11, training loss:1967.9499 validation loss:28.3672
2025-06-04 06:16:24,252 - epoch:12, training loss:2418.5060 validation loss:32.5024
2025-06-04 06:16:28,075 - epoch:14, training loss:2656.7908 validation loss:34.0007
2025-06-04 06:16:33,332 - epoch:12, training loss:1968.5614 validation loss:27.8513
2025-06-04 06:16:34,848 - logger name:log/GLA/pecpm-42/pecpm.log
2025-06-04 06:16:34,848 - params : {'conf': 'conf/GLA/pecpm.json', 'seed': 42, 'paral': 0, 'gpuid': 3, 'logname': 'pecpm', 'method': 'PECPM', 'load_first_year': 0, 'first_year_model_path': 'log/SD/pecpm-42/2017/31.5668.pkl', 'device': device(type='cuda', index=3), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'PECPM': <class 'src.model.model.PECPM_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 32, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'beita': 1.0, 'cluster': 32, 'raw_data_path': 'data/GLA/finaldata/', 'save_data_path': 'data/GLA/FastData/', 'graph_path': 'data/GLA/graph/', 'model_path': 'log/GLA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'train': 1, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'adp_adj': False, 'skip_dim': 64, 'end_dim': 64, 'hidden_channels': 32, 'dilation_channels': 64, 'residual_channels': 64, 'input_dim': 1, 'output_dim': 1, 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 300, 'path': 'log/GLA/pecpm-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-04 06:16:34,970 - [*] Year 2017 load from data/GLA/FastData/2017.npz
2025-06-04 06:16:39,907 - epoch:13, training loss:2405.8765 validation loss:32.2051
2025-06-04 06:16:44,805 - epoch:15, training loss:2654.0554 validation loss:34.0653
2025-06-04 06:16:48,286 - Total Parameters: 71948
2025-06-04 06:16:48,286 - Trainable Parameters: 71948
2025-06-04 06:16:48,286 - [*] Year 2018 Training start
2025-06-04 06:16:51,369 - node number torch.Size([19328, 12])
2025-06-04 06:16:52,414 - [*] loss:2559.9131
2025-06-04 06:16:54,981 - epoch:13, training loss:1963.9136 validation loss:30.0835
2025-06-04 06:16:55,795 - [*] year 2018, testing
2025-06-04 06:16:55,955 - epoch:14, training loss:2415.5274 validation loss:32.1517
2025-06-04 06:17:10,771 - T:3	MAE	25.0669	RMSE	36.9147	MAPE	11.9885
2025-06-04 06:17:11,822 - epoch:15, training loss:2391.0250 validation loss:31.7370
2025-06-04 06:17:16,937 - epoch:14, training loss:1962.8853 validation loss:28.5516
2025-06-04 06:17:27,976 - epoch:16, training loss:2395.6205 validation loss:31.0722
2025-06-04 06:17:38,268 - epoch:15, training loss:1951.7443 validation loss:29.7634
2025-06-04 06:17:40,589 - T:6	MAE	27.4568	RMSE	40.9724	MAPE	13.0678
2025-06-04 06:17:44,290 - epoch:17, training loss:2389.2521 validation loss:32.3078
2025-06-04 06:17:59,872 - epoch:18, training loss:2392.5350 validation loss:34.6193
2025-06-04 06:17:59,942 - epoch:16, training loss:1949.1488 validation loss:29.7942
2025-06-04 06:18:15,387 - epoch:19, training loss:2384.0898 validation loss:33.2211
2025-06-04 06:18:21,762 - epoch:17, training loss:1945.6269 validation loss:28.8753
2025-06-04 06:18:31,262 - epoch:20, training loss:2356.2760 validation loss:31.2060
2025-06-04 06:18:43,159 - epoch:18, training loss:1942.6245 validation loss:28.6294
2025-06-04 06:18:47,610 - epoch:21, training loss:2387.4557 validation loss:31.7944
2025-06-04 06:18:51,694 - [*] loss:2229.6216
2025-06-04 06:18:53,109 - [*] year 2018, testing
2025-06-04 06:19:02,787 - T:12	MAE	32.2066	RMSE	48.6502	MAPE	15.6793
2025-06-04 06:19:02,787 - T:Avg	MAE	27.8006	RMSE	41.4530	MAPE	13.3708
2025-06-04 06:19:02,796 - Finished optimization, total time:139.93 s, best model:log/GLA/retrain_st_sd-42/2018/33.643.pkl
2025-06-04 06:19:03,183 - epoch:22, training loss:2354.7041 validation loss:35.1647

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 874137.31it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 982220.19it/s]
2025-06-04 06:19:07,377 - [*] Year 2017 Dataset load!
2025-06-04 06:19:07,415 - [*] Year 2017 Training start
2025-06-04 06:19:08,290 - T:3	MAE	24.3473	RMSE	37.2909	MAPE	19.8003
2025-06-04 06:19:08,746 - [*] loss:2335.5579

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 985722.86it/s]
2025-06-04 06:19:09,917 - node number torch.Size([58240, 12])
2025-06-04 06:19:10,208 - [*] year 2017, testing
2025-06-04 06:19:25,776 - T:3	MAE	22.7186	RMSE	35.7196	MAPE	9.7300
2025-06-04 06:19:26,608 - epoch:0, training loss:9364.8580 validation loss:34.1428
2025-06-04 06:19:38,515 - T:6	MAE	26.4207	RMSE	40.4094	MAPE	22.0232
2025-06-04 06:19:42,997 - epoch:1, training loss:2801.9501 validation loss:33.1202
2025-06-04 06:19:51,118 - [*] Year 2019 load from data/GLA/FastData/2019.npz
2025-06-04 06:19:51,198 - [*] Year 2019 Dataset load!
2025-06-04 06:19:51,200 - Total Parameters: 3308
2025-06-04 06:19:51,200 - Trainable Parameters: 3308
2025-06-04 06:19:51,200 - [*] Year 2019 Training start
2025-06-04 06:19:54,961 - T:6	MAE	25.2047	RMSE	39.3606	MAPE	11.0220
2025-06-04 06:19:55,032 - node number torch.Size([237952, 12])
2025-06-04 06:20:00,746 - epoch:2, training loss:2700.8922 validation loss:35.4255
2025-06-04 06:20:02,176 - epoch:0, training loss:1508.0269 validation loss:32.6121
2025-06-04 06:20:11,132 - epoch:0, training loss:25758.7421 validation loss:36.5314
2025-06-04 06:20:18,202 - epoch:3, training loss:2655.2391 validation loss:34.8457
2025-06-04 06:20:31,108 - epoch:1, training loss:2517.6159 validation loss:34.8643
2025-06-04 06:20:35,867 - epoch:4, training loss:2633.5854 validation loss:32.3506
2025-06-04 06:20:50,310 - epoch:2, training loss:2423.3803 validation loss:33.6630
2025-06-04 06:20:53,149 - epoch:5, training loss:2579.7708 validation loss:37.0312
2025-06-04 06:21:09,387 - epoch:3, training loss:2372.4743 validation loss:31.8273
2025-06-04 06:21:10,342 - epoch:6, training loss:2546.4244 validation loss:36.5321
2025-06-04 06:21:23,156 - T:12	MAE	30.3386	RMSE	46.0017	MAPE	26.7280
2025-06-04 06:21:23,157 - T:Avg	MAE	26.6709	RMSE	40.7052	MAPE	22.4108
2025-06-04 06:21:23,168 - Finished optimization, total time:220.04 s, best model:log/GBA/retrain_st_sd-42/2018/27.8513.pkl

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 824059.63it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 953954.25it/s]
2025-06-04 06:21:27,550 - epoch:7, training loss:2498.9497 validation loss:31.5375
2025-06-04 06:21:28,469 - T:12	MAE	29.8258	RMSE	45.7827	MAPE	13.7235
2025-06-04 06:21:28,469 - T:Avg	MAE	25.4857	RMSE	39.6565	MAPE	11.2565
2025-06-04 06:21:28,483 - Finished optimization, total time:209.73 s, best model:log/GLA/stkec-42/2017/31.0722.pkl
2025-06-04 06:21:28,577 - epoch:4, training loss:2327.2488 validation loss:33.0743
2025-06-04 06:21:28,692 - [*] Year 2018 load from data/GLA/FastData/2018.npz
2025-06-04 06:21:28,741 - [*] load from log/GLA/stkec-42/2017/31.0722.pkl
2025-06-04 06:21:28,778 - [*] detect strategy feature

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1011028.53it/s]
2025-06-04 06:21:40,215 - number of increase nodes:310, nodes after 2 hop:torch.Size([1648]), total nodes this year 1843
2025-06-04 06:21:43,995 - epoch:8, training loss:2488.2506 validation loss:31.8436
2025-06-04 06:21:47,975 - epoch:5, training loss:2291.7595 validation loss:30.4018
2025-06-04 06:22:00,471 - epoch:9, training loss:2450.8018 validation loss:34.2066
2025-06-04 06:22:05,051 - [*] Year 2018 Dataset load!
2025-06-04 06:22:05,051 - [*] load from log/GLA/stkec-42/2017/31.0722.pkl
2025-06-04 06:22:05,055 - [*] EWC! lambda 0.000100
2025-06-04 06:22:06,939 - epoch:6, training loss:2255.3691 validation loss:31.6629
2025-06-04 06:22:17,733 - [*] Year 2019 load from data/GBA/FastData/2019.npz
2025-06-04 06:22:17,832 - [*] Year 2019 Dataset load!
2025-06-04 06:22:17,834 - Total Parameters: 3308
2025-06-04 06:22:17,834 - Trainable Parameters: 3308
2025-06-04 06:22:17,834 - [*] Year 2019 Training start
2025-06-04 06:22:17,835 - epoch:10, training loss:2457.7297 validation loss:30.9759
2025-06-04 06:22:21,947 - node number torch.Size([301056, 12])
2025-06-04 06:22:26,893 - epoch:7, training loss:2236.0933 validation loss:30.9372
2025-06-04 06:22:28,288 - [*] Year 2018 Training start
2025-06-04 06:22:31,167 - node number torch.Size([210944, 12])
2025-06-04 06:22:35,203 - epoch:11, training loss:2437.9672 validation loss:31.9071
2025-06-04 06:22:42,395 - epoch:0, training loss:2539.4753 validation loss:33.0721
2025-06-04 06:22:42,919 - epoch:0, training loss:17318.5378 validation loss:33.7923
2025-06-04 06:22:46,769 - epoch:8, training loss:2226.4107 validation loss:32.1336
2025-06-04 06:22:52,738 - epoch:12, training loss:2442.3071 validation loss:32.9349
2025-06-04 06:22:56,325 - epoch:1, training loss:2306.4088 validation loss:33.2390
2025-06-04 06:23:06,306 - epoch:9, training loss:2218.0242 validation loss:30.4582
2025-06-04 06:23:07,960 - epoch:1, training loss:2177.2929 validation loss:31.6167
2025-06-04 06:23:09,174 - epoch:13, training loss:2427.5252 validation loss:36.0195
2025-06-04 06:23:09,660 - epoch:2, training loss:2313.0266 validation loss:34.9067
2025-06-04 06:23:14,086 - epoch:1, training loss:1505.4209 validation loss:31.1412
2025-06-04 06:23:23,081 - epoch:3, training loss:2310.8301 validation loss:32.0593
2025-06-04 06:23:25,968 - epoch:10, training loss:2218.0988 validation loss:32.0820
2025-06-04 06:23:26,040 - epoch:14, training loss:2438.8030 validation loss:34.7377
2025-06-04 06:23:32,635 - epoch:2, training loss:2092.7949 validation loss:31.8103
2025-06-04 06:23:36,389 - epoch:4, training loss:2313.9345 validation loss:39.7669
2025-06-04 06:23:43,125 - epoch:15, training loss:2427.6409 validation loss:35.2656
2025-06-04 06:23:45,132 - epoch:11, training loss:2205.9977 validation loss:31.4566
2025-06-04 06:23:49,668 - epoch:5, training loss:2321.5321 validation loss:37.1605
2025-06-04 06:23:55,387 - [*] loss:2168.7500
2025-06-04 06:23:56,525 - [*] year 2019, testing
2025-06-04 06:23:57,286 - epoch:3, training loss:2072.6079 validation loss:32.3432
2025-06-04 06:23:59,698 - epoch:16, training loss:2432.0598 validation loss:32.2716
2025-06-04 06:24:02,647 - epoch:6, training loss:2311.1354 validation loss:36.3891
2025-06-04 06:24:06,871 - [*] loss:2456.0925
2025-06-04 06:24:08,955 - T:3	MAE	23.0759	RMSE	34.6974	MAPE	12.5525
2025-06-04 06:24:10,404 - [*] year 2017, testing
2025-06-04 06:24:15,913 - epoch:7, training loss:2323.1380 validation loss:32.3731
2025-06-04 06:24:22,173 - epoch:4, training loss:2063.2225 validation loss:30.4226
2025-06-04 06:24:28,589 - T:3	MAE	22.8353	RMSE	35.8427	MAPE	9.8366
2025-06-04 06:24:29,511 - epoch:8, training loss:2321.1622 validation loss:39.9350
2025-06-04 06:24:32,093 - T:6	MAE	25.5713	RMSE	38.4025	MAPE	13.9209
2025-06-04 06:24:42,888 - epoch:9, training loss:2319.0300 validation loss:33.5693
2025-06-04 06:24:46,375 - epoch:5, training loss:2051.0551 validation loss:33.7896
2025-06-04 06:24:49,965 - [*] loss:2400.3696
2025-06-04 06:24:51,084 - [*] year 2018, testing
2025-06-04 06:25:03,364 - T:3	MAE	24.2494	RMSE	36.5072	MAPE	10.4668
2025-06-04 06:25:10,815 - epoch:6, training loss:2037.2979 validation loss:30.4538
2025-06-04 06:25:26,256 - T:6	MAE	25.4245	RMSE	39.6309	MAPE	11.1181
2025-06-04 06:25:37,638 - epoch:7, training loss:2031.5178 validation loss:32.3627
2025-06-04 06:25:51,390 - T:6	MAE	26.7784	RMSE	40.2623	MAPE	11.5337
2025-06-04 06:26:02,909 - epoch:8, training loss:2028.2277 validation loss:32.7335
2025-06-04 06:26:17,824 - T:12	MAE	30.2902	RMSE	45.1986	MAPE	16.8556
2025-06-04 06:26:17,825 - T:Avg	MAE	25.8746	RMSE	38.7857	MAPE	14.1925
2025-06-04 06:26:17,834 - Finished optimization, total time:120.27 s, best model:log/GLA/retrain_st_sd-42/2019/30.4018.pkl

  0%|          | 0/21080 [00:00<?, ?it/s]
100%|██████████| 21080/21080 [00:00<00:00, 740204.34it/s]

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 863823.63it/s]

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 749297.67it/s]
2025-06-04 06:26:28,456 - epoch:9, training loss:2027.1471 validation loss:31.7931
2025-06-04 06:26:33,905 - epoch:2, training loss:1514.6952 validation loss:34.9575
2025-06-04 06:26:54,598 - epoch:10, training loss:2025.0114 validation loss:33.1831
2025-06-04 06:27:05,421 - [*] loss:1859.3242
2025-06-04 06:27:06,764 - [*] year 2019, testing
2025-06-04 06:27:30,563 - T:3	MAE	21.6428	RMSE	33.3660	MAPE	13.3422
2025-06-04 06:27:48,327 - T:12	MAE	31.7329	RMSE	47.2920	MAPE	14.3388
2025-06-04 06:27:48,328 - T:Avg	MAE	27.1376	RMSE	40.6890	MAPE	11.8909
2025-06-04 06:27:48,336 - Finished optimization, total time:83.68 s, best model:log/GLA/stkec-42/2018/32.0593.pkl
2025-06-04 06:27:48,544 - [*] Year 2019 load from data/GLA/FastData/2019.npz
2025-06-04 06:27:48,602 - [*] load from log/GLA/stkec-42/2018/32.0593.pkl
2025-06-04 06:27:48,638 - [*] detect strategy feature
2025-06-04 06:27:58,706 - [*] Year 2020 load from data/GLA/FastData/2020.npz
2025-06-04 06:27:58,770 - [*] Year 2020 Dataset load!
2025-06-04 06:27:58,772 - Total Parameters: 3308
2025-06-04 06:27:58,772 - Trainable Parameters: 3308
2025-06-04 06:27:58,772 - [*] Year 2020 Training start
2025-06-04 06:28:01,175 - T:6	MAE	23.6872	RMSE	36.6363	MAPE	14.6467
2025-06-04 06:28:01,891 - number of increase nodes:299, nodes after 2 hop:torch.Size([1669]), total nodes this year 1859
2025-06-04 06:28:02,297 - node number torch.Size([237952, 12])
2025-06-04 06:28:18,456 - epoch:0, training loss:30791.7087 validation loss:40.9413
2025-06-04 06:28:35,352 - [*] Year 2019 Dataset load!
2025-06-04 06:28:35,352 - [*] load from log/GLA/stkec-42/2018/32.0593.pkl
2025-06-04 06:28:35,357 - [*] EWC! lambda 0.000100
2025-06-04 06:28:37,661 - epoch:1, training loss:2471.2161 validation loss:38.8786
2025-06-04 06:28:50,900 - [*] Year 2019 Training start
2025-06-04 06:28:54,592 - node number torch.Size([213632, 12])
2025-06-04 06:28:57,134 - epoch:2, training loss:2246.3231 validation loss:40.7859
2025-06-04 06:29:07,464 - epoch:0, training loss:2149.6511 validation loss:30.7617
2025-06-04 06:29:16,606 - epoch:3, training loss:2180.4206 validation loss:40.6303
2025-06-04 06:29:23,691 - epoch:1, training loss:1918.8138 validation loss:31.0618
2025-06-04 06:29:36,339 - epoch:4, training loss:2148.4255 validation loss:39.0193
2025-06-04 06:29:40,306 - epoch:2, training loss:1923.5052 validation loss:29.5656
2025-06-04 06:29:46,867 - T:12	MAE	27.6816	RMSE	42.7058	MAPE	17.5627
2025-06-04 06:29:46,868 - T:Avg	MAE	23.9809	RMSE	37.0152	MAPE	14.9232
2025-06-04 06:29:46,878 - Finished optimization, total time:145.21 s, best model:log/GBA/retrain_st_sd-42/2019/30.4226.pkl

  0%|          | 0/21080 [00:00<?, ?it/s]
100%|██████████| 21080/21080 [00:00<00:00, 917548.89it/s]
2025-06-04 06:29:50,282 - epoch:3, training loss:1515.9363 validation loss:35.8800

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 952136.14it/s]
2025-06-04 06:29:56,434 - epoch:5, training loss:2124.3999 validation loss:33.7990
2025-06-04 06:29:57,027 - epoch:3, training loss:1930.6108 validation loss:28.4450
2025-06-04 06:30:16,557 - epoch:4, training loss:1948.3117 validation loss:30.3178
2025-06-04 06:30:19,487 - epoch:6, training loss:2111.0296 validation loss:38.5643
2025-06-04 06:30:35,198 - epoch:5, training loss:1924.2090 validation loss:32.0022
2025-06-04 06:30:42,087 - epoch:7, training loss:2093.3306 validation loss:35.4313
2025-06-04 06:30:55,223 - epoch:6, training loss:1928.6630 validation loss:29.4463
2025-06-04 06:31:05,292 - epoch:8, training loss:2094.9654 validation loss:40.2828
2025-06-04 06:31:14,124 - epoch:7, training loss:1933.6978 validation loss:30.5682
2025-06-04 06:31:27,920 - epoch:9, training loss:2070.6889 validation loss:37.8412
2025-06-04 06:31:33,257 - epoch:8, training loss:1929.2051 validation loss:34.2523
2025-06-04 06:31:51,652 - epoch:10, training loss:2064.6429 validation loss:37.7690
2025-06-04 06:31:53,096 - epoch:9, training loss:1944.0220 validation loss:29.1878

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 452851.30it/s]
2025-06-04 06:32:03,832 - [*] loss:2117.2878
2025-06-04 06:32:14,985 - epoch:11, training loss:2059.7756 validation loss:39.7684
2025-06-04 06:32:28,586 - [*] loss:2782.7239
2025-06-04 06:33:08,000 - epoch:4, training loss:1514.7056 validation loss:31.8103
2025-06-04 06:34:53,489 - [*] year 2020, testing
2025-06-04 06:35:14,514 - T:3	MAE	37.3097	RMSE	46.8064	MAPE	27.4717
2025-06-04 06:35:20,060 - [*] year 2019, testing
2025-06-04 06:35:35,134 - T:3	MAE	22.3927	RMSE	34.1568	MAPE	9.9632
2025-06-04 06:35:43,045 - T:6	MAE	38.2094	RMSE	48.6228	MAPE	28.2804
2025-06-04 06:36:29,049 - epoch:5, training loss:1506.5443 validation loss:32.6463
2025-06-04 06:37:37,763 - T:6	MAE	24.9553	RMSE	37.9320	MAPE	11.0803
2025-06-04 06:39:51,170 - epoch:6, training loss:1517.2126 validation loss:31.6788
2025-06-04 06:42:34,220 - [*] Year 2020 load from data/GBA/FastData/2020.npz
2025-06-04 06:42:34,316 - [*] Year 2020 Dataset load!
2025-06-04 06:42:34,317 - Total Parameters: 3308
2025-06-04 06:42:34,317 - Trainable Parameters: 3308
2025-06-04 06:42:34,317 - [*] Year 2020 Training start
2025-06-04 06:42:39,555 - node number torch.Size([301056, 12])
2025-06-04 06:43:02,440 - epoch:0, training loss:18721.7966 validation loss:38.2584
2025-06-04 06:43:03,144 - T:12	MAE	39.8076	RMSE	51.7804	MAPE	30.2527
2025-06-04 06:43:03,144 - T:Avg	MAE	38.2291	RMSE	48.6994	MAPE	28.4201
2025-06-04 06:43:03,173 - Finished optimization, total time:128.65 s, best model:log/GLA/retrain_st_sd-42/2020/33.799.pkl
2025-06-04 06:43:03,174 - 


2025-06-04 06:43:03,174 - 3   	 MAE	     23.22	     25.07	     23.08	     37.31		   27.17
2025-06-04 06:43:03,174 - 3   	RMSE	     36.16	     36.91	     34.70	     46.81		   38.64
2025-06-04 06:43:03,174 - 3   	MAPE	     10.58	     11.99	     12.55	     27.47		   15.65
2025-06-04 06:43:03,174 - 6   	 MAE	     25.93	     27.46	     25.57	     38.21		   29.29
2025-06-04 06:43:03,174 - 6   	RMSE	     40.36	     40.97	     38.40	     48.62		   42.09
2025-06-04 06:43:03,174 - 6   	MAPE	     12.24	     13.07	     13.92	     28.28		   16.88
2025-06-04 06:43:03,174 - 12  	 MAE	     31.19	     32.21	     30.29	     39.81		   33.37
2025-06-04 06:43:03,174 - 12  	RMSE	     48.27	     48.65	     45.20	     51.78		   48.48
2025-06-04 06:43:03,174 - 12  	MAPE	     15.86	     15.68	     16.86	     30.25		   19.66
2025-06-04 06:43:03,174 - Avg 	 MAE	     26.30	     27.80	     25.87	     38.23		   29.55
2025-06-04 06:43:03,174 - Avg 	RMSE	     40.85	     41.45	     38.79	     48.70		   42.45
2025-06-04 06:43:03,174 - Avg 	MAPE	     12.61	     13.37	     14.19	     28.42		   17.15
2025-06-04 06:43:03,175 - year	2017	total_time	  165.0202	average_time	    7.5009	epoch	22
2025-06-04 06:43:03,175 - year	2018	total_time	  139.9318	average_time	    8.7458	epoch	16
2025-06-04 06:43:03,175 - year	2019	total_time	  120.2689	average_time	   10.0224	epoch	12
2025-06-04 06:43:03,175 - year	2020	total_time	  128.6519	average_time	   10.7210	epoch	12
2025-06-04 06:43:03,175 - total time: 553.8728
2025-06-04 06:43:11,903 - epoch:7, training loss:1506.2620 validation loss:31.0013
2025-06-04 06:43:30,165 - epoch:1, training loss:2049.4519 validation loss:33.7185
2025-06-04 06:43:42,981 - T:12	MAE	30.4411	RMSE	46.6418	MAPE	14.1900
2025-06-04 06:43:42,982 - T:Avg	MAE	25.7621	RMSE	40.0190	MAPE	11.4454
2025-06-04 06:43:42,989 - Finished optimization, total time:160.60 s, best model:log/GLA/pecpm-42/2017/30.9759.pkl
2025-06-04 06:43:43,295 - [*] Year 2018 load from data/GLA/FastData/2018.npz
2025-06-04 06:43:43,347 - [*] load from log/GLA/pecpm-42/2017/30.9759.pkl
2025-06-04 06:43:43,390 - [*] detect strategy feature
2025-06-04 06:43:46,322 - T:12	MAE	29.6363	RMSE	44.6718	MAPE	13.5411
2025-06-04 06:43:46,322 - T:Avg	MAE	25.2229	RMSE	38.2781	MAPE	11.3044
2025-06-04 06:43:46,346 - Finished optimization, total time:109.10 s, best model:log/GLA/stkec-42/2019/28.445.pkl
2025-06-04 06:43:46,557 - [*] Year 2020 load from data/GLA/FastData/2020.npz
2025-06-04 06:43:46,610 - [*] load from log/GLA/stkec-42/2019/28.445.pkl
2025-06-04 06:43:46,643 - [*] detect strategy feature
2025-06-04 06:43:51,142 - number of increase nodes:205, nodes after 2 hop:torch.Size([1598]), total nodes this year 1843
2025-06-04 06:43:57,586 - epoch:2, training loss:1933.2266 validation loss:35.0491
2025-06-04 06:44:03,853 - number of increase nodes:285, nodes after 2 hop:torch.Size([1699]), total nodes this year 1859
2025-06-04 06:44:25,479 - epoch:3, training loss:1884.2959 validation loss:33.4234
2025-06-04 06:44:49,857 - [*] Year 2020 Dataset load!
2025-06-04 06:44:49,858 - [*] load from log/GLA/stkec-42/2019/28.445.pkl
2025-06-04 06:44:49,861 - [*] EWC! lambda 0.000100
2025-06-04 06:44:53,633 - epoch:4, training loss:1857.7040 validation loss:32.0275
2025-06-04 06:45:06,072 - [*] Year 2020 Training start
2025-06-04 06:45:10,365 - node number torch.Size([217472, 12])
2025-06-04 06:45:21,367 - epoch:5, training loss:1841.4335 validation loss:33.1995
2025-06-04 06:45:23,658 - epoch:0, training loss:2473.6996 validation loss:36.9064
2025-06-04 06:45:40,791 - epoch:1, training loss:2224.7356 validation loss:37.0921
2025-06-04 06:45:49,563 - epoch:6, training loss:1816.5660 validation loss:30.7406
2025-06-04 06:45:59,062 - epoch:2, training loss:2227.8866 validation loss:36.8569
2025-06-04 06:46:17,427 - epoch:3, training loss:2224.3636 validation loss:38.3197
2025-06-04 06:46:17,632 - epoch:7, training loss:1808.1389 validation loss:30.5223
2025-06-04 06:46:26,718 - epoch:8, training loss:1503.8461 validation loss:31.7705
2025-06-04 06:46:35,589 - epoch:4, training loss:2234.2451 validation loss:35.6432
2025-06-04 06:46:45,799 - epoch:8, training loss:1802.2347 validation loss:32.8203
2025-06-04 06:46:53,099 - epoch:5, training loss:2227.7492 validation loss:37.1538
2025-06-04 06:47:11,803 - epoch:6, training loss:2219.1800 validation loss:39.5291
2025-06-04 06:47:14,041 - epoch:9, training loss:1794.3565 validation loss:33.1365
2025-06-04 06:47:29,202 - epoch:7, training loss:2234.9725 validation loss:38.5203
2025-06-04 06:47:42,088 - epoch:10, training loss:1788.9445 validation loss:29.2386
2025-06-04 06:47:48,057 - epoch:8, training loss:2251.4258 validation loss:37.6759
2025-06-04 06:48:07,512 - epoch:9, training loss:2238.2751 validation loss:39.5848
2025-06-04 06:48:11,612 - epoch:11, training loss:1789.4025 validation loss:33.5696
2025-06-04 06:48:26,348 - epoch:10, training loss:2230.3701 validation loss:35.3236
2025-06-04 06:48:42,009 - epoch:12, training loss:1783.8410 validation loss:32.7762
2025-06-04 06:48:44,418 - epoch:11, training loss:2234.2849 validation loss:33.6753
2025-06-04 06:49:03,013 - epoch:12, training loss:2217.4188 validation loss:36.2536
2025-06-04 06:49:10,571 - epoch:13, training loss:1781.6929 validation loss:27.1353
2025-06-04 06:49:20,478 - epoch:13, training loss:2222.2217 validation loss:43.4290
2025-06-04 06:49:38,776 - epoch:14, training loss:2236.5645 validation loss:35.3904
2025-06-04 06:49:40,202 - epoch:9, training loss:1504.0135 validation loss:32.9963
2025-06-04 06:49:41,278 - epoch:14, training loss:1778.2306 validation loss:33.9597
2025-06-04 06:49:57,632 - epoch:15, training loss:2214.2143 validation loss:35.4337
2025-06-04 06:50:12,744 - epoch:15, training loss:1772.3139 validation loss:31.3798
2025-06-04 06:50:16,074 - epoch:16, training loss:2241.9519 validation loss:33.1590
2025-06-04 06:50:34,836 - epoch:17, training loss:2238.0557 validation loss:38.0174
2025-06-04 06:50:42,718 - epoch:16, training loss:1772.4624 validation loss:34.1631
2025-06-04 06:50:52,854 - epoch:18, training loss:2246.0025 validation loss:36.8335
2025-06-04 06:51:11,042 - epoch:19, training loss:2223.6223 validation loss:36.3722
2025-06-04 06:51:12,042 - epoch:17, training loss:1769.2327 validation loss:33.5672
2025-06-04 06:51:30,166 - epoch:20, training loss:2230.1819 validation loss:37.7080
2025-06-04 06:51:42,257 - epoch:18, training loss:1765.5480 validation loss:29.6030
2025-06-04 06:51:47,930 - epoch:21, training loss:2226.4694 validation loss:36.6439
2025-06-04 06:52:06,556 - epoch:22, training loss:2221.4495 validation loss:37.6112
2025-06-04 06:52:10,839 - epoch:19, training loss:1766.7122 validation loss:33.2828
2025-06-04 06:52:16,807 - [*] loss:2629.9548
2025-06-04 06:52:26,253 - [*] loss:1663.4651
2025-06-04 06:52:58,094 - epoch:10, training loss:1514.3744 validation loss:31.4095
2025-06-04 06:53:02,293 - [*] year 2020, testing
2025-06-04 06:53:05,370 - [*] year 2020, testing
2025-06-04 06:53:26,472 - T:3	MAE	25.4539	RMSE	35.2202	MAPE	17.5362
2025-06-04 06:53:28,445 - T:3	MAE	34.6380	RMSE	43.4288	MAPE	29.1322
2025-06-04 06:56:17,614 - epoch:11, training loss:1506.4109 validation loss:29.9005
2025-06-04 06:56:34,558 - T:6	MAE	26.7854	RMSE	37.2161	MAPE	19.4536
2025-06-04 06:56:36,782 - T:6	MAE	35.9734	RMSE	45.7769	MAPE	30.3075
2025-06-04 06:59:36,216 - epoch:12, training loss:1502.3172 validation loss:32.9780
2025-06-04 07:01:35,425 - [*] Year 2018 Dataset load!
2025-06-04 07:01:35,425 - [*] load from log/GLA/pecpm-42/2017/30.9759.pkl
2025-06-04 07:01:35,429 - [*] EWC! lambda 0.000100
2025-06-04 07:01:52,648 - [*] Year 2018 Training start
2025-06-04 07:01:57,985 - node number torch.Size([51136, 12])
2025-06-04 07:02:19,170 - epoch:0, training loss:2776.8629 validation loss:34.7161
2025-06-04 07:02:39,147 - T:12	MAE	38.7905	RMSE	50.3408	MAPE	32.7730
2025-06-04 07:02:39,148 - T:Avg	MAE	36.2826	RMSE	46.1515	MAPE	30.5553
2025-06-04 07:02:39,156 - Finished optimization, total time:252.18 s, best model:log/GLA/stkec-42/2020/33.159.pkl
2025-06-04 07:02:39,212 - 


2025-06-04 07:02:39,212 - 3   	 MAE	     22.72	     24.25	     22.39	     34.64		   26.00
2025-06-04 07:02:39,212 - 3   	RMSE	     35.72	     36.51	     34.16	     43.43		   37.45
2025-06-04 07:02:39,212 - 3   	MAPE	      9.73	     10.47	      9.96	     29.13		   14.82
2025-06-04 07:02:39,212 - 6   	 MAE	     25.20	     26.78	     24.96	     35.97		   28.23
2025-06-04 07:02:39,212 - 6   	RMSE	     39.36	     40.26	     37.93	     45.78		   40.83
2025-06-04 07:02:39,213 - 6   	MAPE	     11.02	     11.53	     11.08	     30.31		   15.99
2025-06-04 07:02:39,213 - 12  	 MAE	     29.83	     31.73	     29.64	     38.79		   32.50
2025-06-04 07:02:39,213 - 12  	RMSE	     45.78	     47.29	     44.67	     50.34		   47.02
2025-06-04 07:02:39,213 - 12  	MAPE	     13.72	     14.34	     13.54	     32.77		   18.59
2025-06-04 07:02:39,213 - Avg 	 MAE	     25.49	     27.14	     25.22	     36.28		   28.53
2025-06-04 07:02:39,213 - Avg 	RMSE	     39.66	     40.69	     38.28	     46.15		   41.19
2025-06-04 07:02:39,213 - Avg 	MAPE	     11.26	     11.89	     11.30	     30.56		   16.25
2025-06-04 07:02:39,213 - year	2017	total_time	  209.7333	average_time	    9.1189	epoch	23
2025-06-04 07:02:39,213 - year	2018	total_time	   83.6826	average_time	    8.3683	epoch	10
2025-06-04 07:02:39,213 - year	2019	total_time	  109.0984	average_time	   10.9099	epoch	10
2025-06-04 07:02:39,213 - year	2020	total_time	  252.1846	average_time	   10.9646	epoch	23
2025-06-04 07:02:39,213 - total time: 654.6989
2025-06-04 07:02:45,253 - epoch:1, training loss:2758.4059 validation loss:34.7283
2025-06-04 07:02:50,429 - T:12	MAE	28.8695	RMSE	40.5590	MAPE	22.6644
2025-06-04 07:02:50,430 - T:Avg	MAE	26.8023	RMSE	37.3030	MAPE	19.5210
2025-06-04 07:02:50,440 - Finished optimization, total time:297.38 s, best model:log/GBA/retrain_st_sd-42/2020/27.1353.pkl
2025-06-04 07:02:50,441 - 


2025-06-04 07:02:50,441 - 3   	 MAE	     24.02	     24.35	     21.64	     25.45		   23.86
2025-06-04 07:02:50,441 - 3   	RMSE	     35.66	     37.29	     33.37	     35.22		   35.38
2025-06-04 07:02:50,441 - 3   	MAPE	     18.01	     19.80	     13.34	     17.54		   17.17
2025-06-04 07:02:50,441 - 6   	 MAE	     25.45	     26.42	     23.69	     26.79		   25.59
2025-06-04 07:02:50,441 - 6   	RMSE	     38.38	     40.41	     36.64	     37.22		   38.16
2025-06-04 07:02:50,441 - 6   	MAPE	     18.86	     22.02	     14.65	     19.45		   18.74
2025-06-04 07:02:50,441 - 12  	 MAE	     29.49	     30.34	     27.68	     28.87		   29.09
2025-06-04 07:02:50,441 - 12  	RMSE	     45.02	     46.00	     42.71	     40.56		   43.57
2025-06-04 07:02:50,441 - 12  	MAPE	     21.84	     26.73	     17.56	     22.66		   22.20
2025-06-04 07:02:50,441 - Avg 	 MAE	     26.00	     26.67	     23.98	     26.80		   25.86
2025-06-04 07:02:50,441 - Avg 	RMSE	     39.13	     40.71	     37.02	     37.30		   38.54
2025-06-04 07:02:50,442 - Avg 	MAPE	     19.33	     22.41	     14.92	     19.52		   19.05
2025-06-04 07:02:50,442 - year	2017	total_time	  119.8300	average_time	    9.9858	epoch	12
2025-06-04 07:02:50,442 - year	2018	total_time	  220.0450	average_time	   11.5813	epoch	19
2025-06-04 07:02:50,442 - year	2019	total_time	  145.2125	average_time	   13.2012	epoch	11
2025-06-04 07:02:50,442 - year	2020	total_time	  297.3786	average_time	   14.8689	epoch	20
2025-06-04 07:02:50,442 - total time: 782.4660
2025-06-04 07:02:52,372 - epoch:13, training loss:1506.2921 validation loss:29.8294
2025-06-04 07:03:10,388 - epoch:2, training loss:2772.3645 validation loss:33.7728
2025-06-04 07:03:35,467 - epoch:3, training loss:2766.6649 validation loss:34.1662
2025-06-04 07:04:03,141 - epoch:4, training loss:2757.9780 validation loss:35.9373
2025-06-04 07:04:29,294 - epoch:5, training loss:2769.9928 validation loss:35.3355
2025-06-04 07:04:56,282 - epoch:6, training loss:2787.2056 validation loss:32.6987
2025-06-04 07:05:21,642 - epoch:7, training loss:2765.6792 validation loss:33.2615
2025-06-04 07:05:47,785 - epoch:8, training loss:2770.1067 validation loss:32.5526
2025-06-04 07:06:04,830 - epoch:14, training loss:1512.8368 validation loss:33.8378
2025-06-04 07:06:14,469 - epoch:9, training loss:2772.0796 validation loss:33.7315
2025-06-04 07:06:41,777 - epoch:10, training loss:2772.5036 validation loss:35.2405
2025-06-04 07:07:08,661 - epoch:11, training loss:2763.9003 validation loss:33.7813
2025-06-04 07:07:34,514 - epoch:12, training loss:2770.9840 validation loss:34.4255
2025-06-04 07:08:02,294 - epoch:13, training loss:2764.0903 validation loss:35.0576
2025-06-04 07:08:30,300 - epoch:14, training loss:2767.1015 validation loss:32.5439
2025-06-04 07:08:57,352 - epoch:15, training loss:2770.5553 validation loss:34.9222
2025-06-04 07:09:16,698 - epoch:15, training loss:1508.6621 validation loss:33.5219
2025-06-04 07:09:24,233 - epoch:16, training loss:2765.0073 validation loss:35.0898
2025-06-04 07:09:50,625 - epoch:17, training loss:2760.6478 validation loss:33.3194
2025-06-04 07:10:17,589 - epoch:18, training loss:2773.5170 validation loss:34.6430
2025-06-04 07:10:44,449 - epoch:19, training loss:2781.3463 validation loss:38.3105
2025-06-04 07:11:09,648 - epoch:20, training loss:2764.5813 validation loss:33.2537
2025-06-04 07:11:20,221 - [*] loss:2302.0061
2025-06-04 07:11:20,330 - [*] year 2018, testing
2025-06-04 07:11:21,810 - T:3	MAE	23.3603	RMSE	35.3916	MAPE	10.4175
2025-06-04 07:11:24,451 - T:6	MAE	25.8971	RMSE	39.0921	MAPE	11.6414
2025-06-04 07:11:33,024 - T:12	MAE	30.4917	RMSE	45.5721	MAPE	14.7205
2025-06-04 07:11:33,024 - T:Avg	MAE	26.1430	RMSE	39.3765	MAPE	11.9880
2025-06-04 07:11:33,026 - Finished optimization, total time:337.24 s, best model:log/GLA/pecpm-42/2018/32.5439.pkl
2025-06-04 07:11:33,609 - [*] Year 2019 load from data/GLA/FastData/2019.npz
2025-06-04 07:11:33,655 - [*] load from log/GLA/pecpm-42/2018/32.5439.pkl
2025-06-04 07:11:33,717 - [*] detect strategy feature
2025-06-04 07:11:38,719 - number of increase nodes:201, nodes after 2 hop:torch.Size([1571]), total nodes this year 1859
2025-06-04 07:12:28,638 - epoch:16, training loss:1510.6532 validation loss:34.3309
2025-06-04 07:13:31,431 - [*] Year 2019 Dataset load!
2025-06-04 07:13:31,431 - [*] load from log/GLA/pecpm-42/2018/32.5439.pkl
2025-06-04 07:13:31,435 - [*] EWC! lambda 0.000100
2025-06-04 07:13:47,940 - [*] Year 2019 Training start
2025-06-04 07:13:52,841 - node number torch.Size([50272, 12])
2025-06-04 07:14:12,402 - epoch:0, training loss:1872.0889 validation loss:29.7828
2025-06-04 07:14:39,077 - epoch:1, training loss:1864.0899 validation loss:29.1964
2025-06-04 07:15:20,599 - epoch:2, training loss:1861.8014 validation loss:29.8051
2025-06-04 07:15:40,621 - epoch:17, training loss:1504.2769 validation loss:29.4092
2025-06-04 07:16:08,845 - epoch:3, training loss:1865.3238 validation loss:31.8660
2025-06-04 07:16:56,071 - epoch:4, training loss:1859.2031 validation loss:31.4553
2025-06-04 07:17:47,210 - epoch:5, training loss:1873.7500 validation loss:29.7538
2025-06-04 07:18:35,912 - epoch:6, training loss:1867.4821 validation loss:29.6881
2025-06-04 07:18:51,990 - epoch:18, training loss:1501.9143 validation loss:31.2789
2025-06-04 07:19:03,725 - epoch:7, training loss:1869.4686 validation loss:29.2926
2025-06-04 07:19:13,912 - [*] loss:2152.4497
2025-06-04 07:19:14,019 - [*] year 2019, testing
2025-06-04 07:19:15,466 - T:3	MAE	21.3543	RMSE	31.8761	MAPE	10.6872
2025-06-04 07:19:17,986 - T:6	MAE	23.7736	RMSE	35.5625	MAPE	11.7113
2025-06-04 07:19:25,988 - T:12	MAE	28.2906	RMSE	42.2458	MAPE	14.1003
2025-06-04 07:19:25,989 - T:Avg	MAE	24.0484	RMSE	35.9218	MAPE	11.9496
2025-06-04 07:19:25,990 - Finished optimization, total time:212.19 s, best model:log/GLA/pecpm-42/2019/29.1964.pkl
2025-06-04 07:19:26,455 - [*] Year 2020 load from data/GLA/FastData/2020.npz
2025-06-04 07:19:26,481 - [*] load from log/GLA/pecpm-42/2019/29.1964.pkl
2025-06-04 07:19:26,512 - [*] detect strategy feature
2025-06-04 07:19:31,255 - number of increase nodes:185, nodes after 2 hop:torch.Size([1551]), total nodes this year 1859
2025-06-04 07:21:52,544 - [*] Year 2020 Dataset load!
2025-06-04 07:21:52,544 - [*] load from log/GLA/pecpm-42/2019/29.1964.pkl
2025-06-04 07:21:52,549 - [*] EWC! lambda 0.000100
2025-06-04 07:22:06,285 - epoch:19, training loss:1507.4208 validation loss:30.1854
2025-06-04 07:22:11,260 - [*] Year 2020 Training start
2025-06-04 07:22:16,127 - node number torch.Size([49632, 12])
2025-06-04 07:22:37,760 - epoch:0, training loss:1895.4262 validation loss:38.6002
2025-06-04 07:23:01,968 - epoch:1, training loss:1887.8025 validation loss:35.2878
2025-06-04 07:23:28,476 - epoch:2, training loss:1895.0969 validation loss:33.1219
2025-06-04 07:23:54,035 - epoch:3, training loss:1890.0192 validation loss:36.3780
2025-06-04 07:24:22,155 - epoch:4, training loss:1903.1259 validation loss:39.3725
2025-06-04 07:24:47,460 - epoch:5, training loss:1917.1034 validation loss:68.4646
2025-06-04 07:25:12,652 - epoch:6, training loss:2201.3648 validation loss:39.3650
2025-06-04 07:25:20,285 - epoch:20, training loss:1511.9855 validation loss:31.6915
2025-06-04 07:25:36,626 - epoch:7, training loss:1879.0865 validation loss:34.3509
2025-06-04 07:26:01,876 - epoch:8, training loss:1887.5484 validation loss:37.7604
2025-06-04 07:26:11,867 - [*] loss:2890.7749
2025-06-04 07:26:11,963 - [*] year 2020, testing
2025-06-04 07:26:13,224 - T:3	MAE	37.0298	RMSE	47.5153	MAPE	24.5576
2025-06-04 07:26:15,530 - T:6	MAE	37.5490	RMSE	48.9000	MAPE	24.9436
2025-06-04 07:26:22,714 - T:12	MAE	39.4586	RMSE	52.2449	MAPE	26.8174
2025-06-04 07:26:22,714 - T:Avg	MAE	37.8221	RMSE	49.2151	MAPE	25.2470
2025-06-04 07:26:22,716 - Finished optimization, total time:139.82 s, best model:log/GLA/pecpm-42/2020/33.1219.pkl
2025-06-04 07:26:23,054 - 


2025-06-04 07:26:23,055 - 3   	 MAE	     22.84	     23.36	     21.35	     37.03		   26.14
2025-06-04 07:26:23,055 - 3   	RMSE	     35.84	     35.39	     31.88	     47.52		   37.66
2025-06-04 07:26:23,055 - 3   	MAPE	      9.84	     10.42	     10.69	     24.56		   13.87
2025-06-04 07:26:23,055 - 6   	 MAE	     25.42	     25.90	     23.77	     37.55		   28.16
2025-06-04 07:26:23,055 - 6   	RMSE	     39.63	     39.09	     35.56	     48.90		   40.80
2025-06-04 07:26:23,055 - 6   	MAPE	     11.12	     11.64	     11.71	     24.94		   14.85
2025-06-04 07:26:23,055 - 12  	 MAE	     30.44	     30.49	     28.29	     39.46		   32.17
2025-06-04 07:26:23,055 - 12  	RMSE	     46.64	     45.57	     42.25	     52.24		   46.68
2025-06-04 07:26:23,055 - 12  	MAPE	     14.19	     14.72	     14.10	     26.82		   17.46
2025-06-04 07:26:23,056 - Avg 	 MAE	     25.76	     26.14	     24.05	     37.82		   28.44
2025-06-04 07:26:23,056 - Avg 	RMSE	     40.02	     39.38	     35.92	     49.22		   41.13
2025-06-04 07:26:23,056 - Avg 	MAPE	     11.45	     11.99	     11.95	     25.25		   15.16
2025-06-04 07:26:23,056 - year	2017	total_time	  160.6045	average_time	    9.4473	epoch	17
2025-06-04 07:26:23,056 - year	2018	total_time	  337.2445	average_time	   16.0593	epoch	21
2025-06-04 07:26:23,056 - year	2019	total_time	  212.1889	average_time	   26.5237	epoch	8
2025-06-04 07:26:23,056 - year	2020	total_time	  139.8229	average_time	   15.5359	epoch	9
2025-06-04 07:26:23,056 - total time: 849.8608
2025-06-04 07:28:33,875 - epoch:21, training loss:1507.0222 validation loss:34.2563
2025-06-04 07:31:46,963 - epoch:22, training loss:1507.2171 validation loss:32.6575
2025-06-04 07:35:01,000 - epoch:23, training loss:1514.3105 validation loss:32.8286
2025-06-04 07:36:27,091 - [*] loss:2513.5852
2025-06-04 07:36:29,222 - [*] year 2018, testing
2025-06-04 07:36:40,512 - T:3	MAE	26.1501	RMSE	37.6955	MAPE	13.1364
2025-06-04 07:37:03,652 - T:6	MAE	28.6439	RMSE	41.5003	MAPE	14.0122
2025-06-04 07:38:15,458 - T:12	MAE	33.5863	RMSE	48.5718	MAPE	15.9745
2025-06-04 07:38:15,459 - T:Avg	MAE	29.0216	RMSE	41.9333	MAPE	14.2185
2025-06-04 07:38:15,466 - Finished optimization, total time:3200.45 s, best model:log/GLA/team-42/2018/29.4092.pkl
2025-06-04 07:38:15,661 - [*] Year 2019 load from data/GLA/FastData/2019.npz
2025-06-04 07:38:15,731 - [*] load from log/GLA/team-42/2018/29.4092.pkl
2025-06-04 07:38:20,092 - number of increase nodes:207, nodes after 2 hop:torch.Size([1530]), total nodes this year 1859
2025-06-04 07:38:41,947 - [*] Year 2019 Dataset load!
2025-06-04 07:38:41,947 - [*] load from log/GLA/team-42/2018/29.4092.pkl
2025-06-04 07:38:41,956 - [*] EWC! lambda 0.001000
2025-06-04 07:41:46,704 - Total Parameters: 71948
2025-06-04 07:41:46,704 - Trainable Parameters: 71948
2025-06-04 07:41:46,705 - [*] Year 2019 Training start
2025-06-04 07:41:49,033 - node number torch.Size([24480, 12])
2025-06-04 07:45:35,201 - epoch:0, training loss:1850.1299 validation loss:30.5659
2025-06-04 07:49:24,057 - epoch:1, training loss:1847.6792 validation loss:32.4147
2025-06-04 07:53:11,881 - epoch:2, training loss:1855.9043 validation loss:33.2254
2025-06-04 07:57:00,242 - epoch:3, training loss:1849.8489 validation loss:28.3220
2025-06-04 08:00:48,746 - epoch:4, training loss:1854.8996 validation loss:29.0309
2025-06-04 08:04:37,713 - epoch:5, training loss:1851.9323 validation loss:28.3918
2025-06-04 08:08:25,422 - epoch:6, training loss:1854.1599 validation loss:30.8955
2025-06-04 08:12:13,618 - epoch:7, training loss:1846.6668 validation loss:29.2075
2025-06-04 08:16:00,601 - epoch:8, training loss:1855.2958 validation loss:30.8956
2025-06-04 08:19:46,743 - epoch:9, training loss:1856.9091 validation loss:30.3738
2025-06-04 08:21:14,173 - [*] loss:2272.2668
2025-06-04 08:21:16,023 - [*] year 2019, testing
2025-06-04 08:21:27,279 - T:3	MAE	23.2605	RMSE	34.9094	MAPE	10.7826
2025-06-04 08:21:50,700 - T:6	MAE	26.1163	RMSE	38.9806	MAPE	11.9367
2025-06-04 08:23:07,473 - T:12	MAE	31.4591	RMSE	46.4821	MAPE	14.2837
2025-06-04 08:23:07,473 - T:Avg	MAE	26.4544	RMSE	39.4180	MAPE	12.1458
2025-06-04 08:23:07,480 - Finished optimization, total time:1591.02 s, best model:log/GLA/team-42/2019/28.322.pkl
2025-06-04 08:23:07,652 - [*] Year 2020 load from data/GLA/FastData/2020.npz
2025-06-04 08:23:07,718 - [*] load from log/GLA/team-42/2019/28.322.pkl
2025-06-04 08:23:12,150 - number of increase nodes:185, nodes after 2 hop:torch.Size([1260]), total nodes this year 1859
2025-06-04 08:23:45,899 - [*] Year 2020 Dataset load!
2025-06-04 08:23:45,899 - [*] load from log/GLA/team-42/2019/28.322.pkl
2025-06-04 08:23:45,907 - [*] EWC! lambda 0.001000
2025-06-04 08:26:51,712 - Total Parameters: 71948
2025-06-04 08:26:51,712 - Trainable Parameters: 71948
2025-06-04 08:26:51,712 - [*] Year 2020 Training start
2025-06-04 08:26:54,131 - node number torch.Size([20160, 12])
2025-06-04 08:30:08,643 - epoch:0, training loss:1639.0298 validation loss:33.9843
2025-06-04 08:33:25,052 - epoch:1, training loss:1634.9038 validation loss:29.2830
2025-06-04 08:36:42,273 - epoch:2, training loss:1633.5839 validation loss:37.3073
2025-06-04 08:39:59,156 - epoch:3, training loss:1642.3014 validation loss:48.8362
2025-06-04 08:43:15,831 - epoch:4, training loss:1654.6366 validation loss:37.0543
2025-06-04 08:46:32,569 - epoch:5, training loss:1625.0540 validation loss:38.1276
2025-06-04 08:49:50,562 - epoch:6, training loss:1635.5637 validation loss:34.2154
2025-06-04 08:53:07,961 - epoch:7, training loss:1630.5368 validation loss:30.8588
2025-06-04 08:54:29,688 - [*] loss:2505.0854
2025-06-04 08:54:31,446 - [*] year 2020, testing
2025-06-04 08:54:43,645 - T:3	MAE	30.0129	RMSE	40.3481	MAPE	20.8544
2025-06-04 08:55:07,316 - T:6	MAE	31.9088	RMSE	43.3703	MAPE	21.7301
2025-06-04 08:56:27,023 - T:12	MAE	35.7512	RMSE	49.2011	MAPE	23.9394
2025-06-04 08:56:27,024 - T:Avg	MAE	32.1562	RMSE	43.7120	MAPE	21.9127
2025-06-04 08:56:27,031 - Finished optimization, total time:1076.55 s, best model:log/GLA/team-42/2020/29.283.pkl
2025-06-04 08:56:27,090 - 


2025-06-04 08:56:27,091 - 3   	 MAE	     23.78	     26.15	     23.26	     30.01		   25.80
2025-06-04 08:56:27,091 - 3   	RMSE	     36.74	     37.70	     34.91	     40.35		   37.42
2025-06-04 08:56:27,091 - 3   	MAPE	     10.35	     13.14	     10.78	     20.85		   13.78
2025-06-04 08:56:27,091 - 6   	 MAE	     26.46	     28.64	     26.12	     31.91		   28.28
2025-06-04 08:56:27,091 - 6   	RMSE	     40.72	     41.50	     38.98	     43.37		   41.14
2025-06-04 08:56:27,091 - 6   	MAPE	     11.36	     14.01	     11.94	     21.73		   14.76
2025-06-04 08:56:27,091 - 12  	 MAE	     31.56	     33.59	     31.46	     35.75		   33.09
2025-06-04 08:56:27,091 - 12  	RMSE	     47.96	     48.57	     46.48	     49.20		   48.05
2025-06-04 08:56:27,091 - 12  	MAPE	     13.45	     15.97	     14.28	     23.94		   16.91
2025-06-04 08:56:27,091 - Avg 	 MAE	     26.79	     29.02	     26.45	     32.16		   28.60
2025-06-04 08:56:27,091 - Avg 	RMSE	     41.11	     41.93	     39.42	     43.71		   41.54
2025-06-04 08:56:27,092 - Avg 	MAPE	     11.52	     14.22	     12.15	     21.91		   14.95
2025-06-04 08:56:27,092 - year	2017	total_time	 1912.6595	average_time	  191.2660	epoch	10
2025-06-04 08:56:27,092 - year	2018	total_time	 3200.4550	average_time	  133.3523	epoch	24
2025-06-04 08:56:27,092 - year	2019	total_time	 1591.0181	average_time	  159.1018	epoch	10
2025-06-04 08:56:27,092 - year	2020	total_time	 1076.5545	average_time	  134.5693	epoch	8
2025-06-04 08:56:27,092 - total time: 7780.6871
2025-06-04 14:28:19,668 - logger name:log/CA/pretrain_st_sd-42/pretrain_st_sd.log
2025-06-04 14:28:19,669 - logger name:log/CA/retrain_st_sd-42/retrain_st_sd.log
2025-06-04 14:28:19,669 - logger name:log/CA/online_st_an_sd-42/online_st_an_sd.log
2025-06-04 14:28:19,669 - logger name:log/CA/trafficstream-42/trafficstream.log
2025-06-04 14:28:19,669 - params : {'conf': 'conf/CA/retrain_st_sd.json', 'seed': 42, 'paral': 0, 'gpuid': 1, 'logname': 'retrain_st_sd', 'method': 'TrafficStream', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/GBA/dlf-42/2017/30.0695.pkl', 'device': device(type='cuda', index=1), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>, 'DLF': <class 'src.model.model.DLF_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/CA/finaldata/', 'save_data_path': 'data/CA/FastData/', 'graph_path': 'data/CA/graph/', 'model_path': 'log/CA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'rank': 6, 'train': 1, 'strategy': 'retrain', 'init': False, 'increase': False, 'num_hops': 0, 'detect': False, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': False, 'path': 'log/CA/retrain_st_sd-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-04 14:28:19,669 - params : {'conf': 'conf/CA/pretrain_st_sd.json', 'seed': 42, 'paral': 0, 'gpuid': 5, 'logname': 'pretrain_st_sd', 'method': 'TrafficStream', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/GBA/dlf-42/2017/30.0695.pkl', 'device': device(type='cuda', index=5), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>, 'DLF': <class 'src.model.model.DLF_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/CA/finaldata/', 'save_data_path': 'data/CA/FastData/', 'graph_path': 'data/CA/graph/', 'model_path': 'log/CA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'rank': 6, 'train': 1, 'strategy': 'pretrain', 'init': True, 'increase': False, 'num_hops': 0, 'detect': False, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': False, 'path': 'log/CA/pretrain_st_sd-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-04 14:28:19,669 - logger name:log/CA/online_st_nn_sd-42/online_st_nn_sd.log
2025-06-04 14:28:19,669 - params : {'conf': 'conf/CA/online_st_an.json', 'seed': 42, 'paral': 0, 'gpuid': 3, 'logname': 'online_st_an_sd', 'method': 'TrafficStream', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/GBA/dlf-42/2017/30.0695.pkl', 'device': device(type='cuda', index=3), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>, 'DLF': <class 'src.model.model.DLF_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/CA/finaldata/', 'save_data_path': 'data/CA/FastData/', 'graph_path': 'data/CA/graph/', 'model_path': 'log/CA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'rank': 6, 'train': 1, 'strategy': 'retrain', 'init': True, 'increase': True, 'num_hops': 2, 'detect': False, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': False, 'path': 'log/CA/online_st_an_sd-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-04 14:28:19,669 - params : {'conf': 'conf/CA/trafficstream.json', 'seed': 42, 'paral': 0, 'gpuid': 0, 'logname': 'trafficstream', 'method': 'TrafficStream', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/GBA/dlf-42/2017/30.0695.pkl', 'device': device(type='cuda', index=0), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>, 'DLF': <class 'src.model.model.DLF_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/CA/finaldata/', 'save_data_path': 'data/CA/FastData/', 'graph_path': 'data/CA/graph/', 'model_path': 'log/CA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'rank': 6, 'train': 1, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'replay_num_samples': 300, 'extra_feature': True, 'momentum_type': 'linear', 'memory_size': 32, 'path': 'log/CA/trafficstream-42', 'logger': <Logger utils.initialize (INFO)>}
Traceback (most recent call last):
  File "/home/bd2/ANATS/Online_Baselines/main.py", line 204, in <module>
2025-06-04 14:28:19,669 - params : {'conf': 'conf/CA/online_st_nn.json', 'seed': 42, 'paral': 0, 'gpuid': 2, 'logname': 'online_st_nn_sd', 'method': 'TrafficStream', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/GBA/dlf-42/2017/30.0695.pkl', 'device': device(type='cuda', index=2), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>, 'DLF': <class 'src.model.model.DLF_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/CA/finaldata/', 'save_data_path': 'data/CA/FastData/', 'graph_path': 'data/CA/graph/', 'model_path': 'log/CA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'rank': 6, 'train': 1, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': False, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': False, 'path': 'log/CA/online_st_nn_sd-42', 'logger': <Logger utils.initialize (INFO)>}
    main(args)
2025-06-04 14:28:19,669 - logger name:log/CA/eac-42/eac.log
  File "/home/bd2/ANATS/Online_Baselines/main.py", line 25, in main
    mkdirs(args.save_data_path)
  File "/home/bd2/ANATS/Online_Baselines/utils/common_tools.py", line 9, in mkdirs
    os.makedirs(path)
  File "<frozen os>", line 225, in makedirs
FileExistsError: [Errno 17] File exists: 'data/CA/FastData/'
2025-06-04 14:28:19,669 - params : {'conf': 'conf/CA/eac.json', 'seed': 42, 'paral': 0, 'gpuid': 6, 'logname': 'eac', 'method': 'EAC', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/GBA/dlf-42/2017/30.0695.pkl', 'device': device(type='cuda', index=6), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>, 'DLF': <class 'src.model.model.DLF_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/CA/finaldata/', 'save_data_path': 'data/CA/FastData/', 'graph_path': 'data/CA/graph/', 'model_path': 'log/CA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'rank': 6, 'train': 1, 'strategy': 'retrain', 'init': True, 'increase': True, 'num_hops': 2, 'detect': False, 'detect_strategy': 'feature', 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': False, 'replay_strategy': 'random', 'repaly_num_samples': 300, 'extra_feature': True, 'momentum_type': 'linear', 'memory_size': 32, 'path': 'log/CA/eac-42', 'logger': <Logger utils.initialize (INFO)>}
  0%|          | 0/21023 [00:00<?, ?it/s]  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 861741.65it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 880773.26it/s]
100%|██████████| 21023/21023 [00:00<00:00, 875552.11it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 777594.23it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 806704.66it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 833713.30it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 872424.86it/s]
100%|██████████| 21023/21023 [00:00<00:00, 830470.37it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 847056.17it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 839244.03it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 872951.72it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 807635.65it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 844338.98it/s]
2025-06-04 14:31:15,570 - logger name:log/CA/team-42/team.log
2025-06-04 14:31:15,570 - params : {'conf': 'conf/CA/team.json', 'seed': 42, 'paral': 0, 'gpuid': 4, 'logname': 'team', 'method': 'TEAM', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/GBA/dlf-42/2017/30.0695.pkl', 'device': device(type='cuda', index=4), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>, 'DLF': <class 'src.model.model.DLF_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.001, 'batch_size': 16, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'n_heads': 3, 'in_channels': 1, 'K': 3, 'nb_block': 1, 'nb_chev_filter': 64, 'nb_time_filter': 64, 'num_of_hours': 1, 'missing_value': 0.0, 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/CA/finaldata/', 'save_data_path': 'data/CA/FastData/', 'graph_path': 'data/CA/graph', 'model_path': 'log/CA/', 'strategy': 'incremental', 'init': True, 'increase': True, 'decrease': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'original', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.001, 'replay': True, 'replay_strategy': 'distribution', 'replay_num_samples': 100, 'path': 'log/CA/team-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-04 14:31:40,667 - logger name:log/CA/stkec-42/stkec.log
2025-06-04 14:31:40,667 - params : {'conf': 'conf/CA/stkec.json', 'seed': 42, 'paral': 0, 'gpuid': 2, 'logname': 'stkec', 'method': 'STKEC', 'load_first_year': 0, 'first_year_model_path': 'log/PEMS3/trafficStream-42/2011/16.6936.pkl', 'device': device(type='cuda', index=2), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 1, 'influe_length': 168, 'batch_influ_size': 4, 'beita': 1, 'cluster': 24, 'auto_test': 1, 'raw_data_path': 'data/CA/finaldata/', 'save_data_path': 'data/CA/FastData/', 'graph_path': 'data/CA/graph/', 'model_path': 'log/CA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'rank': 6, 'train': 1, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'detect_infl_strategy': True, 'infl_topk': 10, 'adp_adj': False, 'skip_dim': 64, 'end_dim': 64, 'hidden_channels': 32, 'dilation_channels': 64, 'residual_channels': 64, 'input_dim': 1, 'output_dim': 1, 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'replay_num_samples': 300, 'extra_feature': True, 'momentum_type': 'linear', 'memory_size': 32, 'path': 'log/CA/stkec-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-04 14:31:48,801 - logger name:log/CA/pecpm-42/pecpm.log
2025-06-04 14:31:48,801 - params : {'conf': 'conf/CA/pecpm.json', 'seed': 42, 'paral': 0, 'gpuid': 1, 'logname': 'pecpm', 'method': 'PECPM', 'load_first_year': 0, 'first_year_model_path': 'log/SD/pecpm-42/2017/31.5668.pkl', 'device': device(type='cuda', index=1), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'PECPM': <class 'src.model.model.PECPM_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 32, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'beita': 1.0, 'cluster': 32, 'raw_data_path': 'data/CA/finaldata/', 'save_data_path': 'data/CA/FastData/', 'graph_path': 'data/CA/graph/', 'model_path': 'log/CA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'train': 1, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'adp_adj': False, 'skip_dim': 64, 'end_dim': 64, 'hidden_channels': 32, 'dilation_channels': 64, 'residual_channels': 64, 'input_dim': 1, 'output_dim': 1, 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 300, 'path': 'log/CA/pecpm-42', 'logger': <Logger utils.initialize (INFO)>}
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 757949.84it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 747920.65it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 827959.45it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 805680.10it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 850413.77it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 723763.68it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 673105.75it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 827928.35it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 856476.77it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 814611.92it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 842942.59it/s]
2025-06-04 14:44:02,524 - [*] Year 2017 load from data/CA/FastData/2017.npz
2025-06-04 14:44:04,516 - [*] Year 2017 Dataset load!
2025-06-04 14:44:04,558 - Total Parameters: 52556
2025-06-04 14:44:04,558 - Trainable Parameters: 52556
2025-06-04 14:44:04,561 - [*] Year 2017 Training start
2025-06-04 14:44:15,951 - node number torch.Size([1049088, 12])
2025-06-04 14:44:22,130 - [*] Year 2017 load from data/CA/FastData/2017.npz
2025-06-04 14:44:23,424 - [*] Year 2017 Dataset load!
2025-06-04 14:44:23,440 - [*] Year 2017 Training start
2025-06-04 14:44:25,928 - [*] Year 2017 load from data/CA/FastData/2017.npz
2025-06-04 14:44:27,597 - [*] Year 2017 Dataset load!
2025-06-04 14:44:27,613 - Total Parameters: 3308
2025-06-04 14:44:27,613 - Trainable Parameters: 3308
2025-06-04 14:44:27,615 - [*] Year 2017 Training start
2025-06-04 14:44:39,357 - node number torch.Size([1049088, 12])
2025-06-04 14:44:40,218 - node number torch.Size([1049088, 12])
2025-06-04 14:45:17,846 - [*] Year 2017 load from data/CA/FastData/2017.npz
2025-06-04 14:45:20,184 - [*] Year 2017 Dataset load!
2025-06-04 14:45:20,200 - Total Parameters: 3308
2025-06-04 14:45:20,200 - Trainable Parameters: 3308
2025-06-04 14:45:20,202 - [*] Year 2017 Training start
2025-06-04 14:45:38,123 - node number torch.Size([1049088, 12])
2025-06-04 14:47:30,883 - epoch:0, training loss:17522.3199 validation loss:46.7894
2025-06-04 14:47:36,254 - epoch:0, training loss:15400.8568 validation loss:43.2301
2025-06-04 14:47:36,998 - epoch:0, training loss:17522.3199 validation loss:46.7894
2025-06-04 14:47:39,712 - [*] Year 2017 load from data/CA/FastData/2017.npz
2025-06-04 14:47:42,604 - [*] Year 2017 load from data/CA/FastData/2017.npz
2025-06-04 14:47:43,756 - [*] Year 2017 Dataset load!
2025-06-04 14:47:43,882 - Total Parameters: 71948
2025-06-04 14:47:43,882 - Trainable Parameters: 71948
2025-06-04 14:47:43,884 - [*] Year 2017 Training start
2025-06-04 14:47:50,171 - node number torch.Size([131136, 12])
2025-06-04 14:48:47,882 - epoch:0, training loss:17522.3199 validation loss:46.7894
2025-06-04 15:00:49,180 - epoch:1, training loss:2710.6360 validation loss:32.4963
2025-06-04 15:01:03,641 - epoch:1, training loss:2710.6360 validation loss:32.4963
Traceback (most recent call last):
  File "/home/bd2/ANATS/Online_Baselines/pecpm_main.py", line 169, in <module>
    main(args) 
    ^^^^^^^^^^
  File "/home/bd2/ANATS/Online_Baselines/pecpm_main.py", line 120, in main
    train(inputs, args)
  File "/home/bd2/ANATS/Online_Baselines/src/trainer/pecpm_trainer.py", line 37, in train
    attention = attention.reshape(-1, N, C)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: cannot reshape array of size 6122188800 into shape (8196,32)
2025-06-04 15:01:14,559 - epoch:1, training loss:2416.5552 validation loss:33.6936
2025-06-04 15:02:18,899 - epoch:1, training loss:2710.6360 validation loss:32.4963
2025-06-04 15:03:53,234 - epoch:2, training loss:2077.8149 validation loss:31.8023
2025-06-04 15:04:15,049 - epoch:2, training loss:2077.8149 validation loss:31.8023
2025-06-04 15:04:39,410 - epoch:2, training loss:1991.6126 validation loss:37.7220
2025-06-04 15:05:36,385 - epoch:2, training loss:2077.8149 validation loss:31.8023
2025-06-04 15:06:56,088 - epoch:3, training loss:1997.3748 validation loss:33.3688
2025-06-04 15:07:28,371 - epoch:3, training loss:1997.3748 validation loss:33.3688
2025-06-04 15:08:06,526 - epoch:3, training loss:1893.8019 validation loss:32.1744
2025-06-04 15:08:11,189 - epoch:0, training loss:4751.2246 validation loss:31.1560
2025-06-04 15:09:05,260 - epoch:3, training loss:1997.3748 validation loss:33.3688
2025-06-04 15:10:01,350 - epoch:4, training loss:1978.4727 validation loss:32.7290
2025-06-04 15:19:09,179 - epoch:4, training loss:1978.4727 validation loss:32.7290
2025-06-04 15:28:53,264 - epoch:1, training loss:1899.3353 validation loss:32.8431
2025-06-04 15:44:35,121 - epoch:5, training loss:1955.2809 validation loss:30.9248
2025-06-04 15:47:01,580 - epoch:4, training loss:1978.4727 validation loss:32.7290
2025-06-04 15:49:04,138 - epoch:5, training loss:1955.2809 validation loss:30.9248
2025-06-04 15:50:28,409 - epoch:2, training loss:1868.0380 validation loss:30.6499
2025-06-04 16:11:16,124 - epoch:3, training loss:1857.3247 validation loss:29.4746
2025-06-04 16:32:42,309 - epoch:4, training loss:1832.6054 validation loss:29.3150
2025-06-04 16:53:50,351 - epoch:5, training loss:1825.9931 validation loss:36.2034
2025-06-04 17:14:45,232 - epoch:6, training loss:1820.2864 validation loss:33.8165
2025-06-04 17:35:28,870 - epoch:7, training loss:1813.9002 validation loss:31.9376
2025-06-04 17:53:42,174 - epoch:6, training loss:1926.7865 validation loss:32.1844
2025-06-04 17:56:08,953 - epoch:8, training loss:1800.5486 validation loss:32.4835
2025-06-04 18:17:22,955 - epoch:9, training loss:1802.5928 validation loss:31.6476
2025-06-04 18:36:13,023 - epoch:6, training loss:1926.7865 validation loss:32.1844
2025-06-04 18:36:23,939 - epoch:5, training loss:1955.2809 validation loss:30.9248
2025-06-04 18:36:36,327 - epoch:4, training loss:1815.6577 validation loss:35.2046
2025-06-04 18:37:02,329 - epoch:7, training loss:1880.7876 validation loss:32.2528
2025-06-04 18:38:09,326 - epoch:10, training loss:1792.2847 validation loss:31.5537
2025-06-04 18:39:23,757 - epoch:7, training loss:1880.7876 validation loss:32.2528
2025-06-04 18:39:42,505 - epoch:6, training loss:1926.7865 validation loss:32.1844
2025-06-04 18:40:01,697 - epoch:5, training loss:1763.4098 validation loss:35.9333
2025-06-04 18:40:06,397 - epoch:8, training loss:1855.7215 validation loss:32.2282
2025-06-04 18:42:38,135 - epoch:8, training loss:1855.7215 validation loss:32.2282
2025-06-04 18:42:59,278 - epoch:7, training loss:1880.7876 validation loss:32.2528
2025-06-04 18:43:11,518 - epoch:9, training loss:1845.6359 validation loss:31.4990
2025-06-04 18:43:28,100 - epoch:6, training loss:1749.6190 validation loss:36.5106
2025-06-04 18:43:51,388 - [*] loss:1873.3435
2025-06-04 18:43:58,787 - [*] year 2017, testing
2025-06-04 18:44:50,547 - T:3	MAE	21.5278	RMSE	32.4455	MAPE	15.3817
2025-06-04 18:45:49,849 - epoch:9, training loss:1845.6359 validation loss:31.4990
2025-06-04 18:46:16,054 - epoch:10, training loss:1843.4178 validation loss:34.4975
2025-06-04 18:46:17,715 - epoch:8, training loss:1855.7215 validation loss:32.2282
2025-06-04 18:46:40,062 - T:6	MAE	23.6565	RMSE	35.9447	MAPE	16.0717
2025-06-04 18:46:54,125 - epoch:7, training loss:1737.1218 validation loss:33.7257
2025-06-04 18:48:58,925 - epoch:10, training loss:1843.4178 validation loss:34.4975
2025-06-04 18:49:18,457 - epoch:11, training loss:1843.0817 validation loss:31.0497
2025-06-04 18:49:35,618 - epoch:9, training loss:1845.6359 validation loss:31.4990
2025-06-04 18:50:19,615 - epoch:8, training loss:1737.7167 validation loss:30.4924
2025-06-04 18:50:23,010 - [*] loss:2066.7861
2025-06-04 18:50:30,459 - [*] year 2017, testing
2025-06-04 18:51:30,729 - T:3	MAE	24.0046	RMSE	34.9756	MAPE	17.4856
2025-06-04 18:52:11,017 - epoch:11, training loss:1843.0817 validation loss:31.0497
2025-06-04 18:52:39,984 - T:12	MAE	27.8968	RMSE	42.5675	MAPE	18.0336
2025-06-04 18:52:39,984 - T:Avg	MAE	23.9883	RMSE	36.3820	MAPE	16.3559
2025-06-04 18:52:40,014 - Finished optimization, total time:9704.98 s, best model:log/CA/team-42/2017/29.315.pkl
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 1010148.27it/s]
2025-06-04 18:52:54,031 - epoch:10, training loss:1843.4178 validation loss:34.4975
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 1009697.16it/s]
2025-06-04 18:53:19,631 - [*] loss:2066.7861
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 816437.22it/s]
2025-06-04 19:09:07,125 - T:6	MAE	25.3250	RMSE	37.7974	MAPE	18.0012
2025-06-04 19:09:07,822 - [*] year 2017, testing
2025-06-04 20:55:43,304 - epoch:9, training loss:1739.1027 validation loss:37.6032
2025-06-04 22:24:10,143 - epoch:11, training loss:1843.0817 validation loss:31.0497
2025-06-04 22:25:53,801 - [*] loss:2066.7861
2025-06-04 23:13:35,067 - [*] year 2017, testing
2025-06-05 00:00:07,782 - T:3	MAE	24.0046	RMSE	34.9756	MAPE	17.4856
2025-06-05 00:00:14,666 - epoch:10, training loss:1735.3938 validation loss:35.0947
2025-06-05 00:02:02,693 - [*] Year 2018 load from data/CA/FastData/2018.npz
2025-06-05 00:02:04,283 - [*] load from log/CA/team-42/2017/29.315.pkl
2025-06-05 00:02:32,051 - number of increase nodes:753, nodes after 2 hop:torch.Size([2869]), total nodes this year 8428
2025-06-05 00:02:49,114 - T:3	MAE	24.0046	RMSE	34.9756	MAPE	17.4856
2025-06-05 00:02:58,978 - [*] Year 2018 Dataset load!
2025-06-05 00:02:58,978 - [*] load from log/CA/team-42/2017/29.315.pkl
2025-06-05 00:02:58,988 - [*] EWC! lambda 0.001000
2025-06-05 00:03:37,770 - epoch:11, training loss:1720.2478 validation loss:30.4861
2025-06-05 00:03:47,861 - T:6	MAE	25.3250	RMSE	37.7974	MAPE	18.0012
2025-06-05 00:17:27,804 - Total Parameters: 71948
2025-06-05 00:17:27,804 - Trainable Parameters: 71948
2025-06-05 00:17:27,804 - [*] Year 2018 Training start
2025-06-05 00:17:44,884 - node number torch.Size([45904, 12])
2025-06-05 00:20:55,708 - epoch:12, training loss:1725.6310 validation loss:32.9442
2025-06-05 00:21:13,711 - T:6	MAE	25.3250	RMSE	37.7974	MAPE	18.0012
2025-06-05 00:24:21,169 - epoch:0, training loss:1215.2315 validation loss:24.8108
2025-06-05 00:31:13,483 - epoch:1, training loss:1213.0643 validation loss:26.7029
Traceback (most recent call last):
  File "/home/bd2/ANATS/Online_Baselines/main.py", line 204, in <module>
    main(args)
  File "/home/bd2/ANATS/Online_Baselines/main.py", line 154, in main
    train(inputs, args)
  File "/home/bd2/ANATS/Online_Baselines/src/trainer/default_trainer.py", line 159, in train
    loss = masked_mae_np(data.y.cpu().data.numpy(), pred.cpu().data.numpy(), 0)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/ANATS/Online_Baselines/utils/metric.py", line 30, in masked_mae_np
    return np.mean(np.nan_to_num(mask * mae))
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/numpy/lib/_type_check_impl.py", line 477, in nan_to_num
    idx_neginf = isneginf(d)
                 ^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/numpy/lib/_ufunclike_impl.py", line 201, in isneginf
    signbit = nx.signbit(x)
              ^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/utils/data/_utils/signal_handling.py", line 73, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 66504) is killed by signal: Killed. 
Exception in thread Thread-31 (_pin_memory_loop):
Traceback (most recent call last):
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/threading.py", line 1075, in _bootstrap_inner
    self.run()
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/threading.py", line 1012, in run
    self._target(*self._args, **self._kwargs)
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/utils/data/_utils/pin_memory.py", line 61, in _pin_memory_loop
    do_one_step()
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/utils/data/_utils/pin_memory.py", line 37, in do_one_step
    r = in_queue.get(timeout=MP_STATUS_CHECK_INTERVAL)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/multiprocessing/queues.py", line 122, in get
    return _ForkingPickler.loads(res)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/multiprocessing/reductions.py", line 541, in rebuild_storage_fd
    fd = df.detach()
         ^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/multiprocessing/resource_sharer.py", line 57, in detach
    with _resource_sharer.get_connection(self._id) as conn:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/multiprocessing/resource_sharer.py", line 86, in get_connection
    c = Client(address, authkey=process.current_process().authkey)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/multiprocessing/connection.py", line 525, in Client
    answer_challenge(c, authkey)
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/multiprocessing/connection.py", line 953, in answer_challenge
    message = connection.recv_bytes(256)         # reject large message
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/multiprocessing/connection.py", line 216, in recv_bytes
    buf = self._recv_bytes(maxlength)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/multiprocessing/connection.py", line 430, in _recv_bytes
    buf = self._recv(4)
          ^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/multiprocessing/connection.py", line 395, in _recv
    chunk = read(handle, remaining)
            ^^^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [Errno 104] Connection reset by peer
Traceback (most recent call last):
  File "/home/bd2/ANATS/Online_Baselines/main.py", line 204, in <module>
    main(args)
  File "/home/bd2/ANATS/Online_Baselines/main.py", line 154, in main
    train(inputs, args)
  File "/home/bd2/ANATS/Online_Baselines/src/trainer/default_trainer.py", line 154, in train
    pred, _ = to_dense_batch(pred, batch=data.batch)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch_geometric/experimental.py", line 117, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch_geometric/utils/_to_dense_batch.py", line 104, in to_dense_batch
    batch_size = int(batch.max()) + 1
                 ^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/utils/data/_utils/signal_handling.py", line 73, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 83030) is killed by signal: Killed. 
2025-06-05 00:36:46,064 - T:12	MAE	29.1151	RMSE	44.7982	MAPE	20.0028
2025-06-05 00:36:46,064 - T:Avg	MAE	25.8289	RMSE	38.5898	MAPE	18.3226
2025-06-05 00:36:46,095 - Finished optimization, total time:1149.76 s, best model:log/CA/retrain_st_sd-42/2017/30.9248.pkl
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 829688.95it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 981454.90it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 935156.62it/s]
2025-06-05 00:39:16,672 - T:12	MAE	29.1151	RMSE	44.7982	MAPE	20.0028
2025-06-05 00:39:16,672 - T:Avg	MAE	25.8289	RMSE	38.5898	MAPE	18.3226
2025-06-05 00:39:16,749 - Finished optimization, total time:1214.31 s, best model:log/CA/trafficstream-42/2017/30.9248.pkl
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 893962.17it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 1085173.44it/s]
2025-06-05 00:39:46,576 - [*] Year 2018 load from data/CA/FastData/2018.npz
2025-06-05 00:39:47,240 - [*] Year 2018 Dataset load!
2025-06-05 00:39:47,242 - Total Parameters: 3308
2025-06-05 00:39:47,242 - Trainable Parameters: 3308
2025-06-05 00:39:47,242 - [*] Year 2018 Training start
2025-06-05 00:39:50,330 - node number torch.Size([1078784, 12])
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 966067.59it/s]
2025-06-05 00:40:46,634 - T:12	MAE	29.1151	RMSE	44.7982	MAPE	20.0028
2025-06-05 00:40:46,635 - T:Avg	MAE	25.8289	RMSE	38.5898	MAPE	18.3226
2025-06-05 00:40:46,886 - Finished optimization, total time:1247.64 s, best model:log/CA/online_st_an_sd-42/2017/30.9248.pkl
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 849766.33it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 985150.19it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 933631.78it/s]
2025-06-05 00:42:33,787 - epoch:0, training loss:17117.9252 validation loss:35.0823
2025-06-05 00:43:02,363 - [*] Year 2018 load from data/CA/FastData/2018.npz
2025-06-05 00:43:03,529 - [*] load from log/CA/trafficstream-42/2017/30.9248.pkl
/home/bd2/ANATS/Online_Baselines/src/model/detect_default.py:73: RuntimeWarning: invalid value encountered in divide
  pre_data[i,:,j] = (pre_data[i,:,j] - min(pre_data[i,:,j]))/(max(pre_data[i,:,j]) - min(pre_data[i,:,j]))  # Normalize the eigenvalues ​​to the range [0, 1]
/home/bd2/ANATS/Online_Baselines/src/model/detect_default.py:77: RuntimeWarning: invalid value encountered in divide
  pre_prob = pre_prob *1.0 / sum(pre_prob)
/home/bd2/ANATS/Online_Baselines/src/model/detect_default.py:74: RuntimeWarning: invalid value encountered in divide
  cur_data[i,:,j] = (cur_data[i,:,j] - min(cur_data[i,:,j]))/(max(cur_data[i,:,j]) - min(cur_data[i,:,j]))
/home/bd2/ANATS/Online_Baselines/src/model/detect_default.py:79: RuntimeWarning: invalid value encountered in divide
  cur_prob = cur_prob * 1.0 /sum(cur_prob)
2025-06-05 00:43:44,452 - number of increase nodes:927, nodes after 2 hop:torch.Size([5722]), total nodes this year 8428
2025-06-05 00:44:03,257 - [*] Year 2018 load from data/CA/FastData/2018.npz
2025-06-05 00:44:03,943 - [*] Year 2018 Dataset load!
2025-06-05 00:44:03,943 - [*] load from log/CA/online_st_an_sd-42/2017/30.9248.pkl
2025-06-05 00:44:03,950 - Total Parameters: 3308
2025-06-05 00:44:03,950 - Trainable Parameters: 3308
2025-06-05 00:44:03,951 - [*] Year 2018 Training start
2025-06-05 00:44:07,858 - node number torch.Size([1078784, 12])
2025-06-05 00:44:16,693 - [*] Year 2018 Dataset load!
2025-06-05 00:44:16,693 - [*] load from log/CA/trafficstream-42/2017/30.9248.pkl
2025-06-05 00:44:16,697 - [*] EWC! lambda 0.000100
2025-06-05 00:45:22,081 - epoch:1, training loss:2043.0305 validation loss:31.6450
2025-06-05 00:45:49,838 - [*] Year 2018 Training start
2025-06-05 00:45:53,890 - node number torch.Size([732416, 12])
2025-06-05 00:46:49,438 - epoch:0, training loss:2002.6258 validation loss:31.3962
2025-06-05 00:47:07,271 - epoch:0, training loss:1677.2391 validation loss:31.1730
2025-06-05 00:48:10,094 - epoch:2, training loss:1964.7254 validation loss:30.4636
2025-06-05 00:48:23,693 - epoch:1, training loss:1634.5963 validation loss:28.2126
2025-06-05 00:49:36,739 - epoch:1, training loss:1930.7847 validation loss:29.0085
2025-06-05 00:49:40,222 - epoch:2, training loss:1622.1474 validation loss:28.7819
2025-06-05 00:50:56,724 - epoch:3, training loss:1626.2478 validation loss:26.7613
2025-06-05 00:50:58,036 - epoch:3, training loss:1899.9901 validation loss:28.5031
2025-06-05 00:52:13,143 - epoch:4, training loss:1623.3961 validation loss:29.3006
2025-06-05 00:52:24,724 - epoch:2, training loss:1912.4765 validation loss:28.5187
2025-06-05 00:53:29,459 - epoch:5, training loss:1621.5228 validation loss:29.1686
2025-06-05 00:53:46,531 - epoch:4, training loss:1850.8848 validation loss:30.5601
2025-06-05 00:54:45,884 - epoch:6, training loss:1608.1324 validation loss:29.9786
2025-06-05 00:55:11,863 - epoch:3, training loss:1912.4122 validation loss:28.1276
2025-06-05 00:56:02,945 - epoch:7, training loss:1621.5499 validation loss:31.1434
2025-06-05 00:56:34,880 - epoch:5, training loss:1822.7568 validation loss:31.0568
2025-06-05 00:57:19,931 - epoch:8, training loss:1623.1268 validation loss:31.0307
2025-06-05 00:57:59,774 - epoch:4, training loss:1907.2533 validation loss:29.5986
2025-06-05 00:58:35,841 - epoch:9, training loss:1606.8164 validation loss:27.0859
2025-06-05 00:59:23,913 - epoch:6, training loss:1813.0183 validation loss:28.5165
2025-06-05 00:59:35,998 - [*] loss:1986.6738
2025-06-05 00:59:44,150 - [*] year 2018, testing
2025-06-05 01:00:42,428 - T:3	MAE	21.3056	RMSE	33.1910	MAPE	14.4535
2025-06-05 01:00:46,583 - epoch:5, training loss:1898.6687 validation loss:31.3135
2025-06-05 01:02:14,936 - epoch:7, training loss:1807.5246 validation loss:27.0880
2025-06-05 01:02:33,957 - T:6	MAE	23.3824	RMSE	36.7690	MAPE	15.9592
2025-06-05 01:03:34,309 - epoch:6, training loss:1896.1413 validation loss:29.4517
2025-06-05 01:05:05,206 - epoch:8, training loss:1795.3875 validation loss:28.5758
2025-06-05 01:06:22,061 - epoch:7, training loss:1896.0053 validation loss:27.4833
2025-06-05 01:07:55,118 - epoch:9, training loss:1788.7718 validation loss:29.0469
2025-06-05 01:08:31,519 - T:12	MAE	27.6282	RMSE	43.6966	MAPE	19.6910
2025-06-05 01:08:31,519 - T:Avg	MAE	23.7836	RMSE	37.3348	MAPE	16.4457
2025-06-05 01:08:31,554 - Finished optimization, total time:469.49 s, best model:log/CA/trafficstream-42/2018/26.7613.pkl
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 740515.25it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 898278.90it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 1113358.16it/s]
2025-06-05 01:09:09,019 - epoch:8, training loss:1896.4797 validation loss:29.7742
2025-06-05 01:10:43,502 - epoch:10, training loss:1780.5963 validation loss:27.9155
2025-06-05 01:11:29,862 - [*] Year 2019 load from data/CA/FastData/2019.npz
2025-06-05 01:11:30,915 - [*] load from log/CA/trafficstream-42/2018/26.7613.pkl
2025-06-05 01:11:56,926 - epoch:9, training loss:1877.1085 validation loss:29.6657
2025-06-05 01:12:11,282 - number of increase nodes:881, nodes after 2 hop:torch.Size([5408]), total nodes this year 8600
2025-06-05 01:12:41,118 - [*] Year 2019 Dataset load!
2025-06-05 01:12:41,118 - [*] load from log/CA/trafficstream-42/2018/26.7613.pkl
2025-06-05 01:12:41,122 - [*] EWC! lambda 0.000100
2025-06-05 01:13:30,433 - epoch:11, training loss:1779.8080 validation loss:28.3258
2025-06-05 01:14:17,844 - [*] Year 2019 Training start
2025-06-05 01:14:22,506 - node number torch.Size([692224, 12])
2025-06-05 01:14:44,035 - epoch:10, training loss:1848.7143 validation loss:28.2782
2025-06-05 01:15:26,399 - epoch:0, training loss:1987.6473 validation loss:28.9961
2025-06-05 01:16:19,951 - epoch:12, training loss:1770.0362 validation loss:29.1561
2025-06-05 01:16:34,085 - epoch:1, training loss:1953.6285 validation loss:27.3629
2025-06-05 01:17:31,601 - epoch:11, training loss:1826.0004 validation loss:29.2814
2025-06-05 01:17:41,530 - epoch:2, training loss:1951.4420 validation loss:28.7626
2025-06-05 01:18:49,392 - epoch:3, training loss:1942.0969 validation loss:28.8622
2025-06-05 01:19:10,805 - epoch:13, training loss:1765.9611 validation loss:29.0413
2025-06-05 01:19:57,122 - epoch:4, training loss:1961.0712 validation loss:32.9421
2025-06-05 01:20:07,989 - [*] loss:1925.7723
2025-06-05 01:20:15,744 - [*] year 2018, testing
2025-06-05 01:20:19,360 - epoch:12, training loss:1806.8861 validation loss:27.9009
2025-06-05 01:21:04,043 - epoch:5, training loss:1963.1909 validation loss:29.6101
2025-06-05 01:21:16,924 - T:3	MAE	21.8334	RMSE	33.8616	MAPE	14.1302
2025-06-05 01:22:11,959 - epoch:6, training loss:1955.9384 validation loss:29.8623
2025-06-05 01:23:06,398 - epoch:13, training loss:1798.1131 validation loss:29.2335
2025-06-05 01:23:13,221 - T:6	MAE	23.9209	RMSE	37.1172	MAPE	16.1884
2025-06-05 01:23:19,021 - epoch:7, training loss:1956.1486 validation loss:27.9680
2025-06-05 01:24:03,452 - [*] loss:1915.3157
2025-06-05 01:24:11,015 - [*] year 2018, testing
2025-06-05 01:24:22,162 - [*] loss:1830.0386
2025-06-05 01:24:29,821 - [*] year 2019, testing
2025-06-05 01:25:12,284 - T:3	MAE	20.7685	RMSE	32.5060	MAPE	13.8358
2025-06-05 01:25:53,441 - T:3	MAE	21.3822	RMSE	32.1009	MAPE	15.3644
2025-06-05 01:27:14,450 - T:6	MAE	23.0446	RMSE	36.1047	MAPE	16.4661
2025-06-05 01:28:12,105 - T:6	MAE	23.3269	RMSE	35.6867	MAPE	16.3469
2025-06-05 01:30:39,694 - T:12	MAE	27.8841	RMSE	43.0163	MAPE	21.1471
2025-06-05 01:30:39,695 - T:Avg	MAE	24.1823	RMSE	37.4415	MAPE	16.7288
2025-06-05 01:30:39,724 - Finished optimization, total time:1245.77 s, best model:log/CA/retrain_st_sd-42/2018/27.088.pkl
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 956105.75it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 971570.82it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 993597.98it/s]
2025-06-06 06:08:21,665 - logger name:log/CA/pretrain_st_sd-42/pretrain_st_sd.log
2025-06-06 06:08:21,665 - params : {'conf': 'conf/CA/pretrain_st_sd.json', 'seed': 42, 'paral': 0, 'gpuid': 4, 'logname': 'pretrain_st_sd', 'method': 'TrafficStream', 'load_first_year': 1, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/CA/trafficstream-42/2017/30.9248.pkl', 'device': device(type='cuda', index=4), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>, 'DLF': <class 'src.model.model.DLF_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/CA/finaldata/', 'save_data_path': 'data/CA/FastData/', 'graph_path': 'data/CA/graph/', 'model_path': 'log/CA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'rank': 6, 'train': 1, 'strategy': 'pretrain', 'init': True, 'increase': False, 'num_hops': 0, 'detect': False, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': False, 'path': 'log/CA/pretrain_st_sd-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-06 06:08:22,558 - [*] Year 2017 load from data/CA/FastData/2017.npz
2025-06-06 06:08:23,413 - [*] load from /home/bd2/ANATS/Online_Baselines/log/CA/trafficstream-42/2017/30.9248.pkl
2025-06-06 06:09:38,437 - [*] loss:2066.7861
2025-06-06 06:09:45,128 - [*] year 2017, testing
2025-06-06 06:10:44,170 - T:3	MAE	24.0046	RMSE	34.9756	MAPE	17.4856
2025-06-06 06:12:36,698 - T:6	MAE	25.3250	RMSE	37.7974	MAPE	18.0012
2025-06-06 06:18:50,781 - T:12	MAE	29.1151	RMSE	44.7982	MAPE	20.0028
2025-06-06 06:18:50,782 - T:Avg	MAE	25.8289	RMSE	38.5898	MAPE	18.3226
2025-06-06 06:18:51,835 - [*] Year 2018 load from data/CA/FastData/2018.npz
2025-06-06 06:18:52,458 - [*] load from /home/bd2/ANATS/Online_Baselines/log/CA/trafficstream-42/2017/30.9248.pkl
2025-06-06 06:20:10,799 - [*] loss:2010.6511
2025-06-06 06:20:18,108 - [*] year 2018, testing
2025-06-06 06:21:16,487 - T:3	MAE	22.8545	RMSE	34.3953	MAPE	16.6209
2025-06-06 06:23:07,980 - T:6	MAE	24.2659	RMSE	37.2540	MAPE	17.2779
2025-06-06 06:29:41,182 - T:12	MAE	28.1658	RMSE	44.1059	MAPE	19.6508
2025-06-06 06:29:41,182 - T:Avg	MAE	24.7675	RMSE	37.9893	MAPE	17.6448
2025-06-06 06:29:41,211 - [*] No increasing nodes at year 2018, store model of the last year.
2025-06-06 06:29:42,416 - [*] Year 2019 load from data/CA/FastData/2019.npz
2025-06-06 06:29:43,068 - [*] load from log/CA/pretrain_st_sd-42/2018/3.pkl
2025-06-06 06:31:03,571 - [*] loss:1808.9274
2025-06-06 06:31:11,470 - [*] year 2019, testing
2025-06-06 06:32:11,874 - T:3	MAE	21.1842	RMSE	32.3536	MAPE	15.9997
2025-06-06 06:34:07,379 - T:6	MAE	22.6830	RMSE	35.2605	MAPE	16.7800
2025-06-06 06:40:53,110 - T:12	MAE	26.7427	RMSE	42.1949	MAPE	19.5694
2025-06-06 06:40:53,110 - T:Avg	MAE	23.2020	RMSE	36.0044	MAPE	17.2149
2025-06-06 06:40:53,139 - [*] No increasing nodes at year 2019, store model of the last year.
2025-06-06 06:40:54,361 - [*] Year 2020 load from data/CA/FastData/2020.npz
2025-06-06 06:40:55,014 - [*] load from log/CA/pretrain_st_sd-42/2019/3.pkl
2025-06-06 06:42:15,067 - [*] loss:2188.6775
2025-06-06 06:42:22,594 - [*] year 2020, testing
2025-06-06 06:43:22,723 - T:3	MAE	29.0211	RMSE	40.7519	MAPE	28.3824
2025-06-06 06:45:17,322 - T:6	MAE	30.1985	RMSE	42.5398	MAPE	29.5198
2025-06-06 06:51:44,988 - T:12	MAE	32.9558	RMSE	46.5922	MAPE	32.7412
2025-06-06 06:51:44,989 - T:Avg	MAE	30.4967	RMSE	42.9112	MAPE	29.9232
2025-06-06 06:51:45,017 - [*] No increasing nodes at year 2020, store model of the last year.
2025-06-06 06:51:45,018 - 


2025-06-06 06:51:45,018 - 3   	 MAE	     24.00	     22.85	     21.18	     29.02		   24.27
2025-06-06 06:51:45,018 - 3   	RMSE	     34.98	     34.40	     32.35	     40.75		   35.62
2025-06-06 06:51:45,018 - 3   	MAPE	     17.49	     16.62	     16.00	     28.38		   19.62
2025-06-06 06:51:45,018 - 6   	 MAE	     25.32	     24.27	     22.68	     30.20		   25.62
2025-06-06 06:51:45,018 - 6   	RMSE	     37.80	     37.25	     35.26	     42.54		   38.21
2025-06-06 06:51:45,018 - 6   	MAPE	     18.00	     17.28	     16.78	     29.52		   20.39
2025-06-06 06:51:45,018 - 12  	 MAE	     29.12	     28.17	     26.74	     32.96		   29.24
2025-06-06 06:51:45,018 - 12  	RMSE	     44.80	     44.11	     42.19	     46.59		   44.42
2025-06-06 06:51:45,018 - 12  	MAPE	     20.00	     19.65	     19.57	     32.74		   22.99
2025-06-06 06:51:45,018 - Avg 	 MAE	     25.83	     24.77	     23.20	     30.50		   26.07
2025-06-06 06:51:45,018 - Avg 	RMSE	     38.59	     37.99	     36.00	     42.91		   38.87
2025-06-06 06:51:45,018 - Avg 	MAPE	     18.32	     17.64	     17.21	     29.92		   20.78
2025-06-06 06:51:45,018 - total time: 0.0000
2025-06-06 06:59:59,542 - logger name:log/CA/retrain_st_sd-42/retrain_st_sd.log
2025-06-06 06:59:59,543 - params : {'conf': 'conf/CA/retrain_st_sd.json', 'seed': 42, 'paral': 0, 'gpuid': 4, 'logname': 'retrain_st_sd', 'method': 'TrafficStream', 'load_first_year': 1, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/CA/trafficstream-42/2017/30.9248.pkl', 'device': device(type='cuda', index=4), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>, 'DLF': <class 'src.model.model.DLF_Model'>}, 'begin_year': 2018, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/CA/finaldata/', 'save_data_path': 'data/CA/FastData/', 'graph_path': 'data/CA/graph/', 'model_path': 'log/CA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'rank': 6, 'train': 1, 'strategy': 'retrain', 'init': False, 'increase': False, 'num_hops': 0, 'detect': False, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': False, 'path': 'log/CA/retrain_st_sd-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-06 07:00:00,569 - [*] Year 2018 load from data/CA/FastData/2018.npz
2025-06-06 07:00:01,409 - [*] load from /home/bd2/ANATS/Online_Baselines/log/CA/trafficstream-42/2017/30.9248.pkl
2025-06-06 07:01:20,410 - [*] loss:2010.6511
2025-06-06 07:01:26,605 - [*] year 2018, testing
2025-06-06 07:02:26,301 - T:3	MAE	22.8545	RMSE	34.3953	MAPE	16.6209
2025-06-06 07:04:19,929 - T:6	MAE	24.2659	RMSE	37.2540	MAPE	17.2779
2025-06-06 07:05:25,017 - logger name:log/CA/team-42/team.log
2025-06-06 07:05:25,017 - params : {'conf': 'conf/CA/team.json', 'seed': 42, 'paral': 0, 'gpuid': 5, 'logname': 'team', 'method': 'TEAM', 'load_first_year': 1, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/CA/team-42/2017/29.315.pkl', 'device': device(type='cuda', index=5), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>, 'DLF': <class 'src.model.model.DLF_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.001, 'batch_size': 16, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'n_heads': 3, 'in_channels': 1, 'K': 3, 'nb_block': 1, 'nb_chev_filter': 64, 'nb_time_filter': 64, 'num_of_hours': 1, 'missing_value': 0.0, 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/CA/finaldata/', 'save_data_path': 'data/CA/FastData/', 'graph_path': 'data/CA/graph', 'model_path': 'log/CA/', 'strategy': 'incremental', 'init': True, 'increase': True, 'decrease': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'original', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.001, 'replay': True, 'replay_strategy': 'distribution', 'replay_num_samples': 100, 'path': 'log/CA/team-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-06 07:05:25,923 - [*] Year 2017 load from data/CA/FastData/2017.npz
2025-06-06 07:05:26,763 - [*] load from /home/bd2/ANATS/Online_Baselines/log/CA/team-42/2017/29.315.pkl
2025-06-06 07:10:48,990 - T:12	MAE	28.1658	RMSE	44.1059	MAPE	19.6508
2025-06-06 07:10:48,991 - T:Avg	MAE	24.7675	RMSE	37.9893	MAPE	17.6448
2025-06-06 07:10:50,111 - [*] Year 2019 load from data/CA/FastData/2019.npz
2025-06-06 07:11:26,618 - [*] loss:1873.3435
2025-06-06 07:11:34,773 - [*] year 2017, testing
2025-06-06 07:11:55,355 - [*] Year 2019 Dataset load!
2025-06-06 07:11:55,379 - Total Parameters: 3308
2025-06-06 07:11:55,379 - Trainable Parameters: 3308
2025-06-06 07:11:55,380 - [*] Year 2019 Training start
2025-06-06 07:11:57,689 - node number torch.Size([1100800, 12])
2025-06-06 07:12:32,134 - T:3	MAE	21.5278	RMSE	32.4455	MAPE	15.3817
2025-06-06 07:14:21,337 - T:6	MAE	23.6565	RMSE	35.9447	MAPE	16.0717
2025-06-06 07:14:50,092 - epoch:0, training loss:16957.7753 validation loss:39.4503
2025-06-06 07:17:47,979 - epoch:1, training loss:2454.3084 validation loss:31.3458
2025-06-06 07:20:30,319 - T:12	MAE	27.8968	RMSE	42.5675	MAPE	18.0336
2025-06-06 07:20:30,320 - T:Avg	MAE	23.9883	RMSE	36.3820	MAPE	16.3559
2025-06-06 07:20:31,527 - [*] Year 2018 load from data/CA/FastData/2018.npz
2025-06-06 07:20:32,526 - [*] load from /home/bd2/ANATS/Online_Baselines/log/CA/team-42/2017/29.315.pkl
2025-06-06 07:20:45,257 - epoch:2, training loss:2090.3385 validation loss:29.9687
2025-06-06 07:20:53,903 - number of increase nodes:753, nodes after 2 hop:torch.Size([2869]), total nodes this year 8428
2025-06-06 07:22:22,649 - [*] Year 2018 Dataset load!
2025-06-06 07:22:22,650 - [*] load from /home/bd2/ANATS/Online_Baselines/log/CA/team-42/2017/29.315.pkl
2025-06-06 07:22:22,680 - [*] EWC! lambda 0.001000
2025-06-06 07:23:51,603 - epoch:3, training loss:2014.1842 validation loss:30.3142
2025-06-06 07:26:49,049 - epoch:4, training loss:1986.1424 validation loss:29.8172
2025-06-06 07:29:46,000 - epoch:5, training loss:1945.7425 validation loss:30.0187
2025-06-06 07:32:41,995 - epoch:6, training loss:1888.9074 validation loss:29.7877
2025-06-06 07:35:38,222 - epoch:7, training loss:1860.3976 validation loss:30.7968
2025-06-06 07:38:28,722 - Total Parameters: 71948
2025-06-06 07:38:28,723 - Trainable Parameters: 71948
2025-06-06 07:38:28,724 - [*] Year 2018 Training start
2025-06-06 07:38:31,046 - node number torch.Size([45904, 12])
2025-06-06 07:38:34,843 - epoch:8, training loss:1854.6213 validation loss:30.9116
2025-06-06 07:41:36,497 - epoch:9, training loss:1849.7877 validation loss:29.7830
2025-06-06 07:44:43,801 - epoch:10, training loss:1847.7550 validation loss:30.0633
2025-06-06 07:45:49,425 - epoch:0, training loss:1215.9999 validation loss:23.9412
2025-06-06 07:47:42,946 - epoch:11, training loss:1848.7534 validation loss:28.4036
2025-06-06 07:50:52,559 - epoch:12, training loss:1839.5813 validation loss:30.7811
2025-06-06 07:53:08,613 - epoch:1, training loss:1213.7925 validation loss:28.3069
2025-06-06 07:53:52,099 - epoch:13, training loss:1840.2472 validation loss:29.1357
2025-06-06 07:56:51,537 - epoch:14, training loss:1835.2176 validation loss:28.2323
2025-06-06 07:59:51,106 - epoch:15, training loss:1839.5371 validation loss:27.6826
2025-06-06 08:00:32,687 - epoch:2, training loss:1211.1595 validation loss:27.1483
2025-06-06 08:02:48,181 - epoch:16, training loss:1839.3033 validation loss:29.2300
2025-06-06 08:05:45,600 - epoch:17, training loss:1833.6141 validation loss:30.9469
2025-06-06 08:07:58,187 - epoch:3, training loss:1216.0057 validation loss:25.9211
2025-06-06 08:08:43,724 - epoch:18, training loss:1830.1082 validation loss:30.1868
2025-06-06 08:11:43,002 - epoch:19, training loss:1835.2503 validation loss:27.8119
2025-06-06 08:14:40,883 - epoch:20, training loss:1836.5196 validation loss:30.4145
2025-06-06 08:15:21,557 - epoch:4, training loss:1215.1478 validation loss:24.2387
2025-06-06 08:17:40,638 - epoch:21, training loss:1830.7661 validation loss:30.0718
2025-06-06 08:18:43,028 - [*] loss:1683.8768
2025-06-06 08:19:24,853 - [*] year 2019, testing
2025-06-06 08:22:46,652 - T:3	MAE	19.6972	RMSE	30.4080	MAPE	13.4530
2025-06-06 08:22:50,694 - epoch:5, training loss:1210.3527 validation loss:27.5228
2025-06-06 08:27:04,535 - T:6	MAE	21.7771	RMSE	33.9765	MAPE	15.4675
2025-06-06 08:30:17,837 - epoch:6, training loss:1208.4981 validation loss:26.7678
2025-06-06 08:33:27,110 - T:12	MAE	25.9393	RMSE	40.5684	MAPE	21.2143
2025-06-06 08:33:27,111 - T:Avg	MAE	22.1052	RMSE	34.3838	MAPE	16.3156
2025-06-06 08:33:27,143 - Finished optimization, total time:2091.00 s, best model:log/CA/retrain_st_sd-42/2019/27.6826.pkl
2025-06-06 08:33:28,597 - [*] Year 2020 load from data/CA/FastData/2020.npz
2025-06-06 08:35:02,546 - [*] Year 2020 Dataset load!
2025-06-06 08:35:02,569 - Total Parameters: 3308
2025-06-06 08:35:02,569 - Trainable Parameters: 3308
2025-06-06 08:35:02,569 - [*] Year 2020 Training start
2025-06-06 08:35:05,585 - node number torch.Size([1095808, 12])
2025-06-06 08:35:59,663 - [*] loss:1864.7710
2025-06-06 08:36:25,546 - [*] year 2018, testing
2025-06-06 08:37:44,339 - T:3	MAE	21.6947	RMSE	32.5249	MAPE	18.9575
2025-06-06 08:38:04,441 - epoch:0, training loss:17715.3896 validation loss:31.2607
2025-06-06 08:40:22,787 - T:6	MAE	23.7351	RMSE	35.9231	MAPE	19.5103
2025-06-06 08:41:10,431 - epoch:1, training loss:1850.0760 validation loss:29.1779
2025-06-06 08:44:04,609 - epoch:2, training loss:1747.6794 validation loss:28.7185
2025-06-06 08:46:24,336 - T:12	MAE	27.8386	RMSE	42.3387	MAPE	21.2589
2025-06-06 08:46:24,337 - T:Avg	MAE	24.0402	RMSE	36.3254	MAPE	19.7489
2025-06-06 08:46:24,366 - Finished optimization, total time:2185.61 s, best model:log/CA/team-42/2018/23.9412.pkl
2025-06-06 08:46:26,201 - [*] Year 2019 load from data/CA/FastData/2019.npz
2025-06-06 08:46:27,380 - [*] load from log/CA/team-42/2018/23.9412.pkl
2025-06-06 08:46:55,452 - number of increase nodes:701, nodes after 2 hop:torch.Size([3018]), total nodes this year 8600
2025-06-06 08:46:58,174 - epoch:3, training loss:1667.8341 validation loss:28.8331
2025-06-06 08:48:16,377 - [*] Year 2019 Dataset load!
2025-06-06 08:48:16,377 - [*] load from log/CA/team-42/2018/23.9412.pkl
2025-06-06 08:48:16,409 - [*] EWC! lambda 0.001000
2025-06-06 08:49:53,896 - epoch:4, training loss:1653.3925 validation loss:31.6940
2025-06-06 08:52:48,345 - epoch:5, training loss:1643.0149 validation loss:29.8194
2025-06-06 08:55:44,077 - epoch:6, training loss:1639.7965 validation loss:26.8949
2025-06-06 08:58:39,479 - epoch:7, training loss:1635.9070 validation loss:27.5151
2025-06-06 09:01:35,427 - epoch:8, training loss:1631.2739 validation loss:31.6111
2025-06-06 09:03:25,648 - Total Parameters: 71948
2025-06-06 09:03:25,648 - Trainable Parameters: 71948
2025-06-06 09:03:25,648 - [*] Year 2019 Training start
2025-06-06 09:03:32,933 - node number torch.Size([48288, 12])
2025-06-06 09:04:30,569 - epoch:9, training loss:1624.9377 validation loss:29.9721
2025-06-06 09:07:26,534 - epoch:10, training loss:1622.1877 validation loss:28.0003
2025-06-06 09:10:17,232 - epoch:0, training loss:1596.0234 validation loss:29.0284
2025-06-06 09:10:22,333 - epoch:11, training loss:1621.8613 validation loss:28.7997
2025-06-06 09:13:18,166 - epoch:12, training loss:1621.0678 validation loss:32.6986
2025-06-06 09:14:17,240 - [*] loss:1896.2274
2025-06-06 09:14:24,632 - [*] year 2020, testing
2025-06-06 09:15:24,972 - T:3	MAE	28.3602	RMSE	38.8050	MAPE	22.9679
2025-06-06 09:17:08,012 - epoch:1, training loss:1598.2702 validation loss:25.1509
2025-06-06 09:17:21,870 - T:6	MAE	29.1078	RMSE	40.3879	MAPE	23.3964
2025-06-06 09:23:45,565 - T:12	MAE	30.7065	RMSE	43.3252	MAPE	26.1559
2025-06-06 09:23:45,565 - T:Avg	MAE	29.2483	RMSE	40.5552	MAPE	23.9160
2025-06-06 09:23:45,594 - Finished optimization, total time:1218.25 s, best model:log/CA/retrain_st_sd-42/2020/26.8949.pkl
2025-06-06 09:23:45,821 - 


2025-06-06 09:23:45,821 - 3   	 MAE	     22.85	     19.70	     28.36		   23.64
2025-06-06 09:23:45,821 - 3   	RMSE	     34.40	     30.41	     38.80		   34.54
2025-06-06 09:23:45,821 - 3   	MAPE	     16.62	     13.45	     22.97		   17.68
2025-06-06 09:23:45,821 - 6   	 MAE	     24.27	     21.78	     29.11		   25.05
2025-06-06 09:23:45,822 - 6   	RMSE	     37.25	     33.98	     40.39		   37.21
2025-06-06 09:23:45,822 - 6   	MAPE	     17.28	     15.47	     23.40		   18.71
2025-06-06 09:23:45,822 - 12  	 MAE	     28.17	     25.94	     30.71		   28.27
2025-06-06 09:23:45,822 - 12  	RMSE	     44.11	     40.57	     43.33		   42.67
2025-06-06 09:23:45,822 - 12  	MAPE	     19.65	     21.21	     26.16		   22.34
2025-06-06 09:23:45,822 - Avg 	 MAE	     24.77	     22.11	     29.25		   25.37
2025-06-06 09:23:45,822 - Avg 	RMSE	     37.99	     34.38	     40.56		   37.64
2025-06-06 09:23:45,822 - Avg 	MAPE	     17.64	     16.32	     23.92		   19.29
2025-06-06 09:23:45,822 - year	2019	total_time	 2090.9990	average_time	   95.0454	epoch	22
2025-06-06 09:23:45,822 - year	2020	total_time	 1218.2452	average_time	   93.7112	epoch	13
2025-06-06 09:23:45,822 - total time: 3309.2442
2025-06-06 09:23:57,796 - epoch:2, training loss:1594.8193 validation loss:25.0170
2025-06-06 09:30:02,906 - logger name:log/CA/eac-42/eac.log
2025-06-06 09:30:02,906 - params : {'conf': 'conf/CA/eac.json', 'seed': 42, 'paral': 0, 'gpuid': 4, 'logname': 'eac', 'method': 'EAC', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/CA/team-42/2017/29.315.pkl', 'device': device(type='cuda', index=4), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>, 'DLF': <class 'src.model.model.DLF_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/CA/finaldata/', 'save_data_path': 'data/CA/FastData/', 'graph_path': 'data/CA/graph/', 'model_path': 'log/CA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'rank': 6, 'train': 1, 'strategy': 'retrain', 'init': True, 'increase': True, 'num_hops': 2, 'detect': False, 'detect_strategy': 'feature', 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': False, 'replay_strategy': 'random', 'repaly_num_samples': 300, 'extra_feature': True, 'momentum_type': 'linear', 'memory_size': 32, 'path': 'log/CA/eac-42', 'logger': <Logger utils.initialize (INFO)>}
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 786857.75it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 827920.58it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 840299.74it/s]
2025-06-06 09:30:49,991 - epoch:3, training loss:1594.3758 validation loss:28.3680
2025-06-06 09:34:01,644 - [*] Year 2017 load from data/CA/FastData/2017.npz
2025-06-06 09:34:04,592 - [*] Year 2017 Dataset load!
2025-06-06 09:34:04,596 - Total Parameters: 52556
2025-06-06 09:34:04,596 - Trainable Parameters: 52556
2025-06-06 09:34:04,596 - [*] Year 2017 Training start
2025-06-06 09:34:06,483 - node number torch.Size([1049088, 12])
2025-06-06 09:37:07,991 - epoch:0, training loss:15400.8568 validation loss:43.2301
2025-06-06 09:37:42,088 - epoch:4, training loss:1596.4147 validation loss:26.8263
2025-06-06 09:40:11,976 - epoch:1, training loss:2416.5552 validation loss:33.6936
2025-06-06 09:43:16,690 - epoch:2, training loss:1991.6126 validation loss:37.7220
2025-06-06 09:44:31,864 - epoch:5, training loss:1593.8919 validation loss:30.1756
2025-06-06 09:46:20,462 - epoch:3, training loss:1893.8019 validation loss:32.1744
2025-06-06 09:49:25,121 - epoch:4, training loss:1815.6577 validation loss:35.2046
2025-06-06 09:51:21,638 - epoch:6, training loss:1594.0016 validation loss:28.3026
2025-06-06 09:52:28,828 - epoch:5, training loss:1763.4098 validation loss:35.9333
2025-06-06 09:55:32,560 - epoch:6, training loss:1749.6190 validation loss:36.5106
2025-06-06 09:58:12,269 - epoch:7, training loss:1593.9679 validation loss:24.5147
2025-06-06 09:58:36,450 - epoch:7, training loss:1737.1218 validation loss:33.7257
2025-06-06 10:01:40,130 - epoch:8, training loss:1737.7167 validation loss:30.4924
2025-06-06 10:04:43,934 - epoch:9, training loss:1739.1027 validation loss:37.6032
2025-06-06 10:05:02,652 - epoch:8, training loss:1594.8939 validation loss:25.5591
2025-06-06 10:07:47,682 - epoch:10, training loss:1735.3938 validation loss:35.0947
2025-06-06 10:10:52,754 - epoch:11, training loss:1720.2478 validation loss:30.4861
2025-06-06 10:11:54,194 - epoch:9, training loss:1599.6204 validation loss:27.3520
2025-06-06 10:13:57,373 - epoch:12, training loss:1725.6310 validation loss:32.9442
2025-06-06 10:17:01,376 - epoch:13, training loss:1723.7880 validation loss:35.9363
2025-06-06 10:18:44,969 - epoch:10, training loss:1593.5932 validation loss:26.0843
2025-06-06 10:20:05,343 - epoch:14, training loss:1722.2322 validation loss:29.9050
2025-06-06 10:23:09,500 - epoch:15, training loss:1717.6916 validation loss:31.8055
2025-06-06 10:25:33,027 - epoch:11, training loss:1594.3371 validation loss:27.2901
2025-06-06 10:26:13,762 - epoch:16, training loss:1708.0820 validation loss:33.3970
2025-06-06 10:29:18,658 - epoch:17, training loss:1714.0750 validation loss:33.8193
2025-06-06 10:32:23,643 - epoch:18, training loss:1709.3557 validation loss:31.6328
2025-06-06 10:32:23,770 - epoch:12, training loss:1596.1578 validation loss:24.9891
2025-06-06 10:35:29,068 - epoch:19, training loss:1711.8013 validation loss:30.0970
2025-06-06 10:38:36,081 - epoch:20, training loss:1702.8090 validation loss:31.0794
2025-06-06 10:39:15,552 - epoch:13, training loss:1595.0331 validation loss:27.1662
2025-06-06 10:39:31,549 - [*] loss:2164.3025
2025-06-06 10:39:54,784 - [*] year 2017, testing
2025-06-06 10:41:09,609 - T:3	MAE	23.9795	RMSE	36.9479	MAPE	18.8101
2025-06-06 10:43:04,393 - T:6	MAE	25.8576	RMSE	39.8918	MAPE	20.6396
2025-06-06 10:45:17,560 - [*] loss:1798.0883
2025-06-06 10:45:37,986 - [*] year 2019, testing
2025-06-06 10:47:05,633 - T:3	MAE	21.0383	RMSE	31.5977	MAPE	13.4942
2025-06-06 10:49:27,757 - T:12	MAE	29.7518	RMSE	45.7585	MAPE	24.8629
2025-06-06 10:49:27,758 - T:Avg	MAE	26.1915	RMSE	40.3392	MAPE	21.1316
2025-06-06 10:49:27,791 - Finished optimization, total time:2291.50 s, best model:log/CA/eac-42/2017/29.905.pkl
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 831880.65it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 1001850.31it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 937882.01it/s]
2025-06-06 11:18:46,316 - [*] Year 2018 load from data/CA/FastData/2018.npz
2025-06-06 11:18:46,985 - [*] Year 2018 Dataset load!
2025-06-06 11:18:46,985 - [*] load from log/CA/eac-42/2017/29.905.pkl
2025-06-06 11:18:47,002 - Total Parameters: 53948
2025-06-06 11:18:47,002 - Trainable Parameters: 50640
2025-06-06 11:18:47,003 - [*] Year 2018 Training start
2025-06-06 11:18:49,301 - node number torch.Size([1078784, 12])
2025-06-06 11:19:07,519 - T:6	MAE	23.3987	RMSE	35.2533	MAPE	14.8015
2025-06-06 11:21:45,337 - epoch:0, training loss:1921.6778 validation loss:29.6378
2025-06-06 11:24:44,569 - epoch:1, training loss:1805.6444 validation loss:30.8344
2025-06-06 11:24:49,465 - T:12	MAE	27.9346	RMSE	42.0860	MAPE	17.4733
2025-06-06 11:24:49,465 - T:Avg	MAE	23.7188	RMSE	35.6874	MAPE	15.0133
2025-06-06 11:24:49,495 - Finished optimization, total time:4150.72 s, best model:log/CA/team-42/2019/24.5147.pkl
2025-06-06 11:24:51,445 - [*] Year 2020 load from data/CA/FastData/2020.npz
2025-06-06 11:24:52,486 - [*] load from log/CA/team-42/2019/24.5147.pkl
2025-06-06 11:25:10,463 - The number of data points in the previous year is greater than the current year, skipping detection and replay.
2025-06-06 11:25:10,466 - The number of data points in the previous year is greater than the current year, skipping replay.
2025-06-06 11:25:12,950 - number of increase nodes:125, nodes after 2 hop:torch.Size([2420]), total nodes this year 8561
2025-06-06 11:27:47,271 - epoch:2, training loss:1800.1284 validation loss:29.3944
2025-06-06 11:27:50,803 - [*] Year 2020 Dataset load!
2025-06-06 11:27:50,804 - [*] load from log/CA/team-42/2019/24.5147.pkl
2025-06-06 11:27:50,839 - [*] EWC! lambda 0.001000
2025-06-06 11:30:48,298 - epoch:3, training loss:1791.5312 validation loss:29.6519
2025-06-06 11:33:48,975 - epoch:4, training loss:1792.1381 validation loss:30.1047
2025-06-06 11:36:50,949 - epoch:5, training loss:1787.3340 validation loss:29.6060
2025-06-06 11:39:52,303 - epoch:6, training loss:1783.2194 validation loss:29.1839
2025-06-06 11:42:53,036 - epoch:7, training loss:1794.1578 validation loss:31.4301
2025-06-06 11:43:27,919 - Total Parameters: 71948
2025-06-06 11:43:27,919 - Trainable Parameters: 71948
2025-06-06 11:43:27,920 - [*] Year 2020 Training start
2025-06-06 11:43:34,832 - node number torch.Size([38720, 12])
2025-06-06 11:45:53,715 - epoch:8, training loss:1783.5121 validation loss:30.3039
2025-06-06 11:48:54,590 - epoch:9, training loss:1776.9326 validation loss:30.1787
2025-06-06 11:49:07,461 - epoch:0, training loss:1743.9305 validation loss:27.9337
2025-06-06 11:51:55,769 - epoch:10, training loss:1775.5127 validation loss:29.6293
2025-06-06 11:54:51,460 - epoch:1, training loss:1750.4841 validation loss:33.9953
2025-06-06 11:54:56,879 - epoch:11, training loss:1777.4119 validation loss:30.3228
2025-06-06 11:57:58,895 - epoch:12, training loss:1773.1015 validation loss:29.4196
2025-06-06 11:58:56,458 - [*] loss:2184.5491
2025-06-06 11:59:04,289 - [*] year 2018, testing
2025-06-06 12:00:04,492 - T:3	MAE	23.4020	RMSE	37.9492	MAPE	16.9104
2025-06-06 12:00:33,580 - epoch:2, training loss:1752.9953 validation loss:33.9172
2025-06-06 12:01:56,498 - T:6	MAE	25.2011	RMSE	40.6652	MAPE	18.6397
2025-06-06 12:06:18,142 - epoch:3, training loss:1743.9894 validation loss:32.1506
2025-06-06 12:08:02,489 - T:12	MAE	28.8359	RMSE	45.9440	MAPE	22.7403
2025-06-06 12:08:02,490 - T:Avg	MAE	25.4838	RMSE	41.0311	MAPE	19.1208
2025-06-06 12:08:02,517 - Finished optimization, total time:1325.54 s, best model:log/CA/eac-42/2018/29.1839.pkl
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 962618.89it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 1006780.46it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 968891.23it/s]
2025-06-06 12:11:37,708 - [*] Year 2019 load from data/CA/FastData/2019.npz
2025-06-06 12:11:38,445 - [*] Year 2019 Dataset load!
2025-06-06 12:11:38,445 - [*] load from log/CA/eac-42/2018/29.1839.pkl
2025-06-06 12:11:38,451 - Total Parameters: 54980
2025-06-06 12:11:38,451 - Trainable Parameters: 51672
2025-06-06 12:11:38,452 - [*] Year 2019 Training start
2025-06-06 12:11:40,477 - node number torch.Size([1100800, 12])
2025-06-06 12:12:02,833 - epoch:4, training loss:1746.7906 validation loss:30.6763
2025-06-06 12:14:45,914 - epoch:0, training loss:1862.4872 validation loss:30.8355
2025-06-06 12:17:44,256 - epoch:5, training loss:1739.5347 validation loss:34.3259
2025-06-06 12:17:54,809 - epoch:1, training loss:1758.0068 validation loss:29.5863
2025-06-06 12:21:03,656 - epoch:2, training loss:1742.9617 validation loss:28.6999
2025-06-06 12:23:25,860 - epoch:6, training loss:1750.2743 validation loss:35.6752
2025-06-06 12:24:11,787 - epoch:3, training loss:1738.8156 validation loss:30.1506
2025-06-06 12:27:20,638 - epoch:4, training loss:1730.3258 validation loss:29.5700
2025-06-06 12:28:43,640 - [*] loss:2777.5261
2025-06-06 12:29:12,643 - [*] year 2020, testing
2025-06-06 12:30:33,988 - epoch:5, training loss:1731.9031 validation loss:28.7416
2025-06-06 12:30:37,686 - T:3	MAE	36.7881	RMSE	47.1807	MAPE	40.4449
2025-06-06 12:33:26,086 - T:6	MAE	38.1835	RMSE	49.5335	MAPE	41.7366
2025-06-06 12:33:45,385 - epoch:6, training loss:1728.1157 validation loss:29.5425
2025-06-06 12:37:00,410 - epoch:7, training loss:1727.5556 validation loss:29.9316
2025-06-06 12:40:19,352 - epoch:8, training loss:1723.5628 validation loss:29.8135
2025-06-06 12:41:19,640 - [*] loss:1731.6632
2025-06-06 12:41:26,979 - [*] year 2019, testing
2025-06-06 12:42:28,147 - T:3	MAE	21.3111	RMSE	32.6412	MAPE	15.7549
2025-06-06 12:42:50,731 - T:12	MAE	39.8093	RMSE	52.5517	MAPE	45.1162
2025-06-06 12:42:50,731 - T:Avg	MAE	38.0262	RMSE	49.3722	MAPE	42.0045
2025-06-06 12:42:50,763 - Finished optimization, total time:1714.97 s, best model:log/CA/team-42/2020/27.9337.pkl
2025-06-06 12:42:50,934 - 


2025-06-06 12:42:50,934 - 3   	 MAE	     21.53	     21.69	     21.04	     36.79		   25.26
2025-06-06 12:42:50,934 - 3   	RMSE	     32.45	     32.52	     31.60	     47.18		   35.94
2025-06-06 12:42:50,935 - 3   	MAPE	     15.38	     18.96	     13.49	     40.44		   22.07
2025-06-06 12:42:50,935 - 6   	 MAE	     23.66	     23.74	     23.40	     38.18		   27.24
2025-06-06 12:42:50,935 - 6   	RMSE	     35.94	     35.92	     35.25	     49.53		   39.16
2025-06-06 12:42:50,935 - 6   	MAPE	     16.07	     19.51	     14.80	     41.74		   23.03
2025-06-06 12:42:50,935 - 12  	 MAE	     27.90	     27.84	     27.93	     39.81		   30.87
2025-06-06 12:42:50,935 - 12  	RMSE	     42.57	     42.34	     42.09	     52.55		   44.89
2025-06-06 12:42:50,935 - 12  	MAPE	     18.03	     21.26	     17.47	     45.12		   25.47
2025-06-06 12:42:50,935 - Avg 	 MAE	     23.99	     24.04	     23.72	     38.03		   27.44
2025-06-06 12:42:50,935 - Avg 	RMSE	     36.38	     36.33	     35.69	     49.37		   39.44
2025-06-06 12:42:50,935 - Avg 	MAPE	     16.36	     19.75	     15.01	     42.00		   23.28
2025-06-06 12:42:50,935 - year	2018	total_time	 2185.6059	average_time	  312.2294	epoch	7
2025-06-06 12:42:50,935 - year	2019	total_time	 4150.7186	average_time	  296.4799	epoch	14
2025-06-06 12:42:50,935 - year	2020	total_time	 1714.9680	average_time	  244.9954	epoch	7
2025-06-06 12:42:50,935 - total time: 8051.2924
2025-06-06 12:44:20,691 - T:6	MAE	23.0108	RMSE	35.5510	MAPE	17.0428
2025-06-06 12:50:15,288 - T:12	MAE	26.5866	RMSE	41.1876	MAPE	20.4916
2025-06-06 12:50:15,288 - T:Avg	MAE	23.3207	RMSE	35.9474	MAPE	17.5099
2025-06-06 12:50:15,316 - Finished optimization, total time:968.83 s, best model:log/CA/eac-42/2019/28.6999.pkl
  0%|          | 0/21080 [00:00<?, ?it/s]100%|██████████| 21080/21080 [00:00<00:00, 903364.82it/s]
  0%|          | 0/21081 [00:00<?, ?it/s]100%|██████████| 21081/21081 [00:00<00:00, 968955.79it/s]
  0%|          | 0/21081 [00:00<?, ?it/s]100%|██████████| 21081/21081 [00:00<00:00, 982871.72it/s]
2025-06-06 12:53:10,715 - [*] Year 2020 load from data/CA/FastData/2020.npz
2025-06-06 12:53:11,393 - [*] Year 2020 Dataset load!
2025-06-06 12:53:11,393 - [*] load from log/CA/eac-42/2019/28.6999.pkl
2025-06-06 12:53:11,399 - Total Parameters: 54980
2025-06-06 12:53:11,399 - Trainable Parameters: 51672
2025-06-06 12:53:11,399 - [*] Year 2020 Training start
2025-06-06 12:53:14,208 - node number torch.Size([1095808, 12])
2025-06-06 12:56:15,763 - epoch:0, training loss:1669.3094 validation loss:29.3759
2025-06-06 12:59:20,727 - epoch:1, training loss:1630.2200 validation loss:28.8415
2025-06-06 13:02:27,278 - epoch:2, training loss:1623.8453 validation loss:30.8227
2025-06-06 13:05:31,951 - epoch:3, training loss:1617.8064 validation loss:30.0301
2025-06-06 13:08:37,642 - epoch:4, training loss:1616.7064 validation loss:28.2289
2025-06-06 13:11:42,564 - epoch:5, training loss:1610.2581 validation loss:28.8623
2025-06-06 13:14:48,201 - epoch:6, training loss:1610.5753 validation loss:28.9397
2025-06-06 13:17:53,451 - epoch:7, training loss:1607.8066 validation loss:30.6255
2025-06-06 13:21:00,301 - epoch:8, training loss:1606.8677 validation loss:29.2626
2025-06-06 13:24:04,729 - epoch:9, training loss:1604.4354 validation loss:29.8706
2025-06-06 13:27:09,152 - epoch:10, training loss:1603.7558 validation loss:29.5742
2025-06-06 13:28:08,049 - [*] loss:2088.8625
2025-06-06 13:28:15,441 - [*] year 2020, testing
2025-06-06 13:29:15,801 - T:3	MAE	29.7829	RMSE	41.3489	MAPE	24.5475
2025-06-06 13:31:09,192 - T:6	MAE	30.7908	RMSE	42.9056	MAPE	26.7407
2025-06-06 13:37:06,421 - T:12	MAE	32.3808	RMSE	45.4460	MAPE	31.1086
2025-06-06 13:37:06,422 - T:Avg	MAE	30.7976	RMSE	42.9277	MAPE	27.0831
2025-06-06 13:37:06,449 - Finished optimization, total time:1160.56 s, best model:log/CA/eac-42/2020/28.2289.pkl
2025-06-06 13:37:06,450 - 


2025-06-06 13:37:06,450 - 3   	 MAE	     23.98	     23.40	     21.31	     29.78		   24.62
2025-06-06 13:37:06,450 - 3   	RMSE	     36.95	     37.95	     32.64	     41.35		   37.22
2025-06-06 13:37:06,450 - 3   	MAPE	     18.81	     16.91	     15.75	     24.55		   19.01
2025-06-06 13:37:06,450 - 6   	 MAE	     25.86	     25.20	     23.01	     30.79		   26.22
2025-06-06 13:37:06,450 - 6   	RMSE	     39.89	     40.67	     35.55	     42.91		   39.75
2025-06-06 13:37:06,450 - 6   	MAPE	     20.64	     18.64	     17.04	     26.74		   20.77
2025-06-06 13:37:06,450 - 12  	 MAE	     29.75	     28.84	     26.59	     32.38		   29.39
2025-06-06 13:37:06,450 - 12  	RMSE	     45.76	     45.94	     41.19	     45.45		   44.58
2025-06-06 13:37:06,451 - 12  	MAPE	     24.86	     22.74	     20.49	     31.11		   24.80
2025-06-06 13:37:06,451 - Avg 	 MAE	     26.19	     25.48	     23.32	     30.80		   26.45
2025-06-06 13:37:06,451 - Avg 	RMSE	     40.34	     41.03	     35.95	     42.93		   40.06
2025-06-06 13:37:06,451 - Avg 	MAPE	     21.13	     19.12	     17.51	     27.08		   21.21
2025-06-06 13:37:06,451 - year	2017	total_time	 2291.4960	average_time	  109.1189	epoch	21
2025-06-06 13:37:06,451 - year	2018	total_time	 1325.5442	average_time	  101.9649	epoch	13
2025-06-06 13:37:06,451 - year	2019	total_time	  968.8322	average_time	  107.6480	epoch	9
2025-06-06 13:37:06,451 - year	2020	total_time	 1160.5636	average_time	  105.5058	epoch	11
2025-06-06 13:37:06,451 - total time: 5746.4360
2025-06-06 17:22:58,721 - logger name:log/GBA/stkec-42/stkec.log
2025-06-06 17:22:58,721 - params : {'conf': 'conf/GBA/stkec.json', 'seed': 42, 'paral': 0, 'gpuid': 5, 'logname': 'stkec', 'method': 'STKEC', 'load_first_year': 0, 'first_year_model_path': 'log/PEMS3/trafficStream-42/2011/16.6936.pkl', 'device': device(type='cuda', index=5), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 0, 'influe_length': 168, 'batch_influ_size': 4, 'beita': 1, 'cluster': 24, 'auto_test': 1, 'raw_data_path': 'data/GBA/finaldata/', 'save_data_path': 'data/GBA/FastData/', 'graph_path': 'data/GBA/graph/', 'model_path': 'log/GBA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'rank': 6, 'train': 1, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'detect_infl_strategy': True, 'infl_topk': 10, 'adp_adj': False, 'skip_dim': 64, 'end_dim': 64, 'hidden_channels': 32, 'dilation_channels': 64, 'residual_channels': 64, 'input_dim': 1, 'output_dim': 1, 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'replay_num_samples': 300, 'extra_feature': True, 'momentum_type': 'linear', 'memory_size': 32, 'path': 'log/GBA/stkec-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-06 17:22:58,883 - [*] Year 2017 load from data/GBA/FastData/2017.npz
2025-06-06 17:23:27,665 - [*] Year 2017 Dataset load!
2025-06-06 17:23:27,703 - [*] Year 2017 Training start
2025-06-06 17:23:28,735 - node number torch.Size([293632, 12])
/home/bd2/ANATS/Online_Baselines/utils/common_tools.py:63: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  tensor = torch.tensor(matrix)
2025-06-06 17:23:48,742 - epoch:0, training loss:11683.3376 validation loss:41.2888
2025-06-06 17:24:09,875 - epoch:1, training loss:2275.5668 validation loss:34.0305
2025-06-06 17:24:31,247 - epoch:2, training loss:2040.8881 validation loss:32.8076
2025-06-06 17:24:50,183 - epoch:3, training loss:1988.6867 validation loss:36.4517
2025-06-06 17:25:09,346 - epoch:4, training loss:1958.7395 validation loss:32.5718
2025-06-06 17:25:24,059 - logger name:log/GBA/pecpm-42/pecpm.log
2025-06-06 17:25:24,060 - params : {'conf': 'conf/GBA/pecpm.json', 'seed': 42, 'paral': 0, 'gpuid': 2, 'logname': 'pecpm', 'method': 'PECPM', 'load_first_year': 0, 'first_year_model_path': 'log/SD/pecpm-42/2017/31.5668.pkl', 'device': device(type='cuda', index=2), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'PECPM': <class 'src.model.model.PECPM_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'beita': 1.0, 'cluster': 32, 'raw_data_path': 'data/GBA/finaldata/', 'save_data_path': 'data/GBA/FastData/', 'graph_path': 'data/GBA/graph/', 'model_path': 'log/GBA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'train': 1, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'adp_adj': False, 'skip_dim': 64, 'end_dim': 64, 'hidden_channels': 32, 'dilation_channels': 64, 'residual_channels': 64, 'input_dim': 1, 'output_dim': 1, 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 300, 'path': 'log/GBA/pecpm-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-06 17:25:24,191 - [*] Year 2017 load from data/GBA/FastData/2017.npz
Traceback (most recent call last):
  File "/home/bd2/ANATS/Online_Baselines/pecpm_main.py", line 169, in <module>
    main(args) 
    ^^^^^^^^^^
  File "/home/bd2/ANATS/Online_Baselines/pecpm_main.py", line 42, in main
    vars(args)["adj"] = torch.from_numpy(adj).to(torch.float).to(args.device)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: out of memory
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

2025-06-06 17:25:30,532 - epoch:5, training loss:1931.5809 validation loss:33.5667
2025-06-06 17:25:38,592 - logger name:log/GBA/pecpm-42/pecpm.log
2025-06-06 17:25:38,592 - params : {'conf': 'conf/GBA/pecpm.json', 'seed': 42, 'paral': 0, 'gpuid': 6, 'logname': 'pecpm', 'method': 'PECPM', 'load_first_year': 0, 'first_year_model_path': 'log/SD/pecpm-42/2017/31.5668.pkl', 'device': device(type='cuda', index=6), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'PECPM': <class 'src.model.model.PECPM_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'beita': 1.0, 'cluster': 32, 'raw_data_path': 'data/GBA/finaldata/', 'save_data_path': 'data/GBA/FastData/', 'graph_path': 'data/GBA/graph/', 'model_path': 'log/GBA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'train': 1, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'adp_adj': False, 'skip_dim': 64, 'end_dim': 64, 'hidden_channels': 32, 'dilation_channels': 64, 'residual_channels': 64, 'input_dim': 1, 'output_dim': 1, 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 300, 'path': 'log/GBA/pecpm-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-06 17:25:38,718 - [*] Year 2017 load from data/GBA/FastData/2017.npz
Traceback (most recent call last):
  File "/home/bd2/ANATS/Online_Baselines/pecpm_main.py", line 169, in <module>
    main(args) 
    ^^^^^^^^^^
  File "/home/bd2/ANATS/Online_Baselines/pecpm_main.py", line 120, in main
    train(inputs, args)
  File "/home/bd2/ANATS/Online_Baselines/src/trainer/pecpm_trainer.py", line 35, in train
    attention = np.load(pathatt)
                ^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/numpy/lib/_npyio_impl.py", line 451, in load
    fid = stack.enter_context(open(os.fspath(file), "rb"))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'data/CA/attetion/2017_attention.npy'
2025-06-06 17:25:52,495 - epoch:6, training loss:1885.9933 validation loss:35.4202
2025-06-06 17:26:14,275 - epoch:7, training loss:1862.7292 validation loss:38.2871
2025-06-06 17:26:34,457 - epoch:8, training loss:1854.8007 validation loss:34.4765
2025-06-06 17:26:53,909 - epoch:9, training loss:1846.0252 validation loss:31.7964
2025-06-06 17:27:15,740 - epoch:10, training loss:1835.6321 validation loss:35.3636
2025-06-06 17:27:38,217 - epoch:11, training loss:1822.1738 validation loss:30.8536
2025-06-06 17:27:57,573 - epoch:12, training loss:1818.1390 validation loss:33.6854
2025-06-06 17:28:18,012 - epoch:13, training loss:1832.4610 validation loss:31.6657
2025-06-06 17:28:37,577 - epoch:14, training loss:1821.6750 validation loss:34.6222
2025-06-06 17:28:59,286 - epoch:15, training loss:1824.5184 validation loss:31.3168
2025-06-06 17:29:31,146 - epoch:16, training loss:1809.9057 validation loss:31.1437
2025-06-06 17:29:51,229 - epoch:17, training loss:1810.0454 validation loss:31.4379
2025-06-06 17:29:58,458 - [*] loss:1832.4797
2025-06-06 17:30:05,736 - [*] year 2017, testing
2025-06-06 17:30:35,390 - T:3	MAE	21.9616	RMSE	33.8113	MAPE	14.1791
2025-06-06 17:31:07,107 - T:6	MAE	24.0304	RMSE	36.8348	MAPE	16.0647
2025-06-06 17:34:05,363 - T:12	MAE	28.0967	RMSE	42.6161	MAPE	20.2105
2025-06-06 17:34:05,364 - T:Avg	MAE	24.3475	RMSE	37.2432	MAPE	16.4712
2025-06-06 17:34:05,374 - Finished optimization, total time:205.61 s, best model:log/GBA/stkec-42/2017/30.8536.pkl
2025-06-06 17:34:05,648 - [*] Year 2018 load from data/GBA/FastData/2018.npz
2025-06-06 17:34:05,736 - [*] load from log/GBA/stkec-42/2017/30.8536.pkl
2025-06-06 17:34:05,819 - [*] detect strategy feature
2025-06-06 17:34:24,136 - number of increase nodes:306, nodes after 2 hop:torch.Size([2077]), total nodes this year 2321
2025-06-06 17:38:35,966 - [*] Year 2018 Dataset load!
2025-06-06 17:38:35,966 - [*] load from log/GBA/stkec-42/2017/30.8536.pkl
2025-06-06 17:38:35,991 - [*] EWC! lambda 0.000100
2025-06-06 17:40:33,206 - [*] Year 2018 Training start
2025-06-06 17:40:39,523 - node number torch.Size([265856, 12])
2025-06-06 17:40:59,323 - epoch:0, training loss:1894.2764 validation loss:27.1258
2025-06-06 17:41:25,928 - epoch:1, training loss:1674.2818 validation loss:29.5308
2025-06-06 17:41:52,076 - epoch:2, training loss:1682.0733 validation loss:26.8011
2025-06-06 17:42:15,271 - epoch:3, training loss:1686.1122 validation loss:28.0806
2025-06-06 17:42:36,650 - epoch:4, training loss:1685.8518 validation loss:26.9536
2025-06-06 17:43:00,179 - epoch:5, training loss:1698.5538 validation loss:26.7426
2025-06-06 17:43:24,158 - epoch:6, training loss:1687.5042 validation loss:27.5770
2025-06-06 17:43:49,601 - epoch:7, training loss:1712.2042 validation loss:27.1849
2025-06-06 17:44:15,350 - epoch:8, training loss:1695.4079 validation loss:26.6172
2025-06-06 17:44:39,463 - epoch:9, training loss:1691.8933 validation loss:34.0483
2025-06-06 17:45:00,518 - epoch:10, training loss:1706.2378 validation loss:30.9994
2025-06-06 17:45:23,963 - epoch:11, training loss:1685.3019 validation loss:32.1459
2025-06-06 17:45:46,865 - epoch:12, training loss:1699.3936 validation loss:26.5960
2025-06-06 17:46:07,951 - epoch:13, training loss:1689.8491 validation loss:32.1799
2025-06-06 17:46:33,790 - epoch:14, training loss:1705.3482 validation loss:27.2986
2025-06-06 17:46:58,668 - epoch:15, training loss:1694.9447 validation loss:28.0287
2025-06-06 17:47:21,260 - epoch:16, training loss:1713.7159 validation loss:27.5363
2025-06-06 17:47:45,196 - epoch:17, training loss:1697.6166 validation loss:30.2730
2025-06-06 17:48:07,925 - epoch:18, training loss:1688.4737 validation loss:28.5343
2025-06-06 17:48:20,783 - [*] loss:2126.2852
2025-06-06 17:49:12,850 - [*] year 2018, testing
2025-06-06 17:49:27,218 - T:3	MAE	22.6546	RMSE	35.6351	MAPE	16.2216
2025-06-06 17:51:35,642 - T:6	MAE	24.8179	RMSE	38.8373	MAPE	18.2797
2025-06-06 17:55:17,880 - T:12	MAE	29.0797	RMSE	44.8776	MAPE	22.6158
2025-06-06 17:55:17,881 - T:Avg	MAE	25.1538	RMSE	39.2522	MAPE	18.6759
2025-06-06 17:55:17,914 - Finished optimization, total time:282.93 s, best model:log/GBA/stkec-42/2018/26.596.pkl
2025-06-06 17:55:18,239 - [*] Year 2019 load from data/GBA/FastData/2019.npz
2025-06-06 17:55:18,296 - [*] load from log/GBA/stkec-42/2018/26.596.pkl
2025-06-06 17:55:18,363 - [*] detect strategy feature
2025-06-06 17:55:38,779 - number of increase nodes:315, nodes after 2 hop:torch.Size([2070]), total nodes this year 2352
2025-06-06 17:57:10,902 - [*] Year 2019 Dataset load!
2025-06-06 17:57:10,902 - [*] load from log/GBA/stkec-42/2018/26.596.pkl
2025-06-06 17:57:10,929 - [*] EWC! lambda 0.000100
2025-06-06 18:03:35,223 - [*] Year 2019 Training start
2025-06-06 18:03:42,901 - node number torch.Size([264960, 12])
2025-06-06 18:04:05,512 - epoch:0, training loss:2075.4838 validation loss:32.1322
2025-06-06 18:04:34,045 - epoch:1, training loss:1928.1019 validation loss:31.0701
2025-06-06 18:05:01,288 - epoch:2, training loss:1914.1864 validation loss:29.3366
2025-06-06 18:05:29,443 - epoch:3, training loss:1917.6996 validation loss:31.8149
2025-06-06 18:05:57,614 - epoch:4, training loss:1916.6976 validation loss:42.0708
2025-06-06 18:06:27,347 - epoch:5, training loss:1945.2457 validation loss:27.7046
2025-06-06 18:06:56,350 - epoch:6, training loss:1927.6907 validation loss:31.5420
2025-06-06 18:07:24,820 - epoch:7, training loss:1938.1377 validation loss:28.5557
2025-06-06 18:07:54,462 - epoch:8, training loss:1929.3901 validation loss:28.1508
2025-06-06 18:08:22,520 - epoch:9, training loss:1919.9826 validation loss:37.1792
2025-06-06 18:08:51,596 - epoch:10, training loss:1930.4104 validation loss:28.3237
2025-06-06 18:09:21,582 - epoch:11, training loss:1937.1087 validation loss:31.1705
2025-06-06 18:09:35,903 - [*] loss:1783.1316
2025-06-06 18:10:26,312 - [*] year 2019, testing
2025-06-06 18:10:42,006 - T:3	MAE	20.7821	RMSE	32.5465	MAPE	13.0889
2025-06-06 18:17:16,819 - T:6	MAE	22.8684	RMSE	35.7640	MAPE	14.5550
2025-06-06 18:37:19,775 - T:12	MAE	26.9163	RMSE	41.7179	MAPE	18.0410
2025-06-06 18:37:19,776 - T:Avg	MAE	23.1603	RMSE	36.1297	MAPE	14.9350
2025-06-06 18:37:19,827 - Finished optimization, total time:206.55 s, best model:log/GBA/stkec-42/2019/27.7046.pkl
2025-06-06 18:37:20,295 - [*] Year 2020 load from data/GBA/FastData/2020.npz
2025-06-06 18:37:20,373 - [*] load from log/GBA/stkec-42/2019/27.7046.pkl
2025-06-06 18:37:20,589 - [*] detect strategy feature
2025-06-06 18:37:52,928 - number of increase nodes:286, nodes after 2 hop:torch.Size([2069]), total nodes this year 2352
2025-06-06 18:39:06,508 - [*] Year 2020 Dataset load!
2025-06-06 18:39:06,509 - [*] load from log/GBA/stkec-42/2019/27.7046.pkl
2025-06-06 18:39:06,517 - [*] EWC! lambda 0.000100
2025-06-06 18:39:40,068 - [*] Year 2020 Training start
2025-06-06 18:39:45,729 - node number torch.Size([264832, 12])
2025-06-06 18:40:04,910 - epoch:0, training loss:2145.5864 validation loss:31.3493
2025-06-06 18:40:36,130 - epoch:1, training loss:1751.5439 validation loss:29.4004
2025-06-06 18:41:09,132 - epoch:2, training loss:1744.7325 validation loss:32.4923
2025-06-06 18:41:42,030 - epoch:3, training loss:1745.4098 validation loss:32.8626
2025-06-06 18:42:14,278 - epoch:4, training loss:1744.2639 validation loss:34.0392
2025-06-06 18:42:46,871 - epoch:5, training loss:1742.8470 validation loss:27.8290
2025-06-06 18:43:19,899 - epoch:6, training loss:1747.3494 validation loss:32.1993
2025-06-06 18:43:51,033 - epoch:7, training loss:1763.0607 validation loss:33.6287
2025-06-06 18:44:22,090 - epoch:8, training loss:1765.5781 validation loss:27.3486
2025-06-06 18:44:53,383 - epoch:9, training loss:1735.9365 validation loss:33.7739
2025-06-06 18:45:27,111 - epoch:10, training loss:1751.8122 validation loss:34.8674
2025-06-06 18:46:01,029 - epoch:11, training loss:1752.7128 validation loss:30.7496
2025-06-06 18:46:29,942 - epoch:12, training loss:1741.1437 validation loss:30.8590
2025-06-06 18:47:02,386 - epoch:13, training loss:1734.3969 validation loss:31.4694
2025-06-06 18:47:37,428 - epoch:14, training loss:1739.7286 validation loss:32.7726
2025-06-06 18:47:59,145 - [*] loss:1733.0695
2025-06-06 18:55:09,523 - [*] year 2020, testing
2025-06-06 19:07:33,350 - T:3	MAE	26.3152	RMSE	37.1450	MAPE	16.3459
2025-06-06 19:18:09,838 - T:6	MAE	26.8841	RMSE	38.3368	MAPE	17.2426
2025-06-06 19:20:00,145 - T:12	MAE	28.6688	RMSE	41.4073	MAPE	19.3825
2025-06-06 19:20:00,146 - T:Avg	MAE	27.1175	RMSE	38.6582	MAPE	17.4595
2025-06-06 19:20:00,335 - Finished optimization, total time:276.23 s, best model:log/GBA/stkec-42/2020/27.3486.pkl
2025-06-06 19:20:00,420 - 


2025-06-06 19:20:00,421 - 3   	 MAE	     21.96	     22.65	     20.78	     26.32		   22.93
2025-06-06 19:20:00,421 - 3   	RMSE	     33.81	     35.64	     32.55	     37.14		   34.78
2025-06-06 19:20:00,421 - 3   	MAPE	     14.18	     16.22	     13.09	     16.35		   14.96
2025-06-06 19:20:00,421 - 6   	 MAE	     24.03	     24.82	     22.87	     26.88		   24.65
2025-06-06 19:20:00,421 - 6   	RMSE	     36.83	     38.84	     35.76	     38.34		   37.44
2025-06-06 19:20:00,421 - 6   	MAPE	     16.06	     18.28	     14.55	     17.24		   16.54
2025-06-06 19:20:00,421 - 12  	 MAE	     28.10	     29.08	     26.92	     28.67		   28.19
2025-06-06 19:20:00,421 - 12  	RMSE	     42.62	     44.88	     41.72	     41.41		   42.65
2025-06-06 19:20:00,421 - 12  	MAPE	     20.21	     22.62	     18.04	     19.38		   20.06
2025-06-06 19:20:00,421 - Avg 	 MAE	     24.35	     25.15	     23.16	     27.12		   24.94
2025-06-06 19:20:00,421 - Avg 	RMSE	     37.24	     39.25	     36.13	     38.66		   37.82
2025-06-06 19:20:00,421 - Avg 	MAPE	     16.47	     18.68	     14.93	     17.46		   16.89
2025-06-06 19:20:00,421 - year	2017	total_time	  205.6129	average_time	   11.4229	epoch	18
2025-06-06 19:20:00,421 - year	2018	total_time	  282.9348	average_time	   14.8913	epoch	19
2025-06-06 19:20:00,422 - year	2019	total_time	  206.5543	average_time	   17.2129	epoch	12
2025-06-06 19:20:00,422 - year	2020	total_time	  276.2282	average_time	   18.4153	epoch	15
2025-06-06 19:20:00,422 - total time: 971.3303
Processing year 2017
input data shape: (105120, 8196)
attention label shape: (861563520, 32)
saved attention label for year 2017
Processing year 2018
input data shape: (105120, 8428)
attention label shape: (885951360, 32)
saved attention label for year 2018
Processing year 2019
input data shape: (105120, 8600)
attention label shape: (904032000, 32)
saved attention label for year 2019
Processing year 2020
input data shape: (105408, 8561)
attention label shape: (902397888, 32)
saved attention label for year 2020
2025-06-07 00:08:04,491 - logger name:log/CA/stkec-42/stkec.log
2025-06-07 00:08:04,491 - params : {'conf': 'conf/CA/stkec.json', 'seed': 42, 'paral': 0, 'gpuid': 5, 'logname': 'stkec', 'method': 'STKEC', 'load_first_year': 0, 'first_year_model_path': 'log/PEMS3/trafficStream-42/2011/16.6936.pkl', 'device': device(type='cuda', index=5), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 0, 'influe_length': 168, 'batch_influ_size': 4, 'beita': 1, 'cluster': 24, 'auto_test': 1, 'raw_data_path': 'data/CA/finaldata/', 'save_data_path': 'data/CA/FastData/', 'graph_path': 'data/CA/graph/', 'model_path': 'log/CA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'rank': 6, 'train': 1, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'detect_infl_strategy': True, 'infl_topk': 10, 'adp_adj': False, 'skip_dim': 64, 'end_dim': 64, 'hidden_channels': 32, 'dilation_channels': 64, 'residual_channels': 64, 'input_dim': 1, 'output_dim': 1, 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'replay_num_samples': 300, 'extra_feature': True, 'momentum_type': 'linear', 'memory_size': 32, 'path': 'log/CA/stkec-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-07 00:08:05,609 - [*] Year 2017 load from data/CA/FastData/2017.npz
2025-06-07 00:08:08,523 - logger name:log/GBA/pecpm-42/pecpm.log
2025-06-07 00:08:08,524 - params : {'conf': 'conf/GBA/pecpm.json', 'seed': 42, 'paral': 0, 'gpuid': 6, 'logname': 'pecpm', 'method': 'PECPM', 'load_first_year': 0, 'first_year_model_path': 'log/SD/pecpm-42/2017/31.5668.pkl', 'device': device(type='cuda', index=6), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'PECPM': <class 'src.model.model.PECPM_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'beita': 1.0, 'cluster': 32, 'raw_data_path': 'data/GBA/finaldata/', 'save_data_path': 'data/GBA/FastData/', 'graph_path': 'data/GBA/graph/', 'model_path': 'log/GBA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'train': 1, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'adp_adj': False, 'skip_dim': 64, 'end_dim': 64, 'hidden_channels': 32, 'dilation_channels': 64, 'residual_channels': 64, 'input_dim': 1, 'output_dim': 1, 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 300, 'path': 'log/GBA/pecpm-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-07 00:08:08,682 - [*] Year 2017 load from data/GBA/FastData/2017.npz
2025-06-07 00:08:36,971 - logger name:log/CA/pecpm-42/pecpm.log
2025-06-07 00:08:36,971 - params : {'conf': 'conf/CA/pecpm.json', 'seed': 42, 'paral': 0, 'gpuid': 6, 'logname': 'pecpm', 'method': 'PECPM', 'load_first_year': 0, 'first_year_model_path': 'log/SD/pecpm-42/2017/31.5668.pkl', 'device': device(type='cuda', index=6), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'PECPM': <class 'src.model.model.PECPM_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 32, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'beita': 1.0, 'cluster': 32, 'raw_data_path': 'data/CA/finaldata/', 'save_data_path': 'data/CA/FastData/', 'graph_path': 'data/CA/graph/', 'model_path': 'log/CA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'train': 1, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'adp_adj': False, 'skip_dim': 64, 'end_dim': 64, 'hidden_channels': 32, 'dilation_channels': 64, 'residual_channels': 64, 'input_dim': 1, 'output_dim': 1, 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 300, 'path': 'log/CA/pecpm-42', 'logger': <Logger utils.initialize (INFO)>}
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 865896.64it/s]
2025-06-07 00:09:22,703 - logger name:log/CA/pecpm-42/pecpm.log
2025-06-07 00:09:22,703 - params : {'conf': 'conf/CA/pecpm.json', 'seed': 42, 'paral': 0, 'gpuid': 6, 'logname': 'pecpm', 'method': 'PECPM', 'load_first_year': 0, 'first_year_model_path': 'log/SD/pecpm-42/2017/31.5668.pkl', 'device': device(type='cuda', index=6), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'PECPM': <class 'src.model.model.PECPM_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 32, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'beita': 1.0, 'cluster': 32, 'raw_data_path': 'data/CA/finaldata/', 'save_data_path': 'data/CA/FastData/', 'graph_path': 'data/CA/graph/', 'model_path': 'log/CA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'train': 1, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'adp_adj': False, 'skip_dim': 64, 'end_dim': 64, 'hidden_channels': 32, 'dilation_channels': 64, 'residual_channels': 64, 'input_dim': 1, 'output_dim': 1, 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 300, 'path': 'log/CA/pecpm-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-07 00:09:23,640 - [*] Year 2017 load from data/CA/FastData/2017.npz
2025-06-07 00:10:59,966 - [*] Year 2017 Dataset load!
2025-06-07 00:11:00,001 - [*] Year 2017 Training start
2025-06-07 00:11:03,317 - node number torch.Size([1049088, 12])
/home/bd2/ANATS/Online_Baselines/utils/common_tools.py:63: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  tensor = torch.tensor(matrix)
2025-06-07 00:14:12,297 - epoch:0, training loss:12421.2377 validation loss:39.2177
2025-06-07 00:17:09,422 - epoch:1, training loss:2164.9029 validation loss:32.3056
2025-06-07 00:18:24,123 - [*] Year 2017 Dataset load!
2025-06-07 00:18:24,349 - [*] Year 2017 Training start
2025-06-07 00:18:30,481 - node number torch.Size([262272, 12])
2025-06-07 00:20:44,485 - epoch:2, training loss:1934.6036 validation loss:32.1123
2025-06-07 00:20:59,351 - epoch:0, training loss:6081.6688 validation loss:30.4678
2025-06-07 00:23:41,188 - epoch:1, training loss:1944.8705 validation loss:30.5892
2025-06-07 00:23:47,705 - epoch:3, training loss:1892.8002 validation loss:34.6708
2025-06-07 00:26:18,810 - epoch:2, training loss:1867.6121 validation loss:32.9352
2025-06-07 00:26:48,005 - epoch:4, training loss:1863.9979 validation loss:31.3187
2025-06-07 00:28:59,555 - epoch:3, training loss:1860.2216 validation loss:32.0582
2025-06-07 00:29:48,453 - epoch:5, training loss:1844.8337 validation loss:31.6132
2025-06-07 00:31:37,633 - epoch:4, training loss:1859.3117 validation loss:29.3803
2025-06-07 00:32:49,277 - epoch:6, training loss:1790.0255 validation loss:32.6727
2025-06-07 00:34:17,095 - epoch:5, training loss:1850.0556 validation loss:31.0986
2025-06-07 00:35:49,703 - epoch:7, training loss:1763.9873 validation loss:36.0871
2025-06-07 00:36:56,638 - epoch:6, training loss:1803.0544 validation loss:35.4646
2025-06-07 00:38:50,464 - epoch:8, training loss:1754.6091 validation loss:32.0663
2025-06-07 00:39:35,201 - epoch:7, training loss:1773.4331 validation loss:29.4309
2025-06-07 00:41:50,891 - epoch:9, training loss:1746.7149 validation loss:30.8810
2025-06-07 00:42:13,694 - epoch:8, training loss:1758.3045 validation loss:29.9548
2025-06-07 00:44:49,211 - epoch:9, training loss:1750.6798 validation loss:28.3891
2025-06-07 00:44:52,107 - epoch:10, training loss:1738.9649 validation loss:34.3613
2025-06-07 00:47:28,077 - epoch:10, training loss:1754.6168 validation loss:29.0000
2025-06-07 00:47:52,765 - epoch:11, training loss:1726.6297 validation loss:29.9675
2025-06-07 00:50:04,589 - epoch:11, training loss:1738.6698 validation loss:29.4276
2025-06-07 00:50:53,590 - epoch:12, training loss:1721.3574 validation loss:28.6593
2025-06-07 00:53:01,594 - epoch:12, training loss:1735.3100 validation loss:31.7326
2025-06-07 00:53:58,421 - epoch:13, training loss:1713.6722 validation loss:30.6408
2025-06-07 00:56:10,014 - epoch:13, training loss:1716.4410 validation loss:32.9464
2025-06-07 00:57:07,459 - epoch:14, training loss:1736.0390 validation loss:31.9532
2025-06-07 00:58:48,652 - epoch:14, training loss:1724.3194 validation loss:31.3071
2025-06-07 01:00:09,554 - epoch:15, training loss:1715.4900 validation loss:29.8306
2025-06-07 01:01:35,605 - epoch:15, training loss:1715.5241 validation loss:33.2489
2025-06-07 01:02:34,510 - [*] loss:1777.7046
2025-06-07 01:03:04,563 - [*] year 2017, testing
2025-06-07 01:03:15,482 - epoch:16, training loss:1715.9880 validation loss:29.9676
2025-06-07 01:06:31,665 - epoch:17, training loss:1709.2776 validation loss:31.0722
2025-06-07 01:07:28,391 - T:3	MAE	20.6454	RMSE	31.6555	MAPE	13.6154
2025-06-07 01:10:44,131 - epoch:18, training loss:1709.8451 validation loss:33.1704
2025-06-07 01:11:42,455 - [*] loss:1784.5984
2025-06-07 01:11:52,590 - [*] year 2017, testing
2025-06-07 01:12:00,154 - T:6	MAE	22.6253	RMSE	34.9587	MAPE	15.2391
2025-06-07 01:13:04,126 - T:3	MAE	22.4949	RMSE	32.5181	MAPE	17.9781
2025-06-07 02:03:31,151 - T:6	MAE	24.0319	RMSE	35.5478	MAPE	17.8021
2025-06-07 02:06:27,000 - T:12	MAE	26.7374	RMSE	41.2785	MAPE	19.2221
2025-06-07 02:06:27,001 - T:Avg	MAE	22.9666	RMSE	35.3773	MAPE	15.7035
2025-06-07 02:06:27,033 - Finished optimization, total time:1461.05 s, best model:log/CA/pecpm-42/2017/28.3891.pkl
2025-06-07 02:06:29,853 - [*] Year 2018 load from data/CA/FastData/2018.npz
2025-06-07 02:06:30,524 - [*] load from log/CA/pecpm-42/2017/28.3891.pkl
2025-06-07 02:06:31,794 - [*] detect strategy feature
2025-06-07 02:07:03,248 - number of increase nodes:1067, nodes after 2 hop:torch.Size([6708]), total nodes this year 8428
2025-06-07 02:09:39,703 - T:12	MAE	27.3712	RMSE	41.4076	MAPE	19.6531
2025-06-07 02:09:39,704 - T:Avg	MAE	24.3262	RMSE	35.9472	MAPE	18.3896
2025-06-07 02:09:39,732 - Finished optimization, total time:1986.26 s, best model:log/CA/stkec-42/2017/28.6593.pkl
2025-06-07 02:09:42,422 - [*] Year 2018 load from data/CA/FastData/2018.npz
2025-06-07 02:09:43,114 - [*] load from log/CA/stkec-42/2017/28.6593.pkl
2025-06-07 02:09:44,359 - [*] detect strategy feature
2025-06-07 02:10:33,444 - number of increase nodes:842, nodes after 2 hop:torch.Size([6256]), total nodes this year 8428
2025-06-07 03:26:43,676 - [*] Year 2018 Dataset load!
2025-06-07 03:26:43,685 - [*] load from log/CA/stkec-42/2017/28.6593.pkl
2025-06-07 03:26:43,806 - [*] EWC! lambda 0.000100
2025-06-07 03:55:11,336 - logger name:log/CA/pecpm-42/pecpm.log
2025-06-07 03:55:11,337 - params : {'conf': 'conf/CA/pecpm.json', 'seed': 42, 'paral': 0, 'gpuid': 6, 'logname': 'pecpm', 'method': 'PECPM', 'load_first_year': 1, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/CA/pecpm-42/2017/28.3891.pkl', 'device': device(type='cuda', index=6), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'PECPM': <class 'src.model.model.PECPM_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 32, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'beita': 1.0, 'cluster': 32, 'raw_data_path': 'data/CA/finaldata/', 'save_data_path': 'data/CA/FastData/', 'graph_path': 'data/CA/graph/', 'model_path': 'log/CA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'train': 1, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'adp_adj': False, 'skip_dim': 64, 'end_dim': 64, 'hidden_channels': 32, 'dilation_channels': 64, 'residual_channels': 64, 'input_dim': 1, 'output_dim': 1, 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 300, 'path': 'log/CA/pecpm-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-07 03:55:12,785 - [*] Year 2017 load from data/CA/FastData/2017.npz
2025-06-07 03:55:13,656 - [*] load from /home/bd2/ANATS/Online_Baselines/log/CA/pecpm-42/2017/28.3891.pkl
2025-06-07 03:55:54,095 - logger name:log/CA/stkec-42/stkec.log
2025-06-07 03:55:54,095 - params : {'conf': 'conf/CA/stkec.json', 'seed': 42, 'paral': 0, 'gpuid': 5, 'logname': 'stkec', 'method': 'STKEC', 'load_first_year': 1, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/CA/stkec-42/2017/28.6593.pkl', 'device': device(type='cuda', index=5), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 0, 'influe_length': 168, 'batch_influ_size': 4, 'beita': 1, 'cluster': 24, 'auto_test': 1, 'raw_data_path': 'data/CA/finaldata/', 'save_data_path': 'data/CA/FastData/', 'graph_path': 'data/CA/graph/', 'model_path': 'log/CA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'rank': 6, 'train': 1, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'detect_infl_strategy': True, 'infl_topk': 10, 'adp_adj': False, 'skip_dim': 64, 'end_dim': 64, 'hidden_channels': 32, 'dilation_channels': 64, 'residual_channels': 64, 'input_dim': 1, 'output_dim': 1, 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'replay_num_samples': 300, 'extra_feature': True, 'momentum_type': 'linear', 'memory_size': 32, 'path': 'log/CA/stkec-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-07 03:55:54,992 - [*] Year 2017 load from data/CA/FastData/2017.npz
2025-06-07 03:56:07,954 - [*] load from /home/bd2/ANATS/Online_Baselines/log/CA/stkec-42/2017/28.6593.pkl
Traceback (most recent call last):
  File "/home/bd2/ANATS/Online_Baselines/pecpm_main.py", line 169, in <module>
    main(args) 
    ^^^^^^^^^^
  File "/home/bd2/ANATS/Online_Baselines/pecpm_main.py", line 51, in main
    test_model(model, args, test_loader, pin_memory=True)
  File "/home/bd2/ANATS/Online_Baselines/src/trainer/pecpm_trainer.py", line 181, in test_model
    for data in testset:
                ^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 733, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 1515, in _next_data
    return self._process_data(data, worker_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 1550, in _process_data
    data.reraise()
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/_utils.py", line 750, in reraise
    raise exception
IndexError: Caught IndexError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/utils/data/_utils/worker.py", line 349, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/home/bd2/ANATS/Online_Baselines/src/dataer/PecpmDataset.py", line 23, in __getitem__
    att = torch.Tensor(self.att[index])
                       ~~~~~~~~^^^^^^^
IndexError: string index out of range

2025-06-07 03:57:23,719 - [*] loss:1784.5984
2025-06-07 03:57:30,024 - [*] year 2017, testing
2025-06-07 03:58:26,922 - T:3	MAE	22.4949	RMSE	32.5181	MAPE	17.9781
2025-06-07 04:00:15,158 - T:6	MAE	24.0319	RMSE	35.5478	MAPE	17.8021
2025-06-07 04:06:13,635 - T:12	MAE	27.3712	RMSE	41.4076	MAPE	19.6531
2025-06-07 04:06:13,636 - T:Avg	MAE	24.3262	RMSE	35.9472	MAPE	18.3896
2025-06-07 04:06:15,310 - [*] Year 2018 load from data/CA/FastData/2018.npz
2025-06-07 04:06:15,977 - [*] load from /home/bd2/ANATS/Online_Baselines/log/CA/stkec-42/2017/28.6593.pkl
2025-06-07 04:06:16,685 - [*] detect strategy feature
2025-06-07 04:07:00,385 - number of increase nodes:842, nodes after 2 hop:torch.Size([6256]), total nodes this year 8428
2025-06-07 04:10:00,358 - [*] Year 2018 Dataset load!
2025-06-07 04:10:00,358 - [*] load from /home/bd2/ANATS/Online_Baselines/log/CA/stkec-42/2017/28.6593.pkl
2025-06-07 04:10:00,383 - [*] EWC! lambda 0.000100
2025-06-07 04:12:24,917 - [*] Year 2018 Training start
2025-06-07 04:12:28,407 - node number torch.Size([800768, 12])
2025-06-07 04:13:49,623 - epoch:0, training loss:1891.4044 validation loss:27.1164
2025-06-07 04:15:14,809 - epoch:1, training loss:1666.5288 validation loss:29.7942
2025-06-07 04:16:40,421 - epoch:2, training loss:1662.4759 validation loss:29.0747
2025-06-07 04:18:06,413 - epoch:3, training loss:1678.7300 validation loss:28.1293
2025-06-07 04:19:32,411 - epoch:4, training loss:1675.2720 validation loss:29.7309
2025-06-07 04:20:57,514 - epoch:5, training loss:1675.1138 validation loss:27.9094
2025-06-07 04:22:23,155 - epoch:6, training loss:1662.5712 validation loss:30.2661
2025-06-07 04:23:22,450 - [*] loss:1816.2600
2025-06-07 04:23:29,906 - [*] year 2018, testing
2025-06-07 04:24:28,766 - T:3	MAE	20.6827	RMSE	32.2237	MAPE	13.2923
2025-06-07 04:26:20,150 - T:6	MAE	22.7756	RMSE	35.5506	MAPE	14.7595
2025-06-07 04:32:15,467 - T:12	MAE	26.7725	RMSE	41.7068	MAPE	18.0897
2025-06-07 04:32:15,467 - T:Avg	MAE	23.0472	RMSE	35.9213	MAPE	15.0976
2025-06-07 04:32:15,495 - Finished optimization, total time:372.17 s, best model:log/CA/stkec-42/2018/27.1164.pkl
2025-06-07 04:32:17,079 - [*] Year 2019 load from data/CA/FastData/2019.npz
2025-06-07 04:32:17,749 - [*] load from log/CA/stkec-42/2018/27.1164.pkl
2025-06-07 04:32:18,820 - [*] detect strategy feature
/home/bd2/ANATS/Online_Baselines/src/model/detect_default.py:74: RuntimeWarning: invalid value encountered in divide
  cur_data[i,:,j] = (cur_data[i,:,j] - min(cur_data[i,:,j]))/(max(cur_data[i,:,j]) - min(cur_data[i,:,j]))
/home/bd2/ANATS/Online_Baselines/src/model/detect_default.py:79: RuntimeWarning: invalid value encountered in divide
  cur_prob = cur_prob * 1.0 /sum(cur_prob)
2025-06-07 04:33:12,652 - number of increase nodes:860, nodes after 2 hop:torch.Size([6428]), total nodes this year 8600
2025-06-07 04:35:24,412 - [*] Year 2019 Dataset load!
2025-06-07 04:35:24,412 - [*] load from log/CA/stkec-42/2018/27.1164.pkl
2025-06-07 04:35:24,428 - [*] EWC! lambda 0.000100
2025-06-07 04:37:20,154 - [*] Year 2019 Training start
2025-06-07 04:37:23,721 - node number torch.Size([822784, 12])
2025-06-07 04:38:50,653 - epoch:0, training loss:2274.2900 validation loss:30.0004
2025-06-07 04:40:21,670 - epoch:1, training loss:2023.5084 validation loss:28.5195
2025-06-07 04:41:53,141 - epoch:2, training loss:2027.7029 validation loss:28.6130
2025-06-07 04:43:25,064 - epoch:3, training loss:2027.2227 validation loss:28.9497
2025-06-07 04:44:56,140 - epoch:4, training loss:2044.2501 validation loss:28.5414
2025-06-07 04:46:27,834 - epoch:5, training loss:2050.2270 validation loss:28.7816
2025-06-07 04:47:58,884 - epoch:6, training loss:2039.4501 validation loss:31.4503
2025-06-07 04:49:29,802 - epoch:7, training loss:2038.2091 validation loss:28.5461
2025-06-07 04:50:30,748 - [*] loss:1627.1697
2025-06-07 04:50:38,172 - [*] year 2019, testing
2025-06-07 04:51:39,246 - T:3	MAE	20.1108	RMSE	30.3388	MAPE	14.9522
2025-06-07 04:53:34,832 - T:6	MAE	22.0762	RMSE	33.7068	MAPE	15.6344
2025-06-07 04:59:45,613 - T:12	MAE	25.9349	RMSE	39.9351	MAPE	18.2329
2025-06-07 04:59:45,614 - T:Avg	MAE	22.3661	RMSE	34.0964	MAPE	16.0951
2025-06-07 04:59:45,642 - Finished optimization, total time:455.29 s, best model:log/CA/stkec-42/2019/28.5195.pkl
2025-06-07 04:59:47,303 - [*] Year 2020 load from data/CA/FastData/2020.npz
2025-06-07 04:59:47,998 - [*] load from log/CA/stkec-42/2019/28.5195.pkl
2025-06-07 04:59:48,737 - [*] detect strategy feature
2025-06-07 05:00:07,587 - The number of data points in the previous year is greater than the current year, skipping detection and replay.
2025-06-07 05:00:10,125 - number of increase nodes:846, nodes after 2 hop:torch.Size([6689]), total nodes this year 8561
2025-06-07 05:02:21,473 - [*] Year 2020 Dataset load!
2025-06-07 05:02:21,473 - [*] load from log/CA/stkec-42/2019/28.5195.pkl
2025-06-07 05:02:21,498 - [*] EWC! lambda 0.000100
2025-06-07 05:04:17,415 - [*] Year 2020 Training start
2025-06-07 05:04:20,195 - node number torch.Size([856192, 12])
2025-06-07 05:05:55,044 - epoch:0, training loss:1740.5960 validation loss:30.6112
2025-06-07 05:07:33,035 - epoch:1, training loss:1553.1106 validation loss:30.1750
2025-06-07 05:09:10,969 - epoch:2, training loss:1548.2616 validation loss:27.4412
2025-06-07 05:10:49,230 - epoch:3, training loss:1550.6553 validation loss:25.8761
2025-06-07 05:12:26,888 - epoch:4, training loss:1550.3001 validation loss:28.4306
2025-06-07 05:14:04,735 - epoch:5, training loss:1552.6095 validation loss:31.0951
2025-06-07 05:15:42,504 - epoch:6, training loss:1562.0491 validation loss:35.5295
2025-06-07 05:17:20,575 - epoch:7, training loss:1559.3254 validation loss:27.5353
2025-06-07 05:18:58,482 - epoch:8, training loss:1550.8453 validation loss:28.8677
2025-06-07 05:20:36,277 - epoch:9, training loss:1567.6232 validation loss:27.6043
2025-06-07 05:21:36,664 - [*] loss:1722.4117
2025-06-07 05:21:52,124 - [*] year 2020, testing
2025-06-07 05:22:54,021 - T:3	MAE	25.7562	RMSE	35.2814	MAPE	25.3098
2025-06-07 05:24:52,153 - T:6	MAE	27.1351	RMSE	37.5862	MAPE	26.6192
2025-06-07 05:31:12,567 - T:12	MAE	29.2536	RMSE	41.2212	MAPE	29.2085
2025-06-07 05:31:12,568 - T:Avg	MAE	27.1648	RMSE	37.6538	MAPE	26.8041
2025-06-07 05:31:12,597 - Finished optimization, total time:611.55 s, best model:log/CA/stkec-42/2020/25.8761.pkl
2025-06-07 05:31:12,867 - 


2025-06-07 05:31:12,867 - 3   	 MAE	     22.49	     20.68	     20.11	     25.76		   22.26
2025-06-07 05:31:12,867 - 3   	RMSE	     32.52	     32.22	     30.34	     35.28		   32.59
2025-06-07 05:31:12,867 - 3   	MAPE	     17.98	     13.29	     14.95	     25.31		   17.88
2025-06-07 05:31:12,867 - 6   	 MAE	     24.03	     22.78	     22.08	     27.14		   24.00
2025-06-07 05:31:12,867 - 6   	RMSE	     35.55	     35.55	     33.71	     37.59		   35.60
2025-06-07 05:31:12,867 - 6   	MAPE	     17.80	     14.76	     15.63	     26.62		   18.70
2025-06-07 05:31:12,867 - 12  	 MAE	     27.37	     26.77	     25.93	     29.25		   27.33
2025-06-07 05:31:12,867 - 12  	RMSE	     41.41	     41.71	     39.94	     41.22		   41.07
2025-06-07 05:31:12,868 - 12  	MAPE	     19.65	     18.09	     18.23	     29.21		   21.30
2025-06-07 05:31:12,868 - Avg 	 MAE	     24.33	     23.05	     22.37	     27.16		   24.23
2025-06-07 05:31:12,868 - Avg 	RMSE	     35.95	     35.92	     34.10	     37.65		   35.90
2025-06-07 05:31:12,868 - Avg 	MAPE	     18.39	     15.10	     16.10	     26.80		   19.10
2025-06-07 05:31:12,868 - year	2018	total_time	  372.1727	average_time	   53.1675	epoch	7
2025-06-07 05:31:12,868 - year	2019	total_time	  455.2900	average_time	   56.9113	epoch	8
2025-06-07 05:31:12,868 - year	2020	total_time	  611.5491	average_time	   61.1549	epoch	10
2025-06-07 05:31:12,868 - total time: 1439.0119
2025-06-07 06:57:07,544 - logger name:log/CA/pecpm-42/pecpm.log
2025-06-07 06:57:07,544 - params : {'conf': 'conf/CA/pecpm.json', 'seed': 42, 'paral': 0, 'gpuid': 6, 'logname': 'pecpm', 'method': 'PECPM', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/CA/pecpm-42/2017/28.3891.pkl', 'device': device(type='cuda', index=6), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'PECPM': <class 'src.model.model.PECPM_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 32, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'beita': 1.0, 'cluster': 32, 'raw_data_path': 'data/CA/finaldata/', 'save_data_path': 'data/CA/FastData/', 'graph_path': 'data/CA/graph/', 'model_path': 'log/CA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'train': 1, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'adp_adj': False, 'skip_dim': 64, 'end_dim': 64, 'hidden_channels': 32, 'dilation_channels': 64, 'residual_channels': 64, 'input_dim': 1, 'output_dim': 1, 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 300, 'path': 'log/CA/pecpm-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-07 06:57:08,746 - [*] Year 2017 load from data/CA/FastData/2017.npz
2025-06-07 07:04:07,663 - [*] Year 2017 Dataset load!
2025-06-07 07:04:07,837 - [*] Year 2017 Training start
2025-06-07 07:04:14,704 - node number torch.Size([262272, 12])
2025-06-07 07:06:56,098 - epoch:0, training loss:6081.6688 validation loss:30.4678
2025-06-07 07:09:46,627 - epoch:1, training loss:1944.8705 validation loss:30.5892
2025-06-07 07:12:34,566 - epoch:2, training loss:1867.6121 validation loss:32.9352
2025-06-07 07:15:23,943 - epoch:3, training loss:1860.2216 validation loss:32.0582
2025-06-07 07:18:11,504 - epoch:4, training loss:1859.3117 validation loss:29.3803
2025-06-07 07:21:02,293 - epoch:5, training loss:1850.0556 validation loss:31.0986
2025-06-07 07:23:51,924 - epoch:6, training loss:1803.0544 validation loss:35.4646
2025-06-07 07:26:41,892 - epoch:7, training loss:1773.4331 validation loss:29.4309
2025-06-07 07:29:31,380 - epoch:8, training loss:1758.3045 validation loss:29.9548
2025-06-07 07:32:21,058 - epoch:9, training loss:1750.6798 validation loss:28.3891
2025-06-07 07:35:16,035 - epoch:10, training loss:1754.6168 validation loss:29.0000
2025-06-07 07:38:07,636 - epoch:11, training loss:1738.6698 validation loss:29.4276
2025-06-07 07:40:56,386 - epoch:12, training loss:1735.3100 validation loss:31.7326
2025-06-07 07:43:54,848 - epoch:13, training loss:1716.4410 validation loss:32.9464
2025-06-07 07:46:58,783 - epoch:14, training loss:1724.3194 validation loss:31.3071
2025-06-07 07:50:05,919 - epoch:15, training loss:1715.5241 validation loss:33.2489
2025-06-07 07:51:09,277 - [*] loss:1777.7046
2025-06-07 07:51:18,263 - [*] year 2017, testing
2025-06-07 07:53:48,888 - T:3	MAE	20.6454	RMSE	31.6555	MAPE	13.6154
2025-06-07 07:59:58,073 - T:6	MAE	22.6253	RMSE	34.9587	MAPE	15.2391
2025-06-07 08:14:07,873 - T:12	MAE	26.7374	RMSE	41.2785	MAPE	19.2221
2025-06-07 08:14:07,874 - T:Avg	MAE	22.9666	RMSE	35.3773	MAPE	15.7035
2025-06-07 08:14:07,903 - Finished optimization, total time:1489.41 s, best model:log/CA/pecpm-42/2017/28.3891.pkl
2025-06-07 08:14:10,408 - [*] Year 2018 load from data/CA/FastData/2018.npz
2025-06-07 08:14:11,062 - [*] load from log/CA/pecpm-42/2017/28.3891.pkl
2025-06-07 08:14:12,057 - [*] detect strategy feature
2025-06-07 08:14:39,683 - number of increase nodes:1067, nodes after 2 hop:torch.Size([6708]), total nodes this year 8428
2025-06-07 11:51:11,213 - logger name:log/CA/pecpm-42/pecpm.log
2025-06-07 11:51:11,213 - params : {'conf': 'conf/CA/pecpm.json', 'seed': 42, 'paral': 0, 'gpuid': 6, 'logname': 'pecpm', 'method': 'PECPM', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/CA/pecpm-42/2017/28.3891.pkl', 'device': device(type='cuda', index=6), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'PECPM': <class 'src.model.model.PECPM_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 32, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'beita': 1.0, 'cluster': 32, 'raw_data_path': 'data/CA/finaldata/', 'save_data_path': 'data/CA/FastData/', 'graph_path': 'data/CA/graph/', 'model_path': 'log/CA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'train': 1, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'adp_adj': False, 'skip_dim': 64, 'end_dim': 64, 'hidden_channels': 32, 'dilation_channels': 64, 'residual_channels': 64, 'input_dim': 1, 'output_dim': 1, 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 300, 'path': 'log/CA/pecpm-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-07 11:51:12,413 - [*] Year 2017 load from data/CA/FastData/2017.npz
2025-06-07 11:55:44,355 - [*] Year 2017 Dataset load!
2025-06-07 11:55:44,388 - [*] Year 2017 Training start
2025-06-07 11:55:50,517 - node number torch.Size([262272, 12])
2025-06-07 11:58:21,797 - epoch:0, training loss:6081.6688 validation loss:30.4678
2025-06-07 12:01:05,075 - epoch:1, training loss:1944.8705 validation loss:30.5892
2025-06-07 12:03:45,353 - epoch:2, training loss:1867.6121 validation loss:32.9352
2025-06-07 12:06:23,537 - epoch:3, training loss:1860.2216 validation loss:32.0582
2025-06-07 12:09:01,096 - epoch:4, training loss:1859.3117 validation loss:29.3803
2025-06-07 12:11:38,472 - epoch:5, training loss:1850.0556 validation loss:31.0986
2025-06-07 12:14:14,228 - epoch:6, training loss:1803.0544 validation loss:35.4646
2025-06-07 12:16:51,113 - epoch:7, training loss:1773.4331 validation loss:29.4309
2025-06-07 12:19:28,363 - epoch:8, training loss:1758.3045 validation loss:29.9548
2025-06-07 12:22:04,149 - epoch:9, training loss:1750.6798 validation loss:28.3891
2025-06-07 12:24:41,247 - epoch:10, training loss:1754.6168 validation loss:29.0000
2025-06-07 12:27:27,447 - epoch:11, training loss:1738.6698 validation loss:29.4276
2025-06-07 12:30:27,848 - epoch:12, training loss:1735.3100 validation loss:31.7326
2025-06-07 12:33:17,036 - epoch:13, training loss:1716.4410 validation loss:32.9464
2025-06-07 12:36:17,051 - epoch:14, training loss:1724.3194 validation loss:31.3071
2025-06-07 12:39:09,466 - epoch:15, training loss:1715.5241 validation loss:33.2489
2025-06-07 12:40:19,982 - [*] loss:1777.7046
2025-06-07 12:40:30,507 - [*] year 2017, testing
2025-06-07 12:43:01,264 - T:3	MAE	20.6454	RMSE	31.6555	MAPE	13.6154
2025-06-07 12:56:02,683 - T:6	MAE	22.6253	RMSE	34.9587	MAPE	15.2391
2025-06-07 13:04:09,260 - T:12	MAE	26.7374	RMSE	41.2785	MAPE	19.2221
2025-06-07 13:04:09,261 - T:Avg	MAE	22.9666	RMSE	35.3773	MAPE	15.7035
2025-06-07 13:04:09,290 - Finished optimization, total time:1510.64 s, best model:log/CA/pecpm-42/2017/28.3891.pkl
2025-06-07 13:04:11,318 - [*] Year 2018 load from data/CA/FastData/2018.npz
2025-06-07 13:04:11,969 - [*] load from log/CA/pecpm-42/2017/28.3891.pkl
2025-06-07 13:04:13,133 - [*] detect strategy feature
2025-06-07 13:04:40,111 - number of increase nodes:1067, nodes after 2 hop:torch.Size([6708]), total nodes this year 8428
