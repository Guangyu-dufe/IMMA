2025-05-26 02:14:48,181 - logger name:log/SD/oneline_st_nn_sd-42/oneline_st_nn_sd.log
2025-05-26 02:14:48,181 - params : {'conf': 'conf/SD/online_st_nn.json', 'seed': 42, 'paral': 0, 'gpuid': 2, 'logname': 'oneline_st_nn_sd', 'method': 'TrafficStream', 'load_first_year': 0, 'first_year_model_path': 'log/SD/trafficstream-42/2019/22.3629.pkl', 'device': device(type='cuda', index=2), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/SD/finaldata/', 'save_data_path': 'data/SD/FastData/', 'graph_path': 'data/SD/graph/', 'model_path': 'log/SD/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'rank': 6, 'train': 1, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': False, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': False, 'path': 'log/SD/oneline_st_nn_sd-42', 'logger': <Logger utils.initialize (INFO)>}
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 862061.80it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 889265.03it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 1049212.32it/s]
2025-05-26 02:15:04,307 - [*] Year 2017 load from data/SD/FastData/2017.npz
2025-05-26 02:15:04,586 - [*] Year 2017 Dataset load!
2025-05-26 02:15:04,589 - Total Parameters: 3308
2025-05-26 02:15:04,589 - Trainable Parameters: 3308
2025-05-26 02:15:04,589 - [*] Year 2017 Training start
2025-05-26 02:15:04,913 - node number torch.Size([90240, 12])
2025-05-26 02:15:09,743 - epoch:0, training loss:18180.7709 validation loss:49.8031
2025-05-26 02:15:14,379 - epoch:1, training loss:2851.6175 validation loss:35.2882
2025-05-26 02:15:19,128 - epoch:2, training loss:2227.2044 validation loss:33.5646
2025-05-26 02:15:23,818 - epoch:3, training loss:2138.6287 validation loss:34.8725
2025-05-26 02:15:28,443 - epoch:4, training loss:2108.3498 validation loss:35.1587
2025-05-26 02:15:33,215 - epoch:5, training loss:2056.2845 validation loss:32.7855
2025-05-26 02:15:38,043 - epoch:6, training loss:1987.8954 validation loss:32.9930
2025-05-26 02:15:42,970 - epoch:7, training loss:1949.6523 validation loss:33.3834
2025-05-26 02:15:47,742 - epoch:8, training loss:1951.7061 validation loss:34.9994
2025-05-26 02:15:52,621 - epoch:9, training loss:1935.0494 validation loss:35.8891
2025-05-26 02:15:57,376 - epoch:10, training loss:1943.1483 validation loss:35.6961
2025-05-26 02:16:02,225 - epoch:11, training loss:1925.6423 validation loss:33.4956
2025-05-26 02:16:04,421 - [*] loss:1991.8922
2025-05-26 02:16:04,947 - [*] year 2017, testing
2025-05-26 02:16:09,891 - T:3	MAE	23.9438	RMSE	33.7044	MAPE	18.1451
2025-05-26 02:16:19,483 - T:6	MAE	25.2292	RMSE	36.6673	MAPE	18.7154
2025-05-26 02:16:50,326 - T:12	MAE	29.0428	RMSE	44.2175	MAPE	20.9770
2025-05-26 02:16:50,326 - T:Avg	MAE	25.7522	RMSE	37.5641	MAPE	19.0944
2025-05-26 02:16:50,329 - Finished optimization, total time:30.47 s, best model:log/SD/oneline_st_nn_sd-42/2017/32.7855.pkl
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 954997.76it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 986505.86it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 995707.32it/s]
2025-05-26 02:17:06,933 - [*] Year 2018 load from data/SD/FastData/2018.npz
2025-05-26 02:17:06,973 - [*] load from log/SD/oneline_st_nn_sd-42/2017/32.7855.pkl
2025-05-26 02:17:07,860 - number of increase nodes:3, nodes after 2 hop:torch.Size([20]), total nodes this year 708
2025-05-26 02:17:07,960 - [*] Year 2018 Dataset load!
2025-05-26 02:17:07,960 - [*] load from log/SD/oneline_st_nn_sd-42/2017/32.7855.pkl
2025-05-26 02:17:07,963 - Total Parameters: 3308
2025-05-26 02:17:07,963 - Trainable Parameters: 3308
2025-05-26 02:17:07,963 - [*] Year 2018 Training start
2025-05-26 02:17:08,768 - node number torch.Size([2560, 12])
2025-05-26 02:17:11,918 - epoch:0, training loss:402.0954 validation loss:12.9358
2025-05-26 02:17:15,438 - epoch:1, training loss:345.2542 validation loss:13.9766
2025-05-26 02:17:18,587 - epoch:2, training loss:345.1395 validation loss:16.2838
2025-05-26 02:17:22,228 - epoch:3, training loss:344.1805 validation loss:15.4469
2025-05-26 02:17:25,475 - epoch:4, training loss:342.1581 validation loss:22.6723
2025-05-26 02:17:28,468 - epoch:5, training loss:344.1001 validation loss:17.4834
2025-05-26 02:17:31,736 - epoch:6, training loss:344.6253 validation loss:16.5306
2025-05-26 02:17:34,209 - [*] loss:2174.6890
2025-05-26 02:17:34,579 - [*] year 2018, testing
2025-05-26 02:17:38,438 - T:3	MAE	20.9406	RMSE	31.2304	MAPE	14.9745
2025-05-26 02:17:45,940 - T:6	MAE	23.7356	RMSE	35.8792	MAPE	16.8609
2025-05-26 02:18:12,724 - T:12	MAE	29.8716	RMSE	46.1223	MAPE	20.8344
2025-05-26 02:18:12,724 - T:Avg	MAE	24.3275	RMSE	36.8873	MAPE	17.2057
2025-05-26 02:18:12,727 - Finished optimization, total time:13.75 s, best model:log/SD/oneline_st_nn_sd-42/2018/12.9358.pkl
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 958298.23it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 1039184.14it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 1059105.09it/s]
2025-05-26 02:18:29,093 - [*] Year 2019 load from data/SD/FastData/2019.npz
2025-05-26 02:18:29,139 - [*] load from log/SD/oneline_st_nn_sd-42/2018/12.9358.pkl
2025-05-26 02:18:30,060 - number of increase nodes:8, nodes after 2 hop:torch.Size([54]), total nodes this year 716
2025-05-26 02:18:30,322 - [*] Year 2019 Dataset load!
2025-05-26 02:18:30,322 - [*] load from log/SD/oneline_st_nn_sd-42/2018/12.9358.pkl
2025-05-26 02:18:30,325 - Total Parameters: 3308
2025-05-26 02:18:30,325 - Trainable Parameters: 3308
2025-05-26 02:18:30,326 - [*] Year 2019 Training start
2025-05-26 02:18:31,437 - node number torch.Size([6912, 12])
2025-05-26 02:18:34,731 - epoch:0, training loss:505.0802 validation loss:14.8691
2025-05-26 02:18:38,602 - epoch:1, training loss:497.6128 validation loss:14.6718
2025-05-26 02:18:42,874 - epoch:2, training loss:487.8237 validation loss:14.7424
2025-05-26 02:18:47,006 - epoch:3, training loss:488.6302 validation loss:14.8976
2025-05-26 02:18:51,007 - epoch:4, training loss:485.4686 validation loss:16.5373
2025-05-26 02:18:54,985 - epoch:5, training loss:490.1910 validation loss:16.8476
2025-05-26 02:18:59,158 - epoch:6, training loss:512.0275 validation loss:15.7198
2025-05-26 02:19:03,151 - epoch:7, training loss:485.3146 validation loss:15.0226
2025-05-26 02:19:06,039 - [*] loss:2236.8862
2025-05-26 02:19:06,458 - [*] year 2019, testing
2025-05-26 02:19:10,988 - T:3	MAE	23.2672	RMSE	33.7225	MAPE	21.2728
2025-05-26 02:19:20,032 - T:6	MAE	26.2879	RMSE	38.4292	MAPE	23.5339
2025-05-26 02:19:50,416 - T:12	MAE	31.5213	RMSE	47.0798	MAPE	27.4172
2025-05-26 02:19:50,416 - T:Avg	MAE	26.5334	RMSE	38.9405	MAPE	23.7296
2025-05-26 02:19:50,419 - Finished optimization, total time:18.60 s, best model:log/SD/oneline_st_nn_sd-42/2019/14.6718.pkl
  0%|          | 0/21080 [00:00<?, ?it/s]100%|██████████| 21080/21080 [00:00<00:00, 955692.90it/s]
  0%|          | 0/21081 [00:00<?, ?it/s]100%|██████████| 21081/21081 [00:00<00:00, 986545.45it/s]
  0%|          | 0/21081 [00:00<?, ?it/s]100%|██████████| 21081/21081 [00:00<00:00, 1024388.84it/s]
2025-05-26 02:20:06,977 - [*] Year 2020 load from data/SD/FastData/2020.npz
2025-05-26 02:20:07,017 - [*] load from log/SD/oneline_st_nn_sd-42/2019/14.6718.pkl
2025-05-26 02:20:08,005 - number of increase nodes:0, nodes after 2 hop:torch.Size([54]), total nodes this year 697
2025-05-26 02:20:08,005 - [*] load from log/SD/oneline_st_nn_sd-42/2019/14.6718.pkl
2025-05-26 02:20:11,678 - [*] loss:3929.6252
2025-05-26 02:20:12,045 - [*] year 2020, testing
2025-05-26 02:20:16,102 - T:3	MAE	47.7425	RMSE	58.6549	MAPE	53.9550
2025-05-26 02:20:23,545 - T:6	MAE	49.3436	RMSE	61.1777	MAPE	56.0941
2025-05-26 02:20:49,325 - T:12	MAE	49.9964	RMSE	63.2355	MAPE	58.7244
2025-05-26 02:20:49,326 - T:Avg	MAE	48.9066	RMSE	60.7422	MAPE	55.9981
2025-05-26 02:20:49,328 - [*] No increasing nodes at year 2020, store model of the last year.
2025-05-26 02:20:49,329 - 


2025-05-26 02:20:49,329 - 3   	 MAE	     23.94	     20.94	     23.27	     47.74		   28.97
2025-05-26 02:20:49,329 - 3   	RMSE	     33.70	     31.23	     33.72	     58.65		   39.33
2025-05-26 02:20:49,329 - 3   	MAPE	     18.15	     14.97	     21.27	     53.96		   27.09
2025-05-26 02:20:49,329 - 6   	 MAE	     25.23	     23.74	     26.29	     49.34		   31.15
2025-05-26 02:20:49,329 - 6   	RMSE	     36.67	     35.88	     38.43	     61.18		   43.04
2025-05-26 02:20:49,329 - 6   	MAPE	     18.72	     16.86	     23.53	     56.09		   28.80
2025-05-26 02:20:49,329 - 12  	 MAE	     29.04	     29.87	     31.52	     50.00		   35.11
2025-05-26 02:20:49,329 - 12  	RMSE	     44.22	     46.12	     47.08	     63.24		   50.16
2025-05-26 02:20:49,329 - 12  	MAPE	     20.98	     20.83	     27.42	     58.72		   31.99
2025-05-26 02:20:49,329 - Avg 	 MAE	     25.75	     24.33	     26.53	     48.91		   31.38
2025-05-26 02:20:49,329 - Avg 	RMSE	     37.56	     36.89	     38.94	     60.74		   43.53
2025-05-26 02:20:49,329 - Avg 	MAPE	     19.09	     17.21	     23.73	     56.00		   29.01
2025-05-26 02:20:49,329 - year	2017	total_time	   30.4654	average_time	    2.5388	epoch	12
2025-05-26 02:20:49,329 - year	2018	total_time	   13.7492	average_time	    1.9642	epoch	7
2025-05-26 02:20:49,330 - year	2019	total_time	   18.5999	average_time	    2.3250	epoch	8
2025-05-26 02:20:49,330 - total time: 62.8145
2025-05-29 02:20:48,493 - logger name:log/SD/pecpm-42/pecpm.log
2025-05-29 02:20:48,493 - params : {'conf': 'conf/SD/pecpm.json', 'seed': 42, 'paral': 0, 'gpuid': 2, 'logname': 'pecpm', 'method': 'PECPM', 'load_first_year': 0, 'first_year_model_path': 'log/SD/pecpm-42/2017/31.5668.pkl', 'device': device(type='cuda', index=2), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'PECPM': <class 'src.model.model.PECPM_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'beita': 1.0, 'cluster': 32, 'raw_data_path': 'data/SD/finaldata/', 'save_data_path': 'data/SD/FastData/', 'graph_path': 'data/SD/graph/', 'model_path': 'log/SD/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'train': 1, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'adp_adj': False, 'skip_dim': 64, 'end_dim': 64, 'hidden_channels': 32, 'dilation_channels': 64, 'residual_channels': 64, 'input_dim': 1, 'output_dim': 1, 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 300, 'path': 'log/SD/pecpm-42', 'logger': <Logger utils.initialize (INFO)>}
2025-05-29 02:20:48,540 - [*] Year 2017 load from data/SD/FastData/2017.npz
2025-05-29 02:21:01,504 - [*] Year 2017 Dataset load!
2025-05-29 02:21:01,508 - [*] Year 2017 Training start
2025-05-29 02:21:03,310 - node number torch.Size([90240, 12])
2025-05-29 02:21:09,510 - epoch:0, training loss:18116.4573 validation loss:48.7356
2025-05-29 02:21:16,180 - epoch:1, training loss:2853.1238 validation loss:36.2958
2025-05-29 02:21:22,652 - epoch:2, training loss:2221.4153 validation loss:34.4193
2025-05-29 02:21:29,421 - epoch:3, training loss:2140.8676 validation loss:35.3845
2025-05-29 02:21:36,089 - epoch:4, training loss:2095.6261 validation loss:34.4393
2025-05-29 02:21:43,097 - epoch:5, training loss:2042.8313 validation loss:34.6641
2025-05-29 02:21:49,781 - epoch:6, training loss:1975.2769 validation loss:35.4132
2025-05-29 02:21:56,305 - epoch:7, training loss:1949.2893 validation loss:32.9056
2025-05-29 02:22:02,917 - epoch:8, training loss:1931.3821 validation loss:33.6320
2025-05-29 02:22:09,566 - epoch:9, training loss:1925.1775 validation loss:33.2861
2025-05-29 02:22:16,274 - epoch:10, training loss:1926.4316 validation loss:31.6286
2025-05-29 02:22:23,139 - epoch:11, training loss:1902.6118 validation loss:35.3045
2025-05-29 02:22:29,712 - epoch:12, training loss:1895.4016 validation loss:32.1190
2025-05-29 02:22:36,412 - epoch:13, training loss:1908.2196 validation loss:31.9693
2025-05-29 02:22:42,697 - epoch:14, training loss:1884.6085 validation loss:32.5072
2025-05-29 02:22:49,331 - epoch:15, training loss:1887.4055 validation loss:32.9792
2025-05-29 02:22:55,944 - epoch:16, training loss:1880.3362 validation loss:33.9163
2025-05-29 02:22:58,731 - [*] loss:1856.0039
2025-05-29 02:22:59,106 - [*] year 2017, testing
2025-05-29 02:23:03,931 - T:3	MAE	22.0811	RMSE	31.4733	MAPE	15.7790
2025-05-29 02:23:13,226 - T:6	MAE	23.9858	RMSE	35.1588	MAPE	16.8380
2025-05-29 02:23:43,048 - T:12	MAE	28.0770	RMSE	42.6223	MAPE	20.3057
2025-05-29 02:23:43,048 - T:Avg	MAE	24.3363	RMSE	35.7310	MAPE	17.4045
2025-05-29 02:23:43,051 - Finished optimization, total time:55.79 s, best model:log/SD/pecpm-42/2017/31.6286.pkl
2025-05-29 02:23:43,126 - [*] Year 2018 load from data/SD/FastData/2018.npz
2025-05-29 02:23:43,154 - [*] load from log/SD/pecpm-42/2017/31.5668.pkl
2025-05-29 02:23:43,162 - [*] detect strategy feature
2025-05-29 02:23:44,770 - number of increase nodes:72, nodes after 2 hop:torch.Size([562]), total nodes this year 708
2025-05-29 02:24:27,664 - [*] Year 2018 Dataset load!
2025-05-29 02:24:27,664 - [*] load from log/SD/pecpm-42/2017/31.5668.pkl
2025-05-29 02:24:27,668 - [*] EWC! lambda 0.000100
2025-05-29 02:24:36,452 - [*] Year 2018 Training start
2025-05-29 02:24:40,166 - node number torch.Size([71936, 12])
2025-05-29 02:24:48,575 - epoch:0, training loss:1991.7770 validation loss:28.5345
2025-05-29 02:24:58,034 - epoch:1, training loss:1930.8792 validation loss:28.4678
2025-05-29 02:25:07,552 - epoch:2, training loss:1929.8499 validation loss:31.7958
2025-05-29 02:25:18,306 - epoch:3, training loss:1915.8881 validation loss:28.0249
2025-05-29 02:25:29,374 - epoch:4, training loss:1878.4091 validation loss:30.4537
2025-05-29 02:25:40,311 - epoch:5, training loss:1890.0546 validation loss:28.3654
2025-05-29 02:25:51,272 - epoch:6, training loss:1877.7323 validation loss:29.3239
2025-05-29 02:26:02,197 - epoch:7, training loss:1862.8350 validation loss:28.3130
2025-05-29 02:26:13,887 - epoch:8, training loss:1857.7369 validation loss:28.5585
2025-05-29 02:26:22,472 - epoch:9, training loss:1869.1283 validation loss:29.3014
2025-05-29 02:26:26,444 - [*] loss:1829.6702
2025-05-29 02:26:26,483 - [*] year 2018, testing
2025-05-29 02:26:26,911 - T:3	MAE	19.8727	RMSE	29.2953	MAPE	14.4779
2025-05-29 02:26:27,759 - T:6	MAE	22.1685	RMSE	33.0390	MAPE	16.6409
2025-05-29 02:26:30,538 - T:12	MAE	26.5282	RMSE	40.1759	MAPE	20.7708
2025-05-29 02:26:30,539 - T:Avg	MAE	22.4643	RMSE	33.5151	MAPE	16.9623
2025-05-29 02:26:30,539 - Finished optimization, total time:60.77 s, best model:log/SD/pecpm-42/2018/28.0249.pkl
2025-05-29 02:26:30,704 - [*] Year 2019 load from data/SD/FastData/2019.npz
2025-05-29 02:26:30,710 - [*] load from log/SD/pecpm-42/2018/28.0249.pkl
2025-05-29 02:26:30,725 - [*] detect strategy feature
2025-05-29 02:26:32,822 - number of increase nodes:79, nodes after 2 hop:torch.Size([587]), total nodes this year 716
2025-05-29 02:27:18,483 - [*] Year 2019 Dataset load!
2025-05-29 02:27:18,484 - [*] load from log/SD/pecpm-42/2018/28.0249.pkl
2025-05-29 02:27:18,488 - [*] EWC! lambda 0.000100
2025-05-29 02:27:27,265 - [*] Year 2019 Training start
2025-05-29 02:27:31,420 - node number torch.Size([75136, 12])
2025-05-29 02:27:41,026 - epoch:0, training loss:1970.5410 validation loss:29.4730
2025-05-29 02:27:50,865 - epoch:1, training loss:1932.7118 validation loss:28.4102
2025-05-29 02:28:02,361 - epoch:2, training loss:1932.4293 validation loss:28.1091
2025-05-29 02:28:12,119 - epoch:3, training loss:1928.6549 validation loss:28.0385
2025-05-29 02:28:20,380 - epoch:4, training loss:1922.8941 validation loss:29.4981
2025-05-29 02:28:28,918 - epoch:5, training loss:1942.2327 validation loss:28.1857
2025-05-29 02:28:39,024 - epoch:6, training loss:1930.9373 validation loss:28.2773
2025-05-29 02:28:48,523 - epoch:7, training loss:1928.0461 validation loss:29.3281
2025-05-29 02:28:59,048 - epoch:8, training loss:1921.9390 validation loss:29.5778
2025-05-29 02:29:09,555 - epoch:9, training loss:1926.1555 validation loss:28.9543
2025-05-29 02:29:13,336 - [*] loss:1848.2471
2025-05-29 02:29:13,499 - [*] year 2019, testing
2025-05-29 02:29:14,233 - T:3	MAE	20.9140	RMSE	31.0161	MAPE	16.7194
2025-05-29 02:29:16,980 - T:6	MAE	23.0909	RMSE	34.4828	MAPE	18.6198
2025-05-29 02:29:28,472 - T:12	MAE	27.4059	RMSE	41.2785	MAPE	22.5347
2025-05-29 02:29:28,473 - T:Avg	MAE	23.4218	RMSE	34.9757	MAPE	18.9653
2025-05-29 02:29:28,475 - Finished optimization, total time:57.44 s, best model:log/SD/pecpm-42/2019/28.0385.pkl
2025-05-29 02:29:28,643 - [*] Year 2020 load from data/SD/FastData/2020.npz
2025-05-29 02:29:28,654 - [*] load from log/SD/pecpm-42/2019/28.0385.pkl
2025-05-29 02:29:28,664 - [*] detect strategy feature
2025-05-29 02:29:30,387 - number of increase nodes:65, nodes after 2 hop:torch.Size([578]), total nodes this year 697
2025-05-29 02:30:12,185 - [*] Year 2020 Dataset load!
2025-05-29 02:30:12,186 - [*] load from log/SD/pecpm-42/2019/28.0385.pkl
2025-05-29 02:30:12,190 - [*] EWC! lambda 0.000100
2025-05-29 02:30:20,843 - [*] Year 2020 Training start
2025-05-29 02:30:23,297 - node number torch.Size([73984, 12])
2025-05-29 02:30:31,318 - epoch:0, training loss:1821.0969 validation loss:37.1670
2025-05-29 02:30:41,508 - epoch:1, training loss:1772.5882 validation loss:34.5862
2025-05-29 02:30:50,084 - epoch:2, training loss:1771.2748 validation loss:33.3430
2025-05-29 02:30:58,558 - epoch:3, training loss:1765.6560 validation loss:33.5241
2025-05-29 02:31:07,077 - epoch:4, training loss:1777.2841 validation loss:35.7127
2025-05-29 02:31:16,167 - epoch:5, training loss:1768.0659 validation loss:33.3349
2025-05-29 02:31:25,188 - epoch:6, training loss:1764.8791 validation loss:36.4794
2025-05-29 02:31:34,347 - epoch:7, training loss:1772.5122 validation loss:36.1998
2025-05-29 02:31:44,972 - epoch:8, training loss:1766.8204 validation loss:33.9192
2025-05-29 02:31:55,589 - epoch:9, training loss:1776.3634 validation loss:38.7947
2025-05-29 02:32:04,753 - epoch:10, training loss:1769.2178 validation loss:33.9215
2025-05-29 02:32:19,984 - epoch:11, training loss:1766.8376 validation loss:37.7438
2025-05-29 02:32:24,379 - [*] loss:2931.2944
2025-05-29 02:32:24,447 - [*] year 2020, testing
2025-05-29 02:32:24,863 - T:3	MAE	42.2826	RMSE	50.3731	MAPE	47.2463
2025-05-29 02:32:26,484 - T:6	MAE	42.5178	RMSE	51.4402	MAPE	48.1182
2025-05-29 02:32:33,087 - T:12	MAE	43.3924	RMSE	53.7057	MAPE	49.9750
2025-05-29 02:32:33,087 - T:Avg	MAE	42.6032	RMSE	51.5589	MAPE	48.2385
2025-05-29 02:32:33,088 - Finished optimization, total time:66.15 s, best model:log/SD/pecpm-42/2020/33.3349.pkl
2025-05-29 02:32:33,224 - 


2025-05-29 02:32:33,225 - 3   	 MAE	     22.08	     19.87	     20.91	     42.28		   26.29
2025-05-29 02:32:33,225 - 3   	RMSE	     31.47	     29.30	     31.02	     50.37		   35.54
2025-05-29 02:32:33,225 - 3   	MAPE	     15.78	     14.48	     16.72	     47.25		   23.56
2025-05-29 02:32:33,225 - 6   	 MAE	     23.99	     22.17	     23.09	     42.52		   27.94
2025-05-29 02:32:33,225 - 6   	RMSE	     35.16	     33.04	     34.48	     51.44		   38.53
2025-05-29 02:32:33,225 - 6   	MAPE	     16.84	     16.64	     18.62	     48.12		   25.05
2025-05-29 02:32:33,225 - 12  	 MAE	     28.08	     26.53	     27.41	     43.39		   31.35
2025-05-29 02:32:33,225 - 12  	RMSE	     42.62	     40.18	     41.28	     53.71		   44.45
2025-05-29 02:32:33,225 - 12  	MAPE	     20.31	     20.77	     22.53	     49.98		   28.40
2025-05-29 02:32:33,225 - Avg 	 MAE	     24.34	     22.46	     23.42	     42.60		   28.21
2025-05-29 02:32:33,225 - Avg 	RMSE	     35.73	     33.52	     34.98	     51.56		   38.95
2025-05-29 02:32:33,225 - Avg 	MAPE	     17.40	     16.96	     18.97	     48.24		   25.39
2025-05-29 02:32:33,225 - year	2017	total_time	   55.7861	average_time	    3.2815	epoch	17
2025-05-29 02:32:33,225 - year	2018	total_time	   60.7689	average_time	    6.0769	epoch	10
2025-05-29 02:32:33,226 - year	2019	total_time	   57.4389	average_time	    5.7439	epoch	10
2025-05-29 02:32:33,226 - year	2020	total_time	   66.1503	average_time	    5.5125	epoch	12
2025-05-29 02:32:33,226 - total time: 240.1442
Traceback (most recent call last):
  File "/home/bd2/ANATS/Oline_Baselines/main.py", line 8, in <module>
    from torch_geometric.loader import DataLoader
  File "/home/bd2/miniconda3/lib/python3.12/site-packages/torch_geometric/__init__.py", line 4, in <module>
    import torch_geometric.typing
  File "/home/bd2/miniconda3/lib/python3.12/site-packages/torch_geometric/typing.py", line 10, in <module>
    from torch import Tensor
ImportError: cannot import name 'Tensor' from 'torch' (unknown location)
2025-05-29 11:28:40,950 - logger name:log/SD/team-42/team.log
2025-05-29 11:28:40,950 - params : {'conf': 'conf/SD/team.json', 'seed': 42, 'paral': 0, 'gpuid': 2, 'logname': 'team', 'method': 'TEAM', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/Oline_Baselines/log/SD/TEAM-42/2017/51.0326.pkl', 'device': device(type='cuda', index=2), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 16, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'n_heads': 3, 'in_channels': 1, 'K': 3, 'nb_block': 1, 'nb_chev_filter': 64, 'nb_time_filter': 64, 'num_of_hours': 1, 'missing_value': 0.0, 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/SD/finaldata/', 'save_data_path': 'data/SD/FastData/', 'graph_path': 'data/SD/graph', 'model_path': 'log/SD/', 'strategy': 'incremental', 'init': True, 'increase': True, 'decrease': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'original', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.001, 'replay': True, 'replay_strategy': 'distribution', 'replay_num_samples': 100, 'path': 'log/SD/team-42', 'logger': <Logger utils.initialize (INFO)>}
2025-05-29 11:28:40,978 - [*] Year 2017 load from data/SD/FastData/2017.npz
2025-05-29 11:28:46,495 - [*] Year 2017 Dataset load!
2025-05-29 11:28:46,568 - Total Parameters: 71948
2025-05-29 11:28:46,568 - Trainable Parameters: 71948
2025-05-29 11:28:46,568 - [*] Year 2017 Training start
2025-05-29 11:28:46,917 - node number torch.Size([11280, 12])
2025-05-29 11:31:13,604 - epoch:0, training loss:5221.2297 validation loss:62.2977
2025-05-29 11:33:44,051 - epoch:1, training loss:5152.2649 validation loss:55.9722
2025-05-29 11:36:10,851 - epoch:2, training loss:6155.5198 validation loss:54.0785
2025-05-29 11:38:38,102 - epoch:3, training loss:5561.1589 validation loss:46.2101
2025-05-29 11:41:04,703 - epoch:4, training loss:4482.9777 validation loss:41.9492
2025-05-29 11:43:30,038 - epoch:5, training loss:4375.5569 validation loss:48.1124
2025-05-29 11:45:54,732 - epoch:6, training loss:3954.6944 validation loss:46.2101
2025-05-29 11:48:19,460 - epoch:7, training loss:3636.2873 validation loss:43.5587
2025-05-29 11:50:42,612 - epoch:8, training loss:3351.9523 validation loss:38.8605
2025-05-29 11:53:06,669 - epoch:9, training loss:3135.8678 validation loss:38.6019
2025-05-29 11:55:31,092 - epoch:10, training loss:4061.1279 validation loss:40.5328
2025-05-29 11:57:59,033 - epoch:11, training loss:5728.8047 validation loss:59.0892
2025-05-29 12:00:25,088 - epoch:12, training loss:10225.2986 validation loss:69.0253
2025-05-29 12:02:50,199 - epoch:13, training loss:9814.0702 validation loss:62.7199
2025-05-29 12:05:15,114 - epoch:14, training loss:11397.2299 validation loss:74.0670
2025-05-29 12:07:40,256 - epoch:15, training loss:9920.8961 validation loss:66.3954
2025-05-29 12:08:30,686 - [*] loss:2691.3208
2025-05-29 12:08:31,959 - [*] year 2017, testing
2025-05-29 12:08:39,410 - T:3	MAE	28.9929	RMSE	42.6369	MAPE	26.8138
2025-05-29 12:08:58,930 - T:6	MAE	30.7783	RMSE	45.4074	MAPE	26.6165
2025-05-29 12:10:10,070 - T:12	MAE	34.7907	RMSE	51.4867	MAPE	27.7377
2025-05-29 12:10:10,070 - T:Avg	MAE	31.1610	RMSE	45.9624	MAPE	26.9632
2025-05-29 12:10:10,073 - Finished optimization, total time:1526.87 s, best model:log/SD/team-42/2017/38.6019.pkl
2025-05-29 12:10:10,122 - [*] Year 2018 load from data/SD/FastData/2018.npz
2025-05-29 12:10:10,156 - [*] load from log/SD/team-42/2017/38.6019.pkl
2025-05-29 12:10:12,585 - number of increase nodes:137, nodes after 2 hop:torch.Size([620]), total nodes this year 708
2025-05-29 12:10:26,866 - [*] Year 2018 Dataset load!
2025-05-29 12:10:26,867 - [*] load from log/SD/team-42/2017/38.6019.pkl
2025-05-29 12:10:26,876 - [*] EWC! lambda 0.001000
Traceback (most recent call last):
  File "/home/bd2/ANATS/Oline_Baselines/main.py", line 199, in <module>
  File "/home/bd2/ANATS/Oline_Baselines/main.py", line 149, in main
  File "/home/bd2/ANATS/Oline_Baselines/src/trainer/default_trainer.py", line 60, in train
  File "/home/bd2/ANATS/Oline_Baselines/src/model/ewc.py", line 69, in register_ewc_params
  File "/home/bd2/ANATS/Oline_Baselines/src/model/ewc.py", line 35, in _update_fisher_params
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/autograd/__init__.py", line 502, in grad
    result = _engine_run_backward(
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/autograd/graph.py", line 824, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: One of the differentiated Tensors appears to not have been used in the graph. Set allow_unused=True if this is the desired behavior.
2025-06-01 23:39:12,331 - logger name:log/SD/team-42/team.log
2025-06-01 23:39:12,331 - params : {'conf': 'conf/SD/team.json', 'seed': 42, 'paral': 0, 'gpuid': 2, 'logname': 'team', 'method': 'TEAM', 'load_first_year': 1, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/SD/team-42/2017/38.6019.pkl', 'device': device(type='cuda', index=2), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 16, 'epoch': 1, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'n_heads': 3, 'in_channels': 1, 'K': 3, 'nb_block': 1, 'nb_chev_filter': 64, 'nb_time_filter': 64, 'num_of_hours': 1, 'missing_value': 0.0, 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/SD/finaldata/', 'save_data_path': 'data/SD/FastData/', 'graph_path': 'data/SD/graph', 'model_path': 'log/SD/', 'strategy': 'incremental', 'init': True, 'increase': True, 'decrease': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'original', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.001, 'replay': True, 'replay_strategy': 'distribution', 'replay_num_samples': 100, 'path': 'log/SD/team-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-01 23:39:12,359 - [*] Year 2017 load from data/SD/FastData/2017.npz
2025-06-01 23:39:12,622 - [*] load from /home/bd2/ANATS/Online_Baselines/log/SD/team-42/2017/38.6019.pkl
2025-06-01 23:39:14,469 - [*] Year 2018 load from data/SD/FastData/2018.npz
2025-06-01 23:39:14,480 - [*] load from /home/bd2/ANATS/Online_Baselines/log/SD/team-42/2017/38.6019.pkl
2025-06-01 23:39:15,938 - number of increase nodes:137, nodes after 2 hop:torch.Size([620]), total nodes this year 708
2025-06-01 23:39:24,049 - [*] Year 2018 Dataset load!
2025-06-01 23:39:24,049 - [*] load from /home/bd2/ANATS/Online_Baselines/log/SD/team-42/2017/38.6019.pkl
2025-06-01 23:39:24,057 - [*] EWC! lambda 0.001000
2025-06-01 23:41:00,160 - Total Parameters: 71948
2025-06-01 23:41:00,160 - Trainable Parameters: 71948
2025-06-01 23:41:00,160 - [*] Year 2018 Training start
2025-06-01 23:41:00,892 - node number torch.Size([9920, 12])
2025-06-01 23:43:09,889 - epoch:0, training loss:11812.6313 validation loss:34.3456
2025-06-01 23:43:58,930 - [*] loss:2546.6331
2025-06-01 23:43:59,569 - [*] year 2018, testing
2025-06-01 23:44:03,608 - T:3	MAE	26.3986	RMSE	41.4928	MAPE	21.8376
2025-06-01 23:44:12,047 - T:6	MAE	28.3897	RMSE	44.0994	MAPE	23.5138
2025-06-01 23:44:40,036 - T:12	MAE	32.8177	RMSE	50.0077	MAPE	28.3374
2025-06-01 23:44:40,037 - T:Avg	MAE	28.8164	RMSE	44.6904	MAPE	24.1563
2025-06-01 23:44:40,040 - Finished optimization, total time:88.39 s, best model:log/SD/team-42/2018/34.3456.pkl
2025-06-01 23:44:40,095 - [*] Year 2019 load from data/SD/FastData/2019.npz
2025-06-01 23:44:40,126 - [*] load from log/SD/team-42/2018/32.915.pkl
2025-06-01 23:44:41,828 - number of increase nodes:142, nodes after 2 hop:torch.Size([584]), total nodes this year 716
2025-06-01 23:44:52,859 - [*] Year 2019 Dataset load!
2025-06-01 23:44:52,859 - [*] load from log/SD/team-42/2018/32.915.pkl
2025-06-01 23:44:52,867 - [*] EWC! lambda 0.001000
2025-06-01 23:46:05,421 - logger name:log/SD/team-42/team.log
2025-06-01 23:46:05,421 - params : {'conf': 'conf/SD/team.json', 'seed': 42, 'paral': 0, 'gpuid': 2, 'logname': 'team', 'method': 'TEAM', 'load_first_year': 1, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/SD/team-42/2017/38.6019.pkl', 'device': device(type='cuda', index=2), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 16, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'n_heads': 3, 'in_channels': 1, 'K': 3, 'nb_block': 1, 'nb_chev_filter': 64, 'nb_time_filter': 64, 'num_of_hours': 1, 'missing_value': 0.0, 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/SD/finaldata/', 'save_data_path': 'data/SD/FastData/', 'graph_path': 'data/SD/graph', 'model_path': 'log/SD/', 'strategy': 'incremental', 'init': True, 'increase': True, 'decrease': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'original', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.001, 'replay': True, 'replay_strategy': 'distribution', 'replay_num_samples': 100, 'path': 'log/SD/team-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-01 23:46:05,450 - [*] Year 2017 load from data/SD/FastData/2017.npz
2025-06-01 23:46:05,710 - [*] load from /home/bd2/ANATS/Online_Baselines/log/SD/team-42/2017/38.6019.pkl
2025-06-01 23:46:57,006 - [*] loss:2691.3208
2025-06-01 23:46:57,624 - [*] year 2017, testing
2025-06-01 23:47:02,111 - T:3	MAE	28.9929	RMSE	42.6369	MAPE	26.8138
2025-06-01 23:47:11,088 - T:6	MAE	30.7783	RMSE	45.4074	MAPE	26.6165
2025-06-01 23:47:40,309 - T:12	MAE	34.7907	RMSE	51.4867	MAPE	27.7377
2025-06-01 23:47:40,310 - T:Avg	MAE	31.1610	RMSE	45.9624	MAPE	26.9632
2025-06-01 23:47:40,340 - [*] Year 2018 load from data/SD/FastData/2018.npz
2025-06-01 23:47:40,370 - [*] load from /home/bd2/ANATS/Online_Baselines/log/SD/team-42/2017/38.6019.pkl
2025-06-01 23:47:41,825 - number of increase nodes:137, nodes after 2 hop:torch.Size([620]), total nodes this year 708
2025-06-01 23:47:49,706 - [*] Year 2018 Dataset load!
2025-06-01 23:47:49,706 - [*] load from /home/bd2/ANATS/Online_Baselines/log/SD/team-42/2017/38.6019.pkl
2025-06-01 23:47:49,713 - [*] EWC! lambda 0.001000
2025-06-01 23:49:24,254 - Total Parameters: 71948
2025-06-01 23:49:24,255 - Trainable Parameters: 71948
2025-06-01 23:49:24,256 - [*] Year 2018 Training start
2025-06-01 23:49:25,806 - node number torch.Size([9920, 12])
2025-06-01 23:51:47,993 - epoch:0, training loss:8716.7875 validation loss:33.2417
2025-06-01 23:54:10,902 - epoch:1, training loss:8678.1395 validation loss:35.8867
2025-06-01 23:56:36,689 - epoch:2, training loss:11024.7211 validation loss:35.2883
2025-06-01 23:58:58,447 - epoch:3, training loss:15807.2635 validation loss:35.8144
2025-06-02 00:01:22,472 - epoch:4, training loss:9075.0189 validation loss:34.4341
2025-06-02 00:03:47,894 - epoch:5, training loss:16531.8675 validation loss:33.9845
2025-06-02 00:06:11,510 - epoch:6, training loss:13182.3248 validation loss:34.0297
2025-06-02 00:07:01,416 - [*] loss:2581.0906
2025-06-02 00:07:02,193 - [*] year 2018, testing
2025-06-02 00:07:07,000 - T:3	MAE	27.3490	RMSE	41.6368	MAPE	33.7161
2025-06-02 00:07:15,877 - T:6	MAE	29.8069	RMSE	44.6147	MAPE	36.5239
2025-06-02 00:07:45,622 - T:12	MAE	34.2764	RMSE	50.3339	MAPE	42.0114
2025-06-02 00:07:45,623 - T:Avg	MAE	30.0401	RMSE	44.9832	MAPE	36.8189
2025-06-02 00:07:45,626 - Finished optimization, total time:692.36 s, best model:log/SD/team-42/2018/33.2417.pkl
2025-06-02 00:07:45,686 - [*] Year 2019 load from data/SD/FastData/2019.npz
2025-06-02 00:07:45,731 - [*] load from log/SD/team-42/2018/32.915.pkl
2025-06-02 00:07:47,238 - number of increase nodes:142, nodes after 2 hop:torch.Size([584]), total nodes this year 716
2025-06-02 00:07:55,314 - [*] Year 2019 Dataset load!
2025-06-02 00:07:55,314 - [*] load from log/SD/team-42/2018/32.915.pkl
2025-06-02 00:07:55,325 - [*] EWC! lambda 0.001000
2025-06-02 00:09:29,322 - Total Parameters: 71948
2025-06-02 00:09:29,322 - Trainable Parameters: 71948
2025-06-02 00:09:29,322 - [*] Year 2019 Training start
2025-06-02 00:09:30,617 - node number torch.Size([9344, 12])
2025-06-02 00:11:44,914 - epoch:0, training loss:10669.2158 validation loss:37.4776
2025-06-02 00:13:05,563 - logger name:log/SD/dlf-42/dlf.log
2025-06-02 00:13:05,563 - params : {'conf': 'conf/SD/dlf.json', 'seed': 42, 'paral': 0, 'gpuid': 3, 'logname': 'dlf', 'method': 'DLF', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/SD/dlf-42/2017/31.671.pkl', 'device': device(type='cuda', index=3), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>, 'DLF': <class 'src.model.model.DLF_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 1, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/SD/finaldata/', 'save_data_path': 'data/SD/FastData/', 'graph_path': 'data/SD/graph/', 'model_path': 'log/SD/', 'hidden_channels': 64, 'dilation_channels': 32, 'skip_channels': 32, 'end_channels': 32, 'supports_len': 2, 'kernel_size': 2, 'blocks': 4, 'layers': 2, 'rank': 6, 'train': 1, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'replay_num_samples': 300, 'extra_feature': True, 'momentum_type': 'linear', 'memory_size': 32, 'path': 'log/SD/dlf-42', 'logger': <Logger utils.initialize (INFO)>}
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 818149.24it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 1041467.09it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 1031404.73it/s]
2025-06-02 00:13:21,868 - [*] Year 2017 load from data/SD/FastData/2017.npz
2025-06-02 00:13:22,142 - [*] Year 2017 Dataset load!
2025-06-02 00:13:22,149 - Total Parameters: 65356
2025-06-02 00:13:22,149 - Trainable Parameters: 65356
2025-06-02 00:13:22,149 - [*] Year 2017 Training start
2025-06-02 00:13:22,661 - node number torch.Size([90240, 12])
2025-06-02 00:14:03,353 - epoch:1, training loss:8999.3940 validation loss:34.1728
2025-06-02 00:14:45,576 - epoch:0, training loss:7196.6323 validation loss:31.6710
2025-06-02 00:15:08,225 - [*] loss:2247.4675
2025-06-02 00:15:08,823 - [*] year 2017, testing
2025-06-02 00:15:13,735 - T:3	MAE	23.5428	RMSE	34.1038	MAPE	18.4450
2025-06-02 00:15:23,186 - T:6	MAE	26.4065	RMSE	38.4616	MAPE	20.9504
2025-06-02 00:15:53,609 - T:12	MAE	32.0533	RMSE	47.0150	MAPE	25.9530
2025-06-02 00:15:53,610 - T:Avg	MAE	26.8866	RMSE	39.1409	MAPE	21.4446
2025-06-02 00:15:53,613 - Finished optimization, total time:59.79 s, best model:log/SD/dlf-42/2017/31.671.pkl
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 954790.94it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 973770.35it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 998096.70it/s]
2025-06-02 00:16:08,391 - [*] Year 2018 load from data/SD/FastData/2018.npz
2025-06-02 00:16:08,425 - [*] load from log/SD/dlf-42/2017/31.671.pkl
2025-06-02 00:16:13,341 - number of increase nodes:259, nodes after 2 hop:torch.Size([675]), total nodes this year 708
2025-06-02 00:16:16,569 - [*] Year 2018 Dataset load!
2025-06-02 00:16:16,570 - [*] load from log/SD/dlf-42/2017/31.671.pkl
2025-06-02 00:16:16,587 - [*] EWC! lambda 0.000100
2025-06-02 00:16:23,573 - epoch:2, training loss:8622.9266 validation loss:34.5657
2025-06-02 00:17:14,984 - Total Parameters: 65356
2025-06-02 00:17:14,984 - Trainable Parameters: 65356
2025-06-02 00:17:14,985 - [*] Year 2018 Training start
2025-06-02 00:17:16,085 - node number torch.Size([86400, 12])
2025-06-02 00:18:31,930 - epoch:0, training loss:2940.8485 validation loss:28.6843
2025-06-02 00:18:42,676 - epoch:3, training loss:7890.2277 validation loss:37.1485
2025-06-02 00:18:55,008 - [*] loss:1965.9445
2025-06-02 00:18:55,612 - [*] year 2018, testing
2025-06-02 00:18:59,964 - T:3	MAE	22.0456	RMSE	32.2007	MAPE	14.5897
2025-06-02 00:19:09,023 - T:6	MAE	24.7186	RMSE	36.4195	MAPE	16.5017
2025-06-02 00:19:37,815 - T:12	MAE	29.5722	RMSE	43.7775	MAPE	21.0761
2025-06-02 00:19:37,815 - T:Avg	MAE	25.0111	RMSE	36.7961	MAPE	16.9936
2025-06-02 00:19:37,818 - Finished optimization, total time:57.11 s, best model:log/SD/dlf-42/2018/28.6843.pkl
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 969221.37it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 1090771.20it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 947852.83it/s]
2025-06-02 00:19:53,151 - [*] Year 2019 load from data/SD/FastData/2019.npz
2025-06-02 00:19:53,184 - [*] load from log/SD/dlf-42/2018/28.6843.pkl
2025-06-02 00:19:58,973 - number of increase nodes:281, nodes after 2 hop:torch.Size([704]), total nodes this year 716
2025-06-02 00:20:02,366 - [*] Year 2019 Dataset load!
2025-06-02 00:20:02,366 - [*] load from log/SD/dlf-42/2018/28.6843.pkl
2025-06-02 00:20:02,373 - [*] EWC! lambda 0.000100
2025-06-02 00:20:59,980 - epoch:4, training loss:12499.0181 validation loss:34.0450
2025-06-02 00:21:02,044 - Total Parameters: 65356
2025-06-02 00:21:02,044 - Trainable Parameters: 65356
2025-06-02 00:21:02,044 - [*] Year 2019 Training start
2025-06-02 00:21:03,485 - node number torch.Size([90112, 12])
2025-06-02 00:22:21,874 - epoch:0, training loss:2508.2504 validation loss:31.5853
2025-06-02 00:22:46,402 - [*] loss:1855.5870
2025-06-02 00:22:47,036 - [*] year 2019, testing
2025-06-02 00:22:51,364 - T:3	MAE	22.4008	RMSE	32.5677	MAPE	20.7584
2025-06-02 00:23:00,451 - T:6	MAE	24.6466	RMSE	36.3151	MAPE	21.7902
2025-06-02 00:23:17,592 - epoch:5, training loss:26816.4019 validation loss:34.4858
2025-06-02 00:23:30,361 - T:12	MAE	28.7462	RMSE	43.0584	MAPE	23.9216
2025-06-02 00:23:30,361 - T:Avg	MAE	24.9042	RMSE	36.7078	MAPE	21.9676
2025-06-02 00:23:30,364 - Finished optimization, total time:58.60 s, best model:log/SD/dlf-42/2019/31.5853.pkl
  0%|          | 0/21080 [00:00<?, ?it/s]100%|██████████| 21080/21080 [00:00<00:00, 914284.97it/s]
  0%|          | 0/21081 [00:00<?, ?it/s]100%|██████████| 21081/21081 [00:00<00:00, 1037770.51it/s]
  0%|          | 0/21081 [00:00<?, ?it/s]100%|██████████| 21081/21081 [00:00<00:00, 1064123.17it/s]
2025-06-02 00:23:44,674 - [*] Year 2020 load from data/SD/FastData/2020.npz
2025-06-02 00:23:44,705 - [*] load from log/SD/dlf-42/2019/31.5853.pkl
2025-06-02 00:23:45,537 - The number of data points in the previous year is greater than the current year, skipping detection and replay.
2025-06-02 00:23:45,606 - number of increase nodes:238, nodes after 2 hop:torch.Size([653]), total nodes this year 697
2025-06-02 00:23:48,506 - [*] Year 2020 Dataset load!
2025-06-02 00:23:48,506 - [*] load from log/SD/dlf-42/2019/31.5853.pkl
2025-06-02 00:23:48,514 - [*] EWC! lambda 0.000100
2025-06-02 00:24:47,284 - Total Parameters: 65356
2025-06-02 00:24:47,284 - Trainable Parameters: 65356
2025-06-02 00:24:47,284 - [*] Year 2020 Training start
2025-06-02 00:24:48,687 - node number torch.Size([83584, 12])
2025-06-02 00:25:38,197 - epoch:6, training loss:8871.6293 validation loss:35.9058
2025-06-02 00:26:04,865 - logger name:log/SD/dlf-42/dlf.log
2025-06-02 00:26:04,865 - params : {'conf': 'conf/SD/dlf.json', 'seed': 42, 'paral': 0, 'gpuid': 3, 'logname': 'dlf', 'method': 'DLF', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/SD/dlf-42/2017/31.671.pkl', 'device': device(type='cuda', index=3), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>, 'DLF': <class 'src.model.model.DLF_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/SD/finaldata/', 'save_data_path': 'data/SD/FastData/', 'graph_path': 'data/SD/graph/', 'model_path': 'log/SD/', 'hidden_channels': 64, 'dilation_channels': 32, 'skip_channels': 32, 'end_channels': 32, 'supports_len': 2, 'kernel_size': 2, 'blocks': 4, 'layers': 2, 'rank': 6, 'train': 1, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'replay_num_samples': 300, 'extra_feature': True, 'momentum_type': 'linear', 'memory_size': 32, 'path': 'log/SD/dlf-42', 'logger': <Logger utils.initialize (INFO)>}
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 879964.60it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 640540.85it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 888047.02it/s]
2025-06-02 00:26:19,806 - [*] Year 2017 load from data/SD/FastData/2017.npz
2025-06-02 00:26:20,098 - [*] Year 2017 Dataset load!
2025-06-02 00:26:20,110 - Total Parameters: 65356
2025-06-02 00:26:20,110 - Trainable Parameters: 65356
2025-06-02 00:26:20,110 - [*] Year 2017 Training start
2025-06-02 00:26:20,728 - node number torch.Size([90240, 12])
2025-06-02 00:27:44,237 - epoch:0, training loss:7196.6323 validation loss:31.6710
2025-06-02 00:27:44,493 - epoch:7, training loss:20488.7161 validation loss:35.0383
2025-06-02 00:29:08,223 - epoch:1, training loss:2104.6924 validation loss:40.4166
2025-06-02 00:30:00,893 - epoch:8, training loss:49244.4796 validation loss:36.0437
2025-06-02 00:30:32,636 - epoch:2, training loss:1930.7860 validation loss:31.7446
2025-06-02 00:31:56,983 - epoch:3, training loss:1844.0051 validation loss:28.2482
2025-06-02 00:32:15,843 - epoch:9, training loss:7689.8473 validation loss:37.2409
2025-06-02 00:33:21,478 - epoch:4, training loss:1800.9172 validation loss:45.2169
2025-06-02 00:34:34,162 - epoch:10, training loss:5708.3640 validation loss:36.5760
2025-06-02 00:34:45,785 - epoch:5, training loss:1792.4544 validation loss:30.6545
2025-06-02 00:35:22,007 - [*] loss:2696.8413
2025-06-02 00:35:22,620 - [*] year 2019, testing
2025-06-02 00:35:27,396 - T:3	MAE	26.8033	RMSE	42.6574	MAPE	20.8304
2025-06-02 00:35:36,839 - T:6	MAE	28.8644	RMSE	45.4132	MAPE	21.7880
2025-06-02 00:36:08,131 - T:12	MAE	33.1820	RMSE	51.3457	MAPE	24.3252
2025-06-02 00:36:08,131 - T:Avg	MAE	29.2325	RMSE	45.9412	MAPE	22.0985
2025-06-02 00:36:08,134 - Finished optimization, total time:1031.57 s, best model:log/SD/team-42/2019/34.045.pkl
2025-06-02 00:36:08,187 - [*] Year 2020 load from data/SD/FastData/2020.npz
2025-06-02 00:36:08,208 - [*] load from log/SD/team-42/2019/34.045.pkl
2025-06-02 00:36:09,044 - The number of data points in the previous year is greater than the current year, skipping detection and replay.
Traceback (most recent call last):
  File "/home/bd2/ANATS/Online_Baselines/main.py", line 199, in <module>
    main(args)
  File "/home/bd2/ANATS/Online_Baselines/main.py", line 98, in main
    replay_node_list = replay.replay_node_selection(args,influence_node_score,topk, pre_data, cur_data, pre_graph, cur_graph)  # Select the replay node
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/ANATS/Online_Baselines/src/model/replay.py", line 16, in replay_node_selection
    return select_stablest_node(args, pre_data, cur_data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/ANATS/Online_Baselines/src/model/replay.py", line 81, in select_stablest_node
    max_val = max(max(pre_data[:,node]), max(cur_data[:,node]))
                                             ~~~~~~~~^^^^^^^^
IndexError: index 697 is out of bounds for axis 1 with size 697
2025-06-02 00:36:10,737 - epoch:6, training loss:1777.4417 validation loss:31.5215
2025-06-02 00:37:35,134 - epoch:7, training loss:1743.9149 validation loss:34.0433
2025-06-02 00:38:59,622 - epoch:8, training loss:1705.0685 validation loss:33.6474
2025-06-02 00:40:24,262 - epoch:9, training loss:1705.7145 validation loss:56.2629
2025-06-02 00:40:47,620 - [*] loss:1847.6704
2025-06-02 00:40:48,268 - [*] year 2017, testing
2025-06-02 00:40:53,326 - T:3	MAE	22.1317	RMSE	32.4090	MAPE	14.4053
2025-06-02 00:41:03,054 - T:6	MAE	24.2099	RMSE	36.0276	MAPE	15.3224
2025-06-02 00:41:33,608 - T:12	MAE	28.1551	RMSE	42.5165	MAPE	17.5778
2025-06-02 00:41:33,609 - T:Avg	MAE	24.4584	RMSE	36.3658	MAPE	15.5460
2025-06-02 00:41:33,612 - Finished optimization, total time:606.53 s, best model:log/SD/dlf-42/2017/28.2482.pkl
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 952244.12it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 998797.65it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 1018879.09it/s]
2025-06-02 00:41:50,532 - [*] Year 2018 load from data/SD/FastData/2018.npz
2025-06-02 00:41:50,562 - [*] load from log/SD/dlf-42/2017/28.2482.pkl
2025-06-02 00:41:55,953 - number of increase nodes:257, nodes after 2 hop:torch.Size([672]), total nodes this year 708
2025-06-02 00:41:59,338 - [*] Year 2018 Dataset load!
2025-06-02 00:41:59,338 - [*] load from log/SD/dlf-42/2017/28.2482.pkl
2025-06-02 00:41:59,344 - [*] EWC! lambda 0.000100
2025-06-02 00:42:57,987 - Total Parameters: 65356
2025-06-02 00:42:57,987 - Trainable Parameters: 65356
2025-06-02 00:42:57,988 - [*] Year 2018 Training start
2025-06-02 00:42:59,365 - node number torch.Size([86016, 12])
2025-06-02 00:44:14,073 - epoch:0, training loss:2509.0505 validation loss:30.4772
2025-06-02 00:45:29,840 - epoch:1, training loss:1851.7660 validation loss:30.9340
2025-06-02 00:46:45,833 - epoch:2, training loss:1881.0195 validation loss:28.9639
2025-06-02 00:48:01,634 - epoch:3, training loss:1869.9861 validation loss:30.9686
2025-06-02 00:49:17,199 - epoch:4, training loss:1873.2658 validation loss:27.6727
2025-06-02 00:50:32,925 - epoch:5, training loss:1845.5599 validation loss:30.7919
2025-06-02 00:51:48,586 - epoch:6, training loss:1851.0169 validation loss:31.2532
2025-06-02 00:53:04,701 - epoch:7, training loss:1884.0265 validation loss:30.0359
2025-06-02 00:54:21,270 - epoch:8, training loss:1814.3454 validation loss:27.9502
2025-06-02 00:55:37,966 - epoch:9, training loss:1833.7571 validation loss:31.7728
2025-06-02 00:56:54,757 - epoch:10, training loss:1850.3220 validation loss:26.9738
2025-06-02 00:58:11,198 - epoch:11, training loss:1827.5216 validation loss:37.4960
2025-06-02 00:59:27,279 - epoch:12, training loss:1852.1778 validation loss:33.8409
2025-06-02 01:00:43,286 - epoch:13, training loss:1838.3743 validation loss:28.1975
2025-06-02 01:01:59,747 - epoch:14, training loss:1816.2119 validation loss:26.6384
2025-06-02 01:03:16,723 - epoch:15, training loss:1807.5202 validation loss:33.1939
2025-06-02 01:04:33,210 - epoch:16, training loss:1778.6210 validation loss:27.2122
2025-06-02 01:05:49,819 - epoch:17, training loss:1791.6584 validation loss:49.5714
2025-06-02 01:07:06,117 - epoch:18, training loss:1949.7983 validation loss:28.7293
2025-06-02 01:08:22,631 - epoch:19, training loss:1841.0365 validation loss:38.0953
2025-06-02 01:09:38,853 - epoch:20, training loss:1831.3413 validation loss:34.2402
2025-06-02 01:10:02,333 - [*] loss:1884.7456
2025-06-02 01:10:03,036 - [*] year 2018, testing
2025-06-02 01:10:08,084 - T:3	MAE	23.1710	RMSE	32.6413	MAPE	15.6562
2025-06-02 01:10:17,789 - T:6	MAE	25.1825	RMSE	36.1195	MAPE	16.4318
2025-06-02 01:10:48,208 - T:12	MAE	29.2605	RMSE	42.8137	MAPE	18.2449
2025-06-02 01:10:48,208 - T:Avg	MAE	25.5626	RMSE	36.6578	MAPE	16.6565
2025-06-02 01:10:48,211 - Finished optimization, total time:1184.66 s, best model:log/SD/dlf-42/2018/26.6384.pkl
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 884972.13it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 1053587.59it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 930626.42it/s]
2025-06-02 01:11:03,256 - [*] Year 2019 load from data/SD/FastData/2019.npz
2025-06-02 01:11:03,288 - [*] load from log/SD/dlf-42/2018/26.6384.pkl
2025-06-02 01:11:08,735 - number of increase nodes:278, nodes after 2 hop:torch.Size([705]), total nodes this year 716
2025-06-02 01:11:12,167 - [*] Year 2019 Dataset load!
2025-06-02 01:11:12,167 - [*] load from log/SD/dlf-42/2018/26.6384.pkl
2025-06-02 01:11:12,175 - [*] EWC! lambda 0.000100
2025-06-02 01:12:11,927 - Total Parameters: 65356
2025-06-02 01:12:11,927 - Trainable Parameters: 65356
2025-06-02 01:12:11,928 - [*] Year 2019 Training start
2025-06-02 01:12:13,195 - node number torch.Size([90240, 12])
2025-06-02 01:13:33,574 - epoch:0, training loss:2113.3819 validation loss:29.9758
2025-06-02 01:14:55,208 - epoch:1, training loss:1653.3108 validation loss:26.5892
2025-06-02 01:16:16,871 - epoch:2, training loss:1599.9435 validation loss:27.4907
2025-06-02 01:17:38,425 - epoch:3, training loss:1635.6971 validation loss:30.1147
2025-06-02 01:19:00,083 - epoch:4, training loss:1618.4038 validation loss:30.3949
2025-06-02 01:20:21,838 - epoch:5, training loss:1642.9984 validation loss:26.2347
2025-06-02 01:21:43,530 - epoch:6, training loss:1601.1373 validation loss:27.5474
2025-06-02 01:23:05,291 - epoch:7, training loss:1579.9563 validation loss:29.8453
2025-06-02 01:23:52,544 - logger name:log/SD/team-42/team.log
2025-06-02 01:23:52,544 - params : {'conf': 'conf/SD/team.json', 'seed': 42, 'paral': 0, 'gpuid': 1, 'logname': 'team', 'method': 'TEAM', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/SD/team-42/2019/34.045.pkl', 'device': device(type='cuda', index=1), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>, 'DLF': <class 'src.model.model.DLF_Model'>}, 'begin_year': 2019, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.001, 'batch_size': 16, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'n_heads': 3, 'in_channels': 1, 'K': 3, 'nb_block': 1, 'nb_chev_filter': 64, 'nb_time_filter': 64, 'num_of_hours': 1, 'missing_value': 0.0, 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/SD/finaldata/', 'save_data_path': 'data/SD/FastData/', 'graph_path': 'data/SD/graph', 'model_path': 'log/SD/', 'strategy': 'incremental', 'init': True, 'increase': True, 'decrease': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'original', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.001, 'replay': True, 'replay_strategy': 'distribution', 'replay_num_samples': 100, 'path': 'log/SD/team-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-02 01:23:52,572 - [*] Year 2019 load from data/SD/FastData/2019.npz
2025-06-02 01:23:58,480 - [*] Year 2019 Dataset load!
2025-06-02 01:23:58,550 - Total Parameters: 71948
2025-06-02 01:23:58,550 - Trainable Parameters: 71948
2025-06-02 01:23:58,550 - [*] Year 2019 Training start
2025-06-02 01:23:58,879 - node number torch.Size([11456, 12])
2025-06-02 01:24:21,589 - logger name:log/SD/team-42/team.log
2025-06-02 01:24:21,589 - params : {'conf': 'conf/SD/team.json', 'seed': 42, 'paral': 0, 'gpuid': 1, 'logname': 'team', 'method': 'TEAM', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/Online_Baselines/log/SD/team-42/2019/34.045.pkl', 'device': device(type='cuda', index=1), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>, 'DLF': <class 'src.model.model.DLF_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.001, 'batch_size': 16, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'n_heads': 3, 'in_channels': 1, 'K': 3, 'nb_block': 1, 'nb_chev_filter': 64, 'nb_time_filter': 64, 'num_of_hours': 1, 'missing_value': 0.0, 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/SD/finaldata/', 'save_data_path': 'data/SD/FastData/', 'graph_path': 'data/SD/graph', 'model_path': 'log/SD/', 'strategy': 'incremental', 'init': True, 'increase': True, 'decrease': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'original', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.001, 'replay': True, 'replay_strategy': 'distribution', 'replay_num_samples': 100, 'path': 'log/SD/team-42', 'logger': <Logger utils.initialize (INFO)>}
2025-06-02 01:24:21,617 - [*] Year 2017 load from data/SD/FastData/2017.npz
2025-06-02 01:24:27,025 - epoch:8, training loss:1580.5638 validation loss:26.8440
2025-06-02 01:24:27,699 - [*] Year 2017 Dataset load!
2025-06-02 01:24:27,769 - Total Parameters: 71948
2025-06-02 01:24:27,769 - Trainable Parameters: 71948
2025-06-02 01:24:27,769 - [*] Year 2017 Training start
2025-06-02 01:24:28,234 - node number torch.Size([11280, 12])
2025-06-02 01:25:48,579 - epoch:9, training loss:1563.3874 validation loss:26.5572
2025-06-02 01:26:54,276 - epoch:0, training loss:4979.5676 validation loss:33.0177
2025-06-02 01:27:10,336 - epoch:10, training loss:1601.8382 validation loss:25.4796
2025-06-02 01:28:31,981 - epoch:11, training loss:1620.8848 validation loss:29.5006
2025-06-02 01:29:21,442 - epoch:1, training loss:1998.6516 validation loss:36.3522
