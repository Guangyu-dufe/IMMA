2025-05-26 02:14:48,181 - logger name:log/SD/oneline_st_nn_sd-42/oneline_st_nn_sd.log
2025-05-26 02:14:48,181 - params : {'conf': 'conf/SD/online_st_nn.json', 'seed': 42, 'paral': 0, 'gpuid': 2, 'logname': 'oneline_st_nn_sd', 'method': 'TrafficStream', 'load_first_year': 0, 'first_year_model_path': 'log/SD/trafficstream-42/2019/22.3629.pkl', 'device': device(type='cuda', index=2), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/SD/finaldata/', 'save_data_path': 'data/SD/FastData/', 'graph_path': 'data/SD/graph/', 'model_path': 'log/SD/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'rank': 6, 'train': 1, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': False, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': False, 'path': 'log/SD/oneline_st_nn_sd-42', 'logger': <Logger utils.initialize (INFO)>}
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 862061.80it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 889265.03it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 1049212.32it/s]
2025-05-26 02:15:04,307 - [*] Year 2017 load from data/SD/FastData/2017.npz
2025-05-26 02:15:04,586 - [*] Year 2017 Dataset load!
2025-05-26 02:15:04,589 - Total Parameters: 3308
2025-05-26 02:15:04,589 - Trainable Parameters: 3308
2025-05-26 02:15:04,589 - [*] Year 2017 Training start
2025-05-26 02:15:04,913 - node number torch.Size([90240, 12])
2025-05-26 02:15:09,743 - epoch:0, training loss:18180.7709 validation loss:49.8031
2025-05-26 02:15:14,379 - epoch:1, training loss:2851.6175 validation loss:35.2882
2025-05-26 02:15:19,128 - epoch:2, training loss:2227.2044 validation loss:33.5646
2025-05-26 02:15:23,818 - epoch:3, training loss:2138.6287 validation loss:34.8725
2025-05-26 02:15:28,443 - epoch:4, training loss:2108.3498 validation loss:35.1587
2025-05-26 02:15:33,215 - epoch:5, training loss:2056.2845 validation loss:32.7855
2025-05-26 02:15:38,043 - epoch:6, training loss:1987.8954 validation loss:32.9930
2025-05-26 02:15:42,970 - epoch:7, training loss:1949.6523 validation loss:33.3834
2025-05-26 02:15:47,742 - epoch:8, training loss:1951.7061 validation loss:34.9994
2025-05-26 02:15:52,621 - epoch:9, training loss:1935.0494 validation loss:35.8891
2025-05-26 02:15:57,376 - epoch:10, training loss:1943.1483 validation loss:35.6961
2025-05-26 02:16:02,225 - epoch:11, training loss:1925.6423 validation loss:33.4956
2025-05-26 02:16:04,421 - [*] loss:1991.8922
2025-05-26 02:16:04,947 - [*] year 2017, testing
2025-05-26 02:16:09,891 - T:3	MAE	23.9438	RMSE	33.7044	MAPE	18.1451
2025-05-26 02:16:19,483 - T:6	MAE	25.2292	RMSE	36.6673	MAPE	18.7154
2025-05-26 02:16:50,326 - T:12	MAE	29.0428	RMSE	44.2175	MAPE	20.9770
2025-05-26 02:16:50,326 - T:Avg	MAE	25.7522	RMSE	37.5641	MAPE	19.0944
2025-05-26 02:16:50,329 - Finished optimization, total time:30.47 s, best model:log/SD/oneline_st_nn_sd-42/2017/32.7855.pkl
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 954997.76it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 986505.86it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 995707.32it/s]
2025-05-26 02:17:06,933 - [*] Year 2018 load from data/SD/FastData/2018.npz
2025-05-26 02:17:06,973 - [*] load from log/SD/oneline_st_nn_sd-42/2017/32.7855.pkl
2025-05-26 02:17:07,860 - number of increase nodes:3, nodes after 2 hop:torch.Size([20]), total nodes this year 708
2025-05-26 02:17:07,960 - [*] Year 2018 Dataset load!
2025-05-26 02:17:07,960 - [*] load from log/SD/oneline_st_nn_sd-42/2017/32.7855.pkl
2025-05-26 02:17:07,963 - Total Parameters: 3308
2025-05-26 02:17:07,963 - Trainable Parameters: 3308
2025-05-26 02:17:07,963 - [*] Year 2018 Training start
2025-05-26 02:17:08,768 - node number torch.Size([2560, 12])
2025-05-26 02:17:11,918 - epoch:0, training loss:402.0954 validation loss:12.9358
2025-05-26 02:17:15,438 - epoch:1, training loss:345.2542 validation loss:13.9766
2025-05-26 02:17:18,587 - epoch:2, training loss:345.1395 validation loss:16.2838
2025-05-26 02:17:22,228 - epoch:3, training loss:344.1805 validation loss:15.4469
2025-05-26 02:17:25,475 - epoch:4, training loss:342.1581 validation loss:22.6723
2025-05-26 02:17:28,468 - epoch:5, training loss:344.1001 validation loss:17.4834
2025-05-26 02:17:31,736 - epoch:6, training loss:344.6253 validation loss:16.5306
2025-05-26 02:17:34,209 - [*] loss:2174.6890
2025-05-26 02:17:34,579 - [*] year 2018, testing
2025-05-26 02:17:38,438 - T:3	MAE	20.9406	RMSE	31.2304	MAPE	14.9745
2025-05-26 02:17:45,940 - T:6	MAE	23.7356	RMSE	35.8792	MAPE	16.8609
2025-05-26 02:18:12,724 - T:12	MAE	29.8716	RMSE	46.1223	MAPE	20.8344
2025-05-26 02:18:12,724 - T:Avg	MAE	24.3275	RMSE	36.8873	MAPE	17.2057
2025-05-26 02:18:12,727 - Finished optimization, total time:13.75 s, best model:log/SD/oneline_st_nn_sd-42/2018/12.9358.pkl
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 958298.23it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 1039184.14it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 1059105.09it/s]
2025-05-26 02:18:29,093 - [*] Year 2019 load from data/SD/FastData/2019.npz
2025-05-26 02:18:29,139 - [*] load from log/SD/oneline_st_nn_sd-42/2018/12.9358.pkl
2025-05-26 02:18:30,060 - number of increase nodes:8, nodes after 2 hop:torch.Size([54]), total nodes this year 716
2025-05-26 02:18:30,322 - [*] Year 2019 Dataset load!
2025-05-26 02:18:30,322 - [*] load from log/SD/oneline_st_nn_sd-42/2018/12.9358.pkl
2025-05-26 02:18:30,325 - Total Parameters: 3308
2025-05-26 02:18:30,325 - Trainable Parameters: 3308
2025-05-26 02:18:30,326 - [*] Year 2019 Training start
2025-05-26 02:18:31,437 - node number torch.Size([6912, 12])
2025-05-26 02:18:34,731 - epoch:0, training loss:505.0802 validation loss:14.8691
2025-05-26 02:18:38,602 - epoch:1, training loss:497.6128 validation loss:14.6718
2025-05-26 02:18:42,874 - epoch:2, training loss:487.8237 validation loss:14.7424
2025-05-26 02:18:47,006 - epoch:3, training loss:488.6302 validation loss:14.8976
2025-05-26 02:18:51,007 - epoch:4, training loss:485.4686 validation loss:16.5373
2025-05-26 02:18:54,985 - epoch:5, training loss:490.1910 validation loss:16.8476
2025-05-26 02:18:59,158 - epoch:6, training loss:512.0275 validation loss:15.7198
2025-05-26 02:19:03,151 - epoch:7, training loss:485.3146 validation loss:15.0226
2025-05-26 02:19:06,039 - [*] loss:2236.8862
2025-05-26 02:19:06,458 - [*] year 2019, testing
2025-05-26 02:19:10,988 - T:3	MAE	23.2672	RMSE	33.7225	MAPE	21.2728
2025-05-26 02:19:20,032 - T:6	MAE	26.2879	RMSE	38.4292	MAPE	23.5339
2025-05-26 02:19:50,416 - T:12	MAE	31.5213	RMSE	47.0798	MAPE	27.4172
2025-05-26 02:19:50,416 - T:Avg	MAE	26.5334	RMSE	38.9405	MAPE	23.7296
2025-05-26 02:19:50,419 - Finished optimization, total time:18.60 s, best model:log/SD/oneline_st_nn_sd-42/2019/14.6718.pkl
  0%|          | 0/21080 [00:00<?, ?it/s]100%|██████████| 21080/21080 [00:00<00:00, 955692.90it/s]
  0%|          | 0/21081 [00:00<?, ?it/s]100%|██████████| 21081/21081 [00:00<00:00, 986545.45it/s]
  0%|          | 0/21081 [00:00<?, ?it/s]100%|██████████| 21081/21081 [00:00<00:00, 1024388.84it/s]
2025-05-26 02:20:06,977 - [*] Year 2020 load from data/SD/FastData/2020.npz
2025-05-26 02:20:07,017 - [*] load from log/SD/oneline_st_nn_sd-42/2019/14.6718.pkl
2025-05-26 02:20:08,005 - number of increase nodes:0, nodes after 2 hop:torch.Size([54]), total nodes this year 697
2025-05-26 02:20:08,005 - [*] load from log/SD/oneline_st_nn_sd-42/2019/14.6718.pkl
2025-05-26 02:20:11,678 - [*] loss:3929.6252
2025-05-26 02:20:12,045 - [*] year 2020, testing
2025-05-26 02:20:16,102 - T:3	MAE	47.7425	RMSE	58.6549	MAPE	53.9550
2025-05-26 02:20:23,545 - T:6	MAE	49.3436	RMSE	61.1777	MAPE	56.0941
2025-05-26 02:20:49,325 - T:12	MAE	49.9964	RMSE	63.2355	MAPE	58.7244
2025-05-26 02:20:49,326 - T:Avg	MAE	48.9066	RMSE	60.7422	MAPE	55.9981
2025-05-26 02:20:49,328 - [*] No increasing nodes at year 2020, store model of the last year.
2025-05-26 02:20:49,329 - 


2025-05-26 02:20:49,329 - 3   	 MAE	     23.94	     20.94	     23.27	     47.74		   28.97
2025-05-26 02:20:49,329 - 3   	RMSE	     33.70	     31.23	     33.72	     58.65		   39.33
2025-05-26 02:20:49,329 - 3   	MAPE	     18.15	     14.97	     21.27	     53.96		   27.09
2025-05-26 02:20:49,329 - 6   	 MAE	     25.23	     23.74	     26.29	     49.34		   31.15
2025-05-26 02:20:49,329 - 6   	RMSE	     36.67	     35.88	     38.43	     61.18		   43.04
2025-05-26 02:20:49,329 - 6   	MAPE	     18.72	     16.86	     23.53	     56.09		   28.80
2025-05-26 02:20:49,329 - 12  	 MAE	     29.04	     29.87	     31.52	     50.00		   35.11
2025-05-26 02:20:49,329 - 12  	RMSE	     44.22	     46.12	     47.08	     63.24		   50.16
2025-05-26 02:20:49,329 - 12  	MAPE	     20.98	     20.83	     27.42	     58.72		   31.99
2025-05-26 02:20:49,329 - Avg 	 MAE	     25.75	     24.33	     26.53	     48.91		   31.38
2025-05-26 02:20:49,329 - Avg 	RMSE	     37.56	     36.89	     38.94	     60.74		   43.53
2025-05-26 02:20:49,329 - Avg 	MAPE	     19.09	     17.21	     23.73	     56.00		   29.01
2025-05-26 02:20:49,329 - year	2017	total_time	   30.4654	average_time	    2.5388	epoch	12
2025-05-26 02:20:49,329 - year	2018	total_time	   13.7492	average_time	    1.9642	epoch	7
2025-05-26 02:20:49,330 - year	2019	total_time	   18.5999	average_time	    2.3250	epoch	8
2025-05-26 02:20:49,330 - total time: 62.8145
2025-05-29 02:20:48,493 - logger name:log/SD/pecpm-42/pecpm.log
2025-05-29 02:20:48,493 - params : {'conf': 'conf/SD/pecpm.json', 'seed': 42, 'paral': 0, 'gpuid': 2, 'logname': 'pecpm', 'method': 'PECPM', 'load_first_year': 0, 'first_year_model_path': 'log/SD/pecpm-42/2017/31.5668.pkl', 'device': device(type='cuda', index=2), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'PECPM': <class 'src.model.model.PECPM_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'beita': 1.0, 'cluster': 32, 'raw_data_path': 'data/SD/finaldata/', 'save_data_path': 'data/SD/FastData/', 'graph_path': 'data/SD/graph/', 'model_path': 'log/SD/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'train': 1, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'adp_adj': False, 'skip_dim': 64, 'end_dim': 64, 'hidden_channels': 32, 'dilation_channels': 64, 'residual_channels': 64, 'input_dim': 1, 'output_dim': 1, 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 300, 'path': 'log/SD/pecpm-42', 'logger': <Logger utils.initialize (INFO)>}
2025-05-29 02:20:48,540 - [*] Year 2017 load from data/SD/FastData/2017.npz
2025-05-29 02:21:01,504 - [*] Year 2017 Dataset load!
2025-05-29 02:21:01,508 - [*] Year 2017 Training start
2025-05-29 02:21:03,310 - node number torch.Size([90240, 12])
2025-05-29 02:21:09,510 - epoch:0, training loss:18116.4573 validation loss:48.7356
2025-05-29 02:21:16,180 - epoch:1, training loss:2853.1238 validation loss:36.2958
2025-05-29 02:21:22,652 - epoch:2, training loss:2221.4153 validation loss:34.4193
2025-05-29 02:21:29,421 - epoch:3, training loss:2140.8676 validation loss:35.3845
2025-05-29 02:21:36,089 - epoch:4, training loss:2095.6261 validation loss:34.4393
2025-05-29 02:21:43,097 - epoch:5, training loss:2042.8313 validation loss:34.6641
2025-05-29 02:21:49,781 - epoch:6, training loss:1975.2769 validation loss:35.4132
2025-05-29 02:21:56,305 - epoch:7, training loss:1949.2893 validation loss:32.9056
2025-05-29 02:22:02,917 - epoch:8, training loss:1931.3821 validation loss:33.6320
2025-05-29 02:22:09,566 - epoch:9, training loss:1925.1775 validation loss:33.2861
2025-05-29 02:22:16,274 - epoch:10, training loss:1926.4316 validation loss:31.6286
2025-05-29 02:22:23,139 - epoch:11, training loss:1902.6118 validation loss:35.3045
2025-05-29 02:22:29,712 - epoch:12, training loss:1895.4016 validation loss:32.1190
2025-05-29 02:22:36,412 - epoch:13, training loss:1908.2196 validation loss:31.9693
2025-05-29 02:22:42,697 - epoch:14, training loss:1884.6085 validation loss:32.5072
2025-05-29 02:22:49,331 - epoch:15, training loss:1887.4055 validation loss:32.9792
2025-05-29 02:22:55,944 - epoch:16, training loss:1880.3362 validation loss:33.9163
2025-05-29 02:22:58,731 - [*] loss:1856.0039
2025-05-29 02:22:59,106 - [*] year 2017, testing
2025-05-29 02:23:03,931 - T:3	MAE	22.0811	RMSE	31.4733	MAPE	15.7790
2025-05-29 02:23:13,226 - T:6	MAE	23.9858	RMSE	35.1588	MAPE	16.8380
2025-05-29 02:23:43,048 - T:12	MAE	28.0770	RMSE	42.6223	MAPE	20.3057
2025-05-29 02:23:43,048 - T:Avg	MAE	24.3363	RMSE	35.7310	MAPE	17.4045
2025-05-29 02:23:43,051 - Finished optimization, total time:55.79 s, best model:log/SD/pecpm-42/2017/31.6286.pkl
2025-05-29 02:23:43,126 - [*] Year 2018 load from data/SD/FastData/2018.npz
2025-05-29 02:23:43,154 - [*] load from log/SD/pecpm-42/2017/31.5668.pkl
2025-05-29 02:23:43,162 - [*] detect strategy feature
2025-05-29 02:23:44,770 - number of increase nodes:72, nodes after 2 hop:torch.Size([562]), total nodes this year 708
2025-05-29 02:24:27,664 - [*] Year 2018 Dataset load!
2025-05-29 02:24:27,664 - [*] load from log/SD/pecpm-42/2017/31.5668.pkl
2025-05-29 02:24:27,668 - [*] EWC! lambda 0.000100
2025-05-29 02:24:36,452 - [*] Year 2018 Training start
2025-05-29 02:24:40,166 - node number torch.Size([71936, 12])
2025-05-29 02:24:48,575 - epoch:0, training loss:1991.7770 validation loss:28.5345
2025-05-29 02:24:58,034 - epoch:1, training loss:1930.8792 validation loss:28.4678
2025-05-29 02:25:07,552 - epoch:2, training loss:1929.8499 validation loss:31.7958
2025-05-29 02:25:18,306 - epoch:3, training loss:1915.8881 validation loss:28.0249
2025-05-29 02:25:29,374 - epoch:4, training loss:1878.4091 validation loss:30.4537
2025-05-29 02:25:40,311 - epoch:5, training loss:1890.0546 validation loss:28.3654
2025-05-29 02:25:51,272 - epoch:6, training loss:1877.7323 validation loss:29.3239
2025-05-29 02:26:02,197 - epoch:7, training loss:1862.8350 validation loss:28.3130
2025-05-29 02:26:13,887 - epoch:8, training loss:1857.7369 validation loss:28.5585
2025-05-29 02:26:22,472 - epoch:9, training loss:1869.1283 validation loss:29.3014
2025-05-29 02:26:26,444 - [*] loss:1829.6702
2025-05-29 02:26:26,483 - [*] year 2018, testing
2025-05-29 02:26:26,911 - T:3	MAE	19.8727	RMSE	29.2953	MAPE	14.4779
2025-05-29 02:26:27,759 - T:6	MAE	22.1685	RMSE	33.0390	MAPE	16.6409
2025-05-29 02:26:30,538 - T:12	MAE	26.5282	RMSE	40.1759	MAPE	20.7708
2025-05-29 02:26:30,539 - T:Avg	MAE	22.4643	RMSE	33.5151	MAPE	16.9623
2025-05-29 02:26:30,539 - Finished optimization, total time:60.77 s, best model:log/SD/pecpm-42/2018/28.0249.pkl
2025-05-29 02:26:30,704 - [*] Year 2019 load from data/SD/FastData/2019.npz
2025-05-29 02:26:30,710 - [*] load from log/SD/pecpm-42/2018/28.0249.pkl
2025-05-29 02:26:30,725 - [*] detect strategy feature
2025-05-29 02:26:32,822 - number of increase nodes:79, nodes after 2 hop:torch.Size([587]), total nodes this year 716
2025-05-29 02:27:18,483 - [*] Year 2019 Dataset load!
2025-05-29 02:27:18,484 - [*] load from log/SD/pecpm-42/2018/28.0249.pkl
2025-05-29 02:27:18,488 - [*] EWC! lambda 0.000100
2025-05-29 02:27:27,265 - [*] Year 2019 Training start
2025-05-29 02:27:31,420 - node number torch.Size([75136, 12])
2025-05-29 02:27:41,026 - epoch:0, training loss:1970.5410 validation loss:29.4730
2025-05-29 02:27:50,865 - epoch:1, training loss:1932.7118 validation loss:28.4102
2025-05-29 02:28:02,361 - epoch:2, training loss:1932.4293 validation loss:28.1091
2025-05-29 02:28:12,119 - epoch:3, training loss:1928.6549 validation loss:28.0385
2025-05-29 02:28:20,380 - epoch:4, training loss:1922.8941 validation loss:29.4981
2025-05-29 02:28:28,918 - epoch:5, training loss:1942.2327 validation loss:28.1857
2025-05-29 02:28:39,024 - epoch:6, training loss:1930.9373 validation loss:28.2773
2025-05-29 02:28:48,523 - epoch:7, training loss:1928.0461 validation loss:29.3281
2025-05-29 02:28:59,048 - epoch:8, training loss:1921.9390 validation loss:29.5778
2025-05-29 02:29:09,555 - epoch:9, training loss:1926.1555 validation loss:28.9543
2025-05-29 02:29:13,336 - [*] loss:1848.2471
2025-05-29 02:29:13,499 - [*] year 2019, testing
2025-05-29 02:29:14,233 - T:3	MAE	20.9140	RMSE	31.0161	MAPE	16.7194
2025-05-29 02:29:16,980 - T:6	MAE	23.0909	RMSE	34.4828	MAPE	18.6198
2025-05-29 02:29:28,472 - T:12	MAE	27.4059	RMSE	41.2785	MAPE	22.5347
2025-05-29 02:29:28,473 - T:Avg	MAE	23.4218	RMSE	34.9757	MAPE	18.9653
2025-05-29 02:29:28,475 - Finished optimization, total time:57.44 s, best model:log/SD/pecpm-42/2019/28.0385.pkl
2025-05-29 02:29:28,643 - [*] Year 2020 load from data/SD/FastData/2020.npz
2025-05-29 02:29:28,654 - [*] load from log/SD/pecpm-42/2019/28.0385.pkl
2025-05-29 02:29:28,664 - [*] detect strategy feature
2025-05-29 02:29:30,387 - number of increase nodes:65, nodes after 2 hop:torch.Size([578]), total nodes this year 697
2025-05-29 02:30:12,185 - [*] Year 2020 Dataset load!
2025-05-29 02:30:12,186 - [*] load from log/SD/pecpm-42/2019/28.0385.pkl
2025-05-29 02:30:12,190 - [*] EWC! lambda 0.000100
2025-05-29 02:30:20,843 - [*] Year 2020 Training start
2025-05-29 02:30:23,297 - node number torch.Size([73984, 12])
2025-05-29 02:30:31,318 - epoch:0, training loss:1821.0969 validation loss:37.1670
2025-05-29 02:30:41,508 - epoch:1, training loss:1772.5882 validation loss:34.5862
2025-05-29 02:30:50,084 - epoch:2, training loss:1771.2748 validation loss:33.3430
2025-05-29 02:30:58,558 - epoch:3, training loss:1765.6560 validation loss:33.5241
2025-05-29 02:31:07,077 - epoch:4, training loss:1777.2841 validation loss:35.7127
2025-05-29 02:31:16,167 - epoch:5, training loss:1768.0659 validation loss:33.3349
2025-05-29 02:31:25,188 - epoch:6, training loss:1764.8791 validation loss:36.4794
2025-05-29 02:31:34,347 - epoch:7, training loss:1772.5122 validation loss:36.1998
2025-05-29 02:31:44,972 - epoch:8, training loss:1766.8204 validation loss:33.9192
2025-05-29 02:31:55,589 - epoch:9, training loss:1776.3634 validation loss:38.7947
2025-05-29 02:32:04,753 - epoch:10, training loss:1769.2178 validation loss:33.9215
2025-05-29 02:32:19,984 - epoch:11, training loss:1766.8376 validation loss:37.7438
2025-05-29 02:32:24,379 - [*] loss:2931.2944
2025-05-29 02:32:24,447 - [*] year 2020, testing
2025-05-29 02:32:24,863 - T:3	MAE	42.2826	RMSE	50.3731	MAPE	47.2463
2025-05-29 02:32:26,484 - T:6	MAE	42.5178	RMSE	51.4402	MAPE	48.1182
2025-05-29 02:32:33,087 - T:12	MAE	43.3924	RMSE	53.7057	MAPE	49.9750
2025-05-29 02:32:33,087 - T:Avg	MAE	42.6032	RMSE	51.5589	MAPE	48.2385
2025-05-29 02:32:33,088 - Finished optimization, total time:66.15 s, best model:log/SD/pecpm-42/2020/33.3349.pkl
2025-05-29 02:32:33,224 - 


2025-05-29 02:32:33,225 - 3   	 MAE	     22.08	     19.87	     20.91	     42.28		   26.29
2025-05-29 02:32:33,225 - 3   	RMSE	     31.47	     29.30	     31.02	     50.37		   35.54
2025-05-29 02:32:33,225 - 3   	MAPE	     15.78	     14.48	     16.72	     47.25		   23.56
2025-05-29 02:32:33,225 - 6   	 MAE	     23.99	     22.17	     23.09	     42.52		   27.94
2025-05-29 02:32:33,225 - 6   	RMSE	     35.16	     33.04	     34.48	     51.44		   38.53
2025-05-29 02:32:33,225 - 6   	MAPE	     16.84	     16.64	     18.62	     48.12		   25.05
2025-05-29 02:32:33,225 - 12  	 MAE	     28.08	     26.53	     27.41	     43.39		   31.35
2025-05-29 02:32:33,225 - 12  	RMSE	     42.62	     40.18	     41.28	     53.71		   44.45
2025-05-29 02:32:33,225 - 12  	MAPE	     20.31	     20.77	     22.53	     49.98		   28.40
2025-05-29 02:32:33,225 - Avg 	 MAE	     24.34	     22.46	     23.42	     42.60		   28.21
2025-05-29 02:32:33,225 - Avg 	RMSE	     35.73	     33.52	     34.98	     51.56		   38.95
2025-05-29 02:32:33,225 - Avg 	MAPE	     17.40	     16.96	     18.97	     48.24		   25.39
2025-05-29 02:32:33,225 - year	2017	total_time	   55.7861	average_time	    3.2815	epoch	17
2025-05-29 02:32:33,225 - year	2018	total_time	   60.7689	average_time	    6.0769	epoch	10
2025-05-29 02:32:33,226 - year	2019	total_time	   57.4389	average_time	    5.7439	epoch	10
2025-05-29 02:32:33,226 - year	2020	total_time	   66.1503	average_time	    5.5125	epoch	12
2025-05-29 02:32:33,226 - total time: 240.1442
Traceback (most recent call last):
  File "/home/bd2/ANATS/Oline_Baselines/main.py", line 8, in <module>
    from torch_geometric.loader import DataLoader
  File "/home/bd2/miniconda3/lib/python3.12/site-packages/torch_geometric/__init__.py", line 4, in <module>
    import torch_geometric.typing
  File "/home/bd2/miniconda3/lib/python3.12/site-packages/torch_geometric/typing.py", line 10, in <module>
    from torch import Tensor
ImportError: cannot import name 'Tensor' from 'torch' (unknown location)
2025-05-29 11:28:40,950 - logger name:log/SD/team-42/team.log
2025-05-29 11:28:40,950 - params : {'conf': 'conf/SD/team.json', 'seed': 42, 'paral': 0, 'gpuid': 2, 'logname': 'team', 'method': 'TEAM', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/Oline_Baselines/log/SD/TEAM-42/2017/51.0326.pkl', 'device': device(type='cuda', index=2), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>, 'TEAM': <class 'src.model.model.TEAM_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 16, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'n_heads': 3, 'in_channels': 1, 'K': 3, 'nb_block': 1, 'nb_chev_filter': 64, 'nb_time_filter': 64, 'num_of_hours': 1, 'missing_value': 0.0, 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/SD/finaldata/', 'save_data_path': 'data/SD/FastData/', 'graph_path': 'data/SD/graph', 'model_path': 'log/SD/', 'strategy': 'incremental', 'init': True, 'increase': True, 'decrease': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'original', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.001, 'replay': True, 'replay_strategy': 'distribution', 'replay_num_samples': 100, 'path': 'log/SD/team-42', 'logger': <Logger utils.initialize (INFO)>}
2025-05-29 11:28:40,978 - [*] Year 2017 load from data/SD/FastData/2017.npz
2025-05-29 11:28:46,495 - [*] Year 2017 Dataset load!
2025-05-29 11:28:46,568 - Total Parameters: 71948
2025-05-29 11:28:46,568 - Trainable Parameters: 71948
2025-05-29 11:28:46,568 - [*] Year 2017 Training start
2025-05-29 11:28:46,917 - node number torch.Size([11280, 12])
2025-05-29 11:31:13,604 - epoch:0, training loss:5221.2297 validation loss:62.2977
2025-05-29 11:33:44,051 - epoch:1, training loss:5152.2649 validation loss:55.9722
2025-05-29 11:36:10,851 - epoch:2, training loss:6155.5198 validation loss:54.0785
2025-05-29 11:38:38,102 - epoch:3, training loss:5561.1589 validation loss:46.2101
2025-05-29 11:41:04,703 - epoch:4, training loss:4482.9777 validation loss:41.9492
