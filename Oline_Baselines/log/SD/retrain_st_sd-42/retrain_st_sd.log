2025-05-26 02:33:48,812 - logger name:log/SD/retrain_st_sd-42/retrain_st_sd.log
2025-05-26 02:33:48,812 - params : {'conf': 'conf/SD/retrain_st_sd.json', 'seed': 42, 'paral': 0, 'gpuid': 2, 'logname': 'retrain_st_sd', 'method': 'TrafficStream', 'load_first_year': 0, 'first_year_model_path': 'log/SD/trafficstream-42/2019/22.3629.pkl', 'device': device(type='cuda', index=2), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>}, 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/SD/finaldata/', 'save_data_path': 'data/SD/FastData/', 'graph_path': 'data/SD/graph/', 'model_path': 'log/SD/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'rank': 6, 'train': 1, 'strategy': 'retrain', 'init': True, 'increase': False, 'num_hops': 0, 'detect': False, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': False, 'path': 'log/SD/retrain_st_sd-42', 'logger': <Logger utils.initialize (INFO)>}
2025-05-26 02:34:05,375 - [*] Year 2017 load from data/SD/FastData/2017.npz
2025-05-26 02:34:05,652 - [*] Year 2017 Dataset load!
2025-05-26 02:34:05,655 - Total Parameters: 3308
2025-05-26 02:34:05,655 - Trainable Parameters: 3308
2025-05-26 02:34:05,655 - [*] Year 2017 Training start
2025-05-26 02:34:06,113 - node number torch.Size([90240, 12])
2025-05-26 02:34:10,838 - epoch:0, training loss:18180.7709 validation loss:49.8031
2025-05-26 02:34:15,710 - epoch:1, training loss:2851.6175 validation loss:35.2882
2025-05-26 02:34:20,434 - epoch:2, training loss:2227.2044 validation loss:33.5646
2025-05-26 02:34:25,462 - epoch:3, training loss:2138.6287 validation loss:34.8725
2025-05-26 02:34:30,582 - epoch:4, training loss:2108.3498 validation loss:35.1587
2025-05-26 02:34:35,492 - epoch:5, training loss:2056.2845 validation loss:32.7855
2025-05-26 02:34:40,347 - epoch:6, training loss:1987.8954 validation loss:32.9930
2025-05-26 02:34:45,614 - epoch:7, training loss:1949.6523 validation loss:33.3834
2025-05-26 02:34:50,341 - epoch:8, training loss:1951.7061 validation loss:34.9994
2025-05-26 02:34:55,090 - epoch:9, training loss:1935.0494 validation loss:35.8891
2025-05-26 02:34:59,968 - epoch:10, training loss:1943.1483 validation loss:35.6961
2025-05-26 02:35:04,691 - epoch:11, training loss:1925.6423 validation loss:33.4956
2025-05-26 02:35:06,699 - [*] loss:1991.8922
2025-05-26 02:35:07,081 - [*] year 2017, testing
2025-05-26 02:35:11,994 - T:3	MAE	23.9438	RMSE	33.7044	MAPE	18.1451
2025-05-26 02:35:21,574 - T:6	MAE	25.2292	RMSE	36.6673	MAPE	18.7154
2025-05-26 02:35:52,377 - T:12	MAE	29.0428	RMSE	44.2175	MAPE	20.9770
2025-05-26 02:35:52,378 - T:Avg	MAE	25.7522	RMSE	37.5641	MAPE	19.0944
2025-05-26 02:35:52,381 - Finished optimization, total time:31.01 s, best model:log/SD/retrain_st_sd-42/2017/32.7855.pkl
2025-05-26 02:36:09,194 - [*] Year 2018 load from data/SD/FastData/2018.npz
2025-05-26 02:36:09,230 - [*] Year 2018 Dataset load!
2025-05-26 02:36:09,231 - [*] load from log/SD/retrain_st_sd-42/2017/32.7855.pkl
2025-05-26 02:36:09,236 - Total Parameters: 3308
2025-05-26 02:36:09,236 - Trainable Parameters: 3308
2025-05-26 02:36:09,237 - [*] Year 2018 Training start
2025-05-26 02:36:10,158 - node number torch.Size([90624, 12])
2025-05-26 02:36:15,056 - epoch:0, training loss:2071.8825 validation loss:30.9121
2025-05-26 02:36:20,637 - epoch:1, training loss:2013.6520 validation loss:30.6075
2025-05-26 02:36:26,300 - epoch:2, training loss:1994.6517 validation loss:28.3604
2025-05-26 02:36:31,809 - epoch:3, training loss:1992.9170 validation loss:28.5011
2025-05-26 02:36:37,560 - epoch:4, training loss:1978.5330 validation loss:29.1640
2025-05-26 02:36:43,207 - epoch:5, training loss:1967.3912 validation loss:32.6566
2025-05-26 02:36:48,757 - epoch:6, training loss:1962.7517 validation loss:30.4013
2025-05-26 02:36:54,337 - epoch:7, training loss:1963.2239 validation loss:28.5543
2025-05-26 02:36:59,982 - epoch:8, training loss:1956.0432 validation loss:30.9415
2025-05-26 02:37:02,521 - [*] loss:1829.8666
2025-05-26 02:37:02,913 - [*] year 2018, testing
2025-05-26 02:37:07,171 - T:3	MAE	20.7863	RMSE	30.9130	MAPE	15.2616
2025-05-26 02:37:15,833 - T:6	MAE	23.1569	RMSE	34.7260	MAPE	18.2075
2025-05-26 02:37:44,695 - T:12	MAE	27.7633	RMSE	42.0853	MAPE	24.2884
2025-05-26 02:37:44,695 - T:Avg	MAE	23.4849	RMSE	35.2201	MAPE	18.7817
2025-05-26 02:37:44,698 - Finished optimization, total time:26.26 s, best model:log/SD/retrain_st_sd-42/2018/28.3604.pkl
2025-05-26 02:38:01,456 - [*] Year 2019 load from data/SD/FastData/2019.npz
2025-05-26 02:38:01,495 - [*] Year 2019 Dataset load!
2025-05-26 02:38:01,495 - [*] load from log/SD/retrain_st_sd-42/2018/28.3604.pkl
2025-05-26 02:38:01,501 - Total Parameters: 3308
2025-05-26 02:38:01,501 - Trainable Parameters: 3308
2025-05-26 02:38:01,501 - [*] Year 2019 Training start
2025-05-26 02:38:02,669 - node number torch.Size([91648, 12])
2025-05-26 02:38:07,795 - epoch:0, training loss:1958.1605 validation loss:28.0577
2025-05-26 02:38:13,997 - epoch:1, training loss:1930.5471 validation loss:30.2633
2025-05-26 02:38:20,196 - epoch:2, training loss:1921.6005 validation loss:29.4234
2025-05-26 02:38:26,466 - epoch:3, training loss:1916.3181 validation loss:28.6599
2025-05-26 02:38:32,700 - epoch:4, training loss:1915.6381 validation loss:38.2669
2025-05-26 02:38:38,820 - epoch:5, training loss:1933.9023 validation loss:33.4372
2025-05-26 02:38:44,990 - epoch:6, training loss:1920.3006 validation loss:28.7398
2025-05-26 02:38:48,390 - [*] loss:1950.2998
2025-05-26 02:38:48,946 - [*] year 2019, testing
2025-05-26 02:38:53,260 - T:3	MAE	22.0874	RMSE	32.9656	MAPE	16.4316
2025-05-26 02:39:01,990 - T:6	MAE	24.5289	RMSE	36.7893	MAPE	19.4307
2025-05-26 02:39:31,480 - T:12	MAE	28.9953	RMSE	43.8186	MAPE	25.2242
2025-05-26 02:39:31,480 - T:Avg	MAE	24.8244	RMSE	37.2344	MAPE	19.9219
2025-05-26 02:39:31,483 - Finished optimization, total time:22.50 s, best model:log/SD/retrain_st_sd-42/2019/28.0577.pkl
2025-05-26 02:39:47,370 - [*] Year 2020 load from data/SD/FastData/2020.npz
2025-05-26 02:39:47,403 - [*] Year 2020 Dataset load!
2025-05-26 02:39:47,406 - [*] load from log/SD/retrain_st_sd-42/2019/28.0577.pkl
2025-05-26 02:39:47,413 - Total Parameters: 3308
2025-05-26 02:39:47,413 - Trainable Parameters: 3308
2025-05-26 02:39:47,413 - [*] Year 2020 Training start
2025-05-26 02:39:48,550 - node number torch.Size([89216, 12])
2025-05-26 02:39:53,676 - epoch:0, training loss:1915.7960 validation loss:37.1985
2025-05-26 02:40:00,050 - epoch:1, training loss:1867.7706 validation loss:36.0655
2025-05-26 02:40:06,261 - epoch:2, training loss:1878.4799 validation loss:35.4777
2025-05-26 02:40:12,349 - epoch:3, training loss:1819.8494 validation loss:37.5685
2025-05-26 02:40:18,428 - epoch:4, training loss:1803.1153 validation loss:34.3685
2025-05-26 02:40:24,524 - epoch:5, training loss:1788.4261 validation loss:34.1288
2025-05-26 02:40:30,617 - epoch:6, training loss:1771.2475 validation loss:35.8549
2025-05-26 02:40:36,817 - epoch:7, training loss:1769.8983 validation loss:35.7011
2025-05-26 02:40:42,915 - epoch:8, training loss:1766.0885 validation loss:33.5045
2025-05-26 02:40:48,967 - epoch:9, training loss:1757.0283 validation loss:37.5794
2025-05-26 02:40:55,021 - epoch:10, training loss:1752.7474 validation loss:36.3707
2025-05-26 02:41:01,126 - epoch:11, training loss:1751.5101 validation loss:31.4209
2025-05-26 02:41:07,275 - epoch:12, training loss:1748.8250 validation loss:33.2856
2025-05-26 02:41:13,395 - epoch:13, training loss:1741.4984 validation loss:36.0366
2025-05-26 02:41:19,530 - epoch:14, training loss:1739.2892 validation loss:36.5109
2025-05-26 02:41:25,703 - epoch:15, training loss:1732.7337 validation loss:38.6191
2025-05-26 02:41:31,808 - epoch:16, training loss:1736.7717 validation loss:36.8438
2025-05-26 02:41:37,897 - epoch:17, training loss:1736.5283 validation loss:36.6404
2025-05-26 02:41:41,378 - [*] loss:2885.3020
2025-05-26 02:41:41,799 - [*] year 2020, testing
2025-05-26 02:41:46,059 - T:3	MAE	39.1618	RMSE	49.6396	MAPE	41.4203
2025-05-26 02:41:54,182 - T:6	MAE	40.0327	RMSE	51.5759	MAPE	41.7014
2025-05-26 02:42:22,039 - T:12	MAE	40.9278	RMSE	54.1419	MAPE	42.4188
2025-05-26 02:42:22,040 - T:Avg	MAE	39.9118	RMSE	51.4812	MAPE	41.7095
2025-05-26 02:42:22,042 - Finished optimization, total time:56.81 s, best model:log/SD/retrain_st_sd-42/2020/31.4209.pkl
2025-05-26 02:42:22,043 - 


2025-05-26 02:42:22,043 - 3   	 MAE	     23.94	     20.79	     22.09	     39.16		   26.49
2025-05-26 02:42:22,044 - 3   	RMSE	     33.70	     30.91	     32.97	     49.64		   36.81
2025-05-26 02:42:22,044 - 3   	MAPE	     18.15	     15.26	     16.43	     41.42		   22.81
2025-05-26 02:42:22,044 - 6   	 MAE	     25.23	     23.16	     24.53	     40.03		   28.24
2025-05-26 02:42:22,044 - 6   	RMSE	     36.67	     34.73	     36.79	     51.58		   39.94
2025-05-26 02:42:22,044 - 6   	MAPE	     18.72	     18.21	     19.43	     41.70		   24.51
2025-05-26 02:42:22,044 - 12  	 MAE	     29.04	     27.76	     29.00	     40.93		   31.68
2025-05-26 02:42:22,044 - 12  	RMSE	     44.22	     42.09	     43.82	     54.14		   46.07
2025-05-26 02:42:22,044 - 12  	MAPE	     20.98	     24.29	     25.22	     42.42		   28.23
2025-05-26 02:42:22,044 - Avg 	 MAE	     25.75	     23.48	     24.82	     39.91		   28.49
2025-05-26 02:42:22,044 - Avg 	RMSE	     37.56	     35.22	     37.23	     51.48		   40.37
2025-05-26 02:42:22,044 - Avg 	MAPE	     19.09	     18.78	     19.92	     41.71		   24.88
2025-05-26 02:42:22,044 - year	2017	total_time	   31.0143	average_time	    2.5845	epoch	12
2025-05-26 02:42:22,044 - year	2018	total_time	   26.2560	average_time	    2.9173	epoch	9
2025-05-26 02:42:22,044 - year	2019	total_time	   22.5015	average_time	    3.2145	epoch	7
2025-05-26 02:42:22,044 - year	2020	total_time	   56.8096	average_time	    3.1561	epoch	18
2025-05-26 02:42:22,044 - total time: 136.5813
