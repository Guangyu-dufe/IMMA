2025-05-11 06:49:36,257 - logger name:res/SD/trafficStream2025-05-11-06:49:36.255974/trafficStream.log
2025-05-11 06:49:36,257 - params : {'conf': 'conf/trafficStream_SD.json', 'paral': 0, 'gpuid': 5, 'logname': 'trafficStream', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/SD/linear-moco/2017/26.5761.pkl', 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/SD/finaldata/', 'save_data_path': 'data/SD/FastData/', 'graph_path': 'data/SD/graph/', 'model_path': 'res/SD/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'classifier': {'hidden_dim': 128}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': False, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 300, 'extra_feature': True, 'momentum_type': 'linear', 'memory_size': 32, 'time': '2025-05-11-06:49:36.255974', 'path': 'res/SD/trafficStream2025-05-11-06:49:36.255974', 'device': device(type='cuda', index=5), 'logger': <Logger __main__ (INFO)>}
2025-05-11 06:49:36,284 - [*] Year 2017 load from data/SD/FastData/2017_30day.npz
/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-05-11 06:49:49,382 - [*] Year 2017 Dataset load!
2025-05-11 06:49:49,402 - [*] Model parameter count: 277994
2025-05-11 06:49:49,403 - [*] Year 2017 Training start
2025-05-11 06:49:49,755 - node number torch.Size([91648, 24])
2025-05-11 06:59:31,347 - epoch:0, training loss:22930.5999 validation loss:61.9225, moco loss:52227.4141
2025-05-11 07:09:13,439 - epoch:1, training loss:15032.9968 validation loss:53.6718, moco loss:27144.6367
2025-05-11 07:18:58,327 - epoch:2, training loss:8073.1088 validation loss:46.9412, moco loss:16460.8809
2025-05-11 07:28:40,362 - epoch:3, training loss:4326.5700 validation loss:33.8574, moco loss:6288.5674
2025-05-11 07:38:22,502 - epoch:4, training loss:2571.9017 validation loss:31.0138, moco loss:2441.9521
2025-05-11 07:48:02,988 - epoch:5, training loss:1860.4232 validation loss:28.8307, moco loss:1384.7476
2025-05-11 07:57:45,078 - epoch:6, training loss:1550.0122 validation loss:28.5084, moco loss:628.2242
2025-05-11 08:07:26,430 - epoch:7, training loss:1407.7066 validation loss:28.0765, moco loss:86.1433
2025-05-11 08:17:08,157 - epoch:8, training loss:1387.6936 validation loss:29.0776, moco loss:413.6764
2025-05-11 08:26:50,353 - epoch:9, training loss:1325.1474 validation loss:31.0377, moco loss:227.2932
2025-05-11 08:36:32,366 - epoch:10, training loss:1329.2189 validation loss:27.5252, moco loss:68.0987
2025-05-11 08:46:14,465 - epoch:11, training loss:1304.2652 validation loss:26.9122, moco loss:165.6228
2025-05-11 08:55:56,447 - epoch:12, training loss:1287.9272 validation loss:26.7627, moco loss:132.6614
2025-05-11 09:05:38,316 - epoch:13, training loss:1259.4223 validation loss:27.1385, moco loss:107.2031
2025-05-11 09:15:20,376 - epoch:14, training loss:1278.0732 validation loss:27.1387, moco loss:69.8401
2025-05-11 09:25:02,360 - epoch:15, training loss:1257.5856 validation loss:26.9592, moco loss:292.4625
2025-05-11 09:34:44,195 - epoch:16, training loss:1252.9117 validation loss:27.0872, moco loss:72.0571
2025-05-11 09:44:25,873 - epoch:17, training loss:1250.6601 validation loss:27.4366, moco loss:60.7528
2025-05-11 09:54:07,859 - epoch:18, training loss:1238.7506 validation loss:26.5147, moco loss:56.1634
2025-05-11 10:03:49,759 - epoch:19, training loss:1241.3841 validation loss:26.7359, moco loss:69.3889
2025-05-11 10:13:31,841 - epoch:20, training loss:1230.9774 validation loss:27.4800, moco loss:72.2718
2025-05-11 10:23:13,040 - epoch:21, training loss:1237.0688 validation loss:26.8050, moco loss:63.4547
2025-05-11 10:32:54,944 - epoch:22, training loss:1219.2107 validation loss:26.7165, moco loss:62.6575
2025-05-11 10:42:37,194 - epoch:23, training loss:1222.9845 validation loss:27.3565, moco loss:69.2758
2025-05-11 10:52:19,232 - epoch:24, training loss:1225.6895 validation loss:26.4016, moco loss:66.7454
2025-05-11 11:02:00,927 - epoch:25, training loss:1206.9838 validation loss:26.7363, moco loss:70.0772
2025-05-11 11:11:42,815 - epoch:26, training loss:1225.0940 validation loss:29.5496, moco loss:288.1392
2025-05-11 11:21:24,885 - epoch:27, training loss:1210.6596 validation loss:26.4968, moco loss:60.4105
2025-05-11 11:31:06,973 - epoch:28, training loss:1210.0991 validation loss:26.9466, moco loss:47.9414
2025-05-11 11:40:49,078 - epoch:29, training loss:1211.4402 validation loss:27.1434, moco loss:50.7438
2025-05-11 11:50:31,084 - epoch:30, training loss:1202.4213 validation loss:25.7452, moco loss:57.8053
2025-05-11 12:00:12,992 - epoch:31, training loss:1207.5606 validation loss:28.0473, moco loss:92.4923
2025-05-11 12:09:54,984 - epoch:32, training loss:1214.6047 validation loss:26.6124, moco loss:81.6285
2025-05-11 12:19:37,003 - epoch:33, training loss:1191.7331 validation loss:25.9559, moco loss:54.9194
2025-05-11 12:29:19,166 - epoch:34, training loss:1207.5796 validation loss:26.3226, moco loss:55.1852
2025-05-11 12:39:01,399 - epoch:35, training loss:1196.1564 validation loss:27.4868, moco loss:52.8196
2025-05-11 12:48:43,444 - epoch:36, training loss:1198.1854 validation loss:26.6456, moco loss:43.7512
Traceback (most recent call last):
  File "/home/bd2/ANATS/TrafficStream/main_moco.py", line 550, in <module>
    main(args)
  File "/home/bd2/ANATS/TrafficStream/main_moco.py", line 512, in main
    train(inputs, args)
  File "/home/bd2/ANATS/TrafficStream/main_moco.py", line 287, in train
    best_model.load_state_dict(torch.load(best_model_path, args.device)["model_state_dict"])
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 2593, in load_state_dict
    raise RuntimeError(
RuntimeError: Error(s) in loading state_dict for TrafficEvent:
	Unexpected key(s) in state_dict: "basic_model.gwnet.nodevec1", "basic_model.gwnet.nodevec2", "basic_model_m.gwnet.nodevec1", "basic_model_m.gwnet.nodevec2". 
2025-05-13 07:15:07,850 - logger name:res/SD/trafficStream2025-05-13-07:15:07.849734/trafficStream.log
2025-05-13 07:15:07,851 - params : {'conf': 'conf/trafficStream_SD.json', 'paral': 0, 'gpuid': 5, 'logname': 'trafficStream', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/SD/trafficStream2025-05-11-06:49:36.255974/2017/25.7452.pkl', 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/SD/finaldata/', 'save_data_path': 'data/SD/FastData/', 'graph_path': 'data/SD/graph/', 'model_path': 'res/SD/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'classifier': {'hidden_dim': 128}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': False, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 300, 'extra_feature': True, 'momentum_type': 'linear', 'memory_size': 32, 'time': '2025-05-13-07:15:07.849734', 'path': 'res/SD/trafficStream2025-05-13-07:15:07.849734', 'device': device(type='cuda', index=5), 'logger': <Logger __main__ (INFO)>}
2025-05-13 07:15:07,878 - [*] Year 2017 load from data/SD/FastData/2017_30day.npz
/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-05-13 07:15:21,054 - [*] Year 2017 Dataset load!
2025-05-13 07:15:21,075 - [*] Model parameter count: 277994
2025-05-13 07:15:21,075 - [*] Year 2017 Training start
2025-05-13 07:15:21,478 - node number torch.Size([91648, 24])
Traceback (most recent call last):
  File "/home/bd2/ANATS/TrafficStream/main_moco.py", line 558, in <module>
    main(args)
  File "/home/bd2/ANATS/TrafficStream/main_moco.py", line 520, in main
    train(inputs, args)
  File "/home/bd2/ANATS/TrafficStream/main_moco.py", line 190, in train
    basic_features, basic_features_m, similarity, logits = model(data, args.sub_adj)
                                                           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/ANATS/TrafficStream/src/model/model.py", line 209, in forward
    basic_features_m = self.basic_model_m(basic_data, adj) 
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/ANATS/TrafficStream/src/model/model.py", line 75, in forward
    x = self.gwnet(x,adj)
        ^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/ANATS/TrafficStream/src/model/GraphWaveNet.py", line 322, in forward
    x = self.gconv[i](x, new_supports)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/ANATS/TrafficStream/src/model/GraphWaveNet.py", line 131, in forward
    h = self.mlp(h)
        ^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/ANATS/TrafficStream/src/model/GraphWaveNet.py", line 109, in forward
    return self.mlp(x)
           ^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
RuntimeError: Given groups=1, weight of size [32, 96, 1, 1], expected input[128, 160, 716, 12] to have 96 channels, but got 160 channels instead
2025-05-13 07:26:42,448 - logger name:res/SD/trafficStream2025-05-13-07:26:42.447389/trafficStream.log
2025-05-13 07:26:42,448 - params : {'conf': 'conf/trafficStream_SD.json', 'paral': 0, 'gpuid': 5, 'logname': 'trafficStream', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/SD/trafficStream2025-05-11-06:49:36.255974/2017/25.7452.pkl', 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/SD/finaldata/', 'save_data_path': 'data/SD/FastData/', 'graph_path': 'data/SD/graph/', 'model_path': 'res/SD/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'classifier': {'hidden_dim': 128}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': False, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 300, 'extra_feature': True, 'momentum_type': 'linear', 'memory_size': 32, 'time': '2025-05-13-07:26:42.447389', 'path': 'res/SD/trafficStream2025-05-13-07:26:42.447389', 'device': device(type='cuda', index=5), 'logger': <Logger __main__ (INFO)>}
2025-05-13 07:26:42,476 - [*] Year 2017 load from data/SD/FastData/2017_30day.npz
/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-05-13 07:26:56,191 - [*] Year 2017 Dataset load!
2025-05-13 07:26:56,212 - [*] Model parameter count: 277994
2025-05-13 07:26:56,213 - [*] Year 2017 Training start
2025-05-13 07:26:56,694 - node number torch.Size([91648, 24])
Traceback (most recent call last):
  File "/home/bd2/ANATS/TrafficStream/main_moco.py", line 558, in <module>
    main(args)
  File "/home/bd2/ANATS/TrafficStream/main_moco.py", line 520, in main
    train(inputs, args)
  File "/home/bd2/ANATS/TrafficStream/main_moco.py", line 190, in train
    basic_features, basic_features_m, similarity, logits = model(data, args.sub_adj)
                                                           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/ANATS/TrafficStream/src/model/model.py", line 209, in forward
    basic_features_m = self.basic_model_m(basic_data, adj) 
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/ANATS/TrafficStream/src/model/model.py", line 75, in forward
    x = self.gwnet(x,adj)
        ^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/ANATS/TrafficStream/src/model/GraphWaveNet.py", line 323, in forward
    x = self.gconv[i](x, new_supports)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/ANATS/TrafficStream/src/model/GraphWaveNet.py", line 131, in forward
    h = self.mlp(h)
        ^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/ANATS/TrafficStream/src/model/GraphWaveNet.py", line 109, in forward
    return self.mlp(x)
           ^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
RuntimeError: Given groups=1, weight of size [32, 96, 1, 1], expected input[128, 160, 716, 12] to have 96 channels, but got 160 channels instead
2025-05-13 07:29:26,799 - logger name:res/SD/trafficStream2025-05-13-07:29:26.798568/trafficStream.log
2025-05-13 07:29:26,799 - params : {'conf': 'conf/trafficStream_SD.json', 'paral': 0, 'gpuid': 5, 'logname': 'trafficStream', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/SD/trafficStream2025-05-11-06:49:36.255974/2017/25.7452.pkl', 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/SD/finaldata/', 'save_data_path': 'data/SD/FastData/', 'graph_path': 'data/SD/graph/', 'model_path': 'res/SD/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'classifier': {'hidden_dim': 128}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': False, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 300, 'extra_feature': True, 'momentum_type': 'linear', 'memory_size': 32, 'time': '2025-05-13-07:29:26.798568', 'path': 'res/SD/trafficStream2025-05-13-07:29:26.798568', 'device': device(type='cuda', index=5), 'logger': <Logger __main__ (INFO)>}
2025-05-13 07:29:26,828 - [*] Year 2017 load from data/SD/FastData/2017_30day.npz
/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-05-13 07:29:39,922 - [*] Year 2017 Dataset load!
2025-05-13 07:29:39,942 - [*] Model parameter count: 277994
2025-05-13 07:29:39,943 - [*] Year 2017 Training start
2025-05-13 07:29:40,305 - node number torch.Size([91648, 24])
Traceback (most recent call last):
  File "/home/bd2/ANATS/TrafficStream/main_moco.py", line 558, in <module>
    main(args)
  File "/home/bd2/ANATS/TrafficStream/main_moco.py", line 520, in main
    train(inputs, args)
  File "/home/bd2/ANATS/TrafficStream/main_moco.py", line 190, in train
    basic_features, basic_features_m, similarity, logits = model(data, args.sub_adj)
                                                           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/ANATS/TrafficStream/src/model/model.py", line 209, in forward
    basic_features_m = self.basic_model_m(basic_data, adj) 
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/ANATS/TrafficStream/src/model/model.py", line 75, in forward
    x = self.gwnet(x,adj)
        ^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/ANATS/TrafficStream/src/model/GraphWaveNet.py", line 323, in forward
    x = self.gconv[i](x, new_supports)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/ANATS/TrafficStream/src/model/GraphWaveNet.py", line 131, in forward
    h = self.mlp(h)
        ^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/ANATS/TrafficStream/src/model/GraphWaveNet.py", line 109, in forward
    return self.mlp(x)
           ^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
RuntimeError: Given groups=1, weight of size [32, 96, 1, 1], expected input[128, 160, 716, 12] to have 96 channels, but got 160 channels instead
2025-05-13 07:40:17,496 - logger name:res/SD/trafficStream2025-05-13-07:40:17.495815/trafficStream.log
2025-05-13 07:40:17,497 - params : {'conf': 'conf/trafficStream_SD.json', 'paral': 0, 'gpuid': 5, 'logname': 'trafficStream', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/SD/trafficStream2025-05-11-06:49:36.255974/2017/25.7452.pkl', 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/SD/finaldata/', 'save_data_path': 'data/SD/FastData/', 'graph_path': 'data/SD/graph/', 'model_path': 'res/SD/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'classifier': {'hidden_dim': 128}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': False, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 300, 'extra_feature': True, 'momentum_type': 'linear', 'memory_size': 32, 'time': '2025-05-13-07:40:17.495815', 'path': 'res/SD/trafficStream2025-05-13-07:40:17.495815', 'device': device(type='cuda', index=5), 'logger': <Logger __main__ (INFO)>}
2025-05-13 07:40:17,524 - [*] Year 2017 load from data/SD/FastData/2017_30day.npz
/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-05-13 07:40:30,790 - [*] Year 2017 Dataset load!
2025-05-13 07:40:30,811 - [*] Model parameter count: 294378
2025-05-13 07:40:30,811 - [*] Year 2017 Training start
2025-05-13 07:40:31,167 - node number torch.Size([91648, 24])
2025-05-13 07:51:53,115 - epoch:0, training loss:3695.9140 validation loss:33.4781, moco loss:222.5983
2025-05-13 08:03:15,235 - epoch:1, training loss:1511.3155 validation loss:33.5651, moco loss:91.7192
2025-05-13 08:14:38,452 - epoch:2, training loss:1377.5168 validation loss:29.7044, moco loss:124.5017
2025-05-13 08:26:03,099 - epoch:3, training loss:1330.0229 validation loss:28.7224, moco loss:76.2035
2025-05-13 08:37:28,259 - epoch:4, training loss:1271.9099 validation loss:29.7845, moco loss:105.9490
2025-05-13 08:48:54,515 - epoch:5, training loss:1239.5064 validation loss:29.0291, moco loss:86.1294
2025-05-13 09:00:19,362 - epoch:6, training loss:1213.0855 validation loss:29.4330, moco loss:77.7773
2025-05-13 09:11:39,022 - epoch:7, training loss:1190.4754 validation loss:27.5000, moco loss:151.2645
2025-05-13 09:23:05,410 - epoch:8, training loss:1189.7298 validation loss:27.0965, moco loss:144.7319
2025-05-13 09:34:27,166 - epoch:9, training loss:1137.5529 validation loss:28.1130, moco loss:270.8576
2025-05-13 09:45:52,704 - epoch:10, training loss:1122.2176 validation loss:26.1890, moco loss:80.9208
2025-05-13 09:57:15,697 - epoch:11, training loss:1111.4506 validation loss:27.2173, moco loss:143.7800
2025-05-13 10:08:41,580 - epoch:12, training loss:1093.7034 validation loss:26.3157, moco loss:89.6122
2025-05-13 10:20:00,190 - epoch:13, training loss:1087.4674 validation loss:26.9253, moco loss:95.1256
2025-05-13 10:31:23,173 - epoch:14, training loss:1073.9546 validation loss:26.9880, moco loss:97.8214
2025-05-13 10:42:44,582 - epoch:15, training loss:1057.7194 validation loss:25.8616, moco loss:82.3799
2025-05-13 10:54:03,096 - epoch:16, training loss:1048.1364 validation loss:25.8264, moco loss:121.8562
2025-05-13 11:05:25,533 - epoch:17, training loss:1045.3115 validation loss:25.9892, moco loss:92.6802
2025-05-13 11:16:47,413 - epoch:18, training loss:1033.2134 validation loss:26.1284, moco loss:166.6685
2025-05-13 11:28:08,813 - epoch:19, training loss:1032.2700 validation loss:26.4185, moco loss:134.5432
2025-05-13 11:39:29,206 - epoch:20, training loss:1023.0142 validation loss:27.9001, moco loss:146.1081
2025-05-13 11:50:54,426 - epoch:21, training loss:1063.6949 validation loss:26.1291, moco loss:89.0817
2025-05-13 12:02:19,152 - epoch:22, training loss:1001.3646 validation loss:25.2605, moco loss:94.7165
2025-05-13 12:13:41,540 - epoch:23, training loss:992.8560 validation loss:25.6947, moco loss:136.3662
2025-05-13 12:25:05,647 - epoch:24, training loss:1021.8813 validation loss:25.9987, moco loss:81.9640
2025-05-13 12:36:30,558 - epoch:25, training loss:1003.4766 validation loss:25.8918, moco loss:92.4502
2025-05-13 12:47:54,400 - epoch:26, training loss:984.7120 validation loss:25.0437, moco loss:108.1147
2025-05-13 12:59:18,676 - epoch:27, training loss:1003.0029 validation loss:25.7291, moco loss:93.5500
2025-05-13 13:10:40,832 - epoch:28, training loss:983.7072 validation loss:25.7987, moco loss:79.7055
2025-05-13 13:22:04,318 - epoch:29, training loss:990.4656 validation loss:25.1201, moco loss:103.4480
2025-05-13 13:33:22,674 - epoch:30, training loss:969.7831 validation loss:25.8030, moco loss:79.7073
2025-05-13 13:44:45,475 - epoch:31, training loss:978.9110 validation loss:25.4748, moco loss:133.0930
2025-05-13 13:56:04,324 - epoch:32, training loss:1500.8565 validation loss:29.5640, moco loss:48.6601
Traceback (most recent call last):
  File "/home/bd2/ANATS/TrafficStream/main_moco.py", line 559, in <module>
    main(args)
  File "/home/bd2/ANATS/TrafficStream/main_moco.py", line 521, in main
    train(inputs, args)
  File "/home/bd2/ANATS/TrafficStream/main_moco.py", line 296, in train
    best_model.load_state_dict(torch.load(best_model_path, args.device)["model_state_dict"])
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 2593, in load_state_dict
    raise RuntimeError(
RuntimeError: Error(s) in loading state_dict for TrafficEvent:
	Unexpected key(s) in state_dict: "basic_model.gwnet.nodevec1", "basic_model.gwnet.nodevec2", "basic_model_m.gwnet.nodevec1", "basic_model_m.gwnet.nodevec2". 
2025-05-25 11:20:30,019 - logger name:res/SD/trafficStream2025-05-25-11:20:30.017997/trafficStream.log
2025-05-25 11:20:30,019 - params : {'conf': 'conf/trafficStream_SD.json', 'paral': 0, 'gpuid': 5, 'logname': 'trafficStream', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/SD/trafficStream2025-05-13-07:40:17.495815/2017/25.0437.pkl', 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/SD/finaldata/', 'save_data_path': 'data/SD/FastData/', 'graph_path': 'data/SD/graph/', 'model_path': 'res/SD/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'classifier': {'hidden_dim': 128}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': False, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 300, 'extra_feature': True, 'momentum_type': 'linear', 'memory_size': 32, 'time': '2025-05-25-11:20:30.017997', 'path': 'res/SD/trafficStream2025-05-25-11:20:30.017997', 'device': device(type='cuda', index=5), 'logger': <Logger __main__ (INFO)>}

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 875942.28it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1043747.74it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1068434.77it/s]

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 974701.82it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 887180.33it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1061642.64it/s]
2025-05-25 11:21:12,731 - [*] Year 2017 load from data/SD/FastData/2017_30day.npz
/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-05-25 11:21:13,090 - [*] Year 2017 Dataset load!
2025-05-25 11:21:13,153 - [*] Model parameter count: 8842
2025-05-25 11:21:13,154 - [*] Year 2017 Training start
2025-05-25 11:21:13,843 - node number torch.Size([90240, 24])
2025-05-25 11:21:35,980 - epoch:0, training loss:7763.7804 validation loss:29.9708, moco loss:1.3521
2025-05-25 11:21:58,010 - epoch:1, training loss:2044.5957 validation loss:28.4036, moco loss:1.1983
2025-05-25 11:22:21,074 - epoch:2, training loss:1936.8618 validation loss:28.0958, moco loss:9.6465
2025-05-25 11:22:42,972 - epoch:3, training loss:1914.1656 validation loss:28.2872, moco loss:7.3550
2025-05-25 11:23:05,281 - epoch:4, training loss:1894.9904 validation loss:28.8816, moco loss:1.1475
2025-05-25 11:23:27,758 - epoch:5, training loss:1891.2408 validation loss:28.2122, moco loss:36.3825
2025-05-25 11:23:49,821 - epoch:6, training loss:1888.1851 validation loss:28.9340, moco loss:15.5391
2025-05-25 11:24:12,357 - epoch:7, training loss:1876.1562 validation loss:28.0718, moco loss:3.0055
2025-05-25 11:24:34,385 - epoch:8, training loss:1879.2236 validation loss:28.0726, moco loss:46.7483
2025-05-25 11:24:57,035 - epoch:9, training loss:1843.9368 validation loss:27.3806, moco loss:7.4783
2025-05-25 11:25:19,182 - epoch:10, training loss:1795.6960 validation loss:27.1081, moco loss:3.2703
2025-05-25 11:25:40,859 - epoch:11, training loss:1774.9758 validation loss:27.2242, moco loss:2.2487
2025-05-25 11:26:03,265 - epoch:12, training loss:1754.8207 validation loss:27.7463, moco loss:9.6387
2025-05-25 11:26:25,518 - epoch:13, training loss:1739.4999 validation loss:27.0702, moco loss:5.0409
2025-05-25 11:26:47,584 - epoch:14, training loss:1729.9241 validation loss:26.9608, moco loss:13.5699
2025-05-25 11:27:10,563 - epoch:15, training loss:1723.5342 validation loss:27.8679, moco loss:1.5781
2025-05-25 11:27:32,378 - epoch:16, training loss:1718.0089 validation loss:26.9013, moco loss:7.1717
2025-05-25 11:27:55,037 - epoch:17, training loss:1720.0812 validation loss:27.0526, moco loss:51.0431
2025-05-25 11:28:17,189 - epoch:18, training loss:1710.1333 validation loss:27.0753, moco loss:30.7641
2025-05-25 11:28:39,320 - epoch:19, training loss:1706.2250 validation loss:26.9725, moco loss:3.5462
2025-05-25 11:29:01,484 - epoch:20, training loss:1706.7901 validation loss:26.4505, moco loss:54.0976
2025-05-25 11:29:23,586 - epoch:21, training loss:1703.7938 validation loss:26.9110, moco loss:8.3395
2025-05-25 11:29:45,726 - epoch:22, training loss:1697.6063 validation loss:26.7325, moco loss:3.9590
2025-05-25 11:30:08,443 - epoch:23, training loss:1692.2583 validation loss:27.0312, moco loss:5.1757
2025-05-25 11:30:30,460 - epoch:24, training loss:1692.1588 validation loss:27.1048, moco loss:53.9598
2025-05-25 11:30:52,994 - epoch:25, training loss:1689.3603 validation loss:26.7147, moco loss:4.2032
2025-05-25 11:31:15,716 - epoch:26, training loss:1689.2499 validation loss:26.7542, moco loss:2.9457
2025-05-25 11:31:21,888 - [*]Test--basic_loss:2071.9250, event_loss:596.3161, test_loss:1664.4828
2025-05-25 11:31:22,460 - [*] Evaluating all samples:
2025-05-25 11:31:22,460 - [*] year 2017, testing
2025-05-25 11:31:24,756 - T:3	MAE	20.4356	RMSE	30.4887	MAPE	12.6586
2025-05-25 11:31:28,455 - T:6	MAE	22.4912	RMSE	33.8931	MAPE	14.1901
2025-05-25 11:31:34,148 - T:12	MAE	26.5259	RMSE	40.2943	MAPE	17.9063
2025-05-25 11:31:34,609 - [*] Evaluating basic traffic samples (prediction=0):
2025-05-25 11:31:34,609 - [*] year 2017, testing
2025-05-25 11:31:36,186 - T:3	MAE	24.4917	RMSE	34.6374	MAPE	9.4760
2025-05-25 11:31:38,835 - T:6	MAE	26.8476	RMSE	38.3617	MAPE	10.4031
2025-05-25 11:31:42,925 - T:12	MAE	31.1805	RMSE	44.9650	MAPE	12.3065
2025-05-25 11:31:43,111 - [*] Evaluating event traffic samples (prediction=1):
2025-05-25 11:31:43,111 - [*] year 2017, testing
2025-05-25 11:31:43,632 - T:3	MAE	10.1681	RMSE	15.6723	MAPE	20.7149
2025-05-25 11:31:44,409 - T:6	MAE	11.4666	RMSE	18.2093	MAPE	23.7778
2025-05-25 11:31:45,503 - T:12	MAE	14.7472	RMSE	24.8164	MAPE	32.0819
2025-05-25 11:31:45,509 - Finished optimization, total time:474.01 s, best model:res/SD/trafficStream2025-05-25-11:20:30.017997/2017/26.4505.pkl

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 904323.18it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 994472.05it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1025634.25it/s]

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 996489.06it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1020293.82it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1006504.65it/s]
2025-05-25 11:32:32,581 - [*] Year 2018 load from data/SD/FastData/2018_30day.npz
2025-05-25 11:32:32,595 - Secure SignIn[*] load from res/SD/trafficStream2025-05-25-11:20:30.017997/2017/26.4505.pkl
2025-05-25 11:32:32,748 - [*] replay node number 63
2025-05-25 11:32:32,802 - number of increase nodes:63, nodes after 2 hop:torch.Size([524]), total nodes this year 708
2025-05-25 11:32:42,832 - [*] Year 2018 Dataset load!
2025-05-25 11:32:42,832 - Secure SignIn[*] load from res/SD/trafficStream2025-05-25-11:20:30.017997/2017/26.4505.pkl
2025-05-25 11:32:42,975 - [*] EWC! lambda 0.000100
2025-05-25 11:32:53,347 - [*] Model parameter count: 8842
2025-05-25 11:32:53,347 - [*] Year 2018 Training start
2025-05-25 11:32:54,511 - node number torch.Size([67072, 24])
2025-05-25 11:33:23,279 - epoch:0, training loss:1825.3620 validation loss:26.1872, moco loss:11.1181
2025-05-25 11:33:53,322 - epoch:1, training loss:1772.0381 validation loss:26.2601, moco loss:52.4678
2025-05-25 11:34:21,430 - epoch:2, training loss:1771.9655 validation loss:26.6963, moco loss:2.0801
2025-05-25 11:34:51,235 - epoch:3, training loss:1773.2933 validation loss:26.6760, moco loss:17.2884
2025-05-25 11:35:20,990 - epoch:4, training loss:1772.4664 validation loss:26.4845, moco loss:3.8506
2025-05-25 11:35:49,579 - epoch:5, training loss:1774.4573 validation loss:26.7467, moco loss:35.6530
2025-05-25 11:36:19,345 - epoch:6, training loss:1769.4438 validation loss:27.6373, moco loss:33.2584
2025-05-25 11:36:27,820 - [*]Test--basic_loss:2356.1001, event_loss:460.6593, test_loss:1905.1912
2025-05-25 11:36:27,889 - [*] Evaluating all samples:
2025-05-25 11:36:27,889 - [*] year 2018, testing
2025-05-25 11:36:27,948 - T:3	MAE	25.5855	RMSE	37.8496	MAPE	22.6793
2025-05-25 11:36:28,022 - T:6	MAE	26.8025	RMSE	39.8694	MAPE	23.8853
2025-05-25 11:36:28,126 - T:12	MAE	27.2703	RMSE	40.9648	MAPE	27.2602
2025-05-25 11:36:28,156 - [*] Evaluating basic traffic samples (prediction=0):
2025-05-25 11:36:28,156 - [*] year 2018, testing
2025-05-25 11:36:28,160 - T:3	MAE	17.9407	RMSE	23.1221	MAPE	14.0405
2025-05-25 11:36:28,163 - T:6	MAE	19.3163	RMSE	25.1371	MAPE	15.3121
2025-05-25 11:36:28,167 - T:12	MAE	23.0469	RMSE	31.1344	MAPE	18.8993
2025-05-25 11:36:28,177 - [*] Evaluating event traffic samples (prediction=1):
2025-05-25 11:36:28,177 - [*] year 2018, testing
2025-05-25 11:36:28,178 - T:3	MAE	13.6943	RMSE	18.2227	MAPE	16.3580
2025-05-25 11:36:28,179 - T:6	MAE	16.1353	RMSE	22.0119	MAPE	18.8292
2025-05-25 11:36:28,181 - T:12	MAE	21.6499	RMSE	30.8511	MAPE	24.2262
2025-05-25 11:36:28,181 - Finished optimization, total time:170.92 s, best model:res/SD/trafficStream2025-05-25-11:20:30.017997/2018/26.1872.pkl

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 949253.62it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 940272.27it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1019456.30it/s]

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 963140.09it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1016365.86it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 997882.09it/s]
2025-05-25 11:37:18,552 - [*] Year 2019 load from data/SD/FastData/2019_30day.npz
2025-05-25 11:37:18,564 - Secure SignIn[*] load from res/SD/trafficStream2025-05-25-11:20:30.017997/2018/26.1872.pkl
2025-05-25 11:37:18,629 - [*] replay node number 64
2025-05-25 11:37:18,684 - number of increase nodes:67, nodes after 2 hop:torch.Size([533]), total nodes this year 716
2025-05-25 11:37:28,939 - [*] Year 2019 Dataset load!
2025-05-25 11:37:28,939 - Secure SignIn[*] load from res/SD/trafficStream2025-05-25-11:20:30.017997/2018/26.1872.pkl
2025-05-25 11:37:29,083 - [*] EWC! lambda 0.000100
2025-05-25 11:37:39,593 - [*] Model parameter count: 8842
2025-05-25 11:37:39,594 - [*] Year 2019 Training start
2025-05-25 11:37:40,604 - node number torch.Size([68224, 24])
2025-05-25 11:38:09,002 - epoch:0, training loss:1513.3398 validation loss:26.0959, moco loss:2.8289
2025-05-25 11:38:37,096 - epoch:1, training loss:1468.1491 validation loss:25.3332, moco loss:1.2629
2025-05-25 11:39:06,664 - epoch:2, training loss:1474.5294 validation loss:25.4409, moco loss:38.0682
2025-05-25 11:39:34,960 - epoch:3, training loss:1477.3353 validation loss:25.5035, moco loss:5.9226
2025-05-25 11:40:04,413 - epoch:4, training loss:1471.1148 validation loss:25.8808, moco loss:31.9696
2025-05-25 11:40:32,131 - epoch:5, training loss:1474.3498 validation loss:25.3098, moco loss:1.1285
2025-05-25 11:40:58,974 - epoch:6, training loss:1472.5106 validation loss:25.6117, moco loss:1.9509
2025-05-25 11:41:28,649 - epoch:7, training loss:1477.4295 validation loss:25.3153, moco loss:1.8455
2025-05-25 11:41:56,632 - epoch:8, training loss:1475.9031 validation loss:25.3198, moco loss:17.1383
2025-05-25 11:42:26,156 - epoch:9, training loss:1472.1656 validation loss:26.5117, moco loss:19.1082
2025-05-25 11:42:54,416 - epoch:10, training loss:1474.1792 validation loss:25.3141, moco loss:2.0572
2025-05-25 11:43:21,098 - epoch:11, training loss:1472.4232 validation loss:25.5868, moco loss:19.9528
2025-05-25 11:43:28,203 - [*]Test--basic_loss:1621.4501, event_loss:0.0000, test_loss:1621.4501
2025-05-25 11:43:28,296 - [*] Evaluating all samples:
2025-05-25 11:43:28,297 - [*] year 2019, testing
2025-05-25 11:43:28,356 - T:3	MAE	28.9260	RMSE	40.3157	MAPE	20.0016
2025-05-25 11:43:28,427 - T:6	MAE	28.4968	RMSE	40.1137	MAPE	20.8963
2025-05-25 11:43:28,529 - T:12	MAE	27.7202	RMSE	39.3506	MAPE	22.6424
2025-05-25 11:43:28,592 - [*] Evaluating basic traffic samples (prediction=0):
2025-05-25 11:43:28,592 - [*] year 2019, testing
2025-05-25 11:43:28,596 - T:3	MAE	25.0511	RMSE	33.8136	MAPE	11.7196
2025-05-25 11:43:28,600 - T:6	MAE	26.6007	RMSE	36.2905	MAPE	12.2864
2025-05-25 11:43:28,606 - T:12	MAE	29.5453	RMSE	41.0443	MAPE	13.5088
2025-05-25 11:43:28,606 - Finished optimization, total time:288.01 s, best model:res/SD/trafficStream2025-05-25-11:20:30.017997/2019/25.3098.pkl

  0%|          | 0/63243 [00:00<?, ?it/s]
100%|██████████| 63243/63243 [00:00<00:00, 876230.45it/s]

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 1031030.24it/s]

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 1043379.15it/s]

  0%|          | 0/63243 [00:00<?, ?it/s]
100%|██████████| 63243/63243 [00:00<00:00, 1026398.47it/s]

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 1047619.37it/s]

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 1039331.91it/s]
2025-05-25 11:44:13,222 - [*] Year 2020 load from data/SD/FastData/2020_30day.npz
2025-05-25 11:44:13,235 - Secure SignIn[*] load from res/SD/trafficStream2025-05-25-11:20:30.017997/2019/25.3098.pkl
2025-05-25 11:44:13,386 - [*] replay node number 62
2025-05-25 11:44:13,599 - number of increase nodes:59, nodes after 2 hop:torch.Size([567]), total nodes this year 697
2025-05-25 11:44:23,664 - [*] Year 2020 Dataset load!
2025-05-25 11:44:23,664 - Secure SignIn[*] load from res/SD/trafficStream2025-05-25-11:20:30.017997/2019/25.3098.pkl
2025-05-25 11:44:23,806 - [*] EWC! lambda 0.000100
2025-05-25 11:44:34,460 - [*] Model parameter count: 8842
2025-05-25 11:44:34,460 - [*] Year 2020 Training start
2025-05-25 11:44:35,520 - node number torch.Size([72576, 24])
2025-05-25 11:45:04,257 - epoch:0, training loss:1285.3530 validation loss:26.7457, moco loss:1.3382
2025-05-25 11:45:33,317 - epoch:1, training loss:1237.2458 validation loss:26.7566, moco loss:14.0111
2025-05-25 11:45:59,991 - epoch:2, training loss:1239.7005 validation loss:28.2271, moco loss:32.2640
2025-05-25 11:46:20,383 - epoch:3, training loss:1236.4839 validation loss:27.5316, moco loss:30.1337
2025-05-25 11:46:38,699 - epoch:4, training loss:1234.7334 validation loss:27.6758, moco loss:4.4546
2025-05-25 11:46:58,284 - epoch:5, training loss:1233.9836 validation loss:28.3549, moco loss:2.9211
2025-05-25 11:47:18,240 - epoch:6, training loss:1242.3257 validation loss:27.8800, moco loss:0.8281
2025-05-25 11:47:22,594 - [*]Test--basic_loss:1071.5930, event_loss:0.0000, test_loss:1071.5930
2025-05-25 11:47:22,651 - [*] Evaluating all samples:
2025-05-25 11:47:22,651 - [*] year 2020, testing
2025-05-25 11:47:22,714 - T:3	MAE	22.7101	RMSE	34.2016	MAPE	24.8259
2025-05-25 11:47:22,785 - T:6	MAE	23.1465	RMSE	35.1959	MAPE	22.6340
2025-05-25 11:47:22,889 - T:12	MAE	22.3070	RMSE	34.7289	MAPE	24.9603
2025-05-25 11:47:22,933 - [*] Evaluating basic traffic samples (prediction=0):
2025-05-25 11:47:22,933 - [*] year 2020, testing
2025-05-25 11:47:22,938 - T:3	MAE	9.5826	RMSE	13.6229	MAPE	38.4395
2025-05-25 11:47:22,943 - T:6	MAE	10.4501	RMSE	14.8769	MAPE	46.2549
2025-05-25 11:47:22,948 - T:12	MAE	12.5435	RMSE	18.1292	MAPE	65.0887
2025-05-25 11:47:22,948 - Finished optimization, total time:135.48 s, best model:res/SD/trafficStream2025-05-25-11:20:30.017997/2020/26.7457.pkl
2025-05-25 11:47:22,973 - 3	mae	20.44	25.59	28.93	22.71	
2025-05-25 11:47:22,973 - 3	rmse	30.49	37.85	40.32	34.20	
2025-05-25 11:47:22,973 - 3	mape	12.66	22.68	20.00	24.83	
2025-05-25 11:47:22,973 - 6	mae	22.49	26.80	28.50	23.15	
2025-05-25 11:47:22,973 - 6	rmse	33.89	39.87	40.11	35.20	
2025-05-25 11:47:22,973 - 6	mape	14.19	23.89	20.90	22.63	
2025-05-25 11:47:22,973 - 12	mae	26.53	27.27	27.72	22.31	
2025-05-25 11:47:22,973 - 12	rmse	40.29	40.96	39.35	34.73	
2025-05-25 11:47:22,973 - 12	mape	17.91	27.26	22.64	24.96	
2025-05-25 11:47:22,973 - year	2017	total_time	474.0091639999999	average_time	17.555906481481482	epoch	27
2025-05-25 11:47:22,973 - year	2018	total_time	170.91525599999997	average_time	24.416478428571427	epoch	7
2025-05-25 11:47:22,973 - year	2019	total_time	288.00741	average_time	24.00063225	epoch	12
2025-05-25 11:47:22,973 - year	2020	total_time	135.478925	average_time	19.354144428571427	epoch	7
2025-05-26 07:29:54,724 - logger name:res/SD/trafficStream2025-05-26-07:29:54.723877/trafficStream.log
2025-05-26 07:29:54,725 - params : {'conf': 'conf/trafficStream_SD.json', 'paral': 0, 'gpuid': 7, 'logname': 'trafficStream', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/SD/trafficStream2025-05-13-07:40:17.495815/2017/25.0437.pkl', 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 1, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/SD/finaldata/', 'save_data_path': 'data/SD/FastData/', 'graph_path': 'data/SD/graph/', 'model_path': 'res/SD/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'classifier': {'hidden_dim': 128}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': False, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 300, 'extra_feature': True, 'momentum_type': 'linear', 'memory_size': 32, 'time': '2025-05-26-07:29:54.723877', 'path': 'res/SD/trafficStream2025-05-26-07:29:54.723877', 'device': device(type='cuda', index=7), 'logger': <Logger __main__ (INFO)>}
2025-05-26 07:29:54,754 - [*] Year 2017 load from data/SD/FastData/2017_30day.npz
/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-05-26 07:30:08,536 - [*] Year 2017 Dataset load!
2025-05-26 07:30:08,541 - [*] Model parameter count: 8986
2025-05-26 07:30:08,541 - [*] Year 2017 Training start
2025-05-26 07:30:09,005 - node number torch.Size([90240, 24])
2025-05-26 07:30:22,052 - epoch:0, training loss:8158.7242 validation loss:30.2094, moco loss:15.4074
2025-05-26 07:30:25,504 - [*]Test--basic_loss:230.2916, event_loss:2014.9312, test_loss:2011.0750
2025-05-26 07:30:25,977 - [*] Evaluating all samples:
2025-05-26 07:30:25,977 - [*] year 2017, testing
2025-05-26 07:30:28,228 - T:3	MAE	23.3724	RMSE	33.4483	MAPE	24.5476
2025-05-26 07:30:31,812 - T:6	MAE	24.8317	RMSE	36.3239	MAPE	25.0321
2025-05-26 07:30:37,258 - T:12	MAE	29.3005	RMSE	44.3740	MAPE	27.4928
2025-05-26 07:30:37,262 - [*] Evaluating basic traffic samples (prediction=0):
2025-05-26 07:30:37,262 - [*] year 2017, testing
2025-05-26 07:30:37,268 - T:3	MAE	14.3663	RMSE	19.6074	MAPE	31.1446
2025-05-26 07:30:37,276 - T:6	MAE	16.2884	RMSE	22.4171	MAPE	36.2380
2025-05-26 07:30:37,286 - T:12	MAE	21.4996	RMSE	28.7893	MAPE	51.8892
2025-05-26 07:30:37,912 - [*] Evaluating event traffic samples (prediction=1):
2025-05-26 07:30:37,912 - [*] year 2017, testing
2025-05-26 07:30:56,635 - logger name:res/SD/trafficStream2025-05-26-07:30:56.634662/trafficStream.log
2025-05-26 07:30:56,636 - params : {'conf': 'conf/trafficStream_SD.json', 'paral': 0, 'gpuid': 7, 'logname': 'trafficStream', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/SD/trafficStream2025-05-13-07:40:17.495815/2017/25.0437.pkl', 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/SD/finaldata/', 'save_data_path': 'data/SD/FastData/', 'graph_path': 'data/SD/graph/', 'model_path': 'res/SD/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'classifier': {'hidden_dim': 128}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': False, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 300, 'extra_feature': True, 'momentum_type': 'linear', 'memory_size': 32, 'time': '2025-05-26-07:30:56.634662', 'path': 'res/SD/trafficStream2025-05-26-07:30:56.634662', 'device': device(type='cuda', index=7), 'logger': <Logger __main__ (INFO)>}
2025-05-26 07:30:56,663 - [*] Year 2017 load from data/SD/FastData/2017_30day.npz
/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-05-26 07:31:10,294 - [*] Year 2017 Dataset load!
2025-05-26 07:31:10,298 - [*] Model parameter count: 8986
2025-05-26 07:31:10,298 - [*] Year 2017 Training start
2025-05-26 07:31:10,740 - node number torch.Size([90240, 24])
2025-05-26 07:31:22,807 - epoch:0, training loss:8158.7242 validation loss:30.2094, moco loss:15.4074
2025-05-26 07:31:34,927 - epoch:1, training loss:2040.5316 validation loss:28.2477, moco loss:28.5348
2025-05-26 07:31:47,390 - epoch:2, training loss:1939.8769 validation loss:28.0285, moco loss:9.7843
2025-05-26 07:31:59,266 - epoch:3, training loss:1915.4345 validation loss:28.0964, moco loss:82.5639
2025-05-26 07:32:11,533 - epoch:4, training loss:1897.2366 validation loss:27.8287, moco loss:26.4520
2025-05-26 07:32:23,633 - epoch:5, training loss:1890.5488 validation loss:29.5030, moco loss:11.0320
2025-05-26 07:32:35,953 - epoch:6, training loss:1885.2172 validation loss:27.9666, moco loss:11.5848
2025-05-26 07:32:48,413 - epoch:7, training loss:1885.6925 validation loss:28.4735, moco loss:28.4875
2025-05-26 07:33:00,851 - epoch:8, training loss:1873.7595 validation loss:28.1012, moco loss:16.4288
2025-05-26 07:33:13,144 - epoch:9, training loss:1855.6996 validation loss:28.1187, moco loss:15.7090
2025-05-26 07:33:25,349 - epoch:10, training loss:1806.1583 validation loss:27.4174, moco loss:4.4014
2025-05-26 07:33:37,552 - epoch:11, training loss:1768.6312 validation loss:27.1717, moco loss:4.2051
2025-05-26 07:33:50,044 - epoch:12, training loss:1753.3787 validation loss:27.5380, moco loss:2.7649
2025-05-26 07:34:02,358 - epoch:13, training loss:1739.2943 validation loss:27.6813, moco loss:12.3520
2025-05-26 07:34:14,737 - epoch:14, training loss:1736.7945 validation loss:26.7723, moco loss:14.9282
2025-05-26 07:34:27,093 - epoch:15, training loss:1730.0111 validation loss:26.6200, moco loss:3.3252
2025-05-26 07:34:39,413 - epoch:16, training loss:1728.8215 validation loss:27.2886, moco loss:23.2964
2025-05-26 07:34:51,692 - epoch:17, training loss:1719.6242 validation loss:27.1147, moco loss:9.9350
2025-05-26 07:35:04,084 - epoch:18, training loss:1716.0207 validation loss:27.8027, moco loss:1.0537
2025-05-26 07:35:16,615 - epoch:19, training loss:1712.6689 validation loss:26.7004, moco loss:4.3060
2025-05-26 07:35:28,815 - epoch:20, training loss:1714.0030 validation loss:27.5060, moco loss:2.1081
2025-05-26 07:35:41,167 - epoch:21, training loss:1705.2551 validation loss:27.2585, moco loss:55.2470
2025-05-26 07:35:44,446 - [*]Test--basic_loss:138.0037, event_loss:1657.3745, test_loss:1653.9354
2025-05-26 07:35:44,905 - [*] Evaluating all samples:
2025-05-26 07:35:44,905 - [*] year 2017, testing
2025-05-26 07:35:47,141 - T:3	MAE	20.2219	RMSE	30.1137	MAPE	13.5676
2025-05-26 07:35:50,701 - T:6	MAE	22.3871	RMSE	33.6848	MAPE	15.1239
2025-05-26 07:35:56,080 - T:12	MAE	26.4003	RMSE	40.1693	MAPE	18.3357
2025-05-26 07:35:56,084 - [*] Evaluating basic traffic samples (prediction=0):
2025-05-26 07:35:56,084 - [*] year 2017, testing
2025-05-26 07:35:56,090 - T:3	MAE	11.9054	RMSE	17.5737	MAPE	18.4639
2025-05-26 07:35:56,098 - T:6	MAE	13.0778	RMSE	19.7020	MAPE	21.1724
2025-05-26 07:35:56,107 - T:12	MAE	14.8991	RMSE	22.5149	MAPE	27.7417
2025-05-26 07:35:56,725 - [*] Evaluating event traffic samples (prediction=1):
2025-05-26 07:35:56,725 - [*] year 2017, testing
2025-05-26 07:35:58,508 - T:3	MAE	20.2532	RMSE	30.1511	MAPE	13.5491
2025-05-26 07:36:01,279 - T:6	MAE	22.4222	RMSE	33.7266	MAPE	15.1011
2025-05-26 07:36:06,148 - T:12	MAE	26.4436	RMSE	40.2212	MAPE	18.3004
2025-05-26 07:36:06,154 - Finished optimization, total time:192.04 s, best model:res/SD/trafficStream2025-05-26-07:30:56.634662/2017/26.62.pkl
2025-05-26 07:36:06,218 - [*] Year 2018 load from data/SD/FastData/2018_30day.npz
2025-05-26 07:36:06,245 - Secure SignIn[*] load from res/SD/trafficStream2025-05-26-07:30:56.634662/2017/26.62.pkl
2025-05-26 07:36:06,275 - [*] replay node number 63
2025-05-26 07:36:11,688 - number of increase nodes:63, nodes after 2 hop:torch.Size([524]), total nodes this year 708
2025-05-26 07:36:39,695 - [*] Year 2018 Dataset load!
2025-05-26 07:36:39,695 - Secure SignIn[*] load from res/SD/trafficStream2025-05-26-07:30:56.634662/2017/26.62.pkl
2025-05-26 07:36:39,724 - [*] EWC! lambda 0.000100
2025-05-26 07:37:06,976 - [*] Model parameter count: 8986
2025-05-26 07:37:06,977 - [*] Year 2018 Training start
2025-05-26 07:37:08,256 - node number torch.Size([67072, 24])
2025-05-26 07:37:24,494 - epoch:0, training loss:1835.0830 validation loss:26.4192, moco loss:11.5300
2025-05-26 07:37:40,326 - epoch:1, training loss:1798.6021 validation loss:26.6190, moco loss:3.7565
2025-05-26 07:37:54,373 - epoch:2, training loss:1802.9417 validation loss:26.6093, moco loss:1.7371
2025-05-26 07:38:07,547 - epoch:3, training loss:1801.2610 validation loss:26.3073, moco loss:16.5621
2025-05-26 07:38:21,040 - epoch:4, training loss:1802.1854 validation loss:26.7207, moco loss:22.8266
2025-05-26 07:38:35,160 - epoch:5, training loss:1799.9447 validation loss:26.6350, moco loss:3.5324
2025-05-26 07:38:48,425 - epoch:6, training loss:1804.4680 validation loss:26.6629, moco loss:21.7685
2025-05-26 07:39:01,998 - epoch:7, training loss:1803.7052 validation loss:27.4666, moco loss:18.5160
2025-05-26 07:39:15,158 - epoch:8, training loss:1804.4759 validation loss:26.3083, moco loss:8.3777
2025-05-26 07:39:29,002 - epoch:9, training loss:1801.3706 validation loss:26.6342, moco loss:1.4712
2025-05-26 07:39:32,166 - [*]Test--basic_loss:142.7878, event_loss:1806.0128, test_loss:1803.7913
2025-05-26 07:39:32,247 - [*] Evaluating all samples:
2025-05-26 07:39:32,247 - [*] year 2018, testing
2025-05-26 07:39:32,311 - T:3	MAE	25.0848	RMSE	36.8692	MAPE	24.4473
2025-05-26 07:39:32,396 - T:6	MAE	26.2666	RMSE	38.9118	MAPE	26.2055
2025-05-26 07:39:32,516 - T:12	MAE	26.7918	RMSE	40.1804	MAPE	30.1569
2025-05-26 07:39:32,517 - [*] Evaluating basic traffic samples (prediction=0):
2025-05-26 07:39:32,517 - [*] year 2018, testing
2025-05-26 07:39:32,517 - T:3	MAE	11.9453	RMSE	17.7214	MAPE	18.7999
2025-05-26 07:39:32,517 - T:6	MAE	13.1214	RMSE	18.5105	MAPE	19.2334
2025-05-26 07:39:32,517 - T:12	MAE	14.3719	RMSE	21.2542	MAPE	20.1079
2025-05-26 07:39:32,572 - [*] Evaluating event traffic samples (prediction=1):
2025-05-26 07:39:32,572 - [*] year 2018, testing
2025-05-26 07:39:32,577 - T:3	MAE	16.9240	RMSE	21.9715	MAPE	14.9349
2025-05-26 07:39:32,580 - T:6	MAE	18.4351	RMSE	24.1506	MAPE	16.3864
2025-05-26 07:39:32,586 - T:12	MAE	22.0759	RMSE	29.7831	MAPE	19.9390
2025-05-26 07:39:32,586 - Finished optimization, total time:115.54 s, best model:res/SD/trafficStream2025-05-26-07:30:56.634662/2018/26.3073.pkl
2025-05-26 07:39:32,672 - [*] Year 2019 load from data/SD/FastData/2019_30day.npz
2025-05-26 07:39:32,676 - Secure SignIn[*] load from res/SD/trafficStream2025-05-26-07:30:56.634662/2018/26.3073.pkl
2025-05-26 07:39:32,709 - [*] replay node number 64
2025-05-26 07:39:38,215 - number of increase nodes:67, nodes after 2 hop:torch.Size([533]), total nodes this year 716
2025-05-26 07:40:08,678 - [*] Year 2019 Dataset load!
2025-05-26 07:40:08,678 - Secure SignIn[*] load from res/SD/trafficStream2025-05-26-07:30:56.634662/2018/26.3073.pkl
2025-05-26 07:40:08,720 - [*] EWC! lambda 0.000100
2025-05-26 07:40:36,214 - [*] Model parameter count: 8986
2025-05-26 07:40:36,215 - [*] Year 2019 Training start
2025-05-26 07:40:37,544 - node number torch.Size([68224, 24])
2025-05-26 07:40:53,325 - epoch:0, training loss:1523.4563 validation loss:25.8033, moco loss:36.6225
2025-05-26 07:41:06,140 - epoch:1, training loss:1483.4876 validation loss:25.6608, moco loss:6.7393
2025-05-26 07:41:19,344 - epoch:2, training loss:1486.4837 validation loss:25.9637, moco loss:8.3567
2025-05-26 07:41:33,023 - epoch:3, training loss:1491.7832 validation loss:25.6198, moco loss:18.2483
2025-05-26 07:41:46,860 - epoch:4, training loss:1484.3125 validation loss:25.5041, moco loss:2.7688
2025-05-26 07:42:01,554 - epoch:5, training loss:1485.3109 validation loss:25.5909, moco loss:10.4961
2025-05-26 07:42:15,446 - epoch:6, training loss:1494.1064 validation loss:25.4662, moco loss:5.4691
2025-05-26 07:42:29,186 - epoch:7, training loss:1486.9569 validation loss:25.7862, moco loss:6.4337
2025-05-26 07:42:43,687 - epoch:8, training loss:1487.4844 validation loss:25.7296, moco loss:9.8514
2025-05-26 07:42:57,194 - epoch:9, training loss:1486.4115 validation loss:25.4516, moco loss:0.8960
2025-05-26 07:43:10,686 - epoch:10, training loss:1484.5127 validation loss:25.5785, moco loss:9.3940
2025-05-26 07:43:23,937 - epoch:11, training loss:1487.0905 validation loss:25.5118, moco loss:20.3981
2025-05-26 07:43:37,446 - epoch:12, training loss:1487.8126 validation loss:25.4249, moco loss:51.7488
2025-05-26 07:43:51,276 - epoch:13, training loss:1487.5693 validation loss:25.6458, moco loss:23.1554
2025-05-26 07:44:06,166 - epoch:14, training loss:1491.4789 validation loss:25.9197, moco loss:13.0176
2025-05-26 07:44:20,813 - epoch:15, training loss:1486.6248 validation loss:25.4563, moco loss:1.9389
2025-05-26 07:44:34,904 - epoch:16, training loss:1484.5567 validation loss:25.5220, moco loss:4.2543
2025-05-26 07:44:48,625 - epoch:17, training loss:1489.0632 validation loss:25.5186, moco loss:1.8135
2025-05-26 07:45:03,227 - epoch:18, training loss:1489.1461 validation loss:25.4534, moco loss:10.3494
2025-05-26 07:45:06,488 - [*]Test--basic_loss:846.0509, event_loss:1627.6520, test_loss:1637.0673
2025-05-26 07:45:06,642 - [*] Evaluating all samples:
2025-05-26 07:45:06,642 - [*] year 2019, testing
2025-05-26 07:45:06,748 - T:3	MAE	29.0857	RMSE	40.5687	MAPE	19.9831
2025-05-26 07:45:06,852 - T:6	MAE	28.6197	RMSE	40.3867	MAPE	20.7310
2025-05-26 07:45:07,014 - T:12	MAE	27.7533	RMSE	39.5047	MAPE	22.5545
2025-05-26 07:45:07,016 - [*] Evaluating basic traffic samples (prediction=0):
2025-05-26 07:45:07,016 - [*] year 2019, testing
2025-05-26 07:45:07,016 - T:3	MAE	27.2143	RMSE	34.7675	MAPE	12.2312
2025-05-26 07:45:07,016 - T:6	MAE	34.6876	RMSE	44.1028	MAPE	13.4492
2025-05-26 07:45:07,017 - T:12	MAE	49.9616	RMSE	64.2104	MAPE	15.8467
2025-05-26 07:45:07,088 - [*] Evaluating event traffic samples (prediction=1):
2025-05-26 07:45:07,088 - [*] year 2019, testing
2025-05-26 07:45:07,094 - T:3	MAE	24.9309	RMSE	33.7201	MAPE	11.5567
2025-05-26 07:45:07,101 - T:6	MAE	26.2168	RMSE	35.9254	MAPE	12.0339
2025-05-26 07:45:07,108 - T:12	MAE	29.0227	RMSE	40.4349	MAPE	13.3473
2025-05-26 07:45:07,108 - Finished optimization, total time:215.99 s, best model:res/SD/trafficStream2025-05-26-07:30:56.634662/2019/25.4249.pkl
2025-05-26 07:45:07,194 - [*] Year 2020 load from data/SD/FastData/2020_30day.npz
2025-05-26 07:45:07,199 - Secure SignIn[*] load from res/SD/trafficStream2025-05-26-07:30:56.634662/2019/25.4249.pkl
2025-05-26 07:45:07,228 - [*] replay node number 62
2025-05-26 07:45:18,484 - number of increase nodes:59, nodes after 2 hop:torch.Size([567]), total nodes this year 697
2025-05-26 07:45:43,704 - [*] Year 2020 Dataset load!
2025-05-26 07:45:43,704 - Secure SignIn[*] load from res/SD/trafficStream2025-05-26-07:30:56.634662/2019/25.4249.pkl
2025-05-26 07:45:43,730 - [*] EWC! lambda 0.000100
2025-05-26 07:45:57,845 - [*] Model parameter count: 8986
2025-05-26 07:45:57,845 - [*] Year 2020 Training start
2025-05-26 07:45:58,935 - node number torch.Size([72576, 24])
2025-05-26 07:46:11,972 - epoch:0, training loss:1312.0564 validation loss:26.7248, moco loss:0.4616
2025-05-26 07:46:26,015 - epoch:1, training loss:1261.2430 validation loss:26.9615, moco loss:27.9181
2025-05-26 07:46:40,484 - epoch:2, training loss:1265.9140 validation loss:27.5716, moco loss:14.5787
2025-05-26 07:46:54,920 - epoch:3, training loss:1259.6220 validation loss:27.2035, moco loss:3.8771
2025-05-26 07:47:07,672 - epoch:4, training loss:1255.2452 validation loss:27.2545, moco loss:3.6324
2025-05-26 07:47:21,402 - epoch:5, training loss:1253.2300 validation loss:28.2982, moco loss:1.2365
2025-05-26 07:47:34,540 - epoch:6, training loss:1252.3811 validation loss:28.1785, moco loss:4.4253
2025-05-26 07:47:37,619 - [*]Test--basic_loss:316.8721, event_loss:1091.5588, test_loss:1091.7150
2025-05-26 07:47:37,676 - [*] Evaluating all samples:
2025-05-26 07:47:37,676 - [*] year 2020, testing
2025-05-26 07:47:37,738 - T:3	MAE	23.0580	RMSE	34.6820	MAPE	25.8206
2025-05-26 07:47:37,811 - T:6	MAE	23.4500	RMSE	35.6085	MAPE	23.5269
2025-05-26 07:47:37,917 - T:12	MAE	22.5094	RMSE	34.8858	MAPE	26.1151
2025-05-26 07:47:37,918 - [*] Evaluating basic traffic samples (prediction=0):
2025-05-26 07:47:37,918 - [*] year 2020, testing
2025-05-26 07:47:37,918 - T:3	MAE	7.6240	RMSE	9.4831	MAPE	144.9007
2025-05-26 07:47:37,918 - T:6	MAE	9.8409	RMSE	11.8926	MAPE	172.4270
2025-05-26 07:47:37,918 - T:12	MAE	15.1752	RMSE	18.4651	MAPE	205.5889
2025-05-26 07:47:37,960 - [*] Evaluating event traffic samples (prediction=1):
2025-05-26 07:47:37,960 - [*] year 2020, testing
2025-05-26 07:47:37,965 - T:3	MAE	9.9064	RMSE	14.0290	MAPE	38.5732
2025-05-26 07:47:37,968 - T:6	MAE	10.9094	RMSE	15.4012	MAPE	49.1561
2025-05-26 07:47:37,974 - T:12	MAE	13.2668	RMSE	19.0668	MAPE	68.3361
2025-05-26 07:47:37,974 - Finished optimization, total time:78.37 s, best model:res/SD/trafficStream2025-05-26-07:30:56.634662/2020/26.7248.pkl
2025-05-26 07:47:38,023 - 3	mae	20.22	25.08	29.09	23.06	
2025-05-26 07:47:38,024 - 3	rmse	30.11	36.87	40.57	34.68	
2025-05-26 07:47:38,024 - 3	mape	13.57	24.45	19.98	25.82	
2025-05-26 07:47:38,024 - 6	mae	22.39	26.27	28.62	23.45	
2025-05-26 07:47:38,024 - 6	rmse	33.68	38.91	40.39	35.61	
2025-05-26 07:47:38,024 - 6	mape	15.12	26.21	20.73	23.53	
2025-05-26 07:47:38,024 - 12	mae	26.40	26.79	27.75	22.51	
2025-05-26 07:47:38,024 - 12	rmse	40.17	40.18	39.50	34.89	
2025-05-26 07:47:38,024 - 12	mape	18.34	30.16	22.55	26.12	
2025-05-26 07:47:38,024 - year	2017	total_time	192.036943	average_time	8.728961954545454	epoch	22
2025-05-26 07:47:38,024 - year	2018	total_time	115.5414	average_time	11.5541542	epoch	10
2025-05-26 07:47:38,024 - year	2019	total_time	215.987925	average_time	11.367795947368421	epoch	19
2025-05-26 07:47:38,024 - year	2020	total_time	78.365454	average_time	11.195078285714287	epoch	7
2025-05-26 10:16:08,813 - logger name:res/SD/wo_moco2025-05-26-10:16:08.812667/wo_moco.log
2025-05-26 10:16:08,813 - params : {'conf': 'conf/wo-moco.json', 'paral': 0, 'gpuid': 5, 'logname': 'wo_moco', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/SD/linear-moco/2017/26.5761.pkl', 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/SD/finaldata/', 'save_data_path': 'data/SD/FastData/', 'graph_path': 'data/SD/graph/', 'model_path': 'res/SD/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'classifier': {'hidden_dim': 128}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': False, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 300, 'extra_feature': False, 'momentum_type': 'wo', 'memory_size': 32, 'time': '2025-05-26-10:16:08.812667', 'path': 'res/SD/wo_moco2025-05-26-10:16:08.812667', 'device': device(type='cuda', index=5), 'logger': <Logger __main__ (INFO)>}
2025-05-26 10:16:08,841 - [*] Year 2017 load from data/SD/FastData/2017_30day.npz
/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-05-26 10:16:22,550 - [*] Year 2017 Dataset load!
2025-05-26 10:16:22,554 - [*] Model parameter count: 7306
2025-05-26 10:16:22,554 - [*] Year 2017 Training start
2025-05-26 10:16:22,925 - node number torch.Size([90240, 24])
2025-05-26 10:16:45,887 - epoch:0, training loss:7984.5830 validation loss:30.5143, moco loss:102619.5625
2025-05-26 10:17:07,705 - epoch:1, training loss:2091.8279 validation loss:29.2451, moco loss:90557.2422
2025-05-26 10:17:30,495 - epoch:2, training loss:1946.7470 validation loss:29.3831, moco loss:97884.2109
2025-05-26 10:17:52,606 - epoch:3, training loss:1922.6317 validation loss:28.4017, moco loss:81939.1953
2025-05-26 10:18:15,092 - epoch:4, training loss:1905.6148 validation loss:29.0312, moco loss:112640.1172
2025-05-26 10:18:37,374 - epoch:5, training loss:1897.8502 validation loss:28.2238, moco loss:76838.1172
2025-05-26 10:18:59,826 - epoch:6, training loss:1901.3149 validation loss:28.0722, moco loss:97577.8438
2025-05-26 10:19:22,113 - epoch:7, training loss:1884.5086 validation loss:28.8190, moco loss:93828.4688
2025-05-26 10:19:43,939 - epoch:8, training loss:1886.3584 validation loss:27.8187, moco loss:91773.0469
2025-05-26 10:20:06,037 - epoch:9, training loss:1866.6259 validation loss:29.5349, moco loss:96886.2422
2025-05-26 10:20:28,273 - epoch:10, training loss:1818.0369 validation loss:27.4558, moco loss:83643.1719
2025-05-26 10:20:51,079 - epoch:11, training loss:1790.5341 validation loss:28.0358, moco loss:83517.7969
2025-05-26 10:21:13,159 - epoch:12, training loss:1771.0661 validation loss:27.8357, moco loss:96605.5938
2025-05-26 10:21:35,702 - epoch:13, training loss:1750.5000 validation loss:27.3912, moco loss:96250.2578
2025-05-26 10:21:58,116 - epoch:14, training loss:1745.8084 validation loss:26.8141, moco loss:107839.6250
2025-05-26 10:22:20,005 - epoch:15, training loss:1728.7519 validation loss:26.7786, moco loss:97488.3750
2025-05-26 10:22:42,766 - epoch:16, training loss:1737.3578 validation loss:26.9119, moco loss:107232.5781
2025-05-26 10:23:04,757 - epoch:17, training loss:1723.5370 validation loss:26.9616, moco loss:90790.2188
2025-05-26 10:23:27,685 - epoch:18, training loss:1716.0339 validation loss:27.2256, moco loss:80758.8125
2025-05-26 10:23:49,871 - epoch:19, training loss:1724.2655 validation loss:26.7511, moco loss:91977.9375
2025-05-26 10:24:11,969 - epoch:20, training loss:1716.0834 validation loss:26.7420, moco loss:99787.2812
2025-05-26 10:24:34,206 - epoch:21, training loss:1705.0612 validation loss:27.2133, moco loss:94688.2344
2025-05-26 10:24:56,362 - epoch:22, training loss:1713.0103 validation loss:26.6900, moco loss:83775.3203
2025-05-26 10:25:18,971 - epoch:23, training loss:1693.1629 validation loss:26.6193, moco loss:83278.9531
2025-05-26 10:25:40,602 - epoch:24, training loss:1704.1068 validation loss:27.8442, moco loss:86341.8125
2025-05-26 10:26:03,038 - epoch:25, training loss:1700.9488 validation loss:26.3316, moco loss:104383.4609
2025-05-26 10:26:25,223 - epoch:26, training loss:1677.5423 validation loss:26.6625, moco loss:95332.9219
2025-05-26 10:26:47,548 - epoch:27, training loss:1689.3209 validation loss:28.4710, moco loss:95258.2266
2025-05-26 10:27:09,975 - epoch:28, training loss:1680.6966 validation loss:27.4713, moco loss:84619.0781
2025-05-26 10:27:31,974 - epoch:29, training loss:1674.5716 validation loss:27.3780, moco loss:73063.5547
2025-05-26 10:27:54,354 - epoch:30, training loss:1681.6960 validation loss:26.6619, moco loss:84819.7188
2025-05-26 10:28:16,376 - epoch:31, training loss:1671.5309 validation loss:26.1969, moco loss:105537.9766
2025-05-26 10:28:39,069 - epoch:32, training loss:1666.4217 validation loss:26.4801, moco loss:88509.2812
2025-05-26 10:29:01,448 - epoch:33, training loss:1666.5670 validation loss:26.6096, moco loss:83703.4219
2025-05-26 10:29:23,693 - epoch:34, training loss:1668.3790 validation loss:26.1410, moco loss:105380.6094
2025-05-26 10:29:46,002 - epoch:35, training loss:1669.5129 validation loss:26.7241, moco loss:93365.8281
2025-05-26 10:30:08,428 - epoch:36, training loss:1658.7160 validation loss:27.8558, moco loss:104034.3594
2025-05-26 10:30:30,900 - epoch:37, training loss:1660.1812 validation loss:26.9621, moco loss:85636.1406
2025-05-26 10:30:52,696 - epoch:38, training loss:1665.1769 validation loss:27.5840, moco loss:97738.0469
2025-05-26 10:31:15,517 - epoch:39, training loss:1658.2356 validation loss:26.1664, moco loss:98183.6875
2025-05-26 10:31:37,857 - epoch:40, training loss:1660.8772 validation loss:26.9428, moco loss:96627.2188
2025-05-26 10:31:44,724 - [*]Test--basic_loss:2072.4659, event_loss:933.1979, test_loss:1616.7591
2025-05-26 10:31:45,114 - [*] Evaluating all samples:
2025-05-26 10:31:45,114 - [*] year 2017, testing
2025-05-26 10:31:47,445 - T:3	MAE	20.1942	RMSE	30.1349	MAPE	13.1575
2025-05-26 10:31:51,163 - T:6	MAE	22.2164	RMSE	33.4295	MAPE	14.6916
2025-05-26 10:31:56,866 - T:12	MAE	26.2373	RMSE	39.6848	MAPE	18.5049
2025-05-26 10:31:57,246 - [*] Evaluating basic traffic samples (prediction=0):
2025-05-26 10:31:57,247 - [*] year 2017, testing
2025-05-26 10:31:58,558 - T:3	MAE	25.0332	RMSE	35.2450	MAPE	8.7253
2025-05-26 10:32:00,790 - T:6	MAE	27.2211	RMSE	38.6774	MAPE	9.5010
2025-05-26 10:32:04,220 - T:12	MAE	31.3099	RMSE	44.7663	MAPE	11.1270
2025-05-26 10:32:04,473 - [*] Evaluating event traffic samples (prediction=1):
2025-05-26 10:32:04,473 - [*] year 2017, testing
2025-05-26 10:32:05,212 - T:3	MAE	12.8871	RMSE	20.0900	MAPE	19.8504
2025-05-26 10:32:06,329 - T:6	MAE	14.6609	RMSE	23.3711	MAPE	22.5307
2025-05-26 10:32:07,854 - T:12	MAE	18.5792	RMSE	30.4459	MAPE	29.6476
2025-05-26 10:32:07,860 - Finished optimization, total time:706.70 s, best model:res/SD/wo_moco2025-05-26-10:16:08.812667/2017/26.141.pkl
2025-05-26 10:32:07,925 - [*] Year 2018 load from data/SD/FastData/2018_30day.npz
2025-05-26 10:32:07,931 - Secure SignIn[*] load from res/SD/wo_moco2025-05-26-10:16:08.812667/2017/26.141.pkl
2025-05-26 10:32:07,956 - [*] replay node number 63
2025-05-26 10:32:13,486 - number of increase nodes:63, nodes after 2 hop:torch.Size([524]), total nodes this year 708
2025-05-26 10:32:36,827 - [*] Year 2018 Dataset load!
2025-05-26 10:32:36,827 - Secure SignIn[*] load from res/SD/wo_moco2025-05-26-10:16:08.812667/2017/26.141.pkl
2025-05-26 10:32:36,953 - [*] EWC! lambda 0.000100
2025-05-26 10:32:55,592 - [*] Model parameter count: 7306
2025-05-26 10:32:55,593 - [*] Year 2018 Training start
2025-05-26 10:32:57,265 - node number torch.Size([67072, 24])
2025-05-26 10:33:24,405 - epoch:0, training loss:1777.2729 validation loss:25.8109, moco loss:101341.2500
2025-05-26 10:33:52,073 - epoch:1, training loss:1730.0772 validation loss:26.1164, moco loss:100787.2812
2025-05-26 10:34:18,625 - epoch:2, training loss:1737.0696 validation loss:26.2774, moco loss:106679.6250
2025-05-26 10:34:45,497 - epoch:3, training loss:1729.0799 validation loss:26.0142, moco loss:88627.6562
2025-05-26 10:35:15,527 - epoch:4, training loss:1736.4457 validation loss:26.4033, moco loss:85915.5781
2025-05-26 10:35:42,529 - epoch:5, training loss:1733.9293 validation loss:26.0018, moco loss:97371.6406
2025-05-26 10:36:11,814 - epoch:6, training loss:1729.0390 validation loss:26.1936, moco loss:84875.6406
2025-05-26 10:36:20,131 - [*]Test--basic_loss:2355.7681, event_loss:980.5583, test_loss:1790.5216
2025-05-26 10:36:20,192 - [*] Evaluating all samples:
2025-05-26 10:36:20,192 - [*] year 2018, testing
2025-05-26 10:36:20,254 - T:3	MAE	24.9092	RMSE	36.6736	MAPE	23.9975
2025-05-26 10:36:20,326 - T:6	MAE	25.9460	RMSE	38.4049	MAPE	24.2183
2025-05-26 10:36:20,431 - T:12	MAE	26.3860	RMSE	39.3501	MAPE	26.2998
2025-05-26 10:36:20,452 - [*] Evaluating basic traffic samples (prediction=0):
2025-05-26 10:36:20,452 - [*] year 2018, testing
2025-05-26 10:36:20,455 - T:3	MAE	17.3325	RMSE	22.1770	MAPE	14.5479
2025-05-26 10:36:20,457 - T:6	MAE	17.9860	RMSE	23.1027	MAPE	15.3619
2025-05-26 10:36:20,460 - T:12	MAE	20.0627	RMSE	26.1008	MAPE	17.8950
2025-05-26 10:36:20,484 - [*] Evaluating event traffic samples (prediction=1):
2025-05-26 10:36:20,484 - [*] year 2018, testing
2025-05-26 10:36:20,486 - T:3	MAE	15.7257	RMSE	20.8105	MAPE	16.2199
2025-05-26 10:36:20,488 - T:6	MAE	18.1566	RMSE	24.6279	MAPE	18.3309
2025-05-26 10:36:20,490 - T:12	MAE	23.4742	RMSE	33.3686	MAPE	22.9885
2025-05-26 10:36:20,490 - Finished optimization, total time:161.65 s, best model:res/SD/wo_moco2025-05-26-10:16:08.812667/2018/25.8109.pkl
2025-05-26 10:36:20,727 - [*] Year 2019 load from data/SD/FastData/2019_30day.npz
2025-05-26 10:36:20,732 - Secure SignIn[*] load from res/SD/wo_moco2025-05-26-10:16:08.812667/2018/25.8109.pkl
2025-05-26 10:36:20,750 - [*] replay node number 64
2025-05-26 10:36:26,139 - number of increase nodes:67, nodes after 2 hop:torch.Size([533]), total nodes this year 716
2025-05-26 10:36:49,626 - [*] Year 2019 Dataset load!
2025-05-26 10:36:49,626 - Secure SignIn[*] load from res/SD/wo_moco2025-05-26-10:16:08.812667/2018/25.8109.pkl
2025-05-26 10:36:49,644 - [*] EWC! lambda 0.000100
2025-05-26 10:37:07,513 - [*] Model parameter count: 7306
2025-05-26 10:37:07,513 - [*] Year 2019 Training start
2025-05-26 10:37:08,470 - node number torch.Size([68224, 24])
2025-05-26 10:37:26,516 - epoch:0, training loss:1475.4467 validation loss:25.0717, moco loss:89545.5469
2025-05-26 10:37:45,234 - epoch:1, training loss:1448.4495 validation loss:26.0107, moco loss:102249.8281
2025-05-26 10:38:04,140 - epoch:2, training loss:1451.7877 validation loss:25.2563, moco loss:92771.0781
2025-05-26 10:38:22,520 - epoch:3, training loss:1444.0866 validation loss:26.1994, moco loss:88604.3906
2025-05-26 10:38:48,540 - epoch:4, training loss:1441.4163 validation loss:25.2951, moco loss:94422.5156
2025-05-26 10:39:15,019 - epoch:5, training loss:1450.0860 validation loss:25.4482, moco loss:87454.0703
2025-05-26 10:39:41,535 - epoch:6, training loss:1451.4006 validation loss:25.7480, moco loss:83602.7266
2025-05-26 10:39:48,902 - [*]Test--basic_loss:2043.1477, event_loss:850.5381, test_loss:1568.5592
2025-05-26 10:39:48,988 - [*] Evaluating all samples:
2025-05-26 10:39:48,989 - [*] year 2019, testing
2025-05-26 10:39:49,047 - T:3	MAE	28.2968	RMSE	39.6437	MAPE	18.7376
2025-05-26 10:39:49,121 - T:6	MAE	27.9036	RMSE	39.4684	MAPE	19.7482
2025-05-26 10:39:49,225 - T:12	MAE	27.1123	RMSE	38.7121	MAPE	21.1221
2025-05-26 10:39:49,263 - [*] Evaluating basic traffic samples (prediction=0):
2025-05-26 10:39:49,263 - [*] year 2019, testing
2025-05-26 10:39:49,265 - T:3	MAE	31.3030	RMSE	40.1994	MAPE	8.3510
2025-05-26 10:39:49,268 - T:6	MAE	32.3238	RMSE	42.0573	MAPE	8.7087
2025-05-26 10:39:49,271 - T:12	MAE	34.5505	RMSE	45.6549	MAPE	9.5311
2025-05-26 10:39:49,305 - [*] Evaluating event traffic samples (prediction=1):
2025-05-26 10:39:49,305 - [*] year 2019, testing
2025-05-26 10:39:49,307 - T:3	MAE	16.6318	RMSE	22.6951	MAPE	16.8791
2025-05-26 10:39:49,308 - T:6	MAE	18.0328	RMSE	25.3360	MAPE	17.2593
2025-05-26 10:39:49,310 - T:12	MAE	22.0378	RMSE	33.0685	MAPE	19.0156
2025-05-26 10:39:49,310 - Finished optimization, total time:126.28 s, best model:res/SD/wo_moco2025-05-26-10:16:08.812667/2019/25.0717.pkl
2025-05-26 10:39:49,384 - [*] Year 2020 load from data/SD/FastData/2020_30day.npz
2025-05-26 10:39:49,389 - Secure SignIn[*] load from res/SD/wo_moco2025-05-26-10:16:08.812667/2019/25.0717.pkl
2025-05-26 10:39:49,407 - [*] replay node number 62
2025-05-26 10:39:54,647 - number of increase nodes:59, nodes after 2 hop:torch.Size([567]), total nodes this year 697
2025-05-26 10:40:17,723 - [*] Year 2020 Dataset load!
2025-05-26 10:40:17,723 - Secure SignIn[*] load from res/SD/wo_moco2025-05-26-10:16:08.812667/2019/25.0717.pkl
2025-05-26 10:40:17,850 - [*] EWC! lambda 0.000100
2025-05-26 10:40:35,724 - [*] Model parameter count: 7306
2025-05-26 10:40:35,724 - [*] Year 2020 Training start
2025-05-26 10:40:36,643 - node number torch.Size([72576, 24])
2025-05-26 10:41:02,603 - epoch:0, training loss:1263.7437 validation loss:27.8992, moco loss:71252.5078
2025-05-26 10:41:30,784 - epoch:1, training loss:1214.2320 validation loss:29.7206, moco loss:75167.6016
2025-05-26 10:41:59,269 - epoch:2, training loss:1214.4954 validation loss:26.2653, moco loss:64374.6836
2025-05-26 10:42:26,877 - epoch:3, training loss:1220.7562 validation loss:28.7630, moco loss:58588.5117
2025-05-26 10:42:54,665 - epoch:4, training loss:1216.3292 validation loss:27.4543, moco loss:78631.5000
2025-05-26 10:43:22,542 - epoch:5, training loss:1212.5441 validation loss:28.7298, moco loss:68806.6562
2025-05-26 10:43:51,401 - epoch:6, training loss:1211.9757 validation loss:25.5080, moco loss:78800.3906
2025-05-26 10:44:18,561 - epoch:7, training loss:1215.3777 validation loss:29.1722, moco loss:84594.8594
2025-05-26 10:44:44,667 - epoch:8, training loss:1204.8904 validation loss:27.6648, moco loss:70773.2109
2025-05-26 10:45:12,458 - epoch:9, training loss:1210.9902 validation loss:27.4087, moco loss:73151.2500
2025-05-26 10:45:39,122 - epoch:10, training loss:1206.1966 validation loss:27.0580, moco loss:71164.7031
2025-05-26 10:46:05,485 - epoch:11, training loss:1208.7006 validation loss:27.6372, moco loss:74336.5938
2025-05-26 10:46:32,721 - epoch:12, training loss:1214.8067 validation loss:25.9717, moco loss:67772.3516
2025-05-26 10:46:38,882 - [*]Test--basic_loss:1390.9924, event_loss:426.6717, test_loss:1059.6634
2025-05-26 10:46:38,937 - [*] Evaluating all samples:
2025-05-26 10:46:38,937 - [*] year 2020, testing
2025-05-26 10:46:38,996 - T:3	MAE	22.6440	RMSE	33.8238	MAPE	28.6344
2025-05-26 10:46:39,066 - T:6	MAE	23.1490	RMSE	34.8225	MAPE	26.7398
2025-05-26 10:46:39,165 - T:12	MAE	22.3632	RMSE	34.2600	MAPE	29.8940
2025-05-26 10:46:39,178 - [*] Evaluating basic traffic samples (prediction=0):
2025-05-26 10:46:39,178 - [*] year 2020, testing
2025-05-26 10:46:39,180 - T:3	MAE	12.8852	RMSE	16.7934	MAPE	13.6223
2025-05-26 10:46:39,182 - T:6	MAE	13.9237	RMSE	18.4195	MAPE	14.5253
2025-05-26 10:46:39,186 - T:12	MAE	16.0865	RMSE	22.1162	MAPE	16.3486
2025-05-26 10:46:39,207 - [*] Evaluating event traffic samples (prediction=1):
2025-05-26 10:46:39,207 - [*] year 2020, testing
2025-05-26 10:46:39,209 - T:3	MAE	6.4985	RMSE	7.6776	MAPE	151.8726
2025-05-26 10:46:39,210 - T:6	MAE	6.9255	RMSE	8.1969	MAPE	156.6127
2025-05-26 10:46:39,212 - T:12	MAE	9.3021	RMSE	11.5448	MAPE	196.7066
2025-05-26 10:46:39,213 - Finished optimization, total time:296.11 s, best model:res/SD/wo_moco2025-05-26-10:16:08.812667/2020/25.508.pkl
2025-05-26 10:46:39,265 - 3	mae	20.19	24.91	28.30	22.64	
2025-05-26 10:46:39,265 - 3	rmse	30.13	36.67	39.64	33.82	
2025-05-26 10:46:39,265 - 3	mape	13.16	24.00	18.74	28.63	
2025-05-26 10:46:39,265 - 6	mae	22.22	25.95	27.90	23.15	
2025-05-26 10:46:39,266 - 6	rmse	33.43	38.40	39.47	34.82	
2025-05-26 10:46:39,266 - 6	mape	14.69	24.22	19.75	26.74	
2025-05-26 10:46:39,266 - 12	mae	26.24	26.39	27.11	22.36	
2025-05-26 10:46:39,266 - 12	rmse	39.68	39.35	38.71	34.26	
2025-05-26 10:46:39,266 - 12	mape	18.50	26.30	21.12	29.89	
2025-05-26 10:46:39,266 - year	2017	total_time	706.6953939999999	average_time	17.23648443902439	epoch	41
2025-05-26 10:46:39,266 - year	2018	total_time	161.645595	average_time	23.092237571428573	epoch	7
2025-05-26 10:46:39,266 - year	2019	total_time	126.278272	average_time	18.039766285714286	epoch	7
2025-05-26 10:46:39,266 - year	2020	total_time	296.11438400000003	average_time	22.778040230769232	epoch	13
2025-05-26 11:00:11,756 - logger name:res/SD/wo_moco2025-05-26-11:00:11.755245/wo_moco.log
2025-05-26 11:00:11,756 - params : {'conf': 'conf/wo-moco.json', 'paral': 0, 'gpuid': 5, 'logname': 'wo_moco', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/SD/linear-moco/2017/26.5761.pkl', 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/SD/finaldata/', 'save_data_path': 'data/SD/FastData/', 'graph_path': 'data/SD/graph/', 'model_path': 'res/SD/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'classifier': {'hidden_dim': 128}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': False, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 300, 'extra_feature': False, 'momentum_type': 'wo', 'memory_size': 32, 'expand': False, 'time': '2025-05-26-11:00:11.755245', 'path': 'res/SD/wo_moco2025-05-26-11:00:11.755245', 'device': device(type='cuda', index=5), 'logger': <Logger __main__ (INFO)>}
2025-05-26 11:00:11,783 - [*] Year 2017 load from data/SD/FastData/2017_30day.npz
/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-05-26 11:00:25,373 - [*] Year 2017 Dataset load!
2025-05-26 11:00:25,404 - [*] Model parameter count: 7306
2025-05-26 11:00:25,404 - [*] Year 2017 Training start
2025-05-26 11:00:25,773 - node number torch.Size([90240, 24])
Traceback (most recent call last):
  File "/home/bd2/ANATS/TrafficStream/main-womoco.py", line 550, in <module>
    main(args)
  File "/home/bd2/ANATS/TrafficStream/main-womoco.py", line 512, in main
    train(inputs, args)
  File "/home/bd2/ANATS/TrafficStream/main-womoco.py", line 182, in train
    basic_features, basic_features_m, similarity, logits = model(data, args.sub_adj)
                                                           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/ANATS/TrafficStream/src/model/model.py", line 215, in forward
    similarity, logits = self.query_memory(x, adj)
    ^^^^^^^^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)
2025-05-26 12:20:16,115 - logger name:res/SD/all-com2025-05-26-12:20:16.113789/all-com.log
2025-05-26 12:20:16,115 - params : {'conf': 'conf/all-com.json', 'paral': 0, 'gpuid': 3, 'logname': 'all-com', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/SD/trafficStream2025-05-13-07:40:17.495815/2017/25.0437.pkl', 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/SD/finaldata/', 'save_data_path': 'data/SD/FastData/', 'graph_path': 'data/SD/graph/', 'model_path': 'res/SD/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'classifier': {'hidden_dim': 128}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': False, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 300, 'extra_feature': True, 'moco': True, 'momentum_type': 'linear', 'memory_size': 32, 'expand': True, 'time': '2025-05-26-12:20:16.113789', 'path': 'res/SD/all-com2025-05-26-12:20:16.113789', 'device': device(type='cuda', index=3), 'logger': <Logger __main__ (INFO)>}
2025-05-26 12:20:16,146 - [*] Year 2017 load from data/SD/FastData/2017_30day.npz
/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
python: can't open file '/home/bd2/ANATS/TrafficStream/main_womoco.py': [Errno 2] No such file or directory
2025-05-26 12:20:30,017 - [*] Year 2017 Dataset load!
2025-05-26 12:20:30,021 - [*] Model parameter count: 10534
2025-05-26 12:20:30,021 - [*] Year 2017 Training start
2025-05-26 12:20:30,544 - node number torch.Size([90240, 24])
2025-05-26 12:20:44,494 - epoch:0, training loss:16240.4335 validation loss:29.8460, moco loss:33.9080
2025-05-26 12:20:58,299 - epoch:1, training loss:1867.3689 validation loss:27.7914, moco loss:56.7150
2025-05-26 12:21:11,943 - epoch:2, training loss:1760.2268 validation loss:27.1625, moco loss:32.9504
2025-05-26 12:21:25,926 - epoch:3, training loss:1712.4536 validation loss:27.7291, moco loss:30.9322
2025-05-26 12:21:39,716 - epoch:4, training loss:1693.0628 validation loss:27.1366, moco loss:37.4039
2025-05-26 12:21:53,684 - epoch:5, training loss:1671.6012 validation loss:26.8760, moco loss:30.8764
2025-05-26 12:22:07,649 - epoch:6, training loss:1655.8469 validation loss:26.4278, moco loss:16.1697
2025-05-26 12:22:21,745 - epoch:7, training loss:1646.3341 validation loss:26.0928, moco loss:12.4447
2025-05-26 12:22:25,417 - logger name:res/SD/wo_moco2025-05-26-12:22:25.416349/wo_moco.log
2025-05-26 12:22:25,417 - params : {'conf': 'conf/wo-moco.json', 'paral': 0, 'gpuid': 5, 'logname': 'wo_moco', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/SD/linear-moco/2017/26.5761.pkl', 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/SD/finaldata/', 'save_data_path': 'data/SD/FastData/', 'graph_path': 'data/SD/graph/', 'model_path': 'res/SD/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'classifier': {'hidden_dim': 128}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': False, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 300, 'extra_feature': False, 'momentum_type': 'wo', 'memory_size': 32, 'expand': False, 'time': '2025-05-26-12:22:25.416349', 'path': 'res/SD/wo_moco2025-05-26-12:22:25.416349', 'device': device(type='cuda', index=5), 'logger': <Logger __main__ (INFO)>}
2025-05-26 12:22:25,445 - [*] Year 2017 load from data/SD/FastData/2017_30day.npz
Traceback (most recent call last):
  File "/home/bd2/ANATS/TrafficStream/main-womoco.py", line 550, in <module>
    main(args)
  File "/home/bd2/ANATS/TrafficStream/main-womoco.py", line 512, in main
    train(inputs, args)
  File "/home/bd2/ANATS/TrafficStream/main-womoco.py", line 124, in train
    train_loader = DataLoader(TrafficDataset(inputs, "train"), batch_size=args.batch_size, shuffle=True, pin_memory=pin_memory, num_workers=n_work)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/ANATS/TrafficStream/src/trafficDataset.py", line 8, in __init__
    self.x = inputs[split+'_x'] # [T, Len, N]
             ~~~~~~^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/numpy/lib/_npyio_impl.py", line 254, in __getitem__
    return format.read_array(bytes,
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/numpy/lib/format.py", line 852, in read_array
    array[i:i+read_count] = numpy.frombuffer(data, dtype=dtype,
    ~~~~~^^^^^^^^^^^^^^^^
KeyboardInterrupt
2025-05-26 12:22:35,634 - epoch:8, training loss:1634.5787 validation loss:25.9924, moco loss:4.8143
2025-05-26 12:22:42,736 - logger name:res/SD/wo_moco2025-05-26-12:22:42.735211/wo_moco.log
2025-05-26 12:22:42,736 - params : {'conf': 'conf/wo-moco.json', 'paral': 0, 'gpuid': 5, 'logname': 'wo_moco', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/SD/linear-moco/2017/26.5761.pkl', 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/SD/finaldata/', 'save_data_path': 'data/SD/FastData/', 'graph_path': 'data/SD/graph/', 'model_path': 'res/SD/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'classifier': {'hidden_dim': 128}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': False, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 300, 'extra_feature': False, 'momentum_type': 'wo', 'memory_size': 32, 'expand': False, 'time': '2025-05-26-12:22:42.735211', 'path': 'res/SD/wo_moco2025-05-26-12:22:42.735211', 'device': device(type='cuda', index=5), 'logger': <Logger __main__ (INFO)>}
2025-05-26 12:22:42,765 - [*] Year 2017 load from data/SD/FastData/2017_30day.npz
2025-05-26 12:22:49,429 - epoch:9, training loss:1631.7706 validation loss:26.7484, moco loss:14.0947
/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-05-26 12:22:56,808 - [*] Year 2017 Dataset load!
2025-05-26 12:22:56,831 - [*] Model parameter count: 7306
2025-05-26 12:22:56,831 - [*] Year 2017 Training start
2025-05-26 12:22:57,218 - node number torch.Size([90240, 24])
2025-05-26 12:23:03,222 - epoch:10, training loss:1622.8931 validation loss:27.0928, moco loss:20.8602
2025-05-26 12:23:17,259 - epoch:11, training loss:1618.0927 validation loss:26.1010, moco loss:21.4461
2025-05-26 12:23:20,051 - epoch:0, training loss:7942.4210 validation loss:29.9171, moco loss:102015.4531
2025-05-26 12:23:31,168 - epoch:12, training loss:1614.2100 validation loss:26.9262, moco loss:12.8003
2025-05-26 12:23:42,187 - epoch:1, training loss:2084.8769 validation loss:28.3608, moco loss:90168.8047
2025-05-26 12:23:45,136 - epoch:13, training loss:1611.6710 validation loss:26.5176, moco loss:43.8858
2025-05-26 12:23:58,869 - epoch:14, training loss:1608.1216 validation loss:26.0285, moco loss:32.0855
2025-05-26 12:24:02,153 - [*]Test--basic_loss:1555.8986, event_loss:22.5312, test_loss:1555.9366
2025-05-26 12:24:02,622 - [*] Evaluating all samples:
2025-05-26 12:24:02,622 - [*] year 2017, testing
2025-05-26 12:24:04,471 - epoch:2, training loss:1949.3745 validation loss:28.1387, moco loss:86404.2266
2025-05-26 12:24:04,881 - T:3	MAE	20.0343	RMSE	29.7526	MAPE	13.6002
2025-05-26 12:24:08,448 - T:6	MAE	21.9762	RMSE	32.9856	MAPE	14.4861
2025-05-26 12:24:13,873 - T:12	MAE	25.6377	RMSE	38.9270	MAPE	16.6215
2025-05-26 12:24:14,490 - [*] Evaluating basic traffic samples (prediction=0):
2025-05-26 12:24:14,490 - [*] year 2017, testing
2025-05-26 12:24:16,347 - T:3	MAE	20.0331	RMSE	29.7507	MAPE	13.6003
2025-05-26 12:24:19,082 - T:6	MAE	21.9751	RMSE	32.9839	MAPE	14.4863
2025-05-26 12:24:23,753 - T:12	MAE	25.6367	RMSE	38.9256	MAPE	16.6217
2025-05-26 12:24:23,753 - [*] Evaluating event traffic samples (prediction=1):
2025-05-26 12:24:23,753 - [*] year 2017, testing
2025-05-26 12:24:23,754 - T:3	MAE	45.2699	RMSE	56.5161	MAPE	11.8273
2025-05-26 12:24:23,754 - T:6	MAE	47.0863	RMSE	58.3797	MAPE	12.3679
2025-05-26 12:24:23,754 - T:12	MAE	49.0425	RMSE	61.0579	MAPE	13.1670
2025-05-26 12:24:23,760 - Finished optimization, total time:139.87 s, best model:res/SD/all-com2025-05-26-12:20:16.113789/2017/25.9924.pkl
2025-05-26 12:24:23,830 - [*] Year 2018 load from data/SD/FastData/2018_30day.npz
2025-05-26 12:24:23,856 - Secure SignIn[*] load from res/SD/all-com2025-05-26-12:20:16.113789/2017/25.9924.pkl
2025-05-26 12:24:23,888 - [*] replay node number 63
2025-05-26 12:24:26,955 - epoch:3, training loss:1917.9583 validation loss:27.9723, moco loss:77423.3125
2025-05-26 12:24:29,354 - number of increase nodes:63, nodes after 2 hop:torch.Size([524]), total nodes this year 708
2025-05-26 12:24:49,075 - epoch:4, training loss:1905.6017 validation loss:28.5429, moco loss:103532.1953
2025-05-26 12:24:52,904 - [*] Year 2018 Dataset load!
2025-05-26 12:24:52,905 - Secure SignIn[*] load from res/SD/all-com2025-05-26-12:20:16.113789/2017/25.9924.pkl
2025-05-26 12:24:52,930 - [*] EWC! lambda 0.000100
Traceback (most recent call last):
  File "/home/bd2/ANATS/TrafficStream/main_moco.py", line 560, in <module>
    main(args)
  File "/home/bd2/ANATS/TrafficStream/main_moco.py", line 522, in main
    train(inputs, args)
  File "/home/bd2/ANATS/TrafficStream/main_moco.py", line 146, in train
    model.register_ewc_params(ewc_loader, lossfunc, device)
  File "/home/bd2/ANATS/TrafficStream/src/model/ewc.py", line 70, in register_ewc_params
    self._update_fisher_params(loader, lossfunc, device)
  File "/home/bd2/ANATS/TrafficStream/src/model/ewc.py", line 51, in _update_fisher_params
    basic_features = self.model.basic_model.feature(basic_data, self.adj)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/ANATS/TrafficStream/src/model/model.py", line 79, in feature
    x = F.relu(self.gcn1(x, adj))                              # [bs, N, feature]
               ^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/ANATS/TrafficStream/src/model/gcn_conv.py", line 32, in forward
    output = self.weight_neigh(input_x)             # [bs, N, in_features] * [in_features, out_features] = [bs, N, out_features]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (90624x12 and 24x64)
2025-05-26 12:25:11,512 - epoch:5, training loss:1898.1401 validation loss:28.7234, moco loss:92683.7578
2025-05-26 12:25:33,361 - epoch:6, training loss:1888.1293 validation loss:27.8606, moco loss:108200.5391
2025-05-26 12:25:55,501 - epoch:7, training loss:1886.0382 validation loss:28.0082, moco loss:103354.8203
2025-05-26 12:26:17,536 - epoch:8, training loss:1883.3051 validation loss:28.2039, moco loss:90571.7656
2025-05-26 12:26:40,268 - epoch:9, training loss:1828.9807 validation loss:27.4923, moco loss:105822.7500
2025-05-26 12:27:02,405 - epoch:10, training loss:1785.2486 validation loss:28.3799, moco loss:92704.5234
2025-05-26 12:27:25,037 - epoch:11, training loss:1767.3534 validation loss:27.1851, moco loss:103208.1484
2025-05-26 12:27:47,401 - epoch:12, training loss:1744.7833 validation loss:28.2031, moco loss:98748.1328
2025-05-26 12:28:09,872 - epoch:13, training loss:1749.9707 validation loss:28.7718, moco loss:94267.2422
2025-05-26 12:28:32,569 - epoch:14, training loss:1731.6444 validation loss:27.2640, moco loss:102843.4375
2025-05-26 12:28:54,918 - epoch:15, training loss:1721.4686 validation loss:27.4559, moco loss:86421.3750
2025-05-26 12:29:17,611 - epoch:16, training loss:1716.8737 validation loss:27.1988, moco loss:97377.0078
2025-05-26 12:29:40,070 - epoch:17, training loss:1718.1371 validation loss:27.3065, moco loss:99532.7969
2025-05-26 12:29:47,173 - [*]Test--basic_loss:739.5838, event_loss:2417.0923, test_loss:1668.9101
2025-05-26 12:29:47,777 - [*] Evaluating all samples:
2025-05-26 12:29:47,777 - [*] year 2017, testing
2025-05-26 12:29:50,110 - T:3	MAE	20.4684	RMSE	30.4556	MAPE	13.2837
2025-05-26 12:29:53,786 - T:6	MAE	22.5825	RMSE	33.8807	MAPE	15.3666
2025-05-26 12:29:59,496 - T:12	MAE	26.6864	RMSE	40.3364	MAPE	19.9482
2025-05-26 12:29:59,767 - [*] Evaluating basic traffic samples (prediction=0):
2025-05-26 12:29:59,768 - [*] year 2017, testing
2025-05-26 12:30:00,786 - T:3	MAE	13.6192	RMSE	20.4019	MAPE	16.6919
2025-05-26 12:30:02,462 - T:6	MAE	14.7769	RMSE	22.1817	MAPE	19.8271
2025-05-26 12:30:05,063 - T:12	MAE	17.4242	RMSE	25.9345	MAPE	27.6354
2025-05-26 12:30:05,407 - [*] Evaluating event traffic samples (prediction=1):
2025-05-26 12:30:05,407 - [*] year 2017, testing
2025-05-26 12:30:06,426 - T:3	MAE	26.2124	RMSE	36.8286	MAPE	10.4255
2025-05-26 12:30:07,973 - T:6	MAE	29.1301	RMSE	41.2067	MAPE	11.6270
2025-05-26 12:30:10,367 - T:12	MAE	34.4545	RMSE	49.2689	MAPE	13.5036
2025-05-26 12:30:10,372 - Finished optimization, total time:308.33 s, best model:res/SD/wo_moco2025-05-26-12:22:42.735211/2017/27.1851.pkl
2025-05-26 12:30:10,440 - [*] Year 2018 load from data/SD/FastData/2018_30day.npz
2025-05-26 12:30:10,449 - Secure SignIn[*] load from res/SD/wo_moco2025-05-26-12:22:42.735211/2017/27.1851.pkl
2025-05-26 12:30:10,581 - [*] replay node number 63
2025-05-26 12:30:16,016 - number of increase nodes:63, nodes after 2 hop:torch.Size([524]), total nodes this year 708
2025-05-26 12:30:39,619 - [*] Year 2018 Dataset load!
2025-05-26 12:30:39,619 - Secure SignIn[*] load from res/SD/wo_moco2025-05-26-12:22:42.735211/2017/27.1851.pkl
2025-05-26 12:30:39,639 - [*] EWC! lambda 0.000100
2025-05-26 12:30:58,214 - [*] Model parameter count: 7306
2025-05-26 12:30:58,215 - [*] Year 2018 Training start
2025-05-26 12:30:59,088 - node number torch.Size([67072, 24])
2025-05-26 12:31:23,890 - epoch:0, training loss:1855.4693 validation loss:27.2395, moco loss:84106.8125
2025-05-26 12:31:49,763 - epoch:1, training loss:1835.6344 validation loss:26.7263, moco loss:103026.7734
2025-05-26 12:32:16,518 - epoch:2, training loss:1840.4445 validation loss:27.1736, moco loss:112258.1016
2025-05-26 12:32:43,109 - epoch:3, training loss:1838.0541 validation loss:27.0236, moco loss:86865.9844
2025-05-26 12:33:09,843 - epoch:4, training loss:1838.5150 validation loss:26.6513, moco loss:89992.1406
2025-05-26 12:33:36,635 - epoch:5, training loss:1838.0868 validation loss:26.6114, moco loss:88919.1562
2025-05-26 12:34:03,847 - epoch:6, training loss:1840.9981 validation loss:26.8710, moco loss:86438.4062
2025-05-26 12:34:30,769 - epoch:7, training loss:1839.1793 validation loss:26.7830, moco loss:87616.9219
2025-05-26 12:34:57,723 - epoch:8, training loss:1839.6933 validation loss:27.0731, moco loss:96111.0469
2025-05-26 12:35:24,538 - epoch:9, training loss:1837.8004 validation loss:26.6237, moco loss:98020.2500
2025-05-26 12:35:51,256 - epoch:10, training loss:1833.8675 validation loss:26.7924, moco loss:94945.3516
2025-05-26 12:36:17,704 - epoch:11, training loss:1840.2094 validation loss:26.6046, moco loss:95430.1016
2025-05-26 12:36:44,495 - epoch:12, training loss:1840.8149 validation loss:26.9937, moco loss:102414.0156
2025-05-26 12:37:11,459 - epoch:13, training loss:1836.2794 validation loss:27.2585, moco loss:83643.8672
2025-05-26 12:37:38,537 - epoch:14, training loss:1836.7317 validation loss:26.5531, moco loss:91415.1562
2025-05-26 12:38:05,445 - epoch:15, training loss:1837.3940 validation loss:27.0594, moco loss:101429.0312
2025-05-26 12:38:32,132 - epoch:16, training loss:1833.8430 validation loss:26.4804, moco loss:80045.2266
2025-05-26 12:38:58,759 - epoch:17, training loss:1838.4448 validation loss:26.5949, moco loss:93059.0703
2025-05-26 12:39:25,589 - epoch:18, training loss:1839.3939 validation loss:26.9877, moco loss:79458.4062
2025-05-26 12:39:52,577 - epoch:19, training loss:1834.4536 validation loss:27.9504, moco loss:95131.9219
2025-05-26 12:40:19,738 - epoch:20, training loss:1841.7113 validation loss:27.3598, moco loss:97488.5703
2025-05-26 12:40:46,476 - epoch:21, training loss:1839.6780 validation loss:27.2914, moco loss:90527.8672
2025-05-26 12:41:13,270 - epoch:22, training loss:1835.2248 validation loss:26.8730, moco loss:85269.0234
2025-05-26 12:41:20,520 - [*]Test--basic_loss:904.7964, event_loss:2845.5369, test_loss:1876.1386
2025-05-26 12:41:20,606 - [*] Evaluating all samples:
2025-05-26 12:41:20,606 - [*] year 2018, testing
2025-05-26 12:41:20,662 - T:3	MAE	25.7733	RMSE	37.6080	MAPE	25.5323
2025-05-26 12:41:20,732 - T:6	MAE	26.9132	RMSE	39.6258	MAPE	27.0800
2025-05-26 12:41:20,832 - T:12	MAE	27.3393	RMSE	40.8376	MAPE	30.7243
2025-05-26 12:41:20,862 - [*] Evaluating basic traffic samples (prediction=0):
2025-05-26 12:41:20,863 - [*] year 2018, testing
2025-05-26 12:41:20,865 - T:3	MAE	14.6277	RMSE	19.0988	MAPE	16.6980
2025-05-26 12:41:20,867 - T:6	MAE	15.8441	RMSE	20.8125	MAPE	18.3544
2025-05-26 12:41:20,870 - T:12	MAE	18.7307	RMSE	24.9975	MAPE	22.4447
2025-05-26 12:41:20,912 - [*] Evaluating event traffic samples (prediction=1):
2025-05-26 12:41:20,912 - [*] year 2018, testing
2025-05-26 12:41:20,914 - T:3	MAE	18.5938	RMSE	23.7611	MAPE	12.6265
2025-05-26 12:41:20,916 - T:6	MAE	20.1667	RMSE	25.9419	MAPE	13.5658
2025-05-26 12:41:20,919 - T:12	MAE	24.4627	RMSE	32.3150	MAPE	16.2715
2025-05-26 12:41:20,919 - Finished optimization, total time:512.87 s, best model:res/SD/wo_moco2025-05-26-12:22:42.735211/2018/26.4804.pkl
2025-05-26 12:41:20,997 - [*] Year 2019 load from data/SD/FastData/2019_30day.npz
2025-05-26 12:41:21,004 - Secure SignIn[*] load from res/SD/wo_moco2025-05-26-12:22:42.735211/2018/26.4804.pkl
2025-05-26 12:41:21,021 - [*] replay node number 64
2025-05-26 12:41:26,475 - number of increase nodes:67, nodes after 2 hop:torch.Size([533]), total nodes this year 716
2025-05-26 12:41:50,238 - [*] Year 2019 Dataset load!
2025-05-26 12:41:50,238 - Secure SignIn[*] load from res/SD/wo_moco2025-05-26-12:22:42.735211/2018/26.4804.pkl
2025-05-26 12:41:50,365 - [*] EWC! lambda 0.000100
2025-05-26 12:42:08,500 - [*] Model parameter count: 7306
2025-05-26 12:42:08,501 - [*] Year 2019 Training start
2025-05-26 12:42:09,354 - node number torch.Size([68224, 24])
2025-05-26 12:42:34,868 - epoch:0, training loss:1532.9864 validation loss:26.0119, moco loss:96610.2969
2025-05-26 12:43:01,809 - epoch:1, training loss:1504.9172 validation loss:26.4060, moco loss:72615.1562
2025-05-26 12:43:28,539 - epoch:2, training loss:1508.6552 validation loss:25.7466, moco loss:90386.8203
2025-05-26 12:43:55,334 - epoch:3, training loss:1512.7849 validation loss:26.2770, moco loss:82492.0703
2025-05-26 12:44:22,150 - epoch:4, training loss:1508.8257 validation loss:25.6930, moco loss:78578.3594
2025-05-26 12:44:48,760 - epoch:5, training loss:1504.5439 validation loss:25.7850, moco loss:88448.6797
2025-05-26 12:45:15,236 - epoch:6, training loss:1505.0285 validation loss:25.6837, moco loss:75148.3438
2025-05-26 12:45:41,442 - epoch:7, training loss:1515.5084 validation loss:26.1825, moco loss:84357.6172
2025-05-26 12:46:08,239 - epoch:8, training loss:1507.2813 validation loss:25.6251, moco loss:86397.4766
2025-05-26 12:46:34,896 - epoch:9, training loss:1508.7882 validation loss:25.6765, moco loss:68151.1641
2025-05-26 12:47:01,713 - epoch:10, training loss:1510.3520 validation loss:25.7361, moco loss:82179.9453
2025-05-26 12:47:28,524 - epoch:11, training loss:1510.2810 validation loss:25.8660, moco loss:80641.9844
2025-05-26 12:47:55,367 - epoch:12, training loss:1505.4246 validation loss:25.7428, moco loss:89442.1953
2025-05-26 12:48:22,065 - epoch:13, training loss:1511.1340 validation loss:26.0378, moco loss:76439.0312
2025-05-26 12:48:48,740 - epoch:14, training loss:1507.1127 validation loss:26.3593, moco loss:65476.4922
2025-05-26 12:48:56,082 - [*]Test--basic_loss:881.3432, event_loss:2463.4199, test_loss:1695.8289
2025-05-26 12:48:56,170 - [*] Evaluating all samples:
2025-05-26 12:48:56,170 - [*] year 2019, testing
2025-05-26 12:48:56,227 - T:3	MAE	29.4969	RMSE	41.3289	MAPE	18.9083
2025-05-26 12:48:56,298 - T:6	MAE	28.9781	RMSE	41.1100	MAPE	19.6192
2025-05-26 12:48:56,398 - T:12	MAE	28.0084	RMSE	40.0757	MAPE	21.3840
2025-05-26 12:48:56,422 - [*] Evaluating basic traffic samples (prediction=0):
2025-05-26 12:48:56,422 - [*] year 2019, testing
2025-05-26 12:48:56,424 - T:3	MAE	17.7671	RMSE	23.7703	MAPE	14.8697
2025-05-26 12:48:56,426 - T:6	MAE	18.7533	RMSE	25.4265	MAPE	15.4400
2025-05-26 12:48:56,429 - T:12	MAE	21.9729	RMSE	31.3726	MAPE	17.4852
2025-05-26 12:48:56,474 - [*] Evaluating event traffic samples (prediction=1):
2025-05-26 12:48:56,475 - [*] year 2019, testing
2025-05-26 12:48:56,477 - T:3	MAE	31.5701	RMSE	40.9194	MAPE	8.0445
2025-05-26 12:48:56,479 - T:6	MAE	32.8036	RMSE	43.1985	MAPE	8.3295
2025-05-26 12:48:56,482 - T:12	MAE	35.8789	RMSE	48.1540	MAPE	9.0798
2025-05-26 12:48:56,482 - Finished optimization, total time:335.22 s, best model:res/SD/wo_moco2025-05-26-12:22:42.735211/2019/25.6251.pkl
2025-05-26 12:48:56,561 - [*] Year 2020 load from data/SD/FastData/2020_30day.npz
2025-05-26 12:48:56,564 - Secure SignIn[*] load from res/SD/wo_moco2025-05-26-12:22:42.735211/2019/25.6251.pkl
2025-05-26 12:48:56,582 - [*] replay node number 62
2025-05-26 12:49:02,108 - number of increase nodes:59, nodes after 2 hop:torch.Size([567]), total nodes this year 697
2025-05-26 12:49:27,344 - [*] Year 2020 Dataset load!
2025-05-26 12:49:27,344 - Secure SignIn[*] load from res/SD/wo_moco2025-05-26-12:22:42.735211/2019/25.6251.pkl
2025-05-26 12:49:27,358 - [*] EWC! lambda 0.000100
2025-05-26 12:49:46,331 - [*] Model parameter count: 7306
2025-05-26 12:49:46,332 - [*] Year 2020 Training start
2025-05-26 12:49:47,249 - node number torch.Size([72576, 24])
2025-05-26 12:50:13,348 - epoch:0, training loss:1306.0352 validation loss:29.8509, moco loss:76800.6484
2025-05-26 12:50:38,539 - epoch:1, training loss:1271.0473 validation loss:27.6921, moco loss:88812.4688
2025-05-26 12:51:05,235 - epoch:2, training loss:1264.2766 validation loss:27.5266, moco loss:64822.5391
2025-05-26 12:51:32,725 - epoch:3, training loss:1261.5258 validation loss:28.7700, moco loss:71684.8828
2025-05-26 12:52:01,218 - epoch:4, training loss:1261.3707 validation loss:27.9621, moco loss:67587.6328
2025-05-26 12:52:30,199 - epoch:5, training loss:1267.6675 validation loss:30.2990, moco loss:59807.9375
2025-05-26 12:52:57,591 - epoch:6, training loss:1271.3595 validation loss:26.6002, moco loss:76071.9844
2025-05-26 12:53:24,547 - epoch:7, training loss:1261.7802 validation loss:28.5594, moco loss:68502.7031
2025-05-26 12:53:52,566 - epoch:8, training loss:1260.4134 validation loss:26.9587, moco loss:73250.6094
2025-05-26 12:54:19,477 - epoch:9, training loss:1274.3683 validation loss:28.4313, moco loss:73539.5391
2025-05-26 12:54:46,971 - epoch:10, training loss:1263.4127 validation loss:28.1877, moco loss:79367.0547
2025-05-26 12:55:16,185 - epoch:11, training loss:1261.0367 validation loss:29.0718, moco loss:75765.0000
Traceback (most recent call last):
  File "/home/bd2/ANATS/TrafficStream/main_moco.py", line 13, in <module>
    from torch.optim.lr_scheduler import ReduceLROnPlateau, OneCycleLR
ModuleNotFoundError: No module named 'torch.optim.lr_scheduler'
2025-05-26 12:55:43,635 - epoch:12, training loss:1267.1657 validation loss:28.1670, moco loss:68640.8438
2025-05-26 12:55:50,944 - [*]Test--basic_loss:383.2265, event_loss:1744.4043, test_loss:1123.6507
2025-05-26 12:55:51,000 - [*] Evaluating all samples:
2025-05-26 12:55:51,001 - [*] year 2020, testing
2025-05-26 12:55:51,057 - T:3	MAE	23.6866	RMSE	35.0048	MAPE	35.3139
2025-05-26 12:55:51,126 - T:6	MAE	24.0230	RMSE	35.8723	MAPE	30.7654
2025-05-26 12:55:51,226 - T:12	MAE	23.2358	RMSE	35.3216	MAPE	33.6882
2025-05-26 12:55:51,234 - [*] Evaluating basic traffic samples (prediction=0):
2025-05-26 12:55:51,234 - [*] year 2020, testing
2025-05-26 12:55:51,236 - T:3	MAE	6.9939	RMSE	9.2498	MAPE	95.3113
2025-05-26 12:55:51,238 - T:6	MAE	7.6689	RMSE	9.9376	MAPE	116.5085
2025-05-26 12:55:51,241 - T:12	MAE	9.2497	RMSE	11.8981	MAPE	165.3404
2025-05-26 12:55:51,271 - [*] Evaluating event traffic samples (prediction=1):
2025-05-26 12:55:51,271 - [*] year 2020, testing
2025-05-26 12:55:51,273 - T:3	MAE	13.8205	RMSE	17.7275	MAPE	28.0704
2025-05-26 12:55:51,276 - T:6	MAE	15.1766	RMSE	19.5455	MAPE	30.9310
2025-05-26 12:55:51,278 - T:12	MAE	18.6295	RMSE	24.4586	MAPE	34.8650
2025-05-26 12:55:51,279 - Finished optimization, total time:299.35 s, best model:res/SD/wo_moco2025-05-26-12:22:42.735211/2020/26.6002.pkl
2025-05-26 12:55:51,330 - 3	mae	20.47	25.77	29.50	23.69	
2025-05-26 12:55:51,330 - 3	rmse	30.46	37.61	41.33	35.00	
2025-05-26 12:55:51,330 - 3	mape	13.28	25.53	18.91	35.31	
2025-05-26 12:55:51,330 - 6	mae	22.58	26.91	28.98	24.02	
2025-05-26 12:55:51,330 - 6	rmse	33.88	39.63	41.11	35.87	
2025-05-26 12:55:51,330 - 6	mape	15.37	27.08	19.62	30.77	
2025-05-26 12:55:51,330 - 12	mae	26.69	27.34	28.01	23.24	
2025-05-26 12:55:51,330 - 12	rmse	40.34	40.84	40.08	35.32	
2025-05-26 12:55:51,330 - 12	mape	19.95	30.72	21.38	33.69	
2025-05-26 12:55:51,330 - year	2017	total_time	308.331793	average_time	17.1295535	epoch	18
2025-05-26 12:55:51,330 - year	2018	total_time	512.870024	average_time	22.29870904347826	epoch	23
2025-05-26 12:55:51,330 - year	2019	total_time	335.21681299999995	average_time	22.347799133333336	epoch	15
2025-05-26 12:55:51,330 - year	2020	total_time	299.346074	average_time	23.02663384615385	epoch	13
2025-05-26 12:56:32,226 - logger name:res/SD/all-com2025-05-26-12:56:32.225541/all-com.log
2025-05-26 12:56:32,226 - params : {'conf': 'conf/all-com.json', 'paral': 0, 'gpuid': 3, 'logname': 'all-com', 'load_first_year': 1, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/SD/all-com2025-05-26-12:20:16.113789/2017/25.9924.pkl', 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/SD/finaldata/', 'save_data_path': 'data/SD/FastData/', 'graph_path': 'data/SD/graph/', 'model_path': 'res/SD/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'classifier': {'hidden_dim': 128}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': False, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 300, 'extra_feature': True, 'moco': True, 'momentum_type': 'linear', 'memory_size': 32, 'expand': True, 'time': '2025-05-26-12:56:32.225541', 'path': 'res/SD/all-com2025-05-26-12:56:32.225541', 'device': device(type='cuda', index=3), 'logger': <Logger __main__ (INFO)>}
2025-05-26 12:56:32,254 - [*] Year 2017 load from data/SD/FastData/2017_30day.npz
2025-05-26 12:56:32,515 - Secure SignIn[*] load from /home/bd2/ANATS/TrafficStream/res/SD/all-com2025-05-26-12:20:16.113789/2017/25.9924.pkl
/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-05-26 12:56:39,114 - [*]Test--basic_loss:1555.8986, event_loss:22.5312, test_loss:1555.9366
2025-05-26 12:56:39,489 - [*] Evaluating all samples:
2025-05-26 12:56:39,489 - [*] year 2017, testing
2025-05-26 12:56:41,741 - T:3	MAE	20.0343	RMSE	29.7526	MAPE	13.6002
2025-05-26 12:56:45,339 - T:6	MAE	21.9762	RMSE	32.9856	MAPE	14.4861
2025-05-26 12:56:50,787 - T:12	MAE	25.6377	RMSE	38.9270	MAPE	16.6215
2025-05-26 12:56:51,300 - [*] Evaluating basic traffic samples (prediction=0):
2025-05-26 12:56:51,300 - [*] year 2017, testing
2025-05-26 12:56:53,452 - T:3	MAE	20.0331	RMSE	29.7507	MAPE	13.6003
2025-05-26 12:56:57,032 - T:6	MAE	21.9751	RMSE	32.9839	MAPE	14.4863
2025-05-26 12:57:02,488 - T:12	MAE	25.6367	RMSE	38.9256	MAPE	16.6217
2025-05-26 12:57:02,489 - [*] Evaluating event traffic samples (prediction=1):
2025-05-26 12:57:02,489 - [*] year 2017, testing
2025-05-26 12:57:02,489 - T:3	MAE	45.2699	RMSE	56.5161	MAPE	11.8273
2025-05-26 12:57:02,489 - T:6	MAE	47.0863	RMSE	58.3797	MAPE	12.3679
2025-05-26 12:57:02,490 - T:12	MAE	49.0425	RMSE	61.0579	MAPE	13.1670
2025-05-26 12:57:02,523 - [*] Year 2018 load from data/SD/FastData/2018_30day.npz
2025-05-26 12:57:02,542 - Secure SignIn[*] load from /home/bd2/ANATS/TrafficStream/res/SD/all-com2025-05-26-12:20:16.113789/2017/25.9924.pkl
2025-05-26 12:57:02,574 - [*] replay node number 63
2025-05-26 12:57:07,935 - number of increase nodes:63, nodes after 2 hop:torch.Size([524]), total nodes this year 708
2025-05-26 12:57:30,668 - [*] Year 2018 Dataset load!
2025-05-26 12:57:30,668 - Secure SignIn[*] load from /home/bd2/ANATS/TrafficStream/res/SD/all-com2025-05-26-12:20:16.113789/2017/25.9924.pkl
2025-05-26 12:57:30,694 - [*] EWC! lambda 0.000100
2025-05-26 12:57:47,916 - [*] Model parameter count: 10534
2025-05-26 12:57:47,917 - [*] Year 2018 Training start
2025-05-26 12:57:48,854 - node number torch.Size([67072, 24])
2025-05-26 12:58:01,470 - epoch:0, training loss:1755.0019 validation loss:25.9260, moco loss:29.4027
2025-05-26 12:58:15,912 - epoch:1, training loss:1724.4908 validation loss:26.2868, moco loss:5.7619
2025-05-26 12:58:30,276 - epoch:2, training loss:1716.8676 validation loss:25.7927, moco loss:5.1723
2025-05-26 12:58:45,952 - epoch:3, training loss:1711.1831 validation loss:25.6388, moco loss:9.8945
2025-05-26 12:59:00,907 - epoch:4, training loss:1702.0539 validation loss:25.6010, moco loss:19.9837
2025-05-26 12:59:15,567 - epoch:5, training loss:1698.9741 validation loss:25.6779, moco loss:8.7648
2025-05-26 12:59:29,304 - epoch:6, training loss:1689.9281 validation loss:25.7812, moco loss:7.1266
2025-05-26 12:59:43,342 - epoch:7, training loss:1680.8500 validation loss:25.4217, moco loss:3.7001
2025-05-26 12:59:57,244 - epoch:8, training loss:1680.4683 validation loss:25.4355, moco loss:9.6200
2025-05-26 13:00:10,884 - epoch:9, training loss:1661.4902 validation loss:25.5969, moco loss:6.2656
2025-05-26 13:00:24,377 - epoch:10, training loss:1657.3531 validation loss:25.4119, moco loss:5.1320
2025-05-26 13:00:38,359 - epoch:11, training loss:1654.7380 validation loss:25.4564, moco loss:2.9173
2025-05-26 13:00:51,526 - epoch:12, training loss:1651.2747 validation loss:25.3388, moco loss:3.2183
2025-05-26 13:01:05,142 - epoch:13, training loss:1648.0040 validation loss:25.2735, moco loss:11.7478
2025-05-26 13:01:19,720 - epoch:14, training loss:1645.3491 validation loss:25.3724, moco loss:2.7939
2025-05-26 13:01:34,122 - epoch:15, training loss:1644.5749 validation loss:25.2637, moco loss:4.2871
2025-05-26 13:01:47,934 - epoch:16, training loss:1645.1894 validation loss:25.6610, moco loss:6.0109
2025-05-26 13:02:02,455 - epoch:17, training loss:1638.8657 validation loss:25.2324, moco loss:3.5097
2025-05-26 13:02:18,197 - epoch:18, training loss:1641.8230 validation loss:25.6359, moco loss:9.9309
2025-05-26 13:02:31,842 - epoch:19, training loss:1637.8971 validation loss:25.0720, moco loss:7.9440
2025-05-26 13:02:45,469 - epoch:20, training loss:1635.0625 validation loss:25.1570, moco loss:4.7681
2025-05-26 13:03:01,149 - epoch:21, training loss:1633.5586 validation loss:25.5515, moco loss:2.6256
2025-05-26 13:03:15,117 - epoch:22, training loss:1633.9885 validation loss:25.0137, moco loss:3.1244
2025-05-26 13:03:29,489 - epoch:23, training loss:1626.2761 validation loss:26.0430, moco loss:5.1782
2025-05-26 13:03:43,101 - epoch:24, training loss:1631.2802 validation loss:25.0710, moco loss:4.4977
2025-05-26 13:03:57,597 - epoch:25, training loss:1628.5151 validation loss:25.5020, moco loss:3.0615
2025-05-26 13:04:11,663 - epoch:26, training loss:1626.7576 validation loss:25.0183, moco loss:6.1074
2025-05-26 13:04:28,016 - epoch:27, training loss:1630.1993 validation loss:26.3738, moco loss:2.5108
2025-05-26 13:04:44,177 - epoch:28, training loss:1626.2652 validation loss:25.2192, moco loss:4.3005
2025-05-26 13:04:47,063 - [*]Test--basic_loss:1647.1692, event_loss:0.0000, test_loss:1647.1692
2025-05-26 13:04:47,122 - [*] Evaluating all samples:
2025-05-26 13:04:47,123 - [*] year 2018, testing
2025-05-26 13:04:47,180 - T:3	MAE	23.7982	RMSE	34.7135	MAPE	23.2775
2025-05-26 13:04:47,252 - T:6	MAE	24.8799	RMSE	36.7601	MAPE	23.2860
2025-05-26 13:04:47,359 - T:12	MAE	25.4311	RMSE	38.0194	MAPE	24.3476
2025-05-26 13:04:47,407 - [*] Evaluating basic traffic samples (prediction=0):
2025-05-26 13:04:47,408 - [*] year 2018, testing
2025-05-26 13:04:47,411 - T:3	MAE	16.2629	RMSE	21.2242	MAPE	13.9722
2025-05-26 13:04:47,415 - T:6	MAE	17.9845	RMSE	23.9596	MAPE	15.7040
2025-05-26 13:04:47,420 - T:12	MAE	21.8813	RMSE	31.1734	MAPE	19.6447
2025-05-26 13:04:47,421 - Finished optimization, total time:345.15 s, best model:res/SD/all-com2025-05-26-12:56:32.225541/2018/25.0137.pkl
2025-05-26 13:04:47,500 - [*] Year 2019 load from data/SD/FastData/2019_30day.npz
2025-05-26 13:04:47,505 - Secure SignIn[*] load from res/SD/all-com2025-05-26-12:56:32.225541/2018/25.0137.pkl
2025-05-26 13:04:47,534 - [*] replay node number 64
2025-05-26 13:04:52,996 - number of increase nodes:67, nodes after 2 hop:torch.Size([533]), total nodes this year 716
2025-05-26 13:05:15,675 - [*] Year 2019 Dataset load!
2025-05-26 13:05:15,675 - Secure SignIn[*] load from res/SD/all-com2025-05-26-12:56:32.225541/2018/25.0137.pkl
2025-05-26 13:05:15,702 - [*] EWC! lambda 0.000100
2025-05-26 13:05:32,620 - [*] Model parameter count: 10534
2025-05-26 13:05:32,622 - [*] Year 2019 Training start
2025-05-26 13:05:33,582 - node number torch.Size([68224, 24])
2025-05-26 13:05:48,047 - epoch:0, training loss:1365.4392 validation loss:24.1715, moco loss:4.7417
2025-05-26 13:06:05,341 - epoch:1, training loss:1338.0599 validation loss:24.2830, moco loss:1.8856
2025-05-26 13:06:19,427 - epoch:2, training loss:1336.5828 validation loss:24.9557, moco loss:7.5630
2025-05-26 13:06:37,383 - epoch:3, training loss:1351.3128 validation loss:24.6458, moco loss:1.6323
2025-05-26 13:06:51,903 - epoch:4, training loss:1342.6113 validation loss:24.2776, moco loss:2.0497
2025-05-26 13:07:07,628 - epoch:5, training loss:1331.0174 validation loss:24.0863, moco loss:6.4362
2025-05-26 13:07:22,241 - epoch:6, training loss:1327.1232 validation loss:24.4056, moco loss:1.5832
2025-05-26 13:07:36,013 - epoch:7, training loss:1326.9515 validation loss:24.5724, moco loss:1.6170
2025-05-26 13:07:53,022 - epoch:8, training loss:1322.6391 validation loss:24.5786, moco loss:4.8130
2025-05-26 13:08:06,641 - epoch:9, training loss:1326.9860 validation loss:24.5264, moco loss:3.5951
2025-05-26 13:08:22,613 - epoch:10, training loss:1325.0586 validation loss:24.1982, moco loss:5.9753
2025-05-26 13:08:37,564 - epoch:11, training loss:1322.8195 validation loss:24.0930, moco loss:1.3518
2025-05-26 13:08:40,547 - [*]Test--basic_loss:1531.9238, event_loss:0.0000, test_loss:1531.9238
2025-05-26 13:08:40,598 - [*] Evaluating all samples:
2025-05-26 13:08:40,598 - [*] year 2019, testing
2025-05-26 13:08:40,656 - T:3	MAE	28.2442	RMSE	39.3640	MAPE	18.4458
2025-05-26 13:08:40,733 - T:6	MAE	27.9515	RMSE	39.3412	MAPE	19.7158
2025-05-26 13:08:40,840 - T:12	MAE	27.1368	RMSE	38.7729	MAPE	20.7692
2025-05-26 13:08:40,966 - [*] Evaluating basic traffic samples (prediction=0):
2025-05-26 13:08:40,967 - [*] year 2019, testing
2025-05-26 13:08:40,971 - T:3	MAE	25.0504	RMSE	34.0840	MAPE	11.2028
2025-05-26 13:08:40,975 - T:6	MAE	26.8718	RMSE	36.8931	MAPE	11.7472
2025-05-26 13:08:40,980 - T:12	MAE	30.1000	RMSE	41.8929	MAPE	12.9728
2025-05-26 13:08:40,981 - Finished optimization, total time:155.30 s, best model:res/SD/all-com2025-05-26-12:56:32.225541/2019/24.0863.pkl
2025-05-26 13:08:41,059 - [*] Year 2020 load from data/SD/FastData/2020_30day.npz
2025-05-26 13:08:41,063 - Secure SignIn[*] load from res/SD/all-com2025-05-26-12:56:32.225541/2019/24.0863.pkl
2025-05-26 13:08:41,093 - [*] replay node number 62
2025-05-26 13:08:46,560 - number of increase nodes:59, nodes after 2 hop:torch.Size([567]), total nodes this year 697
2025-05-26 13:09:09,750 - [*] Year 2020 Dataset load!
2025-05-26 13:09:09,750 - Secure SignIn[*] load from res/SD/all-com2025-05-26-12:56:32.225541/2019/24.0863.pkl
2025-05-26 13:09:09,777 - [*] EWC! lambda 0.000100
2025-05-26 13:09:26,574 - [*] Model parameter count: 10534
2025-05-26 13:09:26,575 - [*] Year 2020 Training start
2025-05-26 13:09:27,561 - node number torch.Size([72576, 24])
2025-05-26 13:09:41,973 - epoch:0, training loss:1129.2633 validation loss:27.1263, moco loss:2.3073
2025-05-26 13:09:57,857 - epoch:1, training loss:1081.2470 validation loss:28.3473, moco loss:4.8160
2025-05-26 13:10:13,048 - epoch:2, training loss:1081.7527 validation loss:24.9559, moco loss:1.2236
2025-05-26 13:10:30,068 - epoch:3, training loss:1075.5610 validation loss:25.9451, moco loss:1.3507
2025-05-26 13:10:46,620 - epoch:4, training loss:1073.3760 validation loss:26.7341, moco loss:1.4742
2025-05-26 13:11:02,361 - epoch:5, training loss:1077.6436 validation loss:26.4249, moco loss:0.9938
2025-05-26 13:11:18,160 - epoch:6, training loss:1071.5823 validation loss:25.6808, moco loss:1.8727
2025-05-26 13:11:32,962 - epoch:7, training loss:1071.0369 validation loss:26.7963, moco loss:4.4479
2025-05-26 13:11:46,641 - epoch:8, training loss:1068.3752 validation loss:27.0971, moco loss:10.7716
2025-05-26 13:11:49,516 - [*]Test--basic_loss:931.8097, event_loss:0.0000, test_loss:931.8097
2025-05-26 13:11:49,568 - [*] Evaluating all samples:
2025-05-26 13:11:49,568 - [*] year 2020, testing
2025-05-26 13:11:49,624 - T:3	MAE	21.1806	RMSE	31.8934	MAPE	21.6773
2025-05-26 13:11:49,699 - T:6	MAE	21.6511	RMSE	32.7860	MAPE	21.5087
2025-05-26 13:11:49,806 - T:12	MAE	20.8859	RMSE	32.2579	MAPE	23.8337
2025-05-26 13:11:49,839 - [*] Evaluating basic traffic samples (prediction=0):
2025-05-26 13:11:49,839 - [*] year 2020, testing
2025-05-26 13:11:49,843 - T:3	MAE	10.1653	RMSE	13.9173	MAPE	53.0347
2025-05-26 13:11:49,847 - T:6	MAE	10.3980	RMSE	14.4780	MAPE	51.8544
2025-05-26 13:11:49,853 - T:12	MAE	11.8440	RMSE	16.9449	MAPE	57.7778
2025-05-26 13:11:49,854 - Finished optimization, total time:116.73 s, best model:res/SD/all-com2025-05-26-12:56:32.225541/2020/24.9559.pkl
2025-05-26 13:11:49,910 - 3	mae	20.03	23.80	28.24	21.18	
2025-05-26 13:11:49,910 - 3	rmse	29.75	34.71	39.36	31.89	
2025-05-26 13:11:49,910 - 3	mape	13.60	23.28	18.45	21.68	
2025-05-26 13:11:49,910 - 6	mae	21.98	24.88	27.95	21.65	
2025-05-26 13:11:49,910 - 6	rmse	32.99	36.76	39.34	32.79	
2025-05-26 13:11:49,910 - 6	mape	14.49	23.29	19.72	21.51	
2025-05-26 13:11:49,910 - 12	mae	25.64	25.43	27.14	20.89	
2025-05-26 13:11:49,910 - 12	rmse	38.93	38.02	38.77	32.26	
2025-05-26 13:11:49,910 - 12	mape	16.62	24.35	20.77	23.83	
2025-05-26 13:11:49,910 - year	2018	total_time	345.148546	average_time	11.901690620689655	epoch	29
2025-05-26 13:11:49,910 - year	2019	total_time	155.297322	average_time	12.941457666666667	epoch	12
2025-05-26 13:11:49,910 - year	2020	total_time	116.734108	average_time	12.970475555555556	epoch	9
2025-06-03 14:26:29,957 - logger name:res/GBA/gba-val2025-06-03-14:26:29.956215/gba-val.log
2025-06-03 14:26:29,957 - params : {'conf': 'conf/gba.json', 'paral': 0, 'gpuid': 4, 'logname': 'gba-val', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/SD/all-com2025-05-26-12:20:16.113789/2017/25.9924.pkl', 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/GBA/finaldata/', 'save_data_path': 'data/GBA/FastData/', 'graph_path': 'data/GBA/graph/', 'model_path': 'res/GBA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'classifier': {'hidden_dim': 128}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': False, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 300, 'extra_feature': True, 'moco': True, 'momentum_type': 'linear', 'memory_size': 32, 'expand': True, 'time': '2025-06-03-14:26:29.956215', 'path': 'res/GBA/gba-val2025-06-03-14:26:29.956215', 'device': device(type='cuda', index=4), 'logger': <Logger __main__ (INFO)>}

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 940435.80it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1039944.01it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1041135.08it/s]

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 890304.84it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1015359.36it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 979405.46it/s]
2025-06-03 14:33:01,063 - [*] Year 2017 load from data/GBA/FastData/2017_30day.npz
/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-06-03 14:33:01,356 - [*] Year 2017 Dataset load!
2025-06-03 14:33:01,362 - [*] Model parameter count: 10534
2025-06-03 14:33:01,363 - [*] Year 2017 Training start
2025-06-03 14:33:02,057 - node number torch.Size([293632, 24])
2025-06-03 14:34:01,623 - epoch:0, training loss:24435.9097 validation loss:53.1118, moco loss:33932.9531
2025-06-03 14:35:01,949 - epoch:1, training loss:5150.7697 validation loss:30.8217, moco loss:344.8961
2025-06-03 14:36:02,472 - epoch:2, training loss:2096.5062 validation loss:29.8275, moco loss:3.7259
2025-06-03 14:36:59,331 - epoch:3, training loss:2001.4702 validation loss:29.5669, moco loss:15.4030
2025-06-03 14:37:55,521 - epoch:4, training loss:1930.8977 validation loss:29.2391, moco loss:24.6193
2025-06-03 14:38:52,357 - epoch:5, training loss:1906.4698 validation loss:29.1574, moco loss:1.9039
2025-06-03 14:39:49,470 - epoch:6, training loss:1898.5861 validation loss:28.9517, moco loss:1.5033
2025-06-03 14:40:45,292 - epoch:7, training loss:1892.0755 validation loss:28.9436, moco loss:1.2611
2025-06-03 14:41:41,376 - epoch:8, training loss:1883.1633 validation loss:28.8663, moco loss:8.0958
2025-06-03 14:42:38,689 - epoch:9, training loss:1879.5317 validation loss:28.7495, moco loss:0.9362
2025-06-03 14:43:34,806 - epoch:10, training loss:1878.8380 validation loss:28.7751, moco loss:1.6322
2025-06-03 14:44:30,612 - epoch:11, training loss:1878.2276 validation loss:28.7687, moco loss:4.4120
2025-06-03 14:45:27,211 - epoch:12, training loss:1872.0579 validation loss:28.6804, moco loss:23.2318
2025-06-03 14:46:23,873 - epoch:13, training loss:1870.5872 validation loss:28.9383, moco loss:19.0160
2025-06-03 14:47:20,243 - epoch:14, training loss:1873.1799 validation loss:28.8379, moco loss:15.6089
2025-06-03 14:48:17,445 - epoch:15, training loss:1871.8973 validation loss:28.6735, moco loss:20.6737
2025-06-03 14:49:13,345 - epoch:16, training loss:1868.3206 validation loss:29.1493, moco loss:9.9567
2025-06-03 14:50:10,593 - epoch:17, training loss:1866.5827 validation loss:28.7132, moco loss:23.1943
2025-06-03 14:51:07,467 - epoch:18, training loss:1865.4142 validation loss:28.9098, moco loss:4.4434
2025-06-03 14:52:02,931 - epoch:19, training loss:1864.1907 validation loss:29.0029, moco loss:11.4603
2025-06-03 14:52:58,909 - epoch:20, training loss:1865.0740 validation loss:28.8544, moco loss:5.9113
2025-06-03 14:53:55,575 - epoch:21, training loss:1862.8769 validation loss:28.7449, moco loss:36.3009
2025-06-03 14:54:07,599 - [*]Test--basic_loss:1919.6938, event_loss:0.0000, test_loss:1919.6938
2025-06-03 14:54:09,374 - [*] Evaluating all samples:
2025-06-03 14:54:09,374 - [*] year 2017, testing
2025-06-03 14:54:16,610 - T:3	MAE	22.4696	RMSE	34.6224	MAPE	14.1938
2025-06-03 14:54:27,969 - T:6	MAE	24.5065	RMSE	37.6896	MAPE	15.5372
2025-06-03 14:54:45,175 - T:12	MAE	28.5160	RMSE	43.5914	MAPE	18.6181
2025-06-03 14:54:47,116 - [*] Evaluating basic traffic samples (prediction=0):
2025-06-03 14:54:47,116 - [*] year 2017, testing
2025-06-03 14:54:53,037 - T:3	MAE	22.4696	RMSE	34.6224	MAPE	14.1938
2025-06-03 14:55:02,976 - T:6	MAE	24.5065	RMSE	37.6896	MAPE	15.5372
2025-06-03 14:55:18,903 - T:12	MAE	28.5160	RMSE	43.5914	MAPE	18.6181
2025-06-03 14:55:18,918 - Finished optimization, total time:964.94 s, best model:res/GBA/gba-val2025-06-03-14:26:29.956215/2017/28.6735.pkl

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 935583.17it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 950376.19it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1011608.48it/s]

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 981081.99it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1000168.47it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 988075.58it/s]
2025-06-03 14:57:38,253 - [*] Year 2018 load from data/GBA/FastData/2018_30day.npz
2025-06-03 14:57:38,317 - Secure SignIn[*] load from res/GBA/gba-val2025-06-03-14:26:29.956215/2017/28.6735.pkl
2025-06-03 14:57:38,438 - [*] replay node number 208
2025-06-03 14:57:38,720 - number of increase nodes:226, nodes after 2 hop:torch.Size([1847]), total nodes this year 2321
2025-06-03 14:58:14,513 - [*] Year 2018 Dataset load!
2025-06-03 14:58:14,513 - Secure SignIn[*] load from res/GBA/gba-val2025-06-03-14:26:29.956215/2017/28.6735.pkl
2025-06-03 14:58:14,591 - [*] EWC! lambda 0.000100
2025-06-03 14:58:49,241 - [*] Model parameter count: 10534
2025-06-03 14:58:49,242 - [*] Year 2018 Training start
2025-06-03 14:58:51,300 - node number torch.Size([236416, 24])
2025-06-03 14:59:33,738 - epoch:0, training loss:2040.9458 validation loss:29.2027, moco loss:6.3167
2025-06-03 15:00:18,130 - epoch:1, training loss:2029.5456 validation loss:29.3349, moco loss:10.0964
2025-06-03 15:01:02,943 - epoch:2, training loss:2032.1626 validation loss:29.4580, moco loss:14.9995
2025-06-03 15:01:47,233 - epoch:3, training loss:2028.3881 validation loss:29.1828, moco loss:3.0506
2025-06-03 15:02:31,925 - epoch:4, training loss:2029.4903 validation loss:29.0771, moco loss:2.0996
2025-06-03 15:03:16,297 - epoch:5, training loss:2033.5295 validation loss:29.4952, moco loss:4.2398
2025-06-03 15:04:00,945 - epoch:6, training loss:2031.5851 validation loss:29.2107, moco loss:5.7496
2025-06-03 15:04:45,748 - epoch:7, training loss:2030.8995 validation loss:29.3047, moco loss:0.5444
2025-06-03 15:05:30,250 - epoch:8, training loss:2032.2412 validation loss:29.6017, moco loss:1.9106
2025-06-03 15:06:14,937 - epoch:9, training loss:2032.2150 validation loss:29.3562, moco loss:1.6680
2025-06-03 15:06:59,663 - epoch:10, training loss:2030.1626 validation loss:29.2026, moco loss:2.2875
2025-06-03 15:07:10,784 - [*]Test--basic_loss:2137.0367, event_loss:1087.6335, test_loss:2145.3301
2025-06-03 15:07:10,995 - [*] Evaluating all samples:
2025-06-03 15:07:10,995 - [*] year 2018, testing
2025-06-03 15:07:11,054 - T:3	MAE	37.5882	RMSE	56.3090	MAPE	16.5916
2025-06-03 15:07:11,126 - T:6	MAE	37.5461	RMSE	56.2608	MAPE	16.7389
2025-06-03 15:07:11,238 - T:12	MAE	34.9302	RMSE	53.4475	MAPE	17.4174
2025-06-03 15:07:11,432 - [*] Evaluating basic traffic samples (prediction=0):
2025-06-03 15:07:11,432 - [*] year 2018, testing
2025-06-03 15:07:11,437 - T:3	MAE	44.5527	RMSE	63.3179	MAPE	12.6939
2025-06-03 15:07:11,440 - T:6	MAE	48.9517	RMSE	69.5953	MAPE	14.1156
2025-06-03 15:07:11,446 - T:12	MAE	56.2219	RMSE	79.5063	MAPE	16.6666
2025-06-03 15:07:11,446 - [*] Evaluating event traffic samples (prediction=1):
2025-06-03 15:07:11,446 - [*] year 2018, testing
2025-06-03 15:07:11,446 - T:3	MAE	186.8581	RMSE	217.1943	MAPE	74.1794
2025-06-03 15:07:11,446 - T:6	MAE	229.1702	RMSE	247.5296	MAPE	76.7474
2025-06-03 15:07:11,446 - T:12	MAE	270.7498	RMSE	284.1760	MAPE	82.4129
2025-06-03 15:07:11,446 - Finished optimization, total time:400.51 s, best model:res/GBA/gba-val2025-06-03-14:26:29.956215/2018/29.0771.pkl

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 850227.54it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1033084.40it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1042082.50it/s]

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 1014632.13it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1062371.72it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1039331.13it/s]
2025-06-03 15:09:33,228 - [*] Year 2019 load from data/GBA/FastData/2019_30day.npz
2025-06-03 15:09:33,306 - Secure SignIn[*] load from res/GBA/gba-val2025-06-03-14:26:29.956215/2018/29.0771.pkl
2025-06-03 15:09:33,436 - [*] replay node number 211
2025-06-03 15:09:33,712 - number of increase nodes:226, nodes after 2 hop:torch.Size([1873]), total nodes this year 2352
2025-06-03 15:10:26,313 - [*] Year 2019 Dataset load!
2025-06-03 15:10:26,313 - Secure SignIn[*] load from res/GBA/gba-val2025-06-03-14:26:29.956215/2018/29.0771.pkl
2025-06-03 15:10:26,391 - [*] EWC! lambda 0.000100
2025-06-03 15:11:01,294 - [*] Model parameter count: 10534
2025-06-03 15:11:01,295 - [*] Year 2019 Training start
2025-06-03 15:11:03,262 - node number torch.Size([239744, 24])
2025-06-03 15:11:45,695 - epoch:0, training loss:1954.5333 validation loss:27.0740, moco loss:1.6790
2025-06-03 15:12:30,639 - epoch:1, training loss:1946.1260 validation loss:27.0516, moco loss:2.3146
2025-06-03 15:13:15,080 - epoch:2, training loss:1945.5832 validation loss:27.3064, moco loss:2.4178
2025-06-03 15:13:59,987 - epoch:3, training loss:1944.8436 validation loss:27.1451, moco loss:19.4510
2025-06-03 15:14:45,380 - epoch:4, training loss:1946.1939 validation loss:27.2966, moco loss:1.2179
2025-06-03 15:15:29,885 - epoch:5, training loss:1947.0937 validation loss:27.1680, moco loss:3.1556
2025-06-03 15:16:15,321 - epoch:6, training loss:1944.2107 validation loss:26.9654, moco loss:2.3673
2025-06-03 15:17:00,303 - epoch:7, training loss:1947.0231 validation loss:27.4346, moco loss:6.6571
2025-06-03 15:17:44,620 - epoch:8, training loss:1945.6925 validation loss:27.2705, moco loss:5.1320
2025-06-03 15:18:29,657 - epoch:9, training loss:1944.9851 validation loss:27.0158, moco loss:1.8236
2025-06-03 15:19:14,973 - epoch:10, training loss:1944.6019 validation loss:27.5411, moco loss:2.0505
2025-06-03 15:20:00,479 - epoch:11, training loss:1945.9611 validation loss:27.1087, moco loss:2.2875
2025-06-03 15:20:45,943 - epoch:12, training loss:1945.6868 validation loss:26.9057, moco loss:0.5175
2025-06-03 15:21:31,102 - epoch:13, training loss:1948.0722 validation loss:27.3373, moco loss:1.4154
2025-06-03 15:22:16,191 - epoch:14, training loss:1944.0376 validation loss:26.9109, moco loss:9.2727
2025-06-03 15:23:00,674 - epoch:15, training loss:1942.6911 validation loss:27.1143, moco loss:6.8798
2025-06-03 15:23:45,356 - epoch:16, training loss:1946.4316 validation loss:26.9998, moco loss:2.2557
2025-06-03 15:24:30,373 - epoch:17, training loss:1944.5790 validation loss:27.1065, moco loss:2.5765
2025-06-03 15:25:15,641 - epoch:18, training loss:1946.4173 validation loss:27.0519, moco loss:3.0033
2025-06-03 15:25:26,851 - [*]Test--basic_loss:1951.5389, event_loss:0.0000, test_loss:1951.5389
2025-06-03 15:25:27,159 - [*] Evaluating all samples:
2025-06-03 15:25:27,159 - [*] year 2019, testing
2025-06-03 15:25:27,219 - T:3	MAE	27.0036	RMSE	42.7899	MAPE	14.5227
2025-06-03 15:25:27,300 - T:6	MAE	28.4286	RMSE	44.0571	MAPE	15.2927
2025-06-03 15:25:27,413 - T:12	MAE	28.9149	RMSE	44.2405	MAPE	16.9140
2025-06-03 15:25:27,676 - [*] Evaluating basic traffic samples (prediction=0):
2025-06-03 15:25:27,677 - [*] year 2019, testing
2025-06-03 15:25:27,689 - T:3	MAE	18.7842	RMSE	26.7459	MAPE	7.7367
2025-06-03 15:25:27,695 - T:6	MAE	20.8712	RMSE	30.2440	MAPE	8.6091
2025-06-03 15:25:27,701 - T:12	MAE	24.5377	RMSE	36.0217	MAPE	10.0517
2025-06-03 15:25:27,701 - Finished optimization, total time:697.06 s, best model:res/GBA/gba-val2025-06-03-14:26:29.956215/2019/26.9057.pkl

  0%|          | 0/63243 [00:00<?, ?it/s]
100%|██████████| 63243/63243 [00:00<00:00, 834624.53it/s]

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 934397.03it/s]

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 1158241.06it/s]

  0%|          | 0/63243 [00:00<?, ?it/s]
100%|██████████| 63243/63243 [00:00<00:00, 915906.87it/s]

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 1100601.49it/s]

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 1068546.95it/s]
2025-06-03 15:28:01,300 - [*] Year 2020 load from data/GBA/FastData/2020_30day.npz
2025-06-03 15:28:01,380 - Secure SignIn[*] load from res/GBA/gba-val2025-06-03-14:26:29.956215/2019/26.9057.pkl
2025-06-03 15:28:01,507 - [*] replay node number 211
2025-06-03 15:28:01,784 - number of increase nodes:206, nodes after 2 hop:torch.Size([1914]), total nodes this year 2352
2025-06-03 15:28:55,990 - [*] Year 2020 Dataset load!
2025-06-03 15:28:55,991 - Secure SignIn[*] load from res/GBA/gba-val2025-06-03-14:26:29.956215/2019/26.9057.pkl
2025-06-03 15:28:56,068 - [*] EWC! lambda 0.000100
2025-06-03 15:29:31,108 - [*] Model parameter count: 10534
2025-06-03 15:29:31,109 - [*] Year 2020 Training start
2025-06-03 15:29:33,302 - node number torch.Size([244992, 24])
2025-06-03 15:30:17,106 - epoch:0, training loss:1181.4515 validation loss:22.7017, moco loss:9.8989
2025-06-03 15:31:03,382 - epoch:1, training loss:1164.0350 validation loss:22.3934, moco loss:3.8949
2025-06-03 15:31:49,431 - epoch:2, training loss:1163.1045 validation loss:22.2403, moco loss:8.4467
2025-06-03 15:32:35,715 - epoch:3, training loss:1164.2477 validation loss:22.0069, moco loss:0.3160
2025-06-03 15:33:21,610 - epoch:4, training loss:1162.9672 validation loss:23.2960, moco loss:0.6293
2025-06-03 15:34:07,743 - epoch:5, training loss:1163.1592 validation loss:22.1675, moco loss:6.3669
2025-06-03 15:34:53,920 - epoch:6, training loss:1162.4712 validation loss:23.3582, moco loss:3.2267
2025-06-03 15:35:40,095 - epoch:7, training loss:1162.2997 validation loss:21.4604, moco loss:5.7809
2025-06-03 15:36:26,588 - epoch:8, training loss:1161.7703 validation loss:22.3055, moco loss:39.1303
2025-06-03 15:37:12,112 - epoch:9, training loss:1164.7177 validation loss:23.2873, moco loss:6.4276
2025-06-03 15:37:57,792 - epoch:10, training loss:1164.7267 validation loss:23.1381, moco loss:15.5757
2025-06-03 15:38:43,909 - epoch:11, training loss:1163.7942 validation loss:21.6075, moco loss:3.1948
2025-06-03 15:39:30,308 - epoch:12, training loss:1162.2594 validation loss:22.9125, moco loss:1.1077
2025-06-03 15:40:16,747 - epoch:13, training loss:1163.0596 validation loss:22.4076, moco loss:6.3612
2025-06-03 15:40:28,051 - [*]Test--basic_loss:1142.3144, event_loss:0.0000, test_loss:1142.3144
2025-06-03 15:40:28,230 - [*] Evaluating all samples:
2025-06-03 15:40:28,230 - [*] year 2020, testing
2025-06-03 15:40:28,286 - T:3	MAE	20.2713	RMSE	31.1784	MAPE	16.6573
2025-06-03 15:40:28,354 - T:6	MAE	20.7788	RMSE	32.0539	MAPE	16.8737
2025-06-03 15:40:28,470 - T:12	MAE	21.7869	RMSE	34.1778	MAPE	16.6159
2025-06-03 15:40:28,646 - [*] Evaluating basic traffic samples (prediction=0):
2025-06-03 15:40:28,646 - [*] year 2020, testing
2025-06-03 15:40:28,651 - T:3	MAE	28.5746	RMSE	40.7557	MAPE	9.2741
2025-06-03 15:40:28,655 - T:6	MAE	31.8573	RMSE	45.7873	MAPE	10.3956
2025-06-03 15:40:28,660 - T:12	MAE	37.2472	RMSE	53.6623	MAPE	12.3339
2025-06-03 15:40:28,661 - Finished optimization, total time:527.23 s, best model:res/GBA/gba-val2025-06-03-14:26:29.956215/2020/21.4604.pkl
2025-06-03 15:40:28,731 - 3	mae	22.47	37.59	27.00	20.27	
2025-06-03 15:40:28,731 - 3	rmse	34.62	56.31	42.79	31.18	
2025-06-03 15:40:28,731 - 3	mape	14.19	16.59	14.52	16.66	
2025-06-03 15:40:28,731 - 6	mae	24.51	37.55	28.43	20.78	
2025-06-03 15:40:28,731 - 6	rmse	37.69	56.26	44.06	32.05	
2025-06-03 15:40:28,731 - 6	mape	15.54	16.74	15.29	16.87	
2025-06-03 15:40:28,731 - 12	mae	28.52	34.93	28.91	21.79	
2025-06-03 15:40:28,731 - 12	rmse	43.59	53.45	44.24	34.18	
2025-06-03 15:40:28,731 - 12	mape	18.62	17.42	16.91	16.62	
2025-06-03 15:40:28,731 - year	2017	total_time	964.9377220000001	average_time	43.86081804545454	epoch	22
2025-06-03 15:40:28,732 - year	2018	total_time	400.5107310000001	average_time	36.41008845454545	epoch	11
2025-06-03 15:40:28,732 - year	2019	total_time	697.060822	average_time	36.6874282631579	epoch	19
2025-06-03 15:40:28,732 - year	2020	total_time	527.233646	average_time	37.65956285714286	epoch	14
2025-06-04 00:09:29,630 - logger name:res/GBA/gba-val2025-06-04-00:09:29.629591/gba-val.log
2025-06-04 00:09:29,630 - params : {'conf': 'conf/gba.json', 'paral': 0, 'gpuid': 4, 'logname': 'gba-val', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/SD/all-com2025-05-26-12:20:16.113789/2017/25.9924.pkl', 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/GBA/finaldata/', 'save_data_path': 'data/GBA/FastData/', 'graph_path': 'data/GBA/graph/', 'model_path': 'res/GBA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'classifier': {'hidden_dim': 128}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': False, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 300, 'extra_feature': False, 'moco': True, 'momentum_type': 'linear', 'memory_size': 32, 'expand': True, 'time': '2025-06-04-00:09:29.629591', 'path': 'res/GBA/gba-val2025-06-04-00:09:29.629591', 'device': device(type='cuda', index=4), 'logger': <Logger __main__ (INFO)>}
2025-06-04 00:09:29,754 - [*] Year 2017 load from data/GBA/FastData/2017_30day.npz
/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-06-04 00:10:46,138 - [*] Year 2017 Dataset load!
2025-06-04 00:10:46,153 - [*] Model parameter count: 8842
2025-06-04 00:10:46,153 - [*] Year 2017 Training start
2025-06-04 00:10:46,795 - node number torch.Size([293632, 24])
2025-06-04 00:11:42,019 - epoch:0, training loss:16605.7028 validation loss:30.3792, moco loss:3405.9102
2025-06-04 00:12:37,307 - epoch:1, training loss:1778.9073 validation loss:27.5829, moco loss:1.2942
2025-06-04 00:13:33,882 - epoch:2, training loss:1717.4919 validation loss:27.6519, moco loss:1.0479
2025-06-04 00:14:29,565 - epoch:3, training loss:1692.3517 validation loss:26.9283, moco loss:9.8789
2025-06-04 00:15:25,203 - epoch:4, training loss:1677.7040 validation loss:26.8349, moco loss:0.7323
2025-06-04 00:16:21,446 - epoch:5, training loss:1667.6269 validation loss:26.9360, moco loss:8.6260
2025-06-04 00:17:17,463 - epoch:6, training loss:1654.8372 validation loss:27.4023, moco loss:6.2623
2025-06-04 00:18:13,177 - epoch:7, training loss:1647.5751 validation loss:26.5822, moco loss:1.1017
2025-06-04 00:19:10,034 - epoch:8, training loss:1639.8238 validation loss:26.7367, moco loss:4.6076
2025-06-04 00:20:06,118 - epoch:9, training loss:1640.2156 validation loss:26.5368, moco loss:2.5833
2025-06-04 00:21:02,624 - epoch:10, training loss:1630.0499 validation loss:26.7555, moco loss:15.8077
2025-06-04 00:21:59,019 - epoch:11, training loss:1623.0801 validation loss:26.7531, moco loss:6.3556
2025-06-04 00:22:54,822 - epoch:12, training loss:1620.7773 validation loss:26.9470, moco loss:5.7646
2025-06-04 00:23:51,022 - epoch:13, training loss:1618.0213 validation loss:26.4050, moco loss:27.3220
2025-06-04 00:24:47,474 - epoch:14, training loss:1614.1893 validation loss:26.5272, moco loss:12.7779
2025-06-04 00:25:43,393 - epoch:15, training loss:1608.5530 validation loss:26.4711, moco loss:22.7208
2025-06-04 00:26:38,995 - epoch:16, training loss:1611.2721 validation loss:26.5283, moco loss:2.3414
2025-06-04 00:27:35,461 - epoch:17, training loss:1607.9477 validation loss:26.2524, moco loss:4.1671
2025-06-04 00:28:31,464 - epoch:18, training loss:1602.7184 validation loss:26.3988, moco loss:24.3878
2025-06-04 00:29:27,844 - epoch:19, training loss:1604.5123 validation loss:26.6765, moco loss:5.5446
2025-06-04 00:30:23,745 - epoch:20, training loss:1601.5635 validation loss:26.8024, moco loss:10.3627
2025-06-04 00:31:19,690 - epoch:21, training loss:1602.3968 validation loss:26.5587, moco loss:14.8795
2025-06-04 00:32:15,432 - epoch:22, training loss:1596.8800 validation loss:26.7113, moco loss:9.9008
2025-06-04 00:33:11,731 - epoch:23, training loss:1597.2573 validation loss:26.4248, moco loss:23.8719
2025-06-04 00:33:23,607 - [*]Test--basic_loss:953.4438, event_loss:2045.8445, test_loss:1652.8925
2025-06-04 00:33:29,561 - [*] Evaluating all samples:
2025-06-04 00:33:29,561 - [*] year 2017, testing
2025-06-04 00:33:50,509 - T:3	MAE	21.5164	RMSE	33.5949	MAPE	13.4289
2025-06-04 00:34:07,172 - T:6	MAE	23.1156	RMSE	36.0261	MAPE	14.5241
2025-06-04 00:34:25,793 - T:12	MAE	26.1384	RMSE	40.4243	MAPE	16.8361
2025-06-04 00:34:26,552 - [*] Evaluating basic traffic samples (prediction=0):
2025-06-04 00:34:26,552 - [*] year 2017, testing
2025-06-04 00:34:29,265 - T:3	MAE	13.3339	RMSE	22.2818	MAPE	20.5454
2025-06-04 00:34:33,574 - T:6	MAE	14.8183	RMSE	25.0446	MAPE	22.3307
2025-06-04 00:34:40,193 - T:12	MAE	18.0665	RMSE	30.9124	MAPE	26.3549
2025-06-04 00:34:41,552 - [*] Evaluating event traffic samples (prediction=1):
2025-06-04 00:34:41,552 - [*] year 2017, testing
2025-06-04 00:34:46,213 - T:3	MAE	25.9645	RMSE	38.3701	MAPE	9.5602
2025-06-04 00:34:53,156 - T:6	MAE	27.6269	RMSE	40.7738	MAPE	10.2797
2025-06-04 00:35:05,436 - T:12	MAE	30.5285	RMSE	44.7574	MAPE	11.6596
2025-06-04 00:35:05,454 - Finished optimization, total time:1046.68 s, best model:res/GBA/gba-val2025-06-04-00:09:29.629591/2017/26.2524.pkl
2025-06-04 00:35:05,802 - [*] Year 2018 load from data/GBA/FastData/2018_30day.npz
2025-06-04 00:35:05,888 - Secure SignIn[*] load from res/GBA/gba-val2025-06-04-00:09:29.629591/2017/26.2524.pkl
2025-06-04 00:35:06,012 - [*] replay node number 208
2025-06-04 00:35:25,846 - number of increase nodes:225, nodes after 2 hop:torch.Size([1942]), total nodes this year 2321
2025-06-04 00:36:48,428 - [*] Year 2018 Dataset load!
2025-06-04 00:36:48,428 - Secure SignIn[*] load from res/GBA/gba-val2025-06-04-00:09:29.629591/2017/26.2524.pkl
2025-06-04 00:36:48,519 - [*] EWC! lambda 0.000100
Traceback (most recent call last):
  File "/home/bd2/ANATS/TrafficStream/main_moco.py", line 589, in <module>
    main(args)
  File "/home/bd2/ANATS/TrafficStream/main_moco.py", line 551, in main
    train(inputs, args)
  File "/home/bd2/ANATS/TrafficStream/main_moco.py", line 146, in train
    model.register_ewc_params(ewc_loader, lossfunc, device)
  File "/home/bd2/ANATS/TrafficStream/src/model/ewc.py", line 72, in register_ewc_params
    self._update_fisher_params(loader, lossfunc, device)
  File "/home/bd2/ANATS/TrafficStream/src/model/ewc.py", line 51, in _update_fisher_params
    basic_features = self.model.feature(basic_data, self.adj)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/ANATS/TrafficStream/src/model/model.py", line 279, in feature
    x = data.x.reshape((batch_size, N, self.args.gcn["in_channel"]*2))[:, :, :self.args.gcn["in_channel"]]  # [bs, N, feature]
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: shape '[128, 2321, 24]' is invalid for input of size 3565056
2025-06-04 05:09:38,101 - logger name:res/GBA/gba2025-06-04-05:09:38.100730/gba.log
2025-06-04 05:09:38,101 - params : {'conf': 'conf/gba.json', 'paral': 0, 'gpuid': 0, 'logname': 'gba', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/GBA/gba2025-06-04-03:03:30.637631/2018/26.2626.pkl', 'begin_year': 2018, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/GBA/finaldata/', 'save_data_path': 'data/GBA/FastData/', 'graph_path': 'data/GBA/graph/', 'model_path': 'res/GBA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'classifier': {'hidden_dim': 128}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'replay_num_samples': 300, 'extra_feature': False, 'moco': True, 'momentum_type': 'linear', 'memory_size': 32, 'expand': True, 'time': '2025-06-04-05:09:38.100730', 'path': 'res/GBA/gba2025-06-04-05:09:38.100730', 'device': device(type='cuda', index=0), 'logger': <Logger __main__ (INFO)>}

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 932295.85it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1057923.35it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1078273.00it/s]

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 928982.62it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 888915.41it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1035693.26it/s]
2025-06-04 05:13:12,058 - [*] Year 2018 load from data/GBA/FastData/2018_30day.npz
/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-06-04 05:13:12,360 - [*] Year 2018 Dataset load!
2025-06-04 05:13:12,367 - [*] Model parameter count: 8842
2025-06-04 05:13:12,367 - [*] Year 2018 Training start
2025-06-04 05:13:13,390 - node number torch.Size([297088, 24])
2025-06-04 05:14:12,088 - epoch:0, training loss:5643.6285 validation loss:30.4362, moco loss:1.6895
2025-06-04 05:15:14,444 - epoch:1, training loss:2084.9848 validation loss:29.0808, moco loss:15.9149
2025-06-04 05:16:16,870 - epoch:2, training loss:1954.6202 validation loss:29.2304, moco loss:9.5583
2025-06-04 05:17:13,321 - logger name:res/GBA/gba2025-06-04-05:17:13.320829/gba.log
2025-06-04 05:17:13,322 - params : {'conf': 'conf/gba.json', 'paral': 0, 'gpuid': 0, 'logname': 'gba', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/GBA/gba2025-06-04-03:03:30.637631/2018/26.2626.pkl', 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/GBA/finaldata/', 'save_data_path': 'data/GBA/FastData/', 'graph_path': 'data/GBA/graph/', 'model_path': 'res/GBA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'classifier': {'hidden_dim': 128}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'replay_num_samples': 300, 'extra_feature': False, 'moco': True, 'momentum_type': 'linear', 'memory_size': 32, 'expand': True, 'time': '2025-06-04-05:17:13.320829', 'path': 'res/GBA/gba2025-06-04-05:17:13.320829', 'device': device(type='cuda', index=0), 'logger': <Logger __main__ (INFO)>}

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 907229.15it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1029814.69it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1013631.90it/s]

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 907914.16it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1026625.37it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1020612.68it/s]
2025-06-04 05:20:20,215 - [*] Year 2017 load from data/GBA/FastData/2017_30day.npz
/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-06-04 05:20:20,499 - [*] Year 2017 Dataset load!
2025-06-04 05:20:20,503 - [*] Model parameter count: 8842
2025-06-04 05:20:20,503 - [*] Year 2017 Training start
2025-06-04 05:20:21,431 - node number torch.Size([293632, 24])
2025-06-04 05:21:16,246 - epoch:0, training loss:5639.1089 validation loss:30.1254, moco loss:0.7859
2025-06-04 05:22:12,152 - epoch:1, training loss:1980.7918 validation loss:28.8989, moco loss:2.5907
2025-06-04 05:23:09,308 - epoch:2, training loss:1841.5260 validation loss:28.5426, moco loss:6.5878
2025-06-04 05:24:07,139 - epoch:3, training loss:1811.6350 validation loss:27.9197, moco loss:29.0964
2025-06-04 05:25:05,680 - epoch:4, training loss:1792.6959 validation loss:27.6550, moco loss:5.7587
2025-06-04 05:26:04,171 - epoch:5, training loss:1785.0132 validation loss:27.8726, moco loss:27.8724
2025-06-04 05:27:02,792 - epoch:6, training loss:1785.6073 validation loss:27.7458, moco loss:58.9065
2025-06-04 05:28:00,674 - epoch:7, training loss:1778.9337 validation loss:27.7841, moco loss:106.3618
2025-06-04 05:29:01,985 - epoch:8, training loss:1769.2455 validation loss:27.5985, moco loss:93.2373
2025-06-04 05:30:08,499 - epoch:9, training loss:1765.4774 validation loss:27.4290, moco loss:30.2620
2025-06-04 05:31:08,618 - epoch:10, training loss:1758.3304 validation loss:27.7747, moco loss:33.1350
2025-06-04 05:32:09,565 - epoch:11, training loss:1751.0343 validation loss:27.7559, moco loss:35.5751
2025-06-04 05:33:11,771 - epoch:12, training loss:1743.9403 validation loss:27.1818, moco loss:21.5216
2025-06-04 05:34:11,995 - epoch:13, training loss:1725.9669 validation loss:27.1283, moco loss:5.2432
2025-06-04 05:35:13,549 - epoch:14, training loss:1717.6438 validation loss:27.4598, moco loss:11.2461
2025-06-04 05:36:12,568 - epoch:15, training loss:1705.3636 validation loss:27.2958, moco loss:2.6226
2025-06-04 05:37:10,560 - epoch:16, training loss:1702.3227 validation loss:27.6884, moco loss:6.8838
2025-06-04 05:38:08,694 - epoch:17, training loss:1699.8527 validation loss:27.3300, moco loss:2.5842
2025-06-04 05:39:06,159 - epoch:18, training loss:1697.1007 validation loss:27.1284, moco loss:3.0422
2025-06-04 05:40:06,078 - epoch:19, training loss:1692.7494 validation loss:27.3675, moco loss:4.1744
2025-06-04 05:40:18,413 - [*]Test--basic_loss:1756.3328, event_loss:61.3527, test_loss:1756.6389
2025-06-04 05:40:26,051 - [*] Evaluating all samples:
2025-06-04 05:40:26,051 - [*] year 2017, testing
2025-06-04 05:40:42,456 - T:3	MAE	21.7947	RMSE	33.9299	MAPE	13.7522
2025-06-04 05:41:05,081 - T:6	MAE	23.5696	RMSE	36.5976	MAPE	15.1577
2025-06-04 05:41:51,856 - T:12	MAE	26.9148	RMSE	41.5911	MAPE	17.9953
2025-06-04 05:41:53,990 - [*] Evaluating basic traffic samples (prediction=0):
2025-06-04 05:41:53,991 - [*] year 2017, testing
2025-06-04 05:42:00,662 - T:3	MAE	21.7931	RMSE	33.9273	MAPE	13.7522
2025-06-04 05:42:20,620 - T:6	MAE	23.5675	RMSE	36.5944	MAPE	15.1576
2025-06-04 05:43:02,992 - T:12	MAE	26.9123	RMSE	41.5875	MAPE	17.9950
2025-06-04 05:43:02,993 - [*] Evaluating event traffic samples (prediction=1):
2025-06-04 05:43:02,993 - [*] year 2017, testing
2025-06-04 05:43:02,994 - T:3	MAE	40.1695	RMSE	54.8312	MAPE	13.8854
2025-06-04 05:43:02,995 - T:6	MAE	44.4666	RMSE	60.6929	MAPE	16.4464
2025-06-04 05:43:02,996 - T:12	MAE	51.2273	RMSE	70.3179	MAPE	19.6783
2025-06-04 05:43:03,015 - Finished optimization, total time:894.72 s, best model:res/GBA/gba2025-06-04-05:17:13.320829/2017/27.1283.pkl

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 935576.55it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1019067.49it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 976898.95it/s]

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 969383.52it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 741013.09it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 965623.25it/s]
2025-06-04 05:47:37,345 - [*] Year 2018 load from data/GBA/FastData/2018_30day.npz
2025-06-04 05:47:37,425 - Secure SignIn[*] load from res/GBA/gba2025-06-04-05:17:13.320829/2017/27.1283.pkl
2025-06-04 05:47:37,551 - [*] detect strategy feature
2025-06-04 05:47:47,288 - [*] replay node number 300
2025-06-04 05:47:47,656 - number of increase nodes:313, nodes after 2 hop:torch.Size([2071]), total nodes this year 2321
2025-06-04 05:48:38,598 - [*] Year 2018 Dataset load!
2025-06-04 05:48:38,598 - Secure SignIn[*] load from res/GBA/gba2025-06-04-05:17:13.320829/2017/27.1283.pkl
2025-06-04 05:48:38,685 - [*] EWC! lambda 0.000100
2025-06-04 05:49:08,866 - [*] Model parameter count: 8842
2025-06-04 05:49:08,867 - [*] Year 2018 Training start
2025-06-04 05:49:11,780 - node number torch.Size([265088, 24])
2025-06-04 05:50:03,359 - epoch:0, training loss:1789.3034 validation loss:26.0187, moco loss:5.5370
2025-06-04 05:50:57,453 - epoch:1, training loss:1762.3669 validation loss:26.0960, moco loss:9.7834
2025-06-04 05:51:50,712 - epoch:2, training loss:1764.9671 validation loss:26.1856, moco loss:6.7533
2025-06-04 05:52:44,912 - epoch:3, training loss:1767.4882 validation loss:26.0999, moco loss:2.1521
2025-06-04 05:53:38,835 - epoch:4, training loss:1762.8850 validation loss:26.0527, moco loss:2.3356
2025-06-04 05:54:32,597 - epoch:5, training loss:1760.1222 validation loss:26.1550, moco loss:0.7632
2025-06-04 05:55:26,060 - epoch:6, training loss:1765.4293 validation loss:25.8121, moco loss:10.0233
2025-06-04 05:56:19,446 - epoch:7, training loss:1760.9349 validation loss:26.3003, moco loss:2.0277
2025-06-04 05:57:12,564 - epoch:8, training loss:1763.7618 validation loss:26.1984, moco loss:5.4336
2025-06-04 05:58:05,157 - epoch:9, training loss:1761.3257 validation loss:25.7530, moco loss:6.3449
2025-06-04 05:58:58,217 - epoch:10, training loss:1756.7803 validation loss:26.5381, moco loss:11.4436
2025-06-04 05:59:51,921 - epoch:11, training loss:1759.7036 validation loss:25.5298, moco loss:11.3630
2025-06-04 06:00:45,084 - epoch:12, training loss:1759.5446 validation loss:25.8752, moco loss:3.6547
2025-06-04 06:01:38,048 - epoch:13, training loss:1758.7826 validation loss:25.6820, moco loss:3.1422
2025-06-04 06:02:30,431 - epoch:14, training loss:1758.2321 validation loss:26.1414, moco loss:6.7363
2025-06-04 06:03:24,005 - epoch:15, training loss:1759.9199 validation loss:25.6454, moco loss:7.2986
2025-06-04 06:04:18,494 - epoch:16, training loss:1758.7380 validation loss:25.5056, moco loss:3.0576
2025-06-04 06:05:12,407 - epoch:17, training loss:1761.6611 validation loss:26.1556, moco loss:24.3011
2025-06-04 06:06:05,800 - epoch:18, training loss:1756.8548 validation loss:25.9188, moco loss:3.2346
2025-06-04 06:06:59,179 - epoch:19, training loss:1757.5832 validation loss:25.8435, moco loss:0.7642
2025-06-04 06:07:52,424 - epoch:20, training loss:1758.7213 validation loss:25.5143, moco loss:1.2378
2025-06-04 06:08:45,968 - epoch:21, training loss:1754.9207 validation loss:25.6236, moco loss:6.5952
2025-06-04 06:09:40,625 - epoch:22, training loss:1755.1056 validation loss:26.9573, moco loss:1.7046
2025-06-04 06:09:52,404 - [*]Test--basic_loss:1835.6796, event_loss:399.6631, test_loss:1838.6175
2025-06-04 06:09:52,665 - [*] Evaluating all samples:
2025-06-04 06:09:52,665 - [*] year 2018, testing
2025-06-04 06:09:52,730 - T:3	MAE	24.2396	RMSE	39.1473	MAPE	20.6101
2025-06-04 06:09:52,812 - T:6	MAE	23.2356	RMSE	37.4123	MAPE	17.4001
2025-06-04 06:09:52,943 - T:12	MAE	22.9139	RMSE	36.7636	MAPE	15.6321
2025-06-04 06:09:53,206 - [*] Evaluating basic traffic samples (prediction=0):
2025-06-04 06:09:53,206 - [*] year 2018, testing
2025-06-04 06:09:53,211 - T:3	MAE	6.4871	RMSE	8.4672	MAPE	8.4486
2025-06-04 06:09:53,216 - T:6	MAE	7.0906	RMSE	9.5262	MAPE	8.7991
2025-06-04 06:09:53,221 - T:12	MAE	8.6084	RMSE	12.0111	MAPE	10.2180
2025-06-04 06:09:53,221 - [*] Evaluating event traffic samples (prediction=1):
2025-06-04 06:09:53,221 - [*] year 2018, testing
2025-06-04 06:09:53,221 - T:3	MAE	17.2148	RMSE	24.3079	MAPE	6.1344
2025-06-04 06:09:53,222 - T:6	MAE	22.7336	RMSE	30.3197	MAPE	8.4423
2025-06-04 06:09:53,222 - T:12	MAE	32.6361	RMSE	40.0181	MAPE	13.5213
2025-06-04 06:09:53,222 - Finished optimization, total time:996.96 s, best model:res/GBA/gba2025-06-04-05:17:13.320829/2018/25.5056.pkl

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 817239.98it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 900039.33it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 978785.78it/s]

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 889084.02it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 549576.82it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 971153.50it/s]
2025-06-04 06:14:57,104 - [*] Year 2019 load from data/GBA/FastData/2019_30day.npz
2025-06-04 06:14:57,192 - Secure SignIn[*] load from res/GBA/gba2025-06-04-05:17:13.320829/2018/25.5056.pkl
2025-06-04 06:14:57,326 - [*] detect strategy feature
2025-06-04 06:15:07,180 - [*] replay node number 300
2025-06-04 06:15:07,527 - number of increase nodes:324, nodes after 2 hop:torch.Size([2078]), total nodes this year 2352
2025-06-04 06:16:23,339 - [*] Year 2019 Dataset load!
2025-06-04 06:16:23,339 - Secure SignIn[*] load from res/GBA/gba2025-06-04-05:17:13.320829/2018/25.5056.pkl
2025-06-04 06:16:23,431 - [*] EWC! lambda 0.000100
2025-06-04 06:16:53,737 - [*] Model parameter count: 8842
2025-06-04 06:16:53,737 - [*] Year 2019 Training start
2025-06-04 06:16:56,559 - node number torch.Size([265984, 24])
2025-06-04 06:17:50,647 - epoch:0, training loss:1752.5441 validation loss:25.6075, moco loss:25.1797
2025-06-04 06:18:46,259 - epoch:1, training loss:1735.4343 validation loss:25.1973, moco loss:19.4158
2025-06-04 06:19:42,166 - epoch:2, training loss:1732.4039 validation loss:25.6024, moco loss:2.5223
2025-06-04 06:20:37,017 - epoch:3, training loss:1732.2012 validation loss:26.2328, moco loss:4.2078
2025-06-04 06:21:32,334 - epoch:4, training loss:1730.5315 validation loss:25.6248, moco loss:4.1073
2025-06-04 06:22:25,638 - epoch:5, training loss:1731.8933 validation loss:25.3218, moco loss:14.0908
2025-06-04 06:23:19,460 - epoch:6, training loss:1732.3133 validation loss:25.2152, moco loss:24.5745
2025-06-04 06:24:13,927 - epoch:7, training loss:1735.1873 validation loss:26.4072, moco loss:14.7224
2025-06-04 06:24:26,497 - [*]Test--basic_loss:1792.0855, event_loss:0.0000, test_loss:1792.0855
2025-06-04 06:24:26,829 - [*] Evaluating all samples:
2025-06-04 06:24:26,829 - [*] year 2019, testing
2025-06-04 06:24:26,898 - T:3	MAE	24.0194	RMSE	38.3032	MAPE	16.2772
2025-06-04 06:24:26,989 - T:6	MAE	26.0038	RMSE	41.3931	MAPE	18.0197
2025-06-04 06:24:27,162 - T:12	MAE	29.8963	RMSE	47.0327	MAPE	21.6354
2025-06-04 06:24:27,567 - [*] Evaluating basic traffic samples (prediction=0):
2025-06-04 06:24:27,567 - [*] year 2019, testing
2025-06-04 06:24:27,572 - T:3	MAE	27.4171	RMSE	38.9494	MAPE	9.3502
2025-06-04 06:24:27,576 - T:6	MAE	30.1314	RMSE	42.7339	MAPE	10.3088
2025-06-04 06:24:27,582 - T:12	MAE	35.9343	RMSE	51.1789	MAPE	12.3860
2025-06-04 06:24:27,582 - Finished optimization, total time:356.12 s, best model:res/GBA/gba2025-06-04-05:17:13.320829/2019/25.1973.pkl

  0%|          | 0/63243 [00:00<?, ?it/s]
100%|██████████| 63243/63243 [00:00<00:00, 938406.73it/s]

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 854127.40it/s]

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 926175.50it/s]

  0%|          | 0/63243 [00:00<?, ?it/s]
100%|██████████| 63243/63243 [00:00<00:00, 889031.63it/s]

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 852636.62it/s]

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 850872.55it/s]
2025-06-04 06:44:29,560 - [*] Year 2020 load from data/GBA/FastData/2020_30day.npz
2025-06-04 06:44:29,660 - Secure SignIn[*] load from res/GBA/gba2025-06-04-05:17:13.320829/2019/25.1973.pkl
2025-06-04 06:44:29,792 - [*] detect strategy feature
2025-06-04 06:44:39,756 - [*] replay node number 300
2025-06-04 06:44:40,079 - number of increase nodes:293, nodes after 2 hop:torch.Size([2092]), total nodes this year 2352
2025-06-04 06:46:54,319 - [*] Year 2020 Dataset load!
2025-06-04 06:46:54,320 - Secure SignIn[*] load from res/GBA/gba2025-06-04-05:17:13.320829/2019/25.1973.pkl
2025-06-04 06:46:54,421 - [*] EWC! lambda 0.000100
2025-06-04 06:47:26,370 - [*] Model parameter count: 8842
2025-06-04 06:47:26,372 - [*] Year 2020 Training start
2025-06-04 06:47:29,552 - node number torch.Size([267776, 24])
2025-06-04 06:48:24,416 - epoch:0, training loss:1199.9130 validation loss:22.8453, moco loss:4.2083
2025-06-04 06:49:23,022 - epoch:1, training loss:1179.4703 validation loss:23.2877, moco loss:1.4392
2025-06-04 06:50:19,079 - epoch:2, training loss:1177.1829 validation loss:22.6841, moco loss:11.6624
2025-06-04 06:51:18,901 - epoch:3, training loss:1175.5737 validation loss:22.3857, moco loss:3.3803
2025-06-04 06:52:17,240 - epoch:4, training loss:1179.9108 validation loss:21.6541, moco loss:19.3460
2025-06-04 06:53:16,535 - epoch:5, training loss:1177.8731 validation loss:22.9541, moco loss:2.6428
2025-06-04 06:54:17,131 - epoch:6, training loss:1176.0228 validation loss:21.7376, moco loss:8.3206
2025-06-04 06:55:16,762 - epoch:7, training loss:1179.6669 validation loss:21.2665, moco loss:3.8858
2025-06-04 06:56:17,606 - epoch:8, training loss:1177.2453 validation loss:21.9396, moco loss:1.2541
2025-06-04 06:57:15,463 - epoch:9, training loss:1173.0944 validation loss:22.8390, moco loss:6.1862
2025-06-04 06:58:14,822 - epoch:10, training loss:1175.9830 validation loss:22.3642, moco loss:13.3816
2025-06-04 06:59:13,269 - epoch:11, training loss:1173.9497 validation loss:22.4269, moco loss:2.8635
2025-06-04 07:00:13,623 - epoch:12, training loss:1177.7103 validation loss:22.5707, moco loss:6.7510
2025-06-04 07:01:11,393 - epoch:13, training loss:1170.6596 validation loss:21.4473, moco loss:20.7189
2025-06-04 07:01:26,204 - [*]Test--basic_loss:1011.5950, event_loss:0.0000, test_loss:1011.5950
2025-06-04 07:01:27,116 - [*] Evaluating all samples:
2025-06-04 07:01:27,116 - [*] year 2020, testing
2025-06-04 07:01:27,198 - T:3	MAE	17.4365	RMSE	26.8522	MAPE	25.5955
2025-06-04 07:01:27,311 - T:6	MAE	18.3183	RMSE	28.3007	MAPE	21.3566
2025-06-04 07:01:27,468 - T:12	MAE	19.5488	RMSE	30.5438	MAPE	19.4099
2025-06-04 07:01:28,335 - [*] Evaluating basic traffic samples (prediction=0):
2025-06-04 07:01:28,336 - [*] year 2020, testing
2025-06-04 07:01:28,344 - T:3	MAE	9.4011	RMSE	10.9845	MAPE	11.1336
2025-06-04 07:01:28,348 - T:6	MAE	9.3484	RMSE	11.4165	MAPE	9.8227
2025-06-04 07:01:28,355 - T:12	MAE	10.0962	RMSE	12.9633	MAPE	9.6343
2025-06-04 07:01:28,355 - Finished optimization, total time:665.17 s, best model:res/GBA/gba2025-06-04-05:17:13.320829/2020/21.2665.pkl
2025-06-04 07:01:28,464 - 3	mae	21.79	24.24	24.02	17.44	
2025-06-04 07:01:28,465 - 3	rmse	33.93	39.15	38.30	26.85	
2025-06-04 07:01:28,465 - 3	mape	13.75	20.61	16.28	25.60	
2025-06-04 07:01:28,465 - 6	mae	23.57	23.24	26.00	18.32	
2025-06-04 07:01:28,465 - 6	rmse	36.60	37.41	41.39	28.30	
2025-06-04 07:01:28,465 - 6	mape	15.16	17.40	18.02	21.36	
2025-06-04 07:01:28,465 - 12	mae	26.91	22.91	29.90	19.55	
2025-06-04 07:01:28,465 - 12	rmse	41.59	36.76	47.03	30.54	
2025-06-04 07:01:28,465 - 12	mape	18.00	15.63	21.64	19.41	
2025-06-04 07:01:28,465 - year	2017	total_time	894.715509	average_time	44.73578705	epoch	20
2025-06-04 07:01:28,465 - year	2018	total_time	996.96091	average_time	43.346139173913045	epoch	23
2025-06-04 07:01:28,465 - year	2019	total_time	356.11782300000004	average_time	44.514736375	epoch	8
2025-06-04 07:01:28,465 - year	2020	total_time	665.170806	average_time	47.51221792857143	epoch	14
2025-06-04 07:23:05,850 - logger name:res/GLA/gla2025-06-04-07:23:05.849887/gla.log
2025-06-04 07:23:05,851 - params : {'conf': 'conf/gla.json', 'paral': 0, 'gpuid': 0, 'logname': 'gla', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/GBA/gba2025-06-04-03:03:30.637631/2018/26.2626.pkl', 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/GLA/finaldata/', 'save_data_path': 'data/GLA/FastData/', 'graph_path': 'data/GLA/graph/', 'model_path': 'res/GLA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'classifier': {'hidden_dim': 128}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 300, 'extra_feature': False, 'moco': True, 'momentum_type': 'linear', 'memory_size': 32, 'expand': True, 'time': '2025-06-04-07:23:05.849887', 'path': 'res/GLA/gla2025-06-04-07:23:05.849887', 'device': device(type='cuda', index=0), 'logger': <Logger __main__ (INFO)>}

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 790059.99it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 851267.61it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 994954.56it/s]

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 931777.01it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 986693.52it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 990261.59it/s]
2025-06-04 07:25:21,078 - logger name:res/GBA/gba-0.1moco2025-06-04-07:25:21.077003/gba-0.1moco.log
2025-06-04 07:25:21,078 - params : {'conf': 'conf/gba.json', 'paral': 0, 'gpuid': 0, 'logname': 'gba-0.1moco', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/GBA/gba2025-06-04-03:03:30.637631/2018/26.2626.pkl', 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/GBA/finaldata/', 'save_data_path': 'data/GBA/FastData/', 'graph_path': 'data/GBA/graph/', 'model_path': 'res/GBA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'classifier': {'hidden_dim': 128}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'replay_num_samples': 300, 'extra_feature': False, 'moco': True, 'momentum_type': 'linear', 'memory_size': 32, 'expand': True, 'time': '2025-06-04-07:25:21.077003', 'path': 'res/GBA/gba-0.1moco2025-06-04-07:25:21.077003', 'device': device(type='cuda', index=0), 'logger': <Logger __main__ (INFO)>}
2025-06-04 07:25:30,727 - [*] Year 2017 load from data/GLA/FastData/2017_30day.npz
/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-06-04 07:25:30,992 - [*] Year 2017 Dataset load!
2025-06-04 07:25:30,995 - [*] Model parameter count: 8842
2025-06-04 07:25:30,996 - [*] Year 2017 Training start
2025-06-04 07:25:31,798 - node number torch.Size([232960, 24])

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 913684.07it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 970117.09it/s]
2025-06-04 07:26:02,268 - logger name:res/GBA/gba-0.1moco2025-06-04-07:26:02.267442/gba-0.1moco.log
2025-06-04 07:26:02,268 - params : {'conf': 'conf/gba.json', 'paral': 0, 'gpuid': 0, 'logname': 'gba-0.1moco', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/GBA/gba2025-06-04-03:03:30.637631/2018/26.2626.pkl', 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/GBA/finaldata/', 'save_data_path': 'data/GBA/FastData/', 'graph_path': 'data/GBA/graph/', 'model_path': 'res/GBA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'classifier': {'hidden_dim': 128}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'replay_num_samples': 300, 'extra_feature': False, 'moco': True, 'momentum_type': 'linear', 'memory_size': 32, 'expand': True, 'time': '2025-06-04-07:26:02.267442', 'path': 'res/GBA/gba-0.1moco2025-06-04-07:26:02.267442', 'device': device(type='cuda', index=0), 'logger': <Logger __main__ (INFO)>}
2025-06-04 07:26:12,181 - logger name:res/GBA/gba-0.1moco2025-06-04-07:26:12.180267/gba-0.1moco.log
2025-06-04 07:26:12,181 - params : {'conf': 'conf/gba.json', 'paral': 0, 'gpuid': 2, 'logname': 'gba-0.1moco', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/GBA/gba2025-06-04-03:03:30.637631/2018/26.2626.pkl', 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/GBA/finaldata/', 'save_data_path': 'data/GBA/FastData/', 'graph_path': 'data/GBA/graph/', 'model_path': 'res/GBA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'classifier': {'hidden_dim': 128}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'replay_num_samples': 300, 'extra_feature': False, 'moco': True, 'momentum_type': 'linear', 'memory_size': 32, 'expand': True, 'time': '2025-06-04-07:26:12.180267', 'path': 'res/GBA/gba-0.1moco2025-06-04-07:26:12.180267', 'device': device(type='cuda', index=2), 'logger': <Logger __main__ (INFO)>}
2025-06-04 07:26:15,274 - epoch:0, training loss:8802.5757 validation loss:32.7280, moco loss:0.8358

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 891336.77it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1007954.33it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 999035.29it/s]

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 888280.94it/s]
2025-06-04 07:26:56,118 - epoch:1, training loss:2640.2533 validation loss:31.3234, moco loss:15.1498

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1020116.77it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 986439.64it/s]
2025-06-04 07:27:37,097 - epoch:2, training loss:2476.1444 validation loss:30.6997, moco loss:48.8543
2025-06-04 07:28:18,169 - epoch:3, training loss:2440.5419 validation loss:30.1389, moco loss:49.2910
2025-06-04 07:28:58,822 - epoch:4, training loss:2426.0083 validation loss:29.8258, moco loss:64.7175
2025-06-04 07:29:39,282 - epoch:5, training loss:2420.9177 validation loss:30.0246, moco loss:85.3249
2025-06-04 07:30:19,841 - epoch:6, training loss:2417.6951 validation loss:30.3719, moco loss:113.3536
2025-06-04 07:30:35,422 - [*] Year 2017 load from data/GBA/FastData/2017_30day.npz
/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-06-04 07:30:35,717 - [*] Year 2017 Dataset load!
2025-06-04 07:30:35,721 - [*] Model parameter count: 8842
2025-06-04 07:30:35,722 - [*] Year 2017 Training start
2025-06-04 07:30:37,187 - node number torch.Size([293632, 24])
2025-06-04 07:31:00,093 - epoch:7, training loss:2412.1204 validation loss:29.7887, moco loss:222.9395
2025-06-04 07:31:32,647 - epoch:0, training loss:5625.1727 validation loss:30.1735, moco loss:1.2346
2025-06-04 07:31:40,969 - epoch:8, training loss:2401.2742 validation loss:29.5673, moco loss:175.5110
2025-06-04 07:32:21,692 - epoch:9, training loss:2390.2870 validation loss:29.5580, moco loss:66.6079
2025-06-04 07:32:33,216 - epoch:1, training loss:1991.4034 validation loss:29.4226, moco loss:0.6622
2025-06-04 07:33:01,969 - epoch:10, training loss:2370.9791 validation loss:29.1873, moco loss:127.4675
2025-06-04 07:33:33,985 - epoch:2, training loss:1853.0361 validation loss:28.1499, moco loss:2.2825
2025-06-04 07:33:42,368 - epoch:11, training loss:2360.5994 validation loss:29.5958, moco loss:56.7873
2025-06-04 07:34:23,006 - epoch:12, training loss:2351.2017 validation loss:29.2628, moco loss:80.1771
2025-06-04 07:34:35,129 - epoch:3, training loss:1808.7971 validation loss:28.0341, moco loss:11.4613
2025-06-04 07:35:03,675 - epoch:13, training loss:2352.6361 validation loss:29.3200, moco loss:53.4377
2025-06-04 07:35:36,407 - epoch:4, training loss:1792.3058 validation loss:27.6156, moco loss:3.1488
2025-06-04 07:35:44,354 - epoch:14, training loss:2343.0466 validation loss:29.6457, moco loss:92.6991
2025-06-04 07:36:25,381 - epoch:15, training loss:2337.9579 validation loss:29.2920, moco loss:63.9622
2025-06-04 07:36:38,169 - epoch:5, training loss:1785.2118 validation loss:27.8744, moco loss:14.8906
2025-06-04 07:37:05,842 - epoch:16, training loss:2331.2491 validation loss:29.4521, moco loss:29.0259
2025-06-04 07:37:14,863 - [*]Test--basic_loss:2453.3133, event_loss:757.7188, test_loss:2339.0380
2025-06-04 07:37:16,435 - [*] Evaluating all samples:
2025-06-04 07:37:16,436 - [*] year 2017, testing
2025-06-04 07:37:22,301 - T:3	MAE	22.6450	RMSE	35.6668	MAPE	9.8372
2025-06-04 07:37:31,744 - T:6	MAE	24.9038	RMSE	39.1970	MAPE	10.9336
2025-06-04 07:37:39,783 - epoch:6, training loss:1776.2123 validation loss:27.7163, moco loss:13.2788
2025-06-04 07:37:46,026 - T:12	MAE	29.0517	RMSE	45.4099	MAPE	13.0491
2025-06-04 07:37:47,501 - [*] Evaluating basic traffic samples (prediction=0):
2025-06-04 07:37:47,502 - [*] year 2017, testing
2025-06-04 07:37:53,055 - T:3	MAE	23.2566	RMSE	36.3848	MAPE	9.5483
2025-06-04 07:38:01,817 - T:6	MAE	25.6509	RMSE	40.0481	MAPE	10.6648
2025-06-04 07:38:15,273 - T:12	MAE	30.0280	RMSE	46.4860	MAPE	12.7654
2025-06-04 07:38:15,387 - [*] Evaluating event traffic samples (prediction=1):
2025-06-04 07:38:15,387 - [*] year 2017, testing
2025-06-04 07:38:15,707 - T:3	MAE	14.1844	RMSE	23.5945	MAPE	13.8314
2025-06-04 07:38:16,180 - T:6	MAE	14.5688	RMSE	24.5642	MAPE	14.6544
2025-06-04 07:38:16,880 - T:12	MAE	15.5389	RMSE	26.3325	MAPE	16.9764
2025-06-04 07:38:16,896 - Finished optimization, total time:541.07 s, best model:res/GLA/gla2025-06-04-07:23:05.849887/2017/29.1873.pkl

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 945910.29it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1013946.61it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 998096.70it/s]

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 989574.33it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 994786.19it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 981673.44it/s]
2025-06-04 07:38:41,353 - epoch:7, training loss:1765.1613 validation loss:28.1430, moco loss:2.0570
2025-06-04 07:39:42,094 - epoch:8, training loss:1756.5798 validation loss:27.3747, moco loss:45.5492
2025-06-04 07:40:05,504 - [*] Year 2018 load from data/GLA/FastData/2018_30day.npz
2025-06-04 07:40:05,563 - Secure SignIn[*] load from res/GLA/gla2025-06-04-07:23:05.849887/2017/29.1873.pkl
2025-06-04 07:40:05,659 - [*] detect strategy feature
Traceback (most recent call last):
  File "/home/bd2/ANATS/TrafficStream/main_moco.py", line 600, in <module>
    main(args)
  File "/home/bd2/ANATS/TrafficStream/main_moco.py", line 514, in main
    args.logger.info("[*] replay node number {}".format(args.replay_num_samples))
                                                        ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Namespace' object has no attribute 'replay_num_samples'. Did you mean: 'repaly_num_samples'?
2025-06-04 07:40:43,252 - epoch:9, training loss:1751.3849 validation loss:27.4378, moco loss:2.1676
2025-06-04 07:41:43,923 - epoch:10, training loss:1745.6172 validation loss:27.4991, moco loss:28.5729
2025-06-04 07:42:44,742 - epoch:11, training loss:1739.3316 validation loss:27.7630, moco loss:8.1853
2025-06-04 07:43:45,763 - epoch:12, training loss:1728.9557 validation loss:27.1971, moco loss:4.6997
2025-06-04 07:44:46,601 - epoch:13, training loss:1716.0911 validation loss:27.0156, moco loss:1.8731
2025-06-04 07:45:47,626 - epoch:14, training loss:1707.6377 validation loss:27.3507, moco loss:5.7559
2025-06-04 07:46:48,680 - epoch:15, training loss:1699.1051 validation loss:26.9871, moco loss:2.9672
2025-06-04 07:47:49,320 - epoch:16, training loss:1695.6544 validation loss:27.7545, moco loss:2.1708
2025-06-04 07:48:50,220 - epoch:17, training loss:1694.5369 validation loss:27.5325, moco loss:2.5967
2025-06-04 07:49:51,335 - epoch:18, training loss:1691.1463 validation loss:27.3700, moco loss:6.0964
2025-06-04 07:50:51,965 - epoch:19, training loss:1687.1867 validation loss:27.1678, moco loss:11.5052
2025-06-04 07:51:52,607 - epoch:20, training loss:1684.7563 validation loss:27.1893, moco loss:3.2278
2025-06-04 07:52:53,452 - epoch:21, training loss:1686.4008 validation loss:26.9450, moco loss:37.1511
2025-06-04 07:53:54,334 - epoch:22, training loss:1678.1340 validation loss:27.1774, moco loss:40.2263
2025-06-04 07:54:54,808 - epoch:23, training loss:1678.5714 validation loss:26.7271, moco loss:15.5469
2025-06-04 07:55:55,662 - epoch:24, training loss:1674.5305 validation loss:27.2343, moco loss:2.5319
2025-06-04 07:56:56,369 - epoch:25, training loss:1674.2956 validation loss:27.0006, moco loss:36.1077
2025-06-04 07:57:57,076 - epoch:26, training loss:1667.2642 validation loss:27.1550, moco loss:4.1483
2025-06-04 07:58:58,043 - epoch:27, training loss:1670.8840 validation loss:27.6675, moco loss:4.3255
2025-06-04 07:59:59,075 - epoch:28, training loss:1659.8705 validation loss:27.2379, moco loss:6.4265
2025-06-04 08:00:59,945 - epoch:29, training loss:1668.5845 validation loss:26.8235, moco loss:57.6426
2025-06-04 08:01:11,980 - [*]Test--basic_loss:1708.7680, event_loss:18.6064, test_loss:1708.8268
2025-06-04 08:01:13,559 - [*] Evaluating all samples:
2025-06-04 08:01:13,559 - [*] year 2017, testing
2025-06-04 08:01:21,010 - T:3	MAE	21.6515	RMSE	33.7337	MAPE	13.5020
2025-06-04 08:01:32,747 - T:6	MAE	23.3299	RMSE	36.2838	MAPE	14.7664
2025-06-04 08:01:50,776 - T:12	MAE	26.5201	RMSE	41.0046	MAPE	17.5279
2025-06-04 08:01:52,764 - [*] Evaluating basic traffic samples (prediction=0):
2025-06-04 08:01:52,764 - [*] year 2017, testing
2025-06-04 08:01:58,899 - T:3	MAE	21.6509	RMSE	33.7329	MAPE	13.5022
2025-06-04 08:02:09,414 - T:6	MAE	23.3293	RMSE	36.2830	MAPE	14.7666
2025-06-04 08:02:26,565 - T:12	MAE	26.5197	RMSE	41.0038	MAPE	17.5283
2025-06-04 08:02:26,566 - [*] Evaluating event traffic samples (prediction=1):
2025-06-04 08:02:26,566 - [*] year 2017, testing
2025-06-04 08:02:26,566 - T:3	MAE	35.5036	RMSE	49.5009	MAPE	11.2707
2025-06-04 08:02:26,567 - T:6	MAE	37.5075	RMSE	51.8875	MAPE	12.4801
2025-06-04 08:02:26,567 - T:12	MAE	39.6583	RMSE	55.1873	MAPE	13.0946
2025-06-04 08:02:26,583 - Finished optimization, total time:1341.58 s, best model:res/GBA/gba-0.1moco2025-06-04-07:26:12.180267/2017/26.7271.pkl

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 936799.09it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1015230.77it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1038792.39it/s]

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 1000502.82it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1024335.55it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1021428.44it/s]
2025-06-04 08:04:50,352 - [*] Year 2018 load from data/GBA/FastData/2018_30day.npz
2025-06-04 08:04:50,412 - Secure SignIn[*] load from res/GBA/gba-0.1moco2025-06-04-07:26:12.180267/2017/26.7271.pkl
2025-06-04 08:04:50,541 - [*] detect strategy feature
2025-06-04 08:04:59,290 - [*] replay node number 300
2025-06-04 08:04:59,598 - number of increase nodes:324, nodes after 2 hop:torch.Size([2091]), total nodes this year 2321
2025-06-04 08:05:40,322 - [*] Year 2018 Dataset load!
2025-06-04 08:05:40,322 - Secure SignIn[*] load from res/GBA/gba-0.1moco2025-06-04-07:26:12.180267/2017/26.7271.pkl
2025-06-04 08:05:40,399 - [*] EWC! lambda 0.000100
2025-06-04 08:06:09,760 - [*] Model parameter count: 8842
2025-06-04 08:06:09,762 - [*] Year 2018 Training start
2025-06-04 08:06:11,840 - node number torch.Size([267648, 24])
2025-06-04 08:07:01,720 - epoch:0, training loss:1724.4384 validation loss:26.1301, moco loss:0.7094
2025-06-04 08:07:54,257 - epoch:1, training loss:1698.5304 validation loss:25.0432, moco loss:9.1404
2025-06-04 08:08:47,214 - epoch:2, training loss:1704.9974 validation loss:25.2675, moco loss:3.9428
2025-06-04 08:09:40,228 - epoch:3, training loss:1700.5063 validation loss:25.5086, moco loss:8.0714
2025-06-04 08:10:33,164 - epoch:4, training loss:1700.8464 validation loss:25.8638, moco loss:9.9172
2025-06-04 08:11:25,626 - epoch:5, training loss:1702.7484 validation loss:25.1778, moco loss:3.0806
2025-06-04 08:12:18,436 - epoch:6, training loss:1700.6414 validation loss:25.0657, moco loss:4.1801
2025-06-04 08:13:11,410 - epoch:7, training loss:1707.0355 validation loss:26.2980, moco loss:30.4781
2025-06-04 08:13:22,741 - [*]Test--basic_loss:1666.4949, event_loss:358.2908, test_loss:1668.9540
2025-06-04 08:13:23,097 - [*] Evaluating all samples:
2025-06-04 08:13:23,097 - [*] year 2018, testing
2025-06-04 08:13:23,158 - T:3	MAE	19.3915	RMSE	32.0744	MAPE	13.5884
2025-06-04 08:13:23,234 - T:6	MAE	20.9932	RMSE	34.9054	MAPE	14.9198
2025-06-04 08:13:23,346 - T:12	MAE	23.9737	RMSE	39.6613	MAPE	17.5971
2025-06-04 08:13:23,663 - [*] Evaluating basic traffic samples (prediction=0):
2025-06-04 08:13:23,664 - [*] year 2018, testing
2025-06-04 08:13:23,669 - T:3	MAE	6.1410	RMSE	8.0311	MAPE	8.1299
2025-06-04 08:13:23,673 - T:6	MAE	6.8029	RMSE	9.0802	MAPE	8.5087
2025-06-04 08:13:23,678 - T:12	MAE	8.3793	RMSE	11.5322	MAPE	10.0994
2025-06-04 08:13:23,678 - [*] Evaluating event traffic samples (prediction=1):
2025-06-04 08:13:23,678 - [*] year 2018, testing
2025-06-04 08:13:23,678 - T:3	MAE	20.0340	RMSE	22.4423	MAPE	9.9460
2025-06-04 08:13:23,679 - T:6	MAE	24.1415	RMSE	27.3572	MAPE	11.8495
2025-06-04 08:13:23,679 - T:12	MAE	28.7023	RMSE	34.0145	MAPE	14.0762
2025-06-04 08:13:23,679 - Finished optimization, total time:343.98 s, best model:res/GBA/gba-0.1moco2025-06-04-07:26:12.180267/2018/25.0432.pkl

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 951202.57it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 944310.19it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1043105.69it/s]

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 932966.60it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1041135.08it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1022316.62it/s]
2025-06-04 08:15:48,865 - [*] Year 2019 load from data/GBA/FastData/2019_30day.npz
2025-06-04 08:15:48,949 - Secure SignIn[*] load from res/GBA/gba-0.1moco2025-06-04-07:26:12.180267/2018/25.0432.pkl
2025-06-04 08:15:49,091 - [*] detect strategy feature
2025-06-04 08:15:58,161 - [*] replay node number 300
2025-06-04 08:15:58,794 - number of increase nodes:336, nodes after 2 hop:torch.Size([2114]), total nodes this year 2352
2025-06-04 08:16:59,231 - [*] Year 2019 Dataset load!
2025-06-04 08:16:59,232 - Secure SignIn[*] load from res/GBA/gba-0.1moco2025-06-04-07:26:12.180267/2018/25.0432.pkl
2025-06-04 08:16:59,307 - [*] EWC! lambda 0.000100
2025-06-04 08:17:28,974 - [*] Model parameter count: 8842
2025-06-04 08:17:28,975 - [*] Year 2019 Training start
2025-06-04 08:17:31,343 - node number torch.Size([270592, 24])
2025-06-04 08:18:22,049 - epoch:0, training loss:1701.7565 validation loss:24.7812, moco loss:2.6471
2025-06-04 08:19:15,371 - epoch:1, training loss:1666.0994 validation loss:25.0026, moco loss:4.0802
2025-06-04 08:20:08,742 - epoch:2, training loss:1667.4062 validation loss:24.7576, moco loss:1.1186
2025-06-04 08:21:02,598 - epoch:3, training loss:1670.0820 validation loss:24.6998, moco loss:16.1677
2025-06-04 08:21:56,463 - epoch:4, training loss:1668.8927 validation loss:25.8782, moco loss:6.3645
2025-06-04 08:22:50,154 - epoch:5, training loss:1667.4961 validation loss:24.9149, moco loss:49.5790
2025-06-04 08:23:44,123 - epoch:6, training loss:1673.3039 validation loss:24.5324, moco loss:23.9004
2025-06-04 08:24:37,978 - epoch:7, training loss:1668.4324 validation loss:25.0312, moco loss:1.0701
2025-06-04 08:25:31,391 - epoch:8, training loss:1666.7583 validation loss:25.2823, moco loss:20.7143
2025-06-04 08:26:25,060 - epoch:9, training loss:1664.7283 validation loss:24.8323, moco loss:5.7399
2025-06-04 08:27:18,807 - epoch:10, training loss:1668.9231 validation loss:24.7550, moco loss:4.9171
2025-06-04 08:28:12,141 - epoch:11, training loss:1670.1807 validation loss:24.8266, moco loss:27.1922
2025-06-04 08:29:05,770 - epoch:12, training loss:1670.9566 validation loss:26.1223, moco loss:12.1399
2025-06-04 08:29:17,298 - [*]Test--basic_loss:1739.8171, event_loss:7.1868, test_loss:1739.7914
2025-06-04 08:29:17,649 - [*] Evaluating all samples:
2025-06-04 08:29:17,649 - [*] year 2019, testing
2025-06-04 08:29:17,806 - T:3	MAE	23.4728	RMSE	34.9791	MAPE	15.2882
2025-06-04 08:29:17,878 - T:6	MAE	25.5179	RMSE	38.3359	MAPE	16.5126
2025-06-04 08:29:17,986 - T:12	MAE	29.2643	RMSE	44.3150	MAPE	19.2360
2025-06-04 08:29:18,322 - [*] Evaluating basic traffic samples (prediction=0):
2025-06-04 08:29:18,323 - [*] year 2019, testing
2025-06-04 08:29:18,328 - T:3	MAE	27.9295	RMSE	39.0105	MAPE	10.6749
2025-06-04 08:29:18,333 - T:6	MAE	29.6088	RMSE	41.7207	MAPE	11.3259
2025-06-04 08:29:18,339 - T:12	MAE	32.1713	RMSE	45.9661	MAPE	12.2057
2025-06-04 08:29:18,339 - [*] Evaluating event traffic samples (prediction=1):
2025-06-04 08:29:18,339 - [*] year 2019, testing
2025-06-04 08:29:18,339 - T:3	MAE	31.5039	RMSE	35.9064	MAPE	9.3445
2025-06-04 08:29:18,339 - T:6	MAE	27.5030	RMSE	30.6566	MAPE	8.4859
2025-06-04 08:29:18,339 - T:12	MAE	26.2835	RMSE	29.8299	MAPE	8.5723
2025-06-04 08:29:18,340 - Finished optimization, total time:568.10 s, best model:res/GBA/gba-0.1moco2025-06-04-07:26:12.180267/2019/24.5324.pkl

  0%|          | 0/63243 [00:00<?, ?it/s]
100%|██████████| 63243/63243 [00:00<00:00, 925345.16it/s]

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 912394.21it/s]

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 968223.68it/s]

  0%|          | 0/63243 [00:00<?, ?it/s]
100%|██████████| 63243/63243 [00:00<00:00, 983181.37it/s]

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 1041400.66it/s]

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 1028631.35it/s]
2025-06-04 08:31:43,775 - [*] Year 2020 load from data/GBA/FastData/2020_30day.npz
2025-06-04 08:31:43,857 - Secure SignIn[*] load from res/GBA/gba-0.1moco2025-06-04-07:26:12.180267/2019/24.5324.pkl
2025-06-04 08:31:43,975 - [*] detect strategy feature
2025-06-04 08:31:52,747 - [*] replay node number 300
2025-06-04 08:31:53,041 - number of increase nodes:303, nodes after 2 hop:torch.Size([2095]), total nodes this year 2352
2025-06-04 08:32:53,038 - [*] Year 2020 Dataset load!
2025-06-04 08:32:53,038 - Secure SignIn[*] load from res/GBA/gba-0.1moco2025-06-04-07:26:12.180267/2019/24.5324.pkl
2025-06-04 08:32:53,109 - [*] EWC! lambda 0.000100
2025-06-04 08:33:22,815 - [*] Model parameter count: 8842
2025-06-04 08:33:22,816 - [*] Year 2020 Training start
2025-06-04 08:33:25,072 - node number torch.Size([268160, 24])
2025-06-04 08:34:15,326 - epoch:0, training loss:1178.1146 validation loss:22.7519, moco loss:15.4550
2025-06-04 08:35:07,703 - epoch:1, training loss:1155.9033 validation loss:22.6043, moco loss:10.4374
2025-06-04 08:36:00,750 - epoch:2, training loss:1158.5790 validation loss:21.9647, moco loss:6.4157
2025-06-04 08:36:53,579 - epoch:3, training loss:1152.3617 validation loss:22.1713, moco loss:0.9062
2025-06-04 08:37:46,588 - epoch:4, training loss:1155.1471 validation loss:21.2363, moco loss:29.3542
2025-06-04 08:38:39,889 - epoch:5, training loss:1154.5748 validation loss:22.5200, moco loss:2.3637
2025-06-04 08:39:32,801 - epoch:6, training loss:1154.5865 validation loss:21.7283, moco loss:3.7222
2025-06-04 08:40:25,730 - epoch:7, training loss:1156.3629 validation loss:20.7671, moco loss:6.8213
2025-06-04 08:41:19,014 - epoch:8, training loss:1154.2382 validation loss:21.5311, moco loss:1.4164
2025-06-04 08:42:12,080 - epoch:9, training loss:1149.9852 validation loss:22.2280, moco loss:8.9710
2025-06-04 08:43:05,291 - epoch:10, training loss:1155.9916 validation loss:20.6921, moco loss:39.5278
2025-06-04 08:43:58,871 - epoch:11, training loss:1150.3677 validation loss:21.7748, moco loss:0.8931
2025-06-04 08:44:51,693 - epoch:12, training loss:1154.5607 validation loss:21.5970, moco loss:7.3535
2025-06-04 08:45:44,790 - epoch:13, training loss:1149.3814 validation loss:21.0435, moco loss:4.6709
2025-06-04 08:46:37,830 - epoch:14, training loss:1154.6907 validation loss:22.4125, moco loss:6.3014
2025-06-04 08:47:31,092 - epoch:15, training loss:1151.9818 validation loss:22.9888, moco loss:14.6576
2025-06-04 08:48:24,254 - epoch:16, training loss:1153.0686 validation loss:23.4642, moco loss:27.2945
2025-06-04 08:48:35,534 - [*]Test--basic_loss:1010.6386, event_loss:0.0000, test_loss:1010.6386
2025-06-04 08:48:35,847 - [*] Evaluating all samples:
2025-06-04 08:48:35,847 - [*] year 2020, testing
2025-06-04 08:48:35,907 - T:3	MAE	19.0464	RMSE	28.6052	MAPE	15.0232
2025-06-04 08:48:35,983 - T:6	MAE	18.8064	RMSE	28.3263	MAPE	14.7100
2025-06-04 08:48:36,101 - T:12	MAE	18.9737	RMSE	29.1220	MAPE	15.0171
2025-06-04 08:48:36,413 - [*] Evaluating basic traffic samples (prediction=0):
2025-06-04 08:48:36,413 - [*] year 2020, testing
2025-06-04 08:48:36,418 - T:3	MAE	8.4849	RMSE	10.2682	MAPE	8.6262
2025-06-04 08:48:36,422 - T:6	MAE	8.6305	RMSE	10.7266	MAPE	8.2621
2025-06-04 08:48:36,428 - T:12	MAE	9.5871	RMSE	12.4350	MAPE	8.4006
2025-06-04 08:48:36,428 - Finished optimization, total time:735.17 s, best model:res/GBA/gba-0.1moco2025-06-04-07:26:12.180267/2020/20.6921.pkl
2025-06-04 08:48:36,529 - 3	mae	21.65	19.39	23.47	19.05	
2025-06-04 08:48:36,529 - 3	rmse	33.73	32.07	34.98	28.61	
2025-06-04 08:48:36,529 - 3	mape	13.50	13.59	15.29	15.02	
2025-06-04 08:48:36,529 - 6	mae	23.33	20.99	25.52	18.81	
2025-06-04 08:48:36,529 - 6	rmse	36.28	34.91	38.34	28.33	
2025-06-04 08:48:36,529 - 6	mape	14.77	14.92	16.51	14.71	
2025-06-04 08:48:36,529 - 12	mae	26.52	23.97	29.26	18.97	
2025-06-04 08:48:36,529 - 12	rmse	41.00	39.66	44.32	29.12	
2025-06-04 08:48:36,529 - 12	mape	17.53	17.60	19.24	15.02	
2025-06-04 08:48:36,529 - year	2017	total_time	1341.5774059999999	average_time	44.71926293333333	epoch	30
2025-06-04 08:48:36,529 - year	2018	total_time	343.98068600000005	average_time	42.997602625	epoch	8
2025-06-04 08:48:36,529 - year	2019	total_time	568.1039089999999	average_time	43.70031438461539	epoch	13
2025-06-04 08:48:36,529 - year	2020	total_time	735.1733649999999	average_time	43.245507352941175	epoch	17
python: can't open file '/home/bd2/ANATS/TrafficStream/maian_moco.py': [Errno 2] No such file or directory
2025-06-04 08:59:11,853 - logger name:res/GLA/gla2025-06-04-08:59:11.852056/gla.log
2025-06-04 08:59:11,853 - params : {'conf': 'conf/gla.json', 'paral': 0, 'gpuid': 0, 'logname': 'gla', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/GBA/gba2025-06-04-03:03:30.637631/2018/26.2626.pkl', 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/GLA/finaldata/', 'save_data_path': 'data/GLA/FastData/', 'graph_path': 'data/GLA/graph/', 'model_path': 'res/GLA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'classifier': {'hidden_dim': 128}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 300, 'extra_feature': False, 'moco': True, 'momentum_type': 'linear', 'memory_size': 32, 'expand': True, 'time': '2025-06-04-08:59:11.852056', 'path': 'res/GLA/gla2025-06-04-08:59:11.852056', 'device': device(type='cuda', index=0), 'logger': <Logger __main__ (INFO)>}

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 818679.06it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 974405.24it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 768680.29it/s]

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 991562.46it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1025550.74it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1008219.41it/s]
2025-06-04 09:01:24,305 - [*] Year 2017 load from data/GLA/FastData/2017_30day.npz
/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-06-04 09:01:24,577 - [*] Year 2017 Dataset load!
2025-06-04 09:01:24,581 - [*] Model parameter count: 8842
2025-06-04 09:01:24,581 - [*] Year 2017 Training start
2025-06-04 09:01:25,458 - node number torch.Size([232960, 24])
2025-06-04 09:02:04,683 - epoch:0, training loss:8709.5739 validation loss:32.6756, moco loss:1.0158
2025-06-04 09:02:44,414 - epoch:1, training loss:2646.2883 validation loss:31.5931, moco loss:9.7264
2025-06-04 09:03:24,354 - epoch:2, training loss:2470.1058 validation loss:30.4624, moco loss:76.6555
2025-06-04 09:04:04,118 - epoch:3, training loss:2432.3110 validation loss:30.3498, moco loss:43.3275
2025-06-04 09:04:44,021 - epoch:4, training loss:2415.8396 validation loss:29.8484, moco loss:84.2213
2025-06-04 09:05:23,927 - epoch:5, training loss:2410.5612 validation loss:29.9525, moco loss:134.6849
2025-06-04 09:06:04,111 - epoch:6, training loss:2393.0863 validation loss:30.1986, moco loss:158.3931
2025-06-04 09:06:44,300 - epoch:7, training loss:2378.3377 validation loss:29.7026, moco loss:308.9826
2025-06-04 09:07:24,361 - epoch:8, training loss:2364.2181 validation loss:29.5419, moco loss:190.7429
2025-06-04 09:08:04,490 - epoch:9, training loss:2356.0313 validation loss:29.3479, moco loss:86.8254
2025-06-04 09:08:44,609 - epoch:10, training loss:2344.4609 validation loss:29.5242, moco loss:28.8874
2025-06-04 09:09:24,643 - epoch:11, training loss:2340.6291 validation loss:29.4798, moco loss:150.7598
2025-06-04 09:10:04,565 - epoch:12, training loss:2327.4614 validation loss:29.3219, moco loss:64.6339
2025-06-04 09:10:44,712 - epoch:13, training loss:2324.5788 validation loss:29.2477, moco loss:45.3263
2025-06-04 09:11:24,980 - epoch:14, training loss:2326.9824 validation loss:29.4782, moco loss:34.7201
2025-06-04 09:12:04,901 - epoch:15, training loss:2318.5476 validation loss:29.6216, moco loss:46.8118
2025-06-04 09:12:44,653 - epoch:16, training loss:2316.4933 validation loss:29.1202, moco loss:55.7236
2025-06-04 09:13:24,518 - epoch:17, training loss:2311.7433 validation loss:29.0352, moco loss:109.0437
2025-06-04 09:14:04,571 - epoch:18, training loss:2308.3964 validation loss:29.7160, moco loss:28.7913
2025-06-04 09:14:44,445 - epoch:19, training loss:2307.7600 validation loss:29.3032, moco loss:31.4575
2025-06-04 09:15:24,376 - epoch:20, training loss:2304.2325 validation loss:28.8925, moco loss:22.1287
2025-06-04 09:16:04,207 - epoch:21, training loss:2297.4971 validation loss:29.6531, moco loss:72.1787
2025-06-04 09:16:44,246 - epoch:22, training loss:2280.4404 validation loss:29.2225, moco loss:58.0477
2025-06-04 09:17:24,088 - epoch:23, training loss:2261.9011 validation loss:28.7120, moco loss:67.1197
2025-06-04 09:18:04,065 - epoch:24, training loss:2253.2777 validation loss:28.8368, moco loss:67.9489
2025-06-04 09:18:44,053 - epoch:25, training loss:2243.5689 validation loss:28.6330, moco loss:42.5821
2025-06-04 09:19:24,267 - epoch:26, training loss:2230.2865 validation loss:28.5103, moco loss:59.6792
2025-06-04 09:20:04,382 - epoch:27, training loss:2239.3237 validation loss:28.8173, moco loss:25.3499
2025-06-04 09:20:44,222 - epoch:28, training loss:2218.1273 validation loss:29.0262, moco loss:47.7992
2025-06-04 09:21:24,402 - epoch:29, training loss:2221.7702 validation loss:28.7691, moco loss:55.8644
2025-06-04 09:22:04,601 - epoch:30, training loss:2212.0018 validation loss:28.3981, moco loss:64.0154
2025-06-04 09:22:44,534 - epoch:31, training loss:2210.5138 validation loss:28.8437, moco loss:32.1593
2025-06-04 09:23:24,498 - epoch:32, training loss:2208.5777 validation loss:28.7365, moco loss:20.1262
2025-06-04 09:24:04,239 - epoch:33, training loss:2202.6341 validation loss:28.5441, moco loss:99.4587
2025-06-04 09:24:44,463 - epoch:34, training loss:2195.7860 validation loss:29.2147, moco loss:24.4240
2025-06-04 09:25:24,894 - epoch:35, training loss:2200.1962 validation loss:28.6096, moco loss:13.5065
2025-06-04 09:26:05,211 - epoch:36, training loss:2202.5536 validation loss:28.4636, moco loss:73.9578
2025-06-04 09:26:14,145 - [*]Test--basic_loss:2199.1945, event_loss:592.7979, test_loss:2199.9911
2025-06-04 09:26:15,122 - [*] Evaluating all samples:
2025-06-04 09:26:15,122 - [*] year 2017, testing
2025-06-04 09:26:20,913 - T:3	MAE	22.2246	RMSE	35.1719	MAPE	9.5021
2025-06-04 09:26:30,073 - T:6	MAE	24.3995	RMSE	38.4327	MAPE	10.3853
2025-06-04 09:26:43,980 - T:12	MAE	28.2586	RMSE	44.0006	MAPE	12.1672
2025-06-04 09:26:45,540 - [*] Evaluating basic traffic samples (prediction=0):
2025-06-04 09:26:45,540 - [*] year 2017, testing
2025-06-04 09:26:50,421 - T:3	MAE	22.2187	RMSE	35.1658	MAPE	9.4985
2025-06-04 09:26:57,792 - T:6	MAE	24.3940	RMSE	38.4293	MAPE	10.3805
2025-06-04 09:27:10,386 - T:12	MAE	28.2474	RMSE	43.9884	MAPE	12.1586
2025-06-04 09:27:10,392 - [*] Evaluating event traffic samples (prediction=1):
2025-06-04 09:27:10,392 - [*] year 2017, testing
2025-06-04 09:27:10,400 - T:3	MAE	24.9459	RMSE	37.9215	MAPE	11.1783
2025-06-04 09:27:10,411 - T:6	MAE	26.9701	RMSE	39.9375	MAPE	12.6162
2025-06-04 09:27:10,425 - T:12	MAE	33.3938	RMSE	49.3241	MAPE	16.1782
2025-06-04 09:27:10,438 - Finished optimization, total time:1169.46 s, best model:res/GLA/gla2025-06-04-08:59:11.852056/2017/28.3981.pkl

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 1016394.19it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1004223.55it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1063909.91it/s]

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 1026446.80it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1011121.27it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1020305.63it/s]
2025-06-04 09:30:16,055 - [*] Year 2018 load from data/GLA/FastData/2018_30day.npz
2025-06-04 09:30:16,114 - Secure SignIn[*] load from res/GLA/gla2025-06-04-08:59:11.852056/2017/28.3981.pkl
2025-06-04 09:30:16,207 - [*] detect strategy feature
Traceback (most recent call last):
  File "/home/bd2/ANATS/TrafficStream/main_moco.py", line 600, in <module>
    main(args)
  File "/home/bd2/ANATS/TrafficStream/main_moco.py", line 514, in main
    args.logger.info("[*] replay node number {}".format(args.replay_num_samples))
                                                        ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Namespace' object has no attribute 'replay_num_samples'. Did you mean: 'repaly_num_samples'?
2025-06-07 00:17:54,708 - logger name:res/GLA/gla2025-06-07-00:17:54.706568/gla.log
2025-06-07 00:17:54,708 - params : {'conf': 'conf/gla.json', 'paral': 0, 'gpuid': 7, 'logname': 'gla', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/GLA/gla2025-06-04-08:59:11.852056/2017/28.633.pkl', 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/GLA/finaldata/', 'save_data_path': 'data/GLA/FastData/', 'graph_path': 'data/GLA/graph/', 'model_path': 'res/GLA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'classifier': {'hidden_dim': 128}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'replay_num_samples': 300, 'extra_feature': False, 'moco': True, 'momentum_type': 'linear', 'memory_size': 32, 'expand': True, 'time': '2025-06-07-00:17:54.706568', 'path': 'res/GLA/gla2025-06-07-00:17:54.706568', 'device': device(type='cuda', index=7), 'logger': <Logger __main__ (INFO)>}
2025-06-07 00:17:54,808 - [*] Year 2017 load from data/GLA/FastData/2017_30day.npz
/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-06-07 00:19:10,077 - [*] Year 2017 Dataset load!
2025-06-07 00:19:10,115 - [*] Model parameter count: 8842
2025-06-07 00:19:10,115 - [*] Year 2017 Training start
2025-06-07 00:19:10,992 - node number torch.Size([232960, 24])
2025-06-07 00:19:50,642 - epoch:0, training loss:8752.9806 validation loss:32.7356, moco loss:0.9714
2025-06-07 00:20:31,343 - epoch:1, training loss:2643.7759 validation loss:31.3996, moco loss:31.2910
2025-06-07 00:21:11,464 - epoch:2, training loss:2476.6112 validation loss:30.5691, moco loss:84.2439
2025-06-07 00:21:51,401 - epoch:3, training loss:2438.4607 validation loss:30.3662, moco loss:62.6332
2025-06-07 00:22:31,530 - epoch:4, training loss:2419.9159 validation loss:29.7935, moco loss:70.9222
2025-06-07 00:23:11,701 - epoch:5, training loss:2414.7235 validation loss:29.9796, moco loss:125.9929
2025-06-07 00:23:52,234 - epoch:6, training loss:2407.9727 validation loss:30.3707, moco loss:135.9664
2025-06-07 00:24:32,565 - epoch:7, training loss:2398.8087 validation loss:29.6685, moco loss:283.9232
2025-06-07 00:25:12,824 - epoch:8, training loss:2385.7164 validation loss:29.5437, moco loss:170.7735
2025-06-07 00:25:53,054 - epoch:9, training loss:2375.9445 validation loss:29.4633, moco loss:83.4844
2025-06-07 00:26:33,164 - epoch:10, training loss:2361.8733 validation loss:29.3877, moco loss:117.6658
2025-06-07 00:27:13,126 - epoch:11, training loss:2353.9477 validation loss:29.7003, moco loss:109.7170
2025-06-07 00:27:53,310 - epoch:12, training loss:2341.1122 validation loss:29.5483, moco loss:64.1869
2025-06-07 00:28:33,737 - epoch:13, training loss:2337.5932 validation loss:29.3149, moco loss:64.0711
2025-06-07 00:29:13,983 - epoch:14, training loss:2333.3824 validation loss:29.7379, moco loss:100.7309
2025-06-07 00:29:53,928 - epoch:15, training loss:2325.7119 validation loss:29.2526, moco loss:76.9953
2025-06-07 00:30:34,023 - epoch:16, training loss:2324.0264 validation loss:29.2685, moco loss:47.1173
2025-06-07 00:31:14,216 - epoch:17, training loss:2317.6907 validation loss:29.0555, moco loss:92.3418
2025-06-07 00:31:54,386 - epoch:18, training loss:2312.6440 validation loss:29.6964, moco loss:23.5169
2025-06-07 00:32:34,638 - epoch:19, training loss:2309.8850 validation loss:29.2380, moco loss:48.5623
2025-06-07 00:33:14,938 - epoch:20, training loss:2310.1019 validation loss:29.0271, moco loss:25.1868
2025-06-07 00:33:55,268 - epoch:21, training loss:2308.7345 validation loss:29.2036, moco loss:64.0655
2025-06-07 00:34:35,760 - epoch:22, training loss:2305.5668 validation loss:29.5725, moco loss:30.0979
2025-06-07 00:35:16,129 - epoch:23, training loss:2302.9491 validation loss:29.0502, moco loss:41.8223
2025-06-07 00:35:56,281 - epoch:24, training loss:2298.9227 validation loss:29.1117, moco loss:26.1523
2025-06-07 00:36:37,193 - epoch:25, training loss:2284.1216 validation loss:28.6918, moco loss:22.8108
2025-06-07 00:37:17,559 - epoch:26, training loss:2258.9782 validation loss:28.6376, moco loss:12.5294
2025-06-07 00:37:57,708 - epoch:27, training loss:2260.7427 validation loss:29.0223, moco loss:10.5103
2025-06-07 00:38:37,987 - epoch:28, training loss:2235.1491 validation loss:29.0641, moco loss:28.3507
2025-06-07 00:39:18,228 - epoch:29, training loss:2233.7253 validation loss:29.2299, moco loss:7.7563
2025-06-07 00:39:58,823 - epoch:30, training loss:2225.8758 validation loss:28.5691, moco loss:14.2842
2025-06-07 00:40:38,737 - epoch:31, training loss:2222.1625 validation loss:29.2747, moco loss:43.6396
2025-06-07 00:41:18,932 - epoch:32, training loss:2215.0936 validation loss:28.5675, moco loss:27.8290
2025-06-07 00:41:59,588 - epoch:33, training loss:2211.2290 validation loss:28.3920, moco loss:100.9606
2025-06-07 00:42:40,073 - epoch:34, training loss:2202.7479 validation loss:29.3034, moco loss:22.3879
2025-06-07 00:43:20,483 - epoch:35, training loss:2206.7010 validation loss:28.7457, moco loss:32.9526
2025-06-07 00:44:00,779 - epoch:36, training loss:2206.3671 validation loss:28.3679, moco loss:20.0330
2025-06-07 00:44:40,931 - epoch:37, training loss:2199.4637 validation loss:28.6235, moco loss:5.1868
2025-06-07 00:45:21,606 - epoch:38, training loss:2196.7331 validation loss:28.3624, moco loss:7.1109
2025-06-07 00:46:02,089 - epoch:39, training loss:2195.3772 validation loss:28.9469, moco loss:16.0273
2025-06-07 00:46:42,418 - epoch:40, training loss:2192.2177 validation loss:28.2561, moco loss:12.4590
2025-06-07 00:47:22,801 - epoch:41, training loss:2185.0502 validation loss:28.7875, moco loss:5.0461
2025-06-07 00:48:03,539 - epoch:42, training loss:2195.0256 validation loss:28.7075, moco loss:15.9221
2025-06-07 00:48:43,914 - epoch:43, training loss:2191.5592 validation loss:28.3663, moco loss:50.5665
2025-06-07 00:49:24,543 - epoch:44, training loss:2184.4062 validation loss:28.8121, moco loss:42.8360
2025-06-07 00:50:05,056 - epoch:45, training loss:2186.1790 validation loss:28.2718, moco loss:43.2366
2025-06-07 00:50:45,086 - epoch:46, training loss:2186.2224 validation loss:28.6406, moco loss:21.2375
2025-06-07 00:50:54,130 - [*]Test--basic_loss:2188.1610, event_loss:0.0000, test_loss:2188.1610
2025-06-07 00:50:55,180 - [*] Evaluating all samples:
2025-06-07 00:50:55,180 - [*] year 2017, testing
2025-06-07 00:51:02,685 - T:3	MAE	22.1553	RMSE	35.1583	MAPE	9.4267
2025-06-07 00:51:14,865 - T:6	MAE	24.3381	RMSE	38.4454	MAPE	10.3283
2025-06-07 00:51:45,713 - T:12	MAE	28.1195	RMSE	43.9105	MAPE	11.9814
2025-06-07 00:51:45,722 - Finished optimization, total time:1479.82 s, best model:res/GLA/gla2025-06-07-00:17:54.706568/2017/28.2561.pkl
2025-06-07 00:51:46,010 - [*] Year 2018 load from data/GLA/FastData/2018_30day.npz
2025-06-07 00:51:46,055 - Secure SignIn[*] load from res/GLA/gla2025-06-07-00:17:54.706568/2017/28.2561.pkl
2025-06-07 00:51:46,164 - [*] detect strategy feature
2025-06-07 00:51:54,177 - [*] replay node number 300
2025-06-07 00:52:40,989 - number of increase nodes:322, nodes after 2 hop:torch.Size([1698]), total nodes this year 1843
2025-06-07 00:54:33,373 - [*] Year 2018 Dataset load!
2025-06-07 00:54:33,374 - Secure SignIn[*] load from res/GLA/gla2025-06-07-00:17:54.706568/2017/28.2561.pkl
2025-06-07 00:54:33,443 - [*] EWC! lambda 0.000100
2025-06-07 00:55:29,291 - [*] Model parameter count: 8842
2025-06-07 00:55:29,291 - [*] Year 2018 Training start
2025-06-07 00:55:32,231 - node number torch.Size([217344, 24])
2025-06-07 00:56:10,366 - epoch:0, training loss:1949.6749 validation loss:28.5231, moco loss:9.1873
2025-06-07 00:56:51,924 - epoch:1, training loss:1874.8723 validation loss:28.3369, moco loss:20.4761
2025-06-07 00:57:32,958 - epoch:2, training loss:1872.8816 validation loss:28.9380, moco loss:4.5283
2025-06-07 00:58:13,826 - epoch:3, training loss:1880.8614 validation loss:29.3479, moco loss:2.5272
2025-06-07 00:58:55,671 - epoch:4, training loss:1888.3239 validation loss:29.5697, moco loss:9.6472
2025-06-07 00:59:36,024 - epoch:5, training loss:1878.2525 validation loss:28.6748, moco loss:25.4388
2025-06-07 01:00:16,441 - epoch:6, training loss:1882.9320 validation loss:28.6703, moco loss:3.2053
2025-06-07 01:00:56,999 - epoch:7, training loss:1879.7491 validation loss:29.2040, moco loss:5.7535
2025-06-07 01:01:05,906 - [*]Test--basic_loss:1865.3009, event_loss:51.0931, test_loss:1865.5100
2025-06-07 01:01:06,136 - [*] Evaluating all samples:
2025-06-07 01:01:06,137 - [*] year 2018, testing
2025-06-07 01:01:06,207 - T:3	MAE	26.0908	RMSE	38.7566	MAPE	11.4455
2025-06-07 01:01:06,294 - T:6	MAE	26.6534	RMSE	40.5605	MAPE	12.0780
2025-06-07 01:01:06,423 - T:12	MAE	26.5273	RMSE	41.0458	MAPE	12.5293
2025-06-07 01:01:06,424 - Finished optimization, total time:264.62 s, best model:res/GLA/gla2025-06-07-00:17:54.706568/2018/28.3369.pkl
2025-06-07 01:01:06,783 - [*] Year 2019 load from data/GLA/FastData/2019_30day.npz
2025-06-07 01:01:06,810 - Secure SignIn[*] load from res/GLA/gla2025-06-07-00:17:54.706568/2018/28.3369.pkl
2025-06-07 01:01:06,899 - [*] detect strategy feature
2025-06-07 01:01:14,740 - [*] replay node number 300
2025-06-07 01:02:07,686 - number of increase nodes:304, nodes after 2 hop:torch.Size([1712]), total nodes this year 1859
2025-06-07 01:03:54,097 - [*] Year 2019 Dataset load!
2025-06-07 01:03:54,097 - Secure SignIn[*] load from res/GLA/gla2025-06-07-00:17:54.706568/2018/28.3369.pkl
2025-06-07 01:03:54,166 - [*] EWC! lambda 0.000100
2025-06-07 01:04:52,043 - [*] Model parameter count: 8842
2025-06-07 01:04:52,048 - [*] Year 2019 Training start
2025-06-07 01:04:54,557 - node number torch.Size([219136, 24])
2025-06-07 01:05:33,420 - epoch:0, training loss:1733.5875 validation loss:27.4921, moco loss:14.8178
2025-06-07 01:06:15,365 - epoch:1, training loss:1706.8506 validation loss:27.0892, moco loss:72.8552
2025-06-07 01:06:57,964 - epoch:2, training loss:1697.2379 validation loss:27.7701, moco loss:14.8301
2025-06-07 01:07:39,119 - epoch:3, training loss:1702.9198 validation loss:27.1107, moco loss:20.3696
2025-06-07 01:08:21,442 - epoch:4, training loss:1708.1807 validation loss:27.6402, moco loss:38.9918
2025-06-07 01:09:05,511 - epoch:5, training loss:1696.1647 validation loss:27.8549, moco loss:8.7968
2025-06-07 01:09:49,158 - epoch:6, training loss:1698.0969 validation loss:27.4847, moco loss:11.0249
2025-06-07 01:10:31,441 - epoch:7, training loss:1695.2269 validation loss:27.8896, moco loss:79.5304
2025-06-07 01:10:41,190 - [*]Test--basic_loss:2020.7915, event_loss:60.9206, test_loss:2020.9705
2025-06-07 01:10:41,581 - [*] Evaluating all samples:
2025-06-07 01:10:41,582 - [*] year 2019, testing
2025-06-07 01:10:41,650 - T:3	MAE	24.0407	RMSE	36.4285	MAPE	9.9618
2025-06-07 01:10:41,719 - T:6	MAE	23.8629	RMSE	36.0332	MAPE	10.1542
2025-06-07 01:10:41,830 - T:12	MAE	23.8696	RMSE	36.0185	MAPE	11.0311
2025-06-07 01:10:41,831 - Finished optimization, total time:274.06 s, best model:res/GLA/gla2025-06-07-00:17:54.706568/2019/27.0892.pkl
2025-06-07 01:10:42,162 - [*] Year 2020 load from data/GLA/FastData/2020_30day.npz
2025-06-07 01:10:42,193 - Secure SignIn[*] load from res/GLA/gla2025-06-07-00:17:54.706568/2019/27.0892.pkl
2025-06-07 01:10:42,300 - [*] detect strategy feature
2025-06-07 01:10:51,999 - [*] replay node number 300
2025-06-07 01:11:33,268 - number of increase nodes:287, nodes after 2 hop:torch.Size([1744]), total nodes this year 1859
2025-06-07 01:22:13,120 - [*] Year 2020 Dataset load!
2025-06-07 01:22:13,121 - Secure SignIn[*] load from res/GLA/gla2025-06-07-00:17:54.706568/2019/27.0892.pkl
2025-06-07 01:22:13,212 - [*] EWC! lambda 0.000100
2025-06-07 01:53:28,246 - [*] Model parameter count: 8842
2025-06-07 01:53:28,247 - [*] Year 2020 Training start
2025-06-07 01:53:32,086 - node number torch.Size([223232, 24])
2025-06-07 01:54:16,410 - epoch:0, training loss:1489.5110 validation loss:26.3771, moco loss:12.7723
2025-06-07 01:55:03,795 - epoch:1, training loss:1424.6341 validation loss:25.8695, moco loss:16.6313
2025-06-07 01:55:49,961 - epoch:2, training loss:1425.2827 validation loss:25.7931, moco loss:11.8055
2025-06-07 01:56:37,229 - epoch:3, training loss:1417.2963 validation loss:26.8253, moco loss:15.8334
2025-06-07 01:57:26,097 - epoch:4, training loss:1420.0669 validation loss:24.6947, moco loss:17.2081
2025-06-07 01:58:17,247 - epoch:5, training loss:1422.5105 validation loss:24.2001, moco loss:118.6034
2025-06-07 01:59:04,239 - epoch:6, training loss:1421.2778 validation loss:24.4959, moco loss:37.9697
2025-06-07 01:59:54,651 - epoch:7, training loss:1413.8548 validation loss:26.0540, moco loss:10.5124
2025-06-07 02:00:45,734 - epoch:8, training loss:1414.6774 validation loss:24.9485, moco loss:3.8150
2025-06-07 02:01:34,423 - epoch:9, training loss:1414.3179 validation loss:26.0370, moco loss:68.3701
2025-06-07 02:02:22,067 - epoch:10, training loss:1418.9136 validation loss:25.9928, moco loss:6.6483
2025-06-07 02:03:13,285 - epoch:11, training loss:1406.0225 validation loss:26.0925, moco loss:25.6864
2025-06-07 02:03:24,817 - [*]Test--basic_loss:1493.1091, event_loss:29.1658, test_loss:1493.1959
2025-06-07 02:03:25,259 - [*] Evaluating all samples:
2025-06-07 02:03:25,260 - [*] year 2020, testing
2025-06-07 02:03:25,347 - T:3	MAE	26.0855	RMSE	39.0456	MAPE	12.6034
2025-06-07 02:03:25,476 - T:6	MAE	25.5923	RMSE	38.4131	MAPE	12.2624
2025-06-07 02:03:25,624 - T:12	MAE	25.4062	RMSE	38.0509	MAPE	12.3804
2025-06-07 02:03:25,625 - Finished optimization, total time:465.62 s, best model:res/GLA/gla2025-06-07-00:17:54.706568/2020/24.2001.pkl
2025-06-07 02:03:26,044 - 3	mae	22.16	26.09	24.04	26.09	
2025-06-07 02:03:26,044 - 3	rmse	35.16	38.76	36.43	39.05	
2025-06-07 02:03:26,044 - 3	mape	9.43	11.45	9.96	12.60	
2025-06-07 02:03:26,044 - 6	mae	24.34	26.65	23.86	25.59	
2025-06-07 02:03:26,044 - 6	rmse	38.45	40.56	36.03	38.41	
2025-06-07 02:03:26,044 - 6	mape	10.33	12.08	10.15	12.26	
2025-06-07 02:03:26,044 - 12	mae	28.12	26.53	23.87	25.41	
2025-06-07 02:03:26,044 - 12	rmse	43.91	41.05	36.02	38.05	
2025-06-07 02:03:26,044 - 12	mape	11.98	12.53	11.03	12.38	
2025-06-07 02:03:26,044 - year	2017	total_time	1479.817719	average_time	31.485496361702126	epoch	47
2025-06-07 02:03:26,044 - year	2018	total_time	264.619064	average_time	33.077397250000004	epoch	8
2025-06-07 02:03:26,045 - year	2019	total_time	274.06222899999995	average_time	34.257797	epoch	8
2025-06-07 02:03:26,045 - year	2020	total_time	465.62078	average_time	38.80174916666667	epoch	12
2025-06-07 02:12:44,911 - logger name:res/GLA/gla2025-06-07-02:12:44.909296/gla.log
2025-06-07 02:12:44,911 - params : {'conf': 'conf/gla.json', 'paral': 0, 'gpuid': 7, 'logname': 'gla', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/GLA/gla2025-06-04-08:59:11.852056/2017/28.633.pkl', 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/GLA/finaldata/', 'save_data_path': 'data/GLA/FastData/', 'graph_path': 'data/GLA/graph/', 'model_path': 'res/GLA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'classifier': {'hidden_dim': 128}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'replay_num_samples': 300, 'extra_feature': False, 'moco': True, 'momentum_type': 'linear', 'memory_size': 32, 'expand': True, 'time': '2025-06-07-02:12:44.909296', 'path': 'res/GLA/gla2025-06-07-02:12:44.909296', 'device': device(type='cuda', index=7), 'logger': <Logger __main__ (INFO)>}
2025-06-07 02:12:45,044 - [*] Year 2017 load from data/GLA/FastData/2017_30day.npz
/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-06-08 00:13:40,500 - logger name:res/GLA/gla2025-06-08-00:13:40.498147/gla.log
2025-06-08 00:13:40,500 - params : {'conf': 'conf/gla.json', 'paral': 0, 'gpuid': 7, 'logname': 'gla', 'load_first_year': 1, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/GLA/gla2025-06-07-13:14:09.479779/2017/29.0289.pkl', 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/GLA/finaldata/', 'save_data_path': 'data/GLA/FastData/', 'graph_path': 'data/GLA/graph/', 'model_path': 'res/GLA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'classifier': {'hidden_dim': 128}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'replay_num_samples': 300, 'extra_feature': False, 'moco': True, 'momentum_type': 'linear', 'memory_size': 32, 'expand': True, 'time': '2025-06-08-00:13:40.498147', 'path': 'res/GLA/gla2025-06-08-00:13:40.498147', 'device': device(type='cuda', index=7), 'logger': <Logger __main__ (INFO)>}
2025-06-08 00:13:40,617 - [*] Year 2017 load from data/GLA/FastData/2017_30day.npz
2025-06-08 00:13:40,890 - Secure SignIn[*] load from /home/bd2/ANATS/TrafficStream/res/GLA/gla2025-06-07-13:14:09.479779/2017/29.0289.pkl
/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-06-08 00:14:01,334 - [*]Test--basic_loss:2398.3436, event_loss:813.6349, test_loss:2313.7494
2025-06-08 00:14:02,301 - [*] Evaluating all samples:
2025-06-08 00:14:02,302 - [*] year 2017, testing
2025-06-08 00:14:08,124 - T:3	MAE	22.4488	RMSE	35.4589	MAPE	9.6390
2025-06-08 00:14:17,461 - T:6	MAE	24.7425	RMSE	38.9497	MAPE	10.7960
2025-06-08 00:14:31,694 - T:12	MAE	28.8888	RMSE	45.1333	MAPE	13.0299
2025-06-08 00:14:31,837 - [*] Year 2018 load from data/GLA/FastData/2018_30day.npz
2025-06-08 00:14:31,867 - Secure SignIn[*] load from /home/bd2/ANATS/TrafficStream/res/GLA/gla2025-06-07-13:14:09.479779/2017/29.0289.pkl
2025-06-08 00:14:31,955 - [*] detect strategy feature
2025-06-08 00:14:39,634 - [*] replay node number 300
2025-06-08 00:15:01,092 - number of increase nodes:320, nodes after 2 hop:torch.Size([1696]), total nodes this year 1843
2025-06-08 00:16:17,578 - [*] Year 2018 Dataset load!
2025-06-08 00:16:17,578 - Secure SignIn[*] load from /home/bd2/ANATS/TrafficStream/res/GLA/gla2025-06-07-13:14:09.479779/2017/29.0289.pkl
2025-06-08 00:16:17,643 - [*] EWC! lambda 0.000100
2025-06-08 00:17:00,514 - [*] Model parameter count: 8842
2025-06-08 00:17:00,515 - [*] Year 2018 Training start
2025-06-08 00:17:02,484 - node number torch.Size([217088, 24])
2025-06-08 00:17:45,969 - epoch:0, training loss:2052.5678 validation loss:30.3950, moco loss:12.4748
2025-06-08 00:18:29,268 - epoch:1, training loss:2020.6431 validation loss:29.3589, moco loss:40.5067
2025-06-08 00:19:11,759 - epoch:2, training loss:2002.1792 validation loss:29.2487, moco loss:29.1243
2025-06-08 00:19:54,539 - epoch:3, training loss:1994.3801 validation loss:29.5237, moco loss:5.8334
2025-06-08 00:20:37,562 - epoch:4, training loss:1997.7904 validation loss:29.2163, moco loss:21.4851
2025-06-08 00:21:19,900 - epoch:5, training loss:1995.8340 validation loss:29.4245, moco loss:2.5301
2025-06-08 00:22:03,364 - epoch:6, training loss:1984.7340 validation loss:29.4933, moco loss:2.5738
2025-06-08 00:22:44,953 - epoch:7, training loss:1990.8858 validation loss:29.0285, moco loss:2.8894
2025-06-08 00:23:25,611 - epoch:8, training loss:1990.1478 validation loss:29.1446, moco loss:11.4104
2025-06-08 00:24:09,836 - epoch:9, training loss:1991.4593 validation loss:29.4268, moco loss:12.7922
2025-06-08 00:24:52,652 - epoch:10, training loss:1992.4709 validation loss:29.8543, moco loss:6.8624
2025-06-08 00:25:35,783 - epoch:11, training loss:1994.7166 validation loss:29.0931, moco loss:5.0561
2025-06-08 00:26:17,485 - epoch:12, training loss:1993.1674 validation loss:29.5352, moco loss:4.3846
2025-06-08 00:26:59,093 - epoch:13, training loss:1986.0986 validation loss:29.2074, moco loss:49.7678
2025-06-08 00:27:09,364 - [*]Test--basic_loss:2105.2827, event_loss:655.6162, test_loss:2103.8281
2025-06-08 00:27:09,700 - [*] Evaluating all samples:
2025-06-08 00:27:09,700 - [*] year 2018, testing
2025-06-08 00:27:09,763 - T:3	MAE	24.8242	RMSE	38.5207	MAPE	11.8512
2025-06-08 00:27:09,884 - T:6	MAE	25.4449	RMSE	39.8975	MAPE	11.9696
2025-06-08 00:27:09,990 - T:12	MAE	26.4596	RMSE	41.3612	MAPE	12.1446
2025-06-08 00:27:09,991 - Finished optimization, total time:475.61 s, best model:res/GLA/gla2025-06-08-00:13:40.498147/2018/29.0285.pkl
2025-06-08 00:27:10,274 - [*] Year 2019 load from data/GLA/FastData/2019_30day.npz
2025-06-08 00:27:10,298 - Secure SignIn[*] load from res/GLA/gla2025-06-08-00:13:40.498147/2018/29.0285.pkl
2025-06-08 00:27:10,382 - [*] detect strategy feature
2025-06-08 00:27:17,775 - [*] replay node number 300
2025-06-08 00:27:39,088 - number of increase nodes:305, nodes after 2 hop:torch.Size([1707]), total nodes this year 1859
2025-06-08 00:28:55,968 - [*] Year 2019 Dataset load!
2025-06-08 00:28:55,969 - Secure SignIn[*] load from res/GLA/gla2025-06-08-00:13:40.498147/2018/29.0285.pkl
2025-06-08 00:28:56,029 - [*] EWC! lambda 0.000100
2025-06-08 00:29:39,723 - [*] Model parameter count: 8842
2025-06-08 00:29:39,724 - [*] Year 2019 Training start
2025-06-08 00:29:41,761 - node number torch.Size([218496, 24])
2025-06-08 00:30:25,336 - epoch:0, training loss:1853.4797 validation loss:27.8205, moco loss:15.4523
2025-06-08 00:31:09,217 - epoch:1, training loss:1809.7299 validation loss:27.8418, moco loss:50.0650
2025-06-08 00:31:50,329 - epoch:2, training loss:1804.1521 validation loss:28.1848, moco loss:11.1664
2025-06-08 00:32:34,212 - epoch:3, training loss:1801.1492 validation loss:27.9498, moco loss:3.1105
2025-06-08 00:33:19,814 - epoch:4, training loss:1804.7094 validation loss:27.9648, moco loss:33.7466
2025-06-08 00:34:01,678 - epoch:5, training loss:1805.1514 validation loss:27.7214, moco loss:9.5854
2025-06-08 00:34:50,935 - epoch:6, training loss:1808.6437 validation loss:27.8757, moco loss:10.0942
2025-06-08 00:35:34,563 - epoch:7, training loss:1800.3436 validation loss:28.1045, moco loss:4.8966
2025-06-08 00:36:17,677 - epoch:8, training loss:1799.1075 validation loss:28.0219, moco loss:6.1409
2025-06-08 00:36:58,881 - epoch:9, training loss:1803.9638 validation loss:28.6174, moco loss:2.9676
2025-06-08 00:37:42,120 - epoch:10, training loss:1800.5708 validation loss:27.8558, moco loss:16.4171
2025-06-08 00:38:23,073 - epoch:11, training loss:1799.4499 validation loss:28.1438, moco loss:4.8339
2025-06-08 00:38:31,436 - [*]Test--basic_loss:1831.2909, event_loss:320.5378, test_loss:1831.6479
2025-06-08 00:38:31,692 - [*] Evaluating all samples:
2025-06-08 00:38:31,693 - [*] year 2019, testing
2025-06-08 00:38:31,749 - T:3	MAE	27.5656	RMSE	41.8502	MAPE	11.7261
2025-06-08 00:38:31,820 - T:6	MAE	26.9587	RMSE	41.1111	MAPE	11.9215
2025-06-08 00:38:31,931 - T:12	MAE	27.3638	RMSE	41.5096	MAPE	12.8866
2025-06-08 00:38:31,932 - Finished optimization, total time:425.83 s, best model:res/GLA/gla2025-06-08-00:13:40.498147/2019/27.7214.pkl
2025-06-08 00:38:32,207 - [*] Year 2020 load from data/GLA/FastData/2020_30day.npz
2025-06-08 00:38:32,238 - Secure SignIn[*] load from res/GLA/gla2025-06-08-00:13:40.498147/2019/27.7214.pkl
2025-06-08 00:38:32,323 - [*] detect strategy feature
2025-06-08 00:38:39,732 - [*] replay node number 300
2025-06-08 00:39:00,928 - number of increase nodes:288, nodes after 2 hop:torch.Size([1744]), total nodes this year 1859
2025-06-08 00:40:23,213 - [*] Year 2020 Dataset load!
2025-06-08 00:40:23,214 - Secure SignIn[*] load from res/GLA/gla2025-06-08-00:13:40.498147/2019/27.7214.pkl
2025-06-08 00:40:23,297 - [*] EWC! lambda 0.000100
2025-06-08 00:41:26,350 - [*] Model parameter count: 8842
2025-06-08 00:41:26,351 - [*] Year 2020 Training start
2025-06-08 00:41:28,359 - node number torch.Size([223232, 24])
2025-06-08 00:42:11,501 - epoch:0, training loss:1545.8833 validation loss:25.5678, moco loss:6.5441
2025-06-08 00:42:57,951 - epoch:1, training loss:1482.2211 validation loss:27.0343, moco loss:4.4165
2025-06-08 00:43:40,961 - epoch:2, training loss:1480.3051 validation loss:27.4091, moco loss:11.3724
2025-06-08 00:44:26,519 - epoch:3, training loss:1483.8116 validation loss:25.2386, moco loss:7.3921
2025-06-08 00:45:12,619 - epoch:4, training loss:1479.5798 validation loss:24.8716, moco loss:12.5495
2025-06-08 00:45:55,278 - epoch:5, training loss:1478.0867 validation loss:24.6218, moco loss:4.9864
2025-06-08 00:46:37,171 - epoch:6, training loss:1480.6540 validation loss:25.3011, moco loss:13.6794
2025-06-08 00:47:20,813 - epoch:7, training loss:1475.7614 validation loss:25.1076, moco loss:1.2087
2025-06-08 00:48:02,836 - epoch:8, training loss:1474.7495 validation loss:26.5196, moco loss:10.1169
2025-06-08 00:48:47,988 - epoch:9, training loss:1483.8962 validation loss:26.4479, moco loss:15.5153
2025-06-08 00:49:32,476 - epoch:10, training loss:1479.8811 validation loss:25.8789, moco loss:3.4037
2025-06-08 00:50:21,968 - epoch:11, training loss:1475.9171 validation loss:25.5306, moco loss:9.4377
2025-06-08 00:50:31,872 - [*]Test--basic_loss:1520.9725, event_loss:11.5170, test_loss:1520.9907
2025-06-08 00:50:32,161 - [*] Evaluating all samples:
2025-06-08 00:50:32,162 - [*] year 2020, testing
2025-06-08 00:50:32,218 - T:3	MAE	20.5384	RMSE	29.9436	MAPE	10.6784
2025-06-08 00:50:32,287 - T:6	MAE	21.9468	RMSE	32.3434	MAPE	11.2579
2025-06-08 00:50:32,387 - T:12	MAE	24.7482	RMSE	36.8814	MAPE	12.4680
2025-06-08 00:50:32,388 - Finished optimization, total time:434.92 s, best model:res/GLA/gla2025-06-08-00:13:40.498147/2020/24.6218.pkl
2025-06-08 00:50:32,549 - 3	mae	22.45	24.82	27.57	20.54	
2025-06-08 00:50:32,549 - 3	rmse	35.46	38.52	41.85	29.94	
2025-06-08 00:50:32,549 - 3	mape	9.64	11.85	11.73	10.68	
2025-06-08 00:50:32,549 - 6	mae	24.74	25.44	26.96	21.95	
2025-06-08 00:50:32,549 - 6	rmse	38.95	39.90	41.11	32.34	
2025-06-08 00:50:32,549 - 6	mape	10.80	11.97	11.92	11.26	
2025-06-08 00:50:32,549 - 12	mae	28.89	26.46	27.36	24.75	
2025-06-08 00:50:32,549 - 12	rmse	45.13	41.36	41.51	36.88	
2025-06-08 00:50:32,549 - 12	mape	13.03	12.14	12.89	12.47	
2025-06-08 00:50:32,549 - year	2018	total_time	475.61202399999996	average_time	33.972304214285714	epoch	14
2025-06-08 00:50:32,549 - year	2019	total_time	425.83354599999996	average_time	35.48614216666667	epoch	12
2025-06-08 00:50:32,549 - year	2020	total_time	434.919651	average_time	36.24332125	epoch	12
2025-06-08 02:19:38,401 - logger name:res/GLA/gla2025-06-08-02:19:38.399426/gla.log
2025-06-08 02:19:38,401 - params : {'conf': 'conf/gla.json', 'paral': 0, 'gpuid': 7, 'logname': 'gla', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/GLA/gla2025-06-07-13:14:09.479779/2017/29.0289.pkl', 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/GLA/finaldata/', 'save_data_path': 'data/GLA/FastData/', 'graph_path': 'data/GLA/graph/', 'model_path': 'res/GLA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'classifier': {'hidden_dim': 128}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'replay_num_samples': 300, 'extra_feature': False, 'moco': True, 'momentum_type': 'linear', 'memory_size': 32, 'expand': True, 'time': '2025-06-08-02:19:38.399426', 'path': 'res/GLA/gla2025-06-08-02:19:38.399426', 'device': device(type='cuda', index=7), 'logger': <Logger __main__ (INFO)>}
2025-06-08 02:19:38,519 - [*] Year 2017 load from data/GLA/FastData/2017_30day.npz
/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-06-08 02:20:51,041 - [*] Year 2017 Dataset load!
2025-06-08 02:20:51,077 - [*] Model parameter count: 8842
2025-06-08 02:20:51,077 - [*] Year 2017 Training start
2025-06-08 02:20:51,844 - node number torch.Size([232960, 24])
2025-06-08 02:21:41,937 - epoch:0, training loss:8911.2484 validation loss:32.7246, moco loss:2.2827
2025-06-08 02:22:25,943 - epoch:1, training loss:2629.5793 validation loss:31.4413, moco loss:2.9111
2025-06-08 02:23:07,971 - epoch:2, training loss:2466.9090 validation loss:30.6083, moco loss:21.7130
2025-06-08 02:23:53,691 - epoch:3, training loss:2443.8206 validation loss:30.0305, moco loss:21.6567
2025-06-08 02:24:37,781 - epoch:4, training loss:2435.5441 validation loss:30.0054, moco loss:44.2455
2025-06-08 02:25:27,265 - epoch:5, training loss:2442.0690 validation loss:29.9875, moco loss:108.2853
2025-06-08 02:26:16,811 - epoch:6, training loss:2453.3235 validation loss:30.5002, moco loss:134.3951
2025-06-08 02:27:03,712 - epoch:7, training loss:2451.7675 validation loss:29.7137, moco loss:167.4202
2025-06-08 02:27:47,778 - epoch:8, training loss:2444.3510 validation loss:30.3145, moco loss:195.1971
2025-06-08 02:28:33,627 - epoch:9, training loss:2437.7109 validation loss:29.5400, moco loss:150.4909
2025-06-08 02:29:20,574 - epoch:10, training loss:2420.8551 validation loss:29.3089, moco loss:163.0035
2025-06-08 02:30:07,580 - epoch:11, training loss:2403.7344 validation loss:29.7792, moco loss:60.1406
2025-06-08 02:30:56,584 - epoch:12, training loss:2384.6020 validation loss:29.4282, moco loss:96.3131
2025-06-08 02:31:42,639 - epoch:13, training loss:2380.5133 validation loss:29.4307, moco loss:71.2207
2025-06-08 02:32:37,423 - epoch:14, training loss:2370.0283 validation loss:29.9466, moco loss:88.4034
2025-06-08 02:33:23,531 - epoch:15, training loss:2365.6965 validation loss:29.1750, moco loss:48.8004
2025-06-08 02:34:10,072 - epoch:16, training loss:2358.9263 validation loss:29.5177, moco loss:36.6930
2025-06-08 02:34:52,133 - epoch:17, training loss:2342.4089 validation loss:29.4204, moco loss:87.6747
2025-06-08 02:35:34,641 - epoch:18, training loss:2338.2066 validation loss:29.8184, moco loss:34.1020
2025-06-08 02:36:18,526 - epoch:19, training loss:2331.1431 validation loss:29.2127, moco loss:51.9561
2025-06-08 02:37:01,009 - epoch:20, training loss:2323.1812 validation loss:29.1518, moco loss:12.0894
2025-06-08 02:37:42,581 - epoch:21, training loss:2321.6238 validation loss:29.4989, moco loss:24.8580
2025-06-08 02:38:29,891 - epoch:22, training loss:2317.1186 validation loss:29.8158, moco loss:6.6550
2025-06-08 02:39:15,959 - epoch:23, training loss:2316.7318 validation loss:29.3412, moco loss:17.7845
2025-06-08 02:40:00,530 - epoch:24, training loss:2311.2619 validation loss:29.3228, moco loss:36.6107
2025-06-08 02:40:46,781 - epoch:25, training loss:2310.0031 validation loss:28.9904, moco loss:15.4316
2025-06-08 02:41:29,883 - epoch:26, training loss:2301.6168 validation loss:28.9485, moco loss:11.0400
2025-06-08 02:42:15,982 - epoch:27, training loss:2311.1884 validation loss:29.0969, moco loss:3.2337
2025-06-08 02:42:58,654 - epoch:28, training loss:2295.7035 validation loss:29.6018, moco loss:20.3673
2025-06-08 02:43:47,478 - epoch:29, training loss:2297.9867 validation loss:29.6470, moco loss:5.4494
2025-06-08 02:44:31,192 - epoch:30, training loss:2297.0932 validation loss:29.4153, moco loss:29.7223
2025-06-08 02:45:17,039 - epoch:31, training loss:2294.2155 validation loss:29.2597, moco loss:23.0634
2025-06-08 02:46:03,248 - epoch:32, training loss:2292.0144 validation loss:28.8330, moco loss:20.1721
2025-06-08 02:46:53,056 - epoch:33, training loss:2295.6136 validation loss:29.0874, moco loss:21.1444
2025-06-08 02:47:42,058 - epoch:34, training loss:2286.6911 validation loss:29.6045, moco loss:7.1720
2025-06-08 02:48:21,740 - epoch:35, training loss:2293.2611 validation loss:28.9429, moco loss:22.8598
2025-06-08 02:49:05,444 - epoch:36, training loss:2296.1221 validation loss:28.9286, moco loss:9.6009
2025-06-08 02:49:50,634 - epoch:37, training loss:2288.3888 validation loss:29.0996, moco loss:2.2560
2025-06-08 02:50:37,169 - epoch:38, training loss:2289.8628 validation loss:28.8715, moco loss:3.5923
2025-06-08 02:50:46,111 - [*]Test--basic_loss:2299.2583, event_loss:46.7315, test_loss:2299.1721
2025-06-08 02:50:47,086 - [*] Evaluating all samples:
2025-06-08 02:50:47,087 - [*] year 2017, testing
2025-06-08 02:50:52,902 - T:3	MAE	22.2905	RMSE	35.2860	MAPE	9.6930
2025-06-08 02:51:02,056 - T:6	MAE	24.5741	RMSE	38.7916	MAPE	10.8178
2025-06-08 02:51:15,883 - T:12	MAE	28.6935	RMSE	44.9250	MAPE	13.1149
2025-06-08 02:51:15,892 - Finished optimization, total time:1406.05 s, best model:res/GLA/gla2025-06-08-02:19:38.399426/2017/28.833.pkl
2025-06-08 02:51:16,251 - [*] Year 2018 load from data/GLA/FastData/2018_30day.npz
2025-06-08 02:51:16,295 - Secure SignIn[*] load from res/GLA/gla2025-06-08-02:19:38.399426/2017/28.833.pkl
2025-06-08 02:51:16,459 - [*] detect strategy feature
2025-06-08 02:51:25,218 - [*] replay node number 300
2025-06-08 02:51:58,606 - number of increase nodes:318, nodes after 2 hop:torch.Size([1696]), total nodes this year 1843
2025-06-08 02:53:17,163 - [*] Year 2018 Dataset load!
2025-06-08 02:53:17,163 - Secure SignIn[*] load from res/GLA/gla2025-06-08-02:19:38.399426/2017/28.833.pkl
2025-06-08 02:53:17,217 - [*] EWC! lambda 0.000100
2025-06-08 02:53:58,656 - [*] Model parameter count: 8842
2025-06-08 02:53:58,658 - [*] Year 2018 Training start
2025-06-08 02:54:00,933 - node number torch.Size([217088, 24])
2025-06-08 02:54:43,082 - epoch:0, training loss:2027.8684 validation loss:29.0114, moco loss:10.8234
2025-06-08 02:55:27,481 - epoch:1, training loss:1964.8346 validation loss:28.9914, moco loss:17.2289
2025-06-08 02:56:09,095 - epoch:2, training loss:1967.3057 validation loss:29.1048, moco loss:4.9216
2025-06-08 02:56:52,892 - epoch:3, training loss:1973.8627 validation loss:29.1933, moco loss:17.9762
2025-06-08 02:57:34,309 - epoch:4, training loss:1973.2826 validation loss:28.9990, moco loss:15.3073
2025-06-08 02:58:17,959 - epoch:5, training loss:1967.7954 validation loss:29.3671, moco loss:22.3266
2025-06-08 02:59:01,460 - epoch:6, training loss:1972.8006 validation loss:28.9638, moco loss:5.0252
2025-06-08 02:59:43,413 - epoch:7, training loss:1974.4767 validation loss:29.3134, moco loss:15.7701
2025-06-08 03:00:24,831 - epoch:8, training loss:1969.7858 validation loss:28.9377, moco loss:3.7531
2025-06-08 03:01:10,265 - epoch:9, training loss:1973.4749 validation loss:29.2027, moco loss:8.1950
2025-06-08 03:01:54,039 - epoch:10, training loss:1970.1036 validation loss:29.0820, moco loss:1.8442
2025-06-08 03:02:37,869 - epoch:11, training loss:1970.3763 validation loss:29.3080, moco loss:1.5525
2025-06-08 03:03:22,845 - epoch:12, training loss:1976.4786 validation loss:29.6707, moco loss:7.8818
2025-06-08 03:04:05,330 - epoch:13, training loss:1969.2583 validation loss:29.1939, moco loss:10.4187
2025-06-08 03:04:47,761 - epoch:14, training loss:1971.4080 validation loss:29.0527, moco loss:3.7481
2025-06-08 03:04:56,599 - [*]Test--basic_loss:2095.8978, event_loss:311.9821, test_loss:2097.0343
2025-06-08 03:04:56,989 - [*] Evaluating all samples:
2025-06-08 03:04:56,989 - [*] year 2018, testing
2025-06-08 03:04:57,082 - T:3	MAE	24.3174	RMSE	37.7076	MAPE	10.2925
2025-06-08 03:04:57,201 - T:6	MAE	26.2873	RMSE	40.9204	MAPE	11.1793
2025-06-08 03:04:57,344 - T:12	MAE	28.1676	RMSE	42.4520	MAPE	11.1469
2025-06-08 03:04:57,345 - Finished optimization, total time:530.36 s, best model:res/GLA/gla2025-06-08-02:19:38.399426/2018/28.9377.pkl
2025-06-08 03:04:57,630 - [*] Year 2019 load from data/GLA/FastData/2019_30day.npz
2025-06-08 03:04:57,657 - Secure SignIn[*] load from res/GLA/gla2025-06-08-02:19:38.399426/2018/28.9377.pkl
2025-06-08 03:04:57,741 - [*] detect strategy feature
2025-06-08 03:05:06,122 - [*] replay node number 300
2025-06-08 03:05:36,333 - number of increase nodes:304, nodes after 2 hop:torch.Size([1707]), total nodes this year 1859
2025-06-08 03:06:57,531 - [*] Year 2019 Dataset load!
2025-06-08 03:06:57,531 - Secure SignIn[*] load from res/GLA/gla2025-06-08-02:19:38.399426/2018/28.9377.pkl
2025-06-08 03:06:57,593 - [*] EWC! lambda 0.000100
2025-06-08 03:08:05,633 - [*] Model parameter count: 8842
2025-06-08 03:08:05,634 - [*] Year 2019 Training start
2025-06-08 03:08:07,812 - node number torch.Size([218496, 24])
2025-06-08 03:08:49,012 - epoch:0, training loss:1857.9805 validation loss:27.7413, moco loss:6.7713
2025-06-08 03:09:34,118 - epoch:1, training loss:1782.1763 validation loss:27.7495, moco loss:1.7832
2025-06-08 03:10:18,431 - epoch:2, training loss:1790.4882 validation loss:27.6296, moco loss:6.7589
2025-06-08 03:11:02,442 - epoch:3, training loss:1787.6749 validation loss:28.1933, moco loss:9.0291
2025-06-08 03:11:52,596 - epoch:4, training loss:1791.2214 validation loss:27.8061, moco loss:2.1798
2025-06-08 03:12:36,786 - epoch:5, training loss:1793.7757 validation loss:27.7200, moco loss:11.8085
2025-06-08 03:13:23,479 - epoch:6, training loss:1788.6356 validation loss:28.0699, moco loss:0.9441
2025-06-08 03:14:06,611 - epoch:7, training loss:1794.2177 validation loss:28.0233, moco loss:4.0805
2025-06-08 03:14:50,520 - epoch:8, training loss:1790.5894 validation loss:28.0943, moco loss:32.3843
2025-06-08 03:15:00,274 - [*]Test--basic_loss:1822.0123, event_loss:49.3193, test_loss:1822.1293
2025-06-08 03:15:00,614 - [*] Evaluating all samples:
2025-06-08 03:15:00,614 - [*] year 2019, testing
2025-06-08 03:15:00,683 - T:3	MAE	27.8352	RMSE	42.4237	MAPE	12.3191
2025-06-08 03:15:00,827 - T:6	MAE	27.7569	RMSE	42.2466	MAPE	12.2008
2025-06-08 03:15:01,028 - T:12	MAE	28.2423	RMSE	42.6304	MAPE	12.4372
2025-06-08 03:15:01,030 - Finished optimization, total time:328.34 s, best model:res/GLA/gla2025-06-08-02:19:38.399426/2019/27.6296.pkl
2025-06-08 03:15:01,337 - [*] Year 2020 load from data/GLA/FastData/2020_30day.npz
2025-06-08 03:15:01,369 - Secure SignIn[*] load from res/GLA/gla2025-06-08-02:19:38.399426/2019/27.6296.pkl
2025-06-08 03:15:01,507 - [*] detect strategy feature
2025-06-08 03:15:09,978 - [*] replay node number 300
2025-06-08 03:15:40,745 - number of increase nodes:288, nodes after 2 hop:torch.Size([1744]), total nodes this year 1859
2025-06-08 03:17:25,306 - [*] Year 2020 Dataset load!
2025-06-08 03:17:25,307 - Secure SignIn[*] load from res/GLA/gla2025-06-08-02:19:38.399426/2019/27.6296.pkl
2025-06-08 03:17:25,367 - [*] EWC! lambda 0.000100
2025-06-08 03:18:44,908 - [*] Model parameter count: 8842
2025-06-08 03:18:44,910 - [*] Year 2020 Training start
2025-06-08 03:18:47,232 - node number torch.Size([223232, 24])
2025-06-08 03:19:34,376 - epoch:0, training loss:1539.7106 validation loss:26.2570, moco loss:5.7554
2025-06-08 03:20:19,137 - epoch:1, training loss:1476.1103 validation loss:25.4921, moco loss:2.4799
2025-06-08 03:21:02,233 - epoch:2, training loss:1467.8200 validation loss:25.3263, moco loss:2.9922
2025-06-08 03:21:46,863 - epoch:3, training loss:1471.1958 validation loss:26.9675, moco loss:3.1130
2025-06-08 03:22:31,119 - epoch:4, training loss:1468.2552 validation loss:25.3052, moco loss:8.3461
2025-06-08 03:23:15,347 - epoch:5, training loss:1470.4142 validation loss:24.3518, moco loss:29.2956
2025-06-08 03:24:01,836 - epoch:6, training loss:1467.4909 validation loss:24.8320, moco loss:4.5223
2025-06-08 03:24:45,224 - epoch:7, training loss:1462.4056 validation loss:25.9525, moco loss:4.4615
2025-06-08 03:25:30,005 - epoch:8, training loss:1466.4007 validation loss:25.5799, moco loss:1.6637
2025-06-08 03:26:19,741 - epoch:9, training loss:1464.1454 validation loss:25.3070, moco loss:27.9895
2025-06-08 03:27:03,983 - epoch:10, training loss:1466.6745 validation loss:24.9800, moco loss:2.1183
2025-06-08 03:27:53,382 - epoch:11, training loss:1460.8710 validation loss:26.2170, moco loss:25.9088
2025-06-08 03:28:02,029 - [*]Test--basic_loss:1512.4923, event_loss:68.6628, test_loss:1512.8801
2025-06-08 03:28:02,246 - [*] Evaluating all samples:
2025-06-08 03:28:02,246 - [*] year 2020, testing
2025-06-08 03:28:02,303 - T:3	MAE	20.8340	RMSE	30.8192	MAPE	11.2476
2025-06-08 03:28:02,384 - T:6	MAE	22.3624	RMSE	33.3751	MAPE	11.9183
2025-06-08 03:28:02,496 - T:12	MAE	25.4517	RMSE	38.2345	MAPE	13.7271
2025-06-08 03:28:02,497 - Finished optimization, total time:449.77 s, best model:res/GLA/gla2025-06-08-02:19:38.399426/2020/24.3518.pkl
2025-06-08 03:28:02,662 - 3	mae	22.29	24.32	27.84	20.83	
2025-06-08 03:28:02,662 - 3	rmse	35.29	37.71	42.42	30.82	
2025-06-08 03:28:02,662 - 3	mape	9.69	10.29	12.32	11.25	
2025-06-08 03:28:02,662 - 6	mae	24.57	26.29	27.76	22.36	
2025-06-08 03:28:02,662 - 6	rmse	38.79	40.92	42.25	33.38	
2025-06-08 03:28:02,662 - 6	mape	10.82	11.18	12.20	11.92	
2025-06-08 03:28:02,662 - 12	mae	28.69	28.17	28.24	25.45	
2025-06-08 03:28:02,662 - 12	rmse	44.92	42.45	42.63	38.23	
2025-06-08 03:28:02,662 - 12	mape	13.11	11.15	12.44	13.73	
2025-06-08 03:28:02,662 - year	2017	total_time	1406.0521529999999	average_time	36.05263492307692	epoch	39
2025-06-08 03:28:02,662 - year	2018	total_time	530.3601849999999	average_time	35.35735986666667	epoch	15
2025-06-08 03:28:02,663 - year	2019	total_time	328.336305	average_time	36.481825666666666	epoch	9
2025-06-08 03:28:02,663 - year	2020	total_time	449.77376799999996	average_time	37.481162250000004	epoch	12
2025-06-08 03:40:41,362 - logger name:res/CA/ca2025-06-08-03:40:41.360742/ca.log
2025-06-08 03:40:41,362 - params : {'conf': 'conf/ca.json', 'paral': 0, 'gpuid': 7, 'logname': 'ca', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/GLA/gla2025-06-07-13:14:09.479779/2017/29.0289.pkl', 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/CA/finaldata/', 'save_data_path': 'data/CA/FastData/', 'graph_path': 'data/CA/graph/', 'model_path': 'res/CA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'classifier': {'hidden_dim': 128}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'replay_num_samples': 300, 'extra_feature': False, 'moco': True, 'momentum_type': 'linear', 'memory_size': 32, 'expand': True, 'time': '2025-06-08-03:40:41.360742', 'path': 'res/CA/ca2025-06-08-03:40:41.360742', 'device': device(type='cuda', index=7), 'logger': <Logger __main__ (INFO)>}

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 929041.34it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 821227.63it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 955401.31it/s]

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 876154.06it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 817747.11it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 989694.74it/s]
2025-06-08 03:54:58,290 - [*] Year 2017 load from data/CA/FastData/2017_30day.npz
/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-06-08 03:54:59,305 - [*] Year 2017 Dataset load!
2025-06-08 03:54:59,310 - [*] Model parameter count: 8842
2025-06-08 03:54:59,310 - [*] Year 2017 Training start
2025-06-08 03:55:01,513 - node number torch.Size([1049088, 24])
2025-06-08 04:06:01,224 - epoch:0, training loss:5738.4454 validation loss:28.1085, moco loss:1.0176
2025-06-08 04:17:09,648 - epoch:1, training loss:1846.5381 validation loss:27.0661, moco loss:5.5989
2025-06-08 04:28:07,799 - epoch:2, training loss:1703.4697 validation loss:26.1149, moco loss:41.0300
2025-06-08 04:39:07,565 - epoch:3, training loss:1666.5135 validation loss:25.8453, moco loss:12.9644
2025-06-08 04:49:57,634 - epoch:4, training loss:1647.8304 validation loss:25.3408, moco loss:1.4758
2025-06-08 05:01:07,264 - epoch:5, training loss:1636.2904 validation loss:25.6364, moco loss:4.4628
2025-06-08 05:12:12,213 - epoch:6, training loss:1628.6583 validation loss:25.4359, moco loss:5.9755
2025-06-08 05:23:30,734 - epoch:7, training loss:1620.1169 validation loss:25.1280, moco loss:13.3571
2025-06-08 05:34:36,603 - epoch:8, training loss:1612.1046 validation loss:25.5979, moco loss:4.9617
2025-06-08 05:45:43,424 - epoch:9, training loss:1604.9099 validation loss:25.1238, moco loss:4.6043
2025-06-08 05:56:43,085 - epoch:10, training loss:1602.3776 validation loss:24.9427, moco loss:17.0854
2025-06-08 06:07:35,439 - epoch:11, training loss:1599.3944 validation loss:25.6714, moco loss:16.7856
2025-06-08 06:18:19,359 - epoch:12, training loss:1596.3138 validation loss:24.9058, moco loss:8.4745
2025-06-08 06:29:26,391 - epoch:13, training loss:1594.8652 validation loss:25.0618, moco loss:4.8468
2025-06-08 06:40:52,954 - epoch:14, training loss:1594.1021 validation loss:25.8886, moco loss:8.8826
2025-06-08 06:51:45,817 - epoch:15, training loss:1590.2506 validation loss:25.2004, moco loss:2.0037
2025-06-08 07:02:49,045 - epoch:16, training loss:1590.2888 validation loss:25.1531, moco loss:1.3245
2025-06-08 07:13:03,335 - epoch:17, training loss:1586.0457 validation loss:25.1318, moco loss:8.1500
2025-06-08 07:22:50,747 - epoch:18, training loss:1586.6462 validation loss:25.5741, moco loss:2.0675
2025-06-08 07:24:42,396 - [*]Test--basic_loss:1642.7132, event_loss:401.1024, test_loss:1642.1968
2025-06-08 07:25:22,626 - [*] Evaluating all samples:
2025-06-08 07:25:22,626 - [*] year 2017, testing
2025-06-08 07:26:30,147 - T:3	MAE	19.5002	RMSE	30.7779	MAPE	12.6884
2025-06-08 07:27:14,724 - T:6	MAE	21.3497	RMSE	33.8766	MAPE	13.8805
2025-06-08 07:28:19,910 - T:12	MAE	24.7207	RMSE	39.5173	MAPE	16.3577
2025-06-08 07:28:20,408 - Finished optimization, total time:9995.77 s, best model:res/CA/ca2025-06-08-03:40:41.360742/2017/24.9058.pkl

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 915720.90it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 976271.62it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1004052.03it/s]

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 970571.42it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 998187.09it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 980178.45it/s]
2025-06-08 11:35:41,263 - logger name:res/CA/ca2025-06-08-11:35:41.262744/ca.log
2025-06-08 11:35:41,264 - params : {'conf': 'conf/ca.json', 'paral': 0, 'gpuid': 7, 'logname': 'ca', 'load_first_year': 1, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/CA/ca2025-06-08-03:40:41.360742/2017/24.9058.pkl', 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/CA/finaldata/', 'save_data_path': 'data/CA/FastData/', 'graph_path': 'data/CA/graph/', 'model_path': 'res/CA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'classifier': {'hidden_dim': 128}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'replay_num_samples': 300, 'extra_feature': False, 'moco': True, 'momentum_type': 'linear', 'memory_size': 32, 'expand': True, 'time': '2025-06-08-11:35:41.262744', 'path': 'res/CA/ca2025-06-08-11:35:41.262744', 'device': device(type='cuda', index=7), 'logger': <Logger __main__ (INFO)>}
2025-06-08 11:35:41,338 - [*] Loading data for year 2017, current memory usage: 0.00 GB

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 895676.49it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 838190.98it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 997746.59it/s]

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 905161.73it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 852634.03it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1018773.14it/s]
2025-06-08 11:57:01,875 - [*] Year 2017 load from data/CA/FastData/2017_30day.npz, memory usage: 0.00 GB
2025-06-08 11:57:03,065 - Secure SignIn[*] load from /home/bd2/ANATS/TrafficStream/res/CA/ca2025-06-08-03:40:41.360742/2017/24.9058.pkl
/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-06-08 12:00:22,506 - [*]Test--basic_loss:1642.6780, event_loss:222.4397, test_loss:1642.1575
2025-06-08 12:00:22,506 - [*] Evaluating all samples:
2025-06-08 12:00:22,506 - T:3	MAE	19.4989	RMSE	30.7561	MAPE	12.6894
2025-06-08 12:00:22,506 - T:6	MAE	21.3475	RMSE	33.8492	MAPE	13.8811
2025-06-08 12:00:22,506 - T:12	MAE	24.7276	RMSE	39.4837	MAPE	16.3646
2025-06-08 12:00:23,508 - [*] Loading data for year 2018, current memory usage: 0.00 GB

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 968159.55it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1058825.30it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1071629.05it/s]

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 1068408.24it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1003823.42it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1060212.98it/s]
2025-06-08 12:45:47,495 - [*] Year 2018 load from data/CA/FastData/2018_30day.npz, memory usage: 0.00 GB
2025-06-08 12:45:47,785 - Secure SignIn[*] load from /home/bd2/ANATS/TrafficStream/res/CA/ca2025-06-08-03:40:41.360742/2017/24.9058.pkl
2025-06-08 12:45:49,146 - [*] detect strategy feature
2025-06-08 12:46:21,953 - [*] replay node number 300
2025-06-08 12:46:24,134 - number of increase nodes:601, nodes after 2 hop:torch.Size([4982]), total nodes this year 8428
2025-06-08 12:46:24,134 - [*] Large dataset detected (63048 samples), reducing batch size from 128 to 64
2025-06-08 12:48:30,340 - [*] Year 2018 Dataset load!
2025-06-08 12:48:30,340 - [*] Initial memory usage: 0.00 GB
2025-06-08 12:48:30,340 - Secure SignIn[*] load from /home/bd2/ANATS/TrafficStream/res/CA/ca2025-06-08-03:40:41.360742/2017/24.9058.pkl
2025-06-08 12:48:30,930 - [*] EWC! lambda 0.000100
2025-06-08 12:53:10,257 - [*] Model parameter count: 8842
2025-06-08 12:53:10,258 - [*] Year 2018 Training start
2025-06-08 12:53:10,591 - [*] Epoch 0, memory usage: 0.00 GB
2025-06-08 12:53:12,025 - node number torch.Size([318848, 24])
2025-06-08 12:57:10,735 - epoch:0, training loss:1552.3828 validation loss:25.4931, moco loss:10.2112
2025-06-08 13:01:13,288 - epoch:1, training loss:1539.7940 validation loss:26.1514, moco loss:7.9127
2025-06-08 13:05:03,933 - epoch:2, training loss:1541.9123 validation loss:25.7363, moco loss:8.5759
2025-06-08 13:08:51,170 - epoch:3, training loss:1540.1308 validation loss:25.0863, moco loss:8.3410
2025-06-08 13:12:38,768 - epoch:4, training loss:1542.4779 validation loss:26.8506, moco loss:9.0362
2025-06-08 13:16:25,943 - epoch:5, training loss:1539.4785 validation loss:25.1617, moco loss:7.9601
2025-06-08 13:20:14,196 - epoch:6, training loss:1541.4866 validation loss:25.9882, moco loss:8.5929
2025-06-08 13:24:02,921 - epoch:7, training loss:1541.9995 validation loss:26.0342, moco loss:9.4331
2025-06-08 13:27:51,194 - epoch:8, training loss:1538.5534 validation loss:25.2171, moco loss:8.0415
2025-06-08 13:31:39,485 - epoch:9, training loss:1538.3208 validation loss:25.0520, moco loss:7.5158
2025-06-08 13:31:39,712 - [*] Epoch 10, memory usage: 0.00 GB
2025-06-08 13:35:27,302 - epoch:10, training loss:1541.2819 validation loss:25.3155, moco loss:8.5675
2025-06-08 13:39:14,932 - epoch:11, training loss:1536.8693 validation loss:24.9802, moco loss:7.6066
2025-06-08 13:43:02,725 - epoch:12, training loss:1542.0615 validation loss:25.1626, moco loss:8.6839
2025-06-08 13:46:50,987 - epoch:13, training loss:1537.3400 validation loss:25.2692, moco loss:7.1332
2025-06-08 13:50:39,636 - epoch:14, training loss:1538.0205 validation loss:25.9453, moco loss:7.7290
2025-06-08 13:54:28,711 - epoch:15, training loss:1537.6054 validation loss:25.2276, moco loss:7.6223
2025-06-08 13:58:16,945 - epoch:16, training loss:1539.1060 validation loss:25.3323, moco loss:8.0079
2025-06-08 14:02:21,204 - epoch:17, training loss:1535.2528 validation loss:25.1206, moco loss:6.7227
2025-06-08 14:02:21,357 - [*] Training completed, memory usage: 0.00 GB
2025-06-08 14:04:12,159 - [*]Test--basic_loss:2153.8187, event_loss:0.0000, test_loss:2153.8187
2025-06-08 14:04:12,159 - [*] Evaluating all samples:
2025-06-08 14:04:12,159 - T:3	MAE	16.2041	RMSE	22.7060	MAPE	14.3350
2025-06-08 14:04:12,159 - T:6	MAE	17.3163	RMSE	25.0693	MAPE	15.0638
2025-06-08 14:04:12,159 - T:12	MAE	19.6499	RMSE	30.2871	MAPE	16.5565
2025-06-08 14:04:12,160 - Finished optimization, total time:3395.96 s, best model:res/CA/ca2025-06-08-11:35:41.262744/2018/24.9802.pkl
2025-06-08 14:04:13,758 - [*] Year 2018 completed, memory usage: 0.00 GB
2025-06-08 14:04:13,863 - [*] Loading data for year 2019, current memory usage: 0.00 GB

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 996260.14it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1029634.31it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1054860.61it/s]

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 1022653.36it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1053663.13it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1037728.79it/s]
2025-06-08 14:42:31,461 - [*] Year 2019 load from data/CA/FastData/2019_30day.npz, memory usage: 0.00 GB
2025-06-08 14:42:31,875 - Secure SignIn[*] load from res/CA/ca2025-06-08-11:35:41.262744/2018/24.9802.pkl
2025-06-08 14:42:33,706 - [*] detect strategy feature
2025-06-08 14:43:17,448 - [*] replay node number 300
2025-06-08 14:43:19,663 - number of increase nodes:543, nodes after 2 hop:torch.Size([5262]), total nodes this year 8600
2025-06-08 14:43:19,665 - [*] Large dataset detected (63048 samples), reducing batch size from 128 to 64
2025-06-08 14:45:57,533 - [*] Year 2019 Dataset load!
2025-06-08 14:45:57,534 - [*] Initial memory usage: 0.00 GB
2025-06-08 14:45:57,534 - Secure SignIn[*] load from res/CA/ca2025-06-08-11:35:41.262744/2018/24.9802.pkl
2025-06-08 14:45:58,161 - [*] EWC! lambda 0.000100
2025-06-08 14:51:10,930 - [*] Model parameter count: 8842
2025-06-08 14:51:10,935 - [*] Year 2019 Training start
2025-06-08 14:51:14,502 - [*] Epoch 0, memory usage: 0.00 GB
2025-06-08 14:51:16,648 - node number torch.Size([336768, 24])
2025-06-08 14:55:43,381 - epoch:0, training loss:1748.4834 validation loss:25.6246, moco loss:13.4554
2025-06-08 15:00:16,211 - epoch:1, training loss:1736.1541 validation loss:25.1697, moco loss:8.7180
2025-06-08 15:04:50,525 - epoch:2, training loss:1732.3423 validation loss:25.0464, moco loss:8.2032
2025-06-08 15:09:25,245 - epoch:3, training loss:1739.3658 validation loss:25.3188, moco loss:10.6430
2025-06-08 15:13:58,294 - epoch:4, training loss:1736.4512 validation loss:25.2073, moco loss:9.9183
2025-06-08 15:18:30,835 - epoch:5, training loss:1734.9996 validation loss:24.8698, moco loss:9.6765
2025-06-08 15:23:06,994 - epoch:6, training loss:1733.9000 validation loss:25.5180, moco loss:9.1797
2025-06-08 15:27:43,201 - epoch:7, training loss:1733.3558 validation loss:25.1668, moco loss:8.8454
2025-06-08 15:32:18,092 - epoch:8, training loss:1732.5935 validation loss:25.0304, moco loss:8.4844
2025-06-08 15:36:51,304 - epoch:9, training loss:1734.8303 validation loss:26.3657, moco loss:9.6553
2025-06-08 15:36:51,496 - [*] Epoch 10, memory usage: 0.00 GB
2025-06-08 15:41:22,549 - epoch:10, training loss:1735.1364 validation loss:25.2442, moco loss:9.3053
2025-06-08 15:45:59,860 - epoch:11, training loss:1731.3500 validation loss:24.9607, moco loss:8.4931
2025-06-08 15:46:00,055 - [*] Training completed, memory usage: 0.00 GB
2025-06-08 15:48:02,678 - [*]Test--basic_loss:2075.9857, event_loss:0.0000, test_loss:2075.9857
2025-06-08 15:48:02,678 - [*] Evaluating all samples:
2025-06-08 15:48:02,678 - T:3	MAE	13.6217	RMSE	19.6416	MAPE	13.8469
2025-06-08 15:48:02,678 - T:6	MAE	14.8138	RMSE	21.9605	MAPE	14.8587
2025-06-08 15:48:02,678 - T:12	MAE	17.7712	RMSE	28.0149	MAPE	17.3159
2025-06-08 15:48:02,678 - Finished optimization, total time:2677.20 s, best model:res/CA/ca2025-06-08-11:35:41.262744/2019/24.8698.pkl
2025-06-08 15:48:05,721 - [*] Year 2019 completed, memory usage: 0.00 GB
2025-06-08 15:48:05,867 - [*] Loading data for year 2020, current memory usage: 0.00 GB

  0%|          | 0/63243 [00:00<?, ?it/s]
 78%|███████▊  | 49581/63243 [00:00<00:00, 495719.47it/s]
100%|██████████| 63243/63243 [00:00<00:00, 558746.37it/s]

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 864736.02it/s]

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 859482.51it/s]

  0%|          | 0/63243 [00:00<?, ?it/s]
100%|██████████| 63243/63243 [00:00<00:00, 646098.76it/s]

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 680065.86it/s]

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 1075212.78it/s]
2025-06-08 16:08:33,097 - [*] Year 2020 load from data/CA/FastData/2020_30day.npz, memory usage: 0.00 GB
2025-06-08 16:08:33,516 - Secure SignIn[*] load from res/CA/ca2025-06-08-11:35:41.262744/2019/24.8698.pkl
2025-06-08 16:08:34,879 - [*] detect strategy feature
Traceback (most recent call last):
  File "/home/bd2/ANATS/TrafficStream/main_moco.py", line 656, in <module>
    main(args)
  File "/home/bd2/ANATS/TrafficStream/main_moco.py", line 553, in main
    influence_node_list = detect.influence_node_selection(model, args, pre_data, cur_data, pre_graph, cur_graph)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/ANATS/TrafficStream/src/model/detect.py", line 114, in influence_node_selection
    cur_data[i,:,j] = (cur_data[i,:,j] - min(cur_data[i,:,j]))/(max(cur_data[i,:,j]) - min(cur_data[i,:,j]))
                       ~~~~~~~~^^^^^^^
IndexError: index 8561 is out of bounds for axis 0 with size 8561
2025-06-08 17:11:28,242 - logger name:res/CA/ca2025-06-08-17:11:28.241542/ca.log
2025-06-08 17:11:28,243 - params : {'conf': 'conf/ca.json', 'paral': 0, 'gpuid': 7, 'logname': 'ca', 'load_first_year': 1, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/CA/ca2025-06-08-11:35:41.262744/2019/24.8698.pkl', 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/CA/finaldata/', 'save_data_path': 'data/CA/FastData/', 'graph_path': 'data/CA/graph/', 'model_path': 'res/CA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'classifier': {'hidden_dim': 128}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'replay_num_samples': 300, 'extra_feature': False, 'moco': True, 'momentum_type': 'linear', 'memory_size': 32, 'expand': True, 'time': '2025-06-08-17:11:28.241542', 'path': 'res/CA/ca2025-06-08-17:11:28.241542', 'device': device(type='cuda', index=7), 'logger': <Logger __main__ (INFO)>}
2025-06-08 17:11:28,325 - [*] Loading data for year 2017, current memory usage: 0.00 GB

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 894326.00it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 837061.10it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1011921.93it/s]

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 878680.11it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 868848.75it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 958704.57it/s]
2025-06-08 17:21:11,400 - [*] Year 2017 load from data/CA/FastData/2017_30day.npz, memory usage: 0.00 GB
2025-06-08 17:21:12,611 - Secure SignIn[*] load from /home/bd2/ANATS/TrafficStream/res/CA/ca2025-06-08-11:35:41.262744/2019/24.8698.pkl
/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-06-08 17:24:38,245 - [*]Test--basic_loss:1706.9866, event_loss:0.0000, test_loss:1706.9866
2025-06-08 17:24:38,246 - [*] Evaluating all samples:
2025-06-08 17:24:38,246 - T:3	MAE	20.3509	RMSE	31.3117	MAPE	13.5688
2025-06-08 17:24:38,246 - T:6	MAE	22.1530	RMSE	34.4102	MAPE	14.9925
2025-06-08 17:24:38,246 - T:12	MAE	25.6979	RMSE	40.2877	MAPE	18.1366
2025-06-08 17:24:39,110 - [*] Loading data for year 2018, current memory usage: 0.00 GB

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 865003.88it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 814724.82it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1014938.63it/s]

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 807661.26it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 933651.55it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 959111.26it/s]
2025-06-08 18:33:30,033 - [*] Year 2018 load from data/CA/FastData/2018_30day.npz, memory usage: 0.00 GB
2025-06-08 18:33:30,311 - Secure SignIn[*] load from /home/bd2/ANATS/TrafficStream/res/CA/ca2025-06-08-11:35:41.262744/2019/24.8698.pkl
2025-06-08 18:33:31,690 - [*] detect strategy feature
2025-06-08 18:34:03,356 - [*] replay node number 300
2025-06-08 18:34:05,549 - number of increase nodes:601, nodes after 2 hop:torch.Size([5007]), total nodes this year 8428
2025-06-08 18:34:05,550 - [*] Large dataset detected (63048 samples), reducing batch size from 128 to 64
2025-06-08 18:36:04,971 - [*] Year 2018 Dataset load!
2025-06-08 18:36:04,971 - [*] Initial memory usage: 0.00 GB
2025-06-08 18:36:04,972 - Secure SignIn[*] load from /home/bd2/ANATS/TrafficStream/res/CA/ca2025-06-08-11:35:41.262744/2019/24.8698.pkl
2025-06-08 18:36:05,592 - [*] EWC! lambda 0.000100
2025-06-08 18:41:09,028 - [*] Model parameter count: 8842
2025-06-08 18:41:09,029 - [*] Year 2018 Training start
2025-06-08 18:41:09,384 - [*] Epoch 0, memory usage: 0.00 GB
2025-06-08 18:41:10,078 - node number torch.Size([320448, 24])
2025-06-08 18:45:19,797 - epoch:0, training loss:1549.6080 validation loss:25.5300, moco loss:13.7682
2025-06-08 18:49:29,449 - epoch:1, training loss:1530.5282 validation loss:25.8300, moco loss:6.8083
2025-06-08 18:53:48,470 - epoch:2, training loss:1533.5922 validation loss:25.5316, moco loss:7.4700
2025-06-08 18:57:56,587 - epoch:3, training loss:1532.5509 validation loss:25.0948, moco loss:7.3844
2025-06-08 19:02:04,486 - epoch:4, training loss:1535.1866 validation loss:26.4746, moco loss:8.2338
2025-06-08 19:06:13,515 - epoch:5, training loss:1532.2653 validation loss:25.1468, moco loss:7.0694
2025-06-08 19:10:28,047 - epoch:6, training loss:1534.7800 validation loss:25.7464, moco loss:7.8903
2025-06-08 19:14:36,159 - epoch:7, training loss:1534.9189 validation loss:26.2235, moco loss:8.5121
2025-06-08 19:18:45,377 - epoch:8, training loss:1531.7945 validation loss:25.2908, moco loss:7.1806
2025-06-08 19:22:54,972 - epoch:9, training loss:1532.2406 validation loss:25.0508, moco loss:7.0039
2025-06-08 19:22:55,300 - [*] Epoch 10, memory usage: 0.00 GB
2025-06-08 19:27:18,650 - epoch:10, training loss:1534.9318 validation loss:25.2859, moco loss:7.8970
2025-06-08 19:31:24,422 - epoch:11, training loss:1531.2984 validation loss:24.9878, moco loss:7.1787
2025-06-08 19:35:33,272 - epoch:12, training loss:1536.4155 validation loss:25.1174, moco loss:8.1748
2025-06-08 19:39:44,287 - epoch:13, training loss:1531.6415 validation loss:25.2754, moco loss:6.5808
2025-06-08 19:43:52,156 - epoch:14, training loss:1532.6682 validation loss:25.8907, moco loss:7.3278
2025-06-08 19:48:02,628 - epoch:15, training loss:1532.6768 validation loss:25.1343, moco loss:7.2780
2025-06-08 19:52:09,556 - epoch:16, training loss:1534.2717 validation loss:25.3798, moco loss:7.6661
2025-06-08 19:56:15,038 - epoch:17, training loss:1530.2708 validation loss:25.1168, moco loss:6.3724
2025-06-08 19:56:15,212 - [*] Training completed, memory usage: 0.00 GB
2025-06-08 19:58:26,705 - [*]Test--basic_loss:2156.3055, event_loss:0.0000, test_loss:2156.3055
2025-06-08 19:58:26,705 - [*] Evaluating all samples:
2025-06-08 19:58:26,706 - T:3	MAE	16.1896	RMSE	22.6284	MAPE	14.3214
2025-06-08 19:58:26,706 - T:6	MAE	17.2813	RMSE	24.9214	MAPE	15.0459
2025-06-08 19:58:26,706 - T:12	MAE	19.5765	RMSE	30.0383	MAPE	16.5076
2025-06-08 19:58:26,706 - Finished optimization, total time:3709.50 s, best model:res/CA/ca2025-06-08-17:11:28.241542/2018/24.9878.pkl
2025-06-08 19:58:27,658 - [*] Year 2018 completed, memory usage: 0.00 GB
2025-06-08 19:58:27,793 - [*] Loading data for year 2019, current memory usage: 0.00 GB

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 1003272.76it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 1022826.54it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 989550.35it/s]

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 983003.23it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 973286.68it/s]

  0%|          | 0/21023 [00:00<?, ?it/s]
100%|██████████| 21023/21023 [00:00<00:00, 978470.80it/s]
2025-06-08 20:11:24,143 - [*] Year 2019 load from data/CA/FastData/2019_30day.npz, memory usage: 0.00 GB
2025-06-08 20:11:24,475 - Secure SignIn[*] load from res/CA/ca2025-06-08-17:11:28.241542/2018/24.9878.pkl
2025-06-08 20:11:25,820 - [*] detect strategy feature
2025-06-08 20:11:57,388 - [*] replay node number 300
2025-06-08 20:11:59,523 - number of increase nodes:543, nodes after 2 hop:torch.Size([5265]), total nodes this year 8600
2025-06-08 20:11:59,523 - [*] Large dataset detected (63048 samples), reducing batch size from 128 to 64
2025-06-08 20:14:07,653 - [*] Year 2019 Dataset load!
2025-06-08 20:14:07,654 - [*] Initial memory usage: 0.00 GB
2025-06-08 20:14:07,654 - Secure SignIn[*] load from res/CA/ca2025-06-08-17:11:28.241542/2018/24.9878.pkl
2025-06-08 20:14:08,353 - [*] EWC! lambda 0.000100
2025-06-08 20:19:23,966 - [*] Model parameter count: 8842
2025-06-08 20:19:23,966 - [*] Year 2019 Training start
2025-06-08 20:19:24,419 - [*] Epoch 0, memory usage: 0.00 GB
2025-06-08 20:19:25,228 - node number torch.Size([336960, 24])
2025-06-08 20:23:57,805 - epoch:0, training loss:1743.3248 validation loss:25.8438, moco loss:11.9498
2025-06-08 20:28:32,570 - epoch:1, training loss:1732.5333 validation loss:24.9643, moco loss:8.1791
2025-06-08 20:33:06,956 - epoch:2, training loss:1728.9476 validation loss:25.0500, moco loss:7.5844
2025-06-08 20:37:39,637 - epoch:3, training loss:1736.5562 validation loss:25.2993, moco loss:10.0569
2025-06-08 20:42:10,105 - epoch:4, training loss:1733.7168 validation loss:25.2063, moco loss:9.3600
2025-06-08 20:46:42,355 - epoch:5, training loss:1732.7078 validation loss:24.7986, moco loss:9.2455
2025-06-08 20:51:13,507 - epoch:6, training loss:1731.4177 validation loss:25.4999, moco loss:8.7871
2025-06-08 20:55:46,009 - epoch:7, training loss:1730.9839 validation loss:25.1267, moco loss:8.4399
2025-06-08 21:00:16,459 - epoch:8, training loss:1731.1176 validation loss:24.9566, moco loss:8.3756
2025-06-08 21:04:50,458 - epoch:9, training loss:1732.4677 validation loss:26.2384, moco loss:9.2583
2025-06-08 21:04:50,641 - [*] Epoch 10, memory usage: 0.00 GB
2025-06-08 21:09:19,639 - epoch:10, training loss:1733.4615 validation loss:25.3995, moco loss:9.1110
2025-06-08 21:13:52,245 - epoch:11, training loss:1729.5719 validation loss:24.9989, moco loss:8.3560
2025-06-08 21:13:52,427 - [*] Training completed, memory usage: 0.00 GB
2025-06-08 21:15:51,080 - [*]Test--basic_loss:1889.6679, event_loss:0.0000, test_loss:1889.6679
2025-06-08 21:15:51,080 - [*] Evaluating all samples:
2025-06-08 21:15:51,080 - T:3	MAE	13.6591	RMSE	19.6871	MAPE	13.9306
2025-06-08 21:15:51,080 - T:6	MAE	14.8091	RMSE	21.9680	MAPE	14.8801
2025-06-08 21:15:51,080 - T:12	MAE	17.6890	RMSE	27.9085	MAPE	17.2405
2025-06-08 21:15:51,081 - Finished optimization, total time:2679.73 s, best model:res/CA/ca2025-06-08-17:11:28.241542/2019/24.7986.pkl
2025-06-08 21:15:52,156 - [*] Year 2019 completed, memory usage: 0.00 GB
2025-06-08 21:15:52,294 - [*] Loading data for year 2020, current memory usage: 0.00 GB

  0%|          | 0/63243 [00:00<?, ?it/s]
100%|██████████| 63243/63243 [00:00<00:00, 894041.64it/s]

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 884838.31it/s]

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 866804.46it/s]

  0%|          | 0/63243 [00:00<?, ?it/s]
100%|██████████| 63243/63243 [00:00<00:00, 924938.61it/s]

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 855457.84it/s]

  0%|          | 0/21081 [00:00<?, ?it/s]
100%|██████████| 21081/21081 [00:00<00:00, 816467.11it/s]
2025-06-08 21:26:07,260 - [*] Year 2020 load from data/CA/FastData/2020_30day.npz, memory usage: 0.00 GB
2025-06-08 21:26:07,569 - Secure SignIn[*] load from res/CA/ca2025-06-08-17:11:28.241542/2019/24.7986.pkl
2025-06-08 21:26:09,190 - [*] detect strategy feature
Traceback (most recent call last):
  File "/home/bd2/ANATS/TrafficStream/main_moco.py", line 656, in <module>
    main(args)
  File "/home/bd2/ANATS/TrafficStream/main_moco.py", line 553, in main
    influence_node_list = detect.influence_node_selection(model, args, pre_data, cur_data, pre_graph, cur_graph)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/ANATS/TrafficStream/src/model/detect.py", line 114, in influence_node_selection
    for i in range(min_nodes):
                               
IndexError: index 8561 is out of bounds for axis 0 with size 8561
2025-06-08 23:30:12,885 - logger name:res/CA/ca2025-06-08-23:30:12.884128/ca.log
2025-06-08 23:30:12,885 - params : {'conf': 'conf/ca.json', 'paral': 0, 'gpuid': 7, 'logname': 'ca', 'load_first_year': 1, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/CA/ca2025-06-08-11:35:41.262744/2019/24.8698.pkl', 'begin_year': 2019, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/CA/finaldata/', 'save_data_path': 'data/CA/FastData/', 'graph_path': 'data/CA/graph/', 'model_path': 'res/CA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'classifier': {'hidden_dim': 128}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': False, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'replay_num_samples': 300, 'extra_feature': False, 'moco': True, 'momentum_type': 'linear', 'memory_size': 32, 'expand': True, 'time': '2025-06-08-23:30:12.884128', 'path': 'res/CA/ca2025-06-08-23:30:12.884128', 'device': device(type='cuda', index=7), 'logger': <Logger __main__ (INFO)>}
2025-06-08 23:30:12,963 - [*] Loading data for year 2019, current memory usage: 0.00 GB

  0%|          | 0/63071 [00:00<?, ?it/s]
100%|██████████| 63071/63071 [00:00<00:00, 886619.70it/s]
2025-06-08 23:30:54,336 - logger name:res/CA/ca2025-06-08-23:30:54.335566/ca.log
2025-06-08 23:30:54,336 - params : {'conf': 'conf/ca.json', 'paral': 0, 'gpuid': 7, 'logname': 'ca', 'load_first_year': 1, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/CA/ca2025-06-08-11:35:41.262744/2019/24.8698.pkl', 'begin_year': 2019, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/CA/finaldata/', 'save_data_path': 'data/CA/FastData/', 'graph_path': 'data/CA/graph/', 'model_path': 'res/CA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'classifier': {'hidden_dim': 128}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': False, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'replay_num_samples': 300, 'extra_feature': False, 'moco': True, 'momentum_type': 'linear', 'memory_size': 32, 'expand': True, 'time': '2025-06-08-23:30:54.335566', 'path': 'res/CA/ca2025-06-08-23:30:54.335566', 'device': device(type='cuda', index=7), 'logger': <Logger __main__ (INFO)>}
2025-06-08 23:30:54,407 - [*] Loading data for year 2019, current memory usage: 0.00 GB
2025-06-08 23:30:55,433 - [*] Year 2019 load from data/CA/FastData/2019_30day.npz, memory usage: 0.00 GB
2025-06-08 23:30:56,631 - Secure SignIn[*] load from /home/bd2/ANATS/TrafficStream/res/CA/ca2025-06-08-11:35:41.262744/2019/24.8698.pkl
/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-06-08 23:35:16,045 - [*]Test--basic_loss:1584.9707, event_loss:0.0000, test_loss:1584.9707
2025-06-08 23:35:16,045 - [*] Evaluating all samples:
2025-06-08 23:35:16,045 - T:3	MAE	19.1422	RMSE	30.0521	MAPE	13.2114
2025-06-08 23:35:16,045 - T:6	MAE	21.0605	RMSE	33.1860	MAPE	15.1646
2025-06-08 23:35:16,045 - T:12	MAE	24.6084	RMSE	38.9656	MAPE	18.9818
2025-06-08 23:35:16,361 - [*] Loading data for year 2020, current memory usage: 0.00 GB
2025-06-08 23:35:17,544 - [*] Year 2020 load from data/CA/FastData/2020_30day.npz, memory usage: 0.00 GB
2025-06-08 23:35:17,801 - Secure SignIn[*] load from /home/bd2/ANATS/TrafficStream/res/CA/ca2025-06-08-11:35:41.262744/2019/24.8698.pkl
2025-06-08 23:35:19,158 - [*] replay node number 300
2025-06-08 23:37:47,685 - number of increase nodes:296, nodes after 2 hop:torch.Size([4439]), total nodes this year 8561
2025-06-08 23:41:36,632 - [*] Large dataset detected (63220 samples), reducing batch size from 128 to 64
2025-06-08 23:49:55,676 - [*] Year 2020 Dataset load!
2025-06-08 23:49:55,677 - [*] Initial memory usage: 0.00 GB
2025-06-08 23:49:55,677 - Secure SignIn[*] load from /home/bd2/ANATS/TrafficStream/res/CA/ca2025-06-08-11:35:41.262744/2019/24.8698.pkl
2025-06-08 23:49:56,290 - [*] EWC! lambda 0.000100
2025-06-08 23:59:45,443 - [*] Model parameter count: 8842
2025-06-08 23:59:45,458 - [*] Year 2020 Training start
2025-06-08 23:59:49,269 - [*] Epoch 0, memory usage: 0.00 GB
2025-06-08 23:59:50,049 - node number torch.Size([284096, 24])
2025-06-09 00:03:09,542 - epoch:0, training loss:1159.4248 validation loss:22.0565, moco loss:11.9379
2025-06-09 00:06:33,023 - epoch:1, training loss:1145.4763 validation loss:21.3722, moco loss:6.3446
2025-06-09 00:09:57,382 - epoch:2, training loss:1149.1392 validation loss:21.7541, moco loss:7.9283
2025-06-09 00:13:20,955 - epoch:3, training loss:1145.6154 validation loss:22.1907, moco loss:6.8173
2025-06-09 00:16:43,688 - epoch:4, training loss:1146.7235 validation loss:21.4288, moco loss:7.3702
2025-06-09 00:20:04,307 - epoch:5, training loss:1146.3984 validation loss:21.8074, moco loss:6.9789
2025-06-09 00:23:25,168 - epoch:6, training loss:1144.8185 validation loss:21.5016, moco loss:7.0020
2025-06-09 00:26:44,946 - epoch:7, training loss:1144.4827 validation loss:22.7799, moco loss:6.8741
2025-06-09 00:26:45,074 - [*] Training completed, memory usage: 0.00 GB
2025-06-09 00:28:41,585 - [*]Test--basic_loss:988.3640, event_loss:0.0000, test_loss:988.3640
2025-06-09 00:28:41,585 - [*] Evaluating all samples:
2025-06-09 00:28:41,586 - T:3	MAE	18.6767	RMSE	25.4899	MAPE	11.9142
2025-06-09 00:28:41,586 - T:6	MAE	19.3769	RMSE	26.6599	MAPE	12.1754
2025-06-09 00:28:41,586 - T:12	MAE	21.3781	RMSE	29.5208	MAPE	13.3399
2025-06-09 00:28:41,586 - Finished optimization, total time:1343.75 s, best model:res/CA/ca2025-06-08-23:30:54.335566/2020/21.3722.pkl
2025-06-09 00:28:42,375 - [*] Year 2020 completed, memory usage: 0.00 GB
2025-06-09 00:28:42,375 - 3	mae	24.32	16.20	19.14	18.68	
2025-06-09 00:28:42,375 - 3	rmse	37.71	22.71	30.05	25.49	
2025-06-09 00:28:42,375 - 3	mape	10.29	14.34	13.21	11.91	
2025-06-09 00:28:42,375 - 6	mae	26.29	17.32	21.06	19.38	
2025-06-09 00:28:42,375 - 6	rmse	40.92	25.07	33.19	26.66	
2025-06-09 00:28:42,375 - 6	mape	11.18	15.06	15.16	12.18	
2025-06-09 00:28:42,375 - 12	mae	28.17	19.65	24.61	21.38	
2025-06-09 00:28:42,375 - 12	rmse	42.45	30.29	38.97	29.52	
2025-06-09 00:28:42,375 - 12	mape	11.15	16.56	18.98	13.34	
2025-06-09 00:28:42,375 - year	2020	total_time	1343.7454970000001	average_time	167.96819762500002	epoch	8
Traceback (most recent call last):
  File "/home/bd2/ANATS/TrafficStream/main_moco_org.py", line 13, in <module>
    from torch.optim.lr_scheduler import ReduceLROnPlateau, OneCycleLR
ModuleNotFoundError: No module named 'torch.optim.lr_scheduler'
2025-06-09 03:59:45,632 - logger name:res/GLA/gla2025-06-09-03:59:45.631079/gla.log
2025-06-09 03:59:45,633 - params : {'conf': 'conf/gla.json', 'paral': 0, 'gpuid': 4, 'logname': 'gla', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/SD/all-com2025-05-26-12:20:16.113789/2017/25.9924.pkl', 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/GLA/finaldata/', 'save_data_path': 'data/GLA/FastData/', 'graph_path': 'data/GLA/graph/', 'model_path': 'res/GLA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'classifier': {'hidden_dim': 128}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'replay_num_samples': 300, 'extra_feature': False, 'moco': True, 'momentum_type': 'linear', 'memory_size': 64, 'expand': True, 'time': '2025-06-09-03:59:45.631079', 'path': 'res/GLA/gla2025-06-09-03:59:45.631079', 'device': device(type='cuda', index=4), 'logger': <Logger __main__ (INFO)>}
2025-06-09 03:59:45,750 - [*] Year 2017 load from data/GLA/FastData/2017_30day.npz
/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-06-09 04:01:13,852 - [*] Year 2017 Dataset load!
2025-06-09 04:01:13,859 - [*] Model parameter count: 9226
2025-06-09 04:01:13,860 - [*] Year 2017 Training start
2025-06-09 04:01:14,799 - node number torch.Size([232960, 24])
2025-06-09 04:01:55,706 - epoch:0, training loss:14182.3244 validation loss:32.8496, moco loss:0.6096
2025-06-09 04:02:36,521 - epoch:1, training loss:2623.2774 validation loss:31.1131, moco loss:2.5299
2025-06-09 04:03:18,078 - epoch:2, training loss:2437.7238 validation loss:30.0238, moco loss:2.0166
2025-06-09 04:03:58,696 - epoch:3, training loss:2404.5651 validation loss:29.7522, moco loss:4.7302
2025-06-09 04:04:40,559 - epoch:4, training loss:2386.4225 validation loss:29.6758, moco loss:2.4736
2025-06-09 04:05:20,958 - epoch:5, training loss:2363.3854 validation loss:29.7075, moco loss:3.0726
2025-06-09 04:06:02,091 - epoch:6, training loss:2354.9924 validation loss:29.7963, moco loss:18.7199
2025-06-09 04:06:42,115 - epoch:7, training loss:2337.5504 validation loss:29.0756, moco loss:5.7983
2025-06-09 04:07:22,261 - epoch:8, training loss:2304.6076 validation loss:29.3157, moco loss:8.3375
2025-06-09 04:08:04,587 - epoch:9, training loss:2264.1265 validation loss:28.6499, moco loss:4.1684
2025-06-09 04:08:48,623 - epoch:10, training loss:2240.7279 validation loss:28.7311, moco loss:48.8585
2025-06-09 04:09:32,836 - epoch:11, training loss:2226.1032 validation loss:29.2388, moco loss:27.8511
2025-06-09 04:10:17,162 - epoch:12, training loss:2215.3855 validation loss:28.5171, moco loss:17.7105
2025-06-09 04:11:01,512 - epoch:13, training loss:2205.6934 validation loss:28.6096, moco loss:9.3876
2025-06-09 04:11:45,747 - epoch:14, training loss:2201.1863 validation loss:29.0059, moco loss:67.7681
2025-06-09 04:12:29,924 - epoch:15, training loss:2202.2862 validation loss:28.3617, moco loss:35.5545
2025-06-09 04:13:14,278 - epoch:16, training loss:2195.8844 validation loss:28.3695, moco loss:2.2415
2025-06-09 04:13:58,464 - epoch:17, training loss:2186.6110 validation loss:29.5773, moco loss:10.0643
2025-06-09 04:14:42,764 - epoch:18, training loss:2188.7557 validation loss:28.4252, moco loss:6.6658
2025-06-09 04:15:27,218 - epoch:19, training loss:2186.1634 validation loss:28.7300, moco loss:5.9669
2025-06-09 04:16:11,290 - epoch:20, training loss:2183.1921 validation loss:29.2692, moco loss:15.1975
2025-06-09 04:16:55,515 - epoch:21, training loss:2181.4665 validation loss:29.3012, moco loss:82.9369
2025-06-09 04:17:04,998 - [*]Test--basic_loss:1373.7614, event_loss:2796.3379, test_loss:2183.4050
2025-06-09 04:17:08,034 - [*] Evaluating all samples:
2025-06-09 04:17:08,034 - [*] year 2017, testing
2025-06-09 04:17:21,120 - T:3	MAE	22.2446	RMSE	35.1590	MAPE	9.7048
2025-06-09 04:17:45,686 - T:6	MAE	24.4117	RMSE	38.3822	MAPE	10.6807
2025-06-09 04:18:27,244 - T:12	MAE	28.2179	RMSE	43.8049	MAPE	12.5479
2025-06-09 04:18:27,254 - Finished optimization, total time:743.80 s, best model:res/GLA/gla2025-06-09-03:59:45.631079/2017/28.3617.pkl
2025-06-09 04:18:27,481 - [*] Year 2018 load from data/GLA/FastData/2018_30day.npz
2025-06-09 04:18:27,514 - Secure SignIn[*] load from res/GLA/gla2025-06-09-03:59:45.631079/2017/28.3617.pkl
2025-06-09 04:18:27,601 - [*] detect strategy feature
2025-06-09 04:18:34,633 - [*] replay node number 165
2025-06-09 04:18:59,837 - number of increase nodes:184, nodes after 2 hop:torch.Size([1440]), total nodes this year 1843
2025-06-09 04:20:45,743 - [*] Year 2018 Dataset load!
2025-06-09 04:20:45,743 - Secure SignIn[*] load from res/GLA/gla2025-06-09-03:59:45.631079/2017/28.3617.pkl
2025-06-09 04:20:45,802 - [*] EWC! lambda 0.000100
2025-06-09 04:21:52,328 - [*] Model parameter count: 9226
2025-06-09 04:21:52,330 - [*] Year 2018 Training start
2025-06-09 04:21:54,526 - node number torch.Size([184320, 24])
2025-06-09 04:22:25,305 - epoch:0, training loss:1990.4858 validation loss:29.0233, moco loss:2.7544
2025-06-09 04:22:58,606 - epoch:1, training loss:1957.8719 validation loss:29.6391, moco loss:4.1664
2025-06-09 04:23:32,609 - epoch:2, training loss:1957.2285 validation loss:29.1343, moco loss:4.0104
2025-06-09 04:24:05,822 - epoch:3, training loss:1957.0316 validation loss:29.3835, moco loss:12.4681
2025-06-09 04:24:39,440 - epoch:4, training loss:1953.7834 validation loss:28.9996, moco loss:28.3318
2025-06-09 04:25:13,127 - epoch:5, training loss:1960.1331 validation loss:29.3925, moco loss:2.4516
2025-06-09 04:25:46,677 - epoch:6, training loss:1954.6696 validation loss:29.1561, moco loss:40.0718
2025-06-09 04:26:19,797 - epoch:7, training loss:1960.1617 validation loss:29.5767, moco loss:29.4075
2025-06-09 04:26:52,146 - epoch:8, training loss:1961.5070 validation loss:29.0537, moco loss:3.5327
2025-06-09 04:27:25,038 - epoch:9, training loss:1950.9948 validation loss:29.2309, moco loss:10.8177
2025-06-09 04:27:58,059 - epoch:10, training loss:1956.6536 validation loss:29.0889, moco loss:1.3293
2025-06-09 04:28:06,483 - [*]Test--basic_loss:1360.7259, event_loss:2303.9814, test_loss:1852.2571
2025-06-09 04:28:06,744 - [*] Evaluating all samples:
2025-06-09 04:28:06,744 - [*] year 2018, testing
2025-06-09 04:28:06,800 - T:3	MAE	27.7243	RMSE	41.2903	MAPE	13.3342
2025-06-09 04:28:06,869 - T:6	MAE	28.0041	RMSE	42.0478	MAPE	13.5901
2025-06-09 04:28:06,985 - T:12	MAE	29.2085	RMSE	44.1230	MAPE	13.6866
2025-06-09 04:28:06,986 - Finished optimization, total time:296.11 s, best model:res/GLA/gla2025-06-09-03:59:45.631079/2018/28.9996.pkl
2025-06-09 04:28:07,257 - [*] Year 2019 load from data/GLA/FastData/2019_30day.npz
2025-06-09 04:28:07,284 - Secure SignIn[*] load from res/GLA/gla2025-06-09-03:59:45.631079/2018/28.9996.pkl
2025-06-09 04:28:07,374 - [*] detect strategy feature
2025-06-09 04:28:14,748 - [*] replay node number 167
2025-06-09 04:28:40,849 - number of increase nodes:185, nodes after 2 hop:torch.Size([1535]), total nodes this year 1859
2025-06-09 04:34:21,713 - [*] Year 2019 Dataset load!
2025-06-09 04:34:21,713 - Secure SignIn[*] load from res/GLA/gla2025-06-09-03:59:45.631079/2018/28.9996.pkl
2025-06-09 04:34:21,782 - [*] EWC! lambda 0.000100
2025-06-09 04:35:05,711 - [*] Model parameter count: 9226
2025-06-09 04:35:05,713 - [*] Year 2019 Training start
2025-06-09 04:35:08,349 - node number torch.Size([196480, 24])
2025-06-09 04:35:41,098 - epoch:0, training loss:1900.6882 validation loss:27.8537, moco loss:6.7403
2025-06-09 04:36:16,416 - epoch:1, training loss:1855.1172 validation loss:27.2036, moco loss:7.1385
2025-06-09 04:36:50,952 - epoch:2, training loss:1863.4223 validation loss:27.1028, moco loss:20.7241
2025-06-09 04:37:25,548 - epoch:3, training loss:1856.4030 validation loss:26.9820, moco loss:7.9227
2025-06-09 04:38:00,047 - epoch:4, training loss:1860.1197 validation loss:27.3019, moco loss:13.8306
2025-06-09 04:38:34,456 - epoch:5, training loss:1855.9166 validation loss:26.8891, moco loss:22.7876
2025-06-09 04:39:08,269 - epoch:6, training loss:1859.0020 validation loss:27.1633, moco loss:11.1188
2025-06-09 04:39:43,214 - epoch:7, training loss:1855.3206 validation loss:27.4763, moco loss:5.2497
2025-06-09 04:40:17,520 - epoch:8, training loss:1863.8767 validation loss:27.4460, moco loss:3.2646
2025-06-09 04:40:52,220 - epoch:9, training loss:1854.7993 validation loss:27.0201, moco loss:2.8979
2025-06-09 04:41:26,823 - epoch:10, training loss:1854.6863 validation loss:26.8948, moco loss:3.3441
2025-06-09 04:42:01,453 - epoch:11, training loss:1858.8910 validation loss:26.9934, moco loss:4.7648
2025-06-09 04:42:09,915 - [*]Test--basic_loss:1703.2851, event_loss:3248.6708, test_loss:1798.8892
2025-06-09 04:42:10,166 - [*] Evaluating all samples:
2025-06-09 04:42:10,166 - [*] year 2019, testing
2025-06-09 04:42:10,229 - T:3	MAE	27.0392	RMSE	40.1327	MAPE	12.3757
2025-06-09 04:42:10,305 - T:6	MAE	26.2192	RMSE	39.1565	MAPE	12.6943
2025-06-09 04:42:10,427 - T:12	MAE	24.3023	RMSE	36.0903	MAPE	13.0597
2025-06-09 04:42:10,428 - Finished optimization, total time:333.67 s, best model:res/GLA/gla2025-06-09-03:59:45.631079/2019/26.8891.pkl
2025-06-09 04:42:10,711 - [*] Year 2020 load from data/GLA/FastData/2020_30day.npz
2025-06-09 04:42:10,734 - Secure SignIn[*] load from res/GLA/gla2025-06-09-03:59:45.631079/2019/26.8891.pkl
2025-06-09 04:42:10,817 - [*] detect strategy feature
2025-06-09 04:42:18,442 - [*] replay node number 167
2025-06-09 04:42:46,961 - number of increase nodes:174, nodes after 2 hop:torch.Size([1583]), total nodes this year 1859
2025-06-09 04:44:50,772 - [*] Year 2020 Dataset load!
2025-06-09 04:44:50,773 - Secure SignIn[*] load from res/GLA/gla2025-06-09-03:59:45.631079/2019/26.8891.pkl
2025-06-09 04:44:50,834 - [*] EWC! lambda 0.000100
2025-06-09 04:45:59,719 - [*] Model parameter count: 9226
2025-06-09 04:45:59,720 - [*] Year 2020 Training start
2025-06-09 04:46:03,325 - node number torch.Size([202624, 24])
2025-06-09 04:46:37,798 - epoch:0, training loss:1649.2325 validation loss:26.0644, moco loss:9.1675
2025-06-09 04:47:16,018 - epoch:1, training loss:1613.1748 validation loss:27.3219, moco loss:2.2138
2025-06-09 04:47:54,165 - epoch:2, training loss:1605.7516 validation loss:26.6045, moco loss:19.4832
2025-06-09 04:48:31,510 - epoch:3, training loss:1609.5470 validation loss:26.4965, moco loss:1.8043
2025-06-09 04:49:08,852 - epoch:4, training loss:1604.3738 validation loss:26.4348, moco loss:14.9087
2025-06-09 04:49:46,345 - epoch:5, training loss:1611.7299 validation loss:26.1942, moco loss:23.0436
2025-06-09 04:50:23,450 - epoch:6, training loss:1610.1775 validation loss:25.5004, moco loss:3.3317
2025-06-09 04:51:01,245 - epoch:7, training loss:1602.6862 validation loss:25.4869, moco loss:3.4734
2025-06-09 04:51:39,485 - epoch:8, training loss:1609.2082 validation loss:27.4918, moco loss:14.8432
2025-06-09 04:52:16,637 - epoch:9, training loss:1610.0277 validation loss:26.3850, moco loss:29.3676
2025-06-09 04:52:53,887 - epoch:10, training loss:1603.7305 validation loss:26.0002, moco loss:10.6616
2025-06-09 04:53:31,421 - epoch:11, training loss:1611.4435 validation loss:27.0732, moco loss:5.9844
2025-06-09 04:54:09,286 - epoch:12, training loss:1601.3383 validation loss:26.0828, moco loss:21.6977
2025-06-09 04:54:47,332 - epoch:13, training loss:1605.1048 validation loss:25.4988, moco loss:13.3758
2025-06-09 04:54:56,027 - [*]Test--basic_loss:1596.1564, event_loss:1877.1900, test_loss:1606.5844
2025-06-09 04:54:56,267 - [*] Evaluating all samples:
2025-06-09 04:54:56,267 - [*] year 2020, testing
2025-06-09 04:54:56,332 - T:3	MAE	26.3523	RMSE	40.9230	MAPE	12.3702
2025-06-09 04:54:56,407 - T:6	MAE	27.6543	RMSE	42.9724	MAPE	12.9067
2025-06-09 04:54:56,529 - T:12	MAE	27.0204	RMSE	41.5574	MAPE	12.6019
2025-06-09 04:54:56,530 - Finished optimization, total time:424.09 s, best model:res/GLA/gla2025-06-09-03:59:45.631079/2020/25.4869.pkl
2025-06-09 04:54:56,697 - 3	mae	22.24	27.72	27.04	26.35	
2025-06-09 04:54:56,697 - 3	rmse	35.16	41.29	40.13	40.92	
2025-06-09 04:54:56,697 - 3	mape	9.70	13.33	12.38	12.37	
2025-06-09 04:54:56,697 - 6	mae	24.41	28.00	26.22	27.65	
2025-06-09 04:54:56,697 - 6	rmse	38.38	42.05	39.16	42.97	
2025-06-09 04:54:56,697 - 6	mape	10.68	13.59	12.69	12.91	
2025-06-09 04:54:56,697 - 12	mae	28.22	29.21	24.30	27.02	
2025-06-09 04:54:56,697 - 12	rmse	43.80	44.12	36.09	41.56	
2025-06-09 04:54:56,697 - 12	mape	12.55	13.69	13.06	12.60	
2025-06-09 04:54:56,697 - year	2017	total_time	743.8029769999999	average_time	33.80923818181818	epoch	22
2025-06-09 04:54:56,697 - year	2018	total_time	296.10889399999996	average_time	26.919007727272728	epoch	11
2025-06-09 04:54:56,698 - year	2019	total_time	333.6662840000001	average_time	27.80554125	epoch	12
2025-06-09 04:54:56,698 - year	2020	total_time	424.08890599999995	average_time	30.292095571428572	epoch	14
2025-06-09 10:08:38,741 - logger name:res/CA/ca-gwnet2025-06-09-10:08:38.740709/ca-gwnet.log
2025-06-09 10:08:38,742 - params : {'conf': 'conf/ca.json', 'paral': 0, 'gpuid': 7, 'logname': 'ca-gwnet', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/CA/ca2025-06-08-11:35:41.262744/2019/24.8698.pkl', 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 10, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/CA/finaldata/', 'save_data_path': 'data/CA/FastData/', 'graph_path': 'data/CA/graph/', 'model_path': 'res/CA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'classifier': {'hidden_dim': 128}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': False, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'replay_num_samples': 300, 'extra_feature': False, 'moco': True, 'momentum_type': 'linear', 'memory_size': 32, 'expand': True, 'time': '2025-06-09-10:08:38.740709', 'path': 'res/CA/ca-gwnet2025-06-09-10:08:38.740709', 'device': device(type='cuda', index=7), 'logger': <Logger __main__ (INFO)>}
2025-06-09 10:08:38,812 - [*] Loading data for year 2017, current memory usage: 0.00 GB
2025-06-09 10:08:40,241 - [*] Year 2017 load from data/CA/FastData/2017_30day.npz, memory usage: 0.00 GB
Traceback (most recent call last):
  File "/home/bd2/ANATS/TrafficStream/main_moco_mem.py", line 656, in <module>
    main(args)
  File "/home/bd2/ANATS/TrafficStream/main_moco_mem.py", line 607, in main
    train(inputs, args)
  File "/home/bd2/ANATS/TrafficStream/main_moco_mem.py", line 134, in train
    data_size = inputs["train_x"].shape[0] if hasattr(inputs["train_x"], 'shape') else len(inputs["train_x"])
                                                      ~~~~~~^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/numpy/lib/_npyio_impl.py", line 249, in __getitem__
    bytes = self.zip.open(key)
            ^^^^^^^^^^^^^^^^^^
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/zipfile/__init__.py", line 1657, in open
    raise BadZipFile(f"Overlapped entries: {zinfo.orig_filename!r} (possible zip bomb)")
zipfile.BadZipFile: Overlapped entries: 'train_x.npy' (possible zip bomb)
2025-06-09 10:08:57,971 - logger name:res/CA/ca-gwnet2025-06-09-10:08:57.970549/ca-gwnet.log
2025-06-09 10:08:57,971 - params : {'conf': 'conf/ca.json', 'paral': 0, 'gpuid': 7, 'logname': 'ca-gwnet', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/CA/ca2025-06-08-11:35:41.262744/2019/24.8698.pkl', 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 10, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/CA/finaldata/', 'save_data_path': 'data/CA/FastData/', 'graph_path': 'data/CA/graph/', 'model_path': 'res/CA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'classifier': {'hidden_dim': 128}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': False, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'replay_num_samples': 300, 'extra_feature': False, 'moco': True, 'momentum_type': 'linear', 'memory_size': 32, 'expand': True, 'time': '2025-06-09-10:08:57.970549', 'path': 'res/CA/ca-gwnet2025-06-09-10:08:57.970549', 'device': device(type='cuda', index=7), 'logger': <Logger __main__ (INFO)>}
2025-06-09 10:08:58,044 - [*] Loading data for year 2017, current memory usage: 0.00 GB
  0%|          | 0/63071 [00:00<?, ?it/s]100%|██████████| 63071/63071 [00:00<00:00, 872872.82it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 783773.35it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 904888.43it/s]
  0%|          | 0/63071 [00:00<?, ?it/s]100%|██████████| 63071/63071 [00:00<00:00, 892046.10it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 854062.73it/s]
  0%|          | 0/21023 [00:00<?, ?it/s]100%|██████████| 21023/21023 [00:00<00:00, 894152.54it/s]
2025-06-09 11:04:31,707 - [*] Year 2017 load from data/CA/FastData/2017_30day.npz, memory usage: 0.00 GB
2025-06-09 11:04:32,647 - [*] Large dataset detected (63048 samples), reducing batch size from 128 to 64
/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-06-09 11:04:32,669 - [*] Year 2017 Dataset load!
2025-06-09 11:04:32,671 - [*] Initial memory usage: 0.00 GB
Traceback (most recent call last):
  File "/home/bd2/ANATS/TrafficStream/main_moco_mem.py", line 656, in <module>
    main(args)
  File "/home/bd2/ANATS/TrafficStream/main_moco_mem.py", line 607, in main
    train(inputs, args)
  File "/home/bd2/ANATS/TrafficStream/main_moco_mem.py", line 173, in train
    gnn_model = TrafficEvent(args).to(args.device)
                ^^^^^^^^^^^^^^^^^^
  File "/home/bd2/ANATS/TrafficStream/src/model/model.py", line 157, in __init__
    self.copy_params()
  File "/home/bd2/miniconda3/envs/ANATS/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/bd2/ANATS/TrafficStream/src/model/model.py", line 168, in copy_params
    param_m.data.copy_(param.data)  # initialize
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (24) must match the size of tensor b (2) at non-singleton dimension 3
