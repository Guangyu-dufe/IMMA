2025-05-10 05:52:15,290 - logger name:res/SD/trafficStream2025-05-10-05:52:15.289535/trafficStream.log
2025-05-10 05:52:15,290 - params : {'conf': 'conf/trafficStream_SD.json', 'paral': 0, 'gpuid': 5, 'logname': 'trafficStream', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/SD/linear-moco/2017/26.5761.pkl', 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/SD/finaldata/', 'save_data_path': 'data/SD/FastData/', 'graph_path': 'data/SD/graph/', 'model_path': 'res/SD/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'classifier': {'hidden_dim': 128}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': False, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 300, 'extra_feature': True, 'momentum_type': 'linear', 'time': '2025-05-10-05:52:15.289535', 'path': 'res/SD/trafficStream2025-05-10-05:52:15.289535', 'device': device(type='cuda', index=5), 'logger': <Logger __main__ (INFO)>}
2025-05-10 05:52:15,319 - [*] Year 2017 load from data/SD/FastData/2017_30day.npz
2025-05-10 05:52:28,539 - [*] Year 2017 Dataset load!
2025-05-10 05:52:28,543 - [*] Model parameter count: 8842
2025-05-10 05:52:28,544 - [*] Year 2017 Training start
2025-05-10 05:52:28,893 - node number torch.Size([91648, 24])
2025-05-10 05:52:40,897 - epoch:0, training loss:8802.0876 validation loss:30.0621, moco loss:1.3486
2025-05-10 05:52:52,662 - epoch:1, training loss:2050.3773 validation loss:29.0668, moco loss:2.4457
2025-05-10 05:53:04,432 - epoch:2, training loss:1953.1713 validation loss:28.1967, moco loss:8.5320
2025-05-10 05:53:16,429 - epoch:3, training loss:1915.6017 validation loss:28.5654, moco loss:9.2437
2025-05-10 05:53:28,343 - epoch:4, training loss:1894.8744 validation loss:28.1421, moco loss:1.1790
2025-05-10 05:53:40,398 - epoch:5, training loss:1881.0866 validation loss:28.3511, moco loss:19.5006
2025-05-10 05:53:52,343 - epoch:6, training loss:1868.4439 validation loss:28.3467, moco loss:10.4853
2025-05-10 05:54:04,308 - epoch:7, training loss:1861.0646 validation loss:27.9412, moco loss:9.1698
2025-05-10 05:54:16,339 - epoch:8, training loss:1853.7781 validation loss:27.7789, moco loss:6.6986
2025-05-10 05:54:28,259 - epoch:9, training loss:1848.5147 validation loss:28.1439, moco loss:22.8604
2025-05-10 05:54:40,325 - epoch:10, training loss:1844.5194 validation loss:27.9123, moco loss:5.5643
2025-05-10 05:54:52,404 - epoch:11, training loss:1840.5192 validation loss:27.8870, moco loss:0.9594
2025-05-10 05:55:04,624 - epoch:12, training loss:1797.9265 validation loss:27.3074, moco loss:14.8270
2025-05-10 05:55:16,751 - epoch:13, training loss:1752.6951 validation loss:27.2539, moco loss:3.7632
2025-05-10 05:55:28,768 - epoch:14, training loss:1727.1664 validation loss:27.0619, moco loss:11.2462
2025-05-10 05:55:40,667 - epoch:15, training loss:1715.0516 validation loss:28.4832, moco loss:3.1864
2025-05-10 05:55:52,579 - epoch:16, training loss:1706.8900 validation loss:27.2296, moco loss:26.4375
2025-05-10 05:56:04,786 - epoch:17, training loss:1702.8531 validation loss:27.4684, moco loss:7.8496
2025-05-10 05:56:16,849 - epoch:18, training loss:1697.3662 validation loss:27.5128, moco loss:14.6479
2025-05-10 05:56:29,044 - epoch:19, training loss:1691.7476 validation loss:26.7385, moco loss:3.9021
2025-05-10 05:56:41,188 - epoch:20, training loss:1692.4908 validation loss:26.7523, moco loss:6.7165
2025-05-10 05:56:53,265 - epoch:21, training loss:1688.8472 validation loss:27.0515, moco loss:4.4503
2025-05-10 05:57:05,356 - epoch:22, training loss:1688.0684 validation loss:27.0518, moco loss:36.7556
2025-05-10 05:57:17,418 - epoch:23, training loss:1687.6087 validation loss:27.0700, moco loss:3.9399
2025-05-10 05:57:29,360 - epoch:24, training loss:1681.7575 validation loss:27.0635, moco loss:13.5125
2025-05-10 05:57:41,429 - epoch:25, training loss:1682.9354 validation loss:26.7869, moco loss:9.2382
2025-05-10 05:57:44,609 - [*]Test--basic_loss:1997.0732, event_loss:620.9854, test_loss:1617.1500
2025-05-10 05:57:45,020 - [*] Evaluating all samples:
2025-05-10 05:57:45,020 - [*] year 2017, testing
2025-05-10 05:57:47,300 - T:3	MAE	19.9536	RMSE	29.8881	MAPE	12.8082
2025-05-10 05:57:50,932 - T:6	MAE	22.1593	RMSE	33.4826	MAPE	14.5759
2025-05-10 05:57:56,465 - T:12	MAE	26.2707	RMSE	39.9887	MAPE	18.6873
2025-05-10 05:57:56,909 - [*] Evaluating basic traffic samples (prediction=0):
2025-05-10 05:57:56,909 - [*] year 2017, testing
2025-05-10 05:57:58,475 - T:3	MAE	23.7840	RMSE	33.8637	MAPE	9.2069
2025-05-10 05:58:01,061 - T:6	MAE	26.3065	RMSE	37.8004	MAPE	10.2526
2025-05-10 05:58:05,020 - T:12	MAE	30.6569	RMSE	44.4030	MAPE	12.2520
2025-05-10 05:58:05,194 - [*] Evaluating event traffic samples (prediction=1):
2025-05-10 05:58:05,194 - [*] year 2017, testing
2025-05-10 05:58:05,689 - T:3	MAE	10.1057	RMSE	15.5454	MAPE	22.0677
2025-05-10 05:58:06,436 - T:6	MAE	11.4970	RMSE	18.1606	MAPE	25.6909
2025-05-10 05:58:07,446 - T:12	MAE	14.9936	RMSE	25.3248	MAPE	35.2281
2025-05-10 05:58:07,451 - Finished optimization, total time:219.65 s, best model:res/SD/trafficStream2025-05-10-05:52:15.289535/2017/26.7385.pkl
2025-05-10 05:58:07,517 - [*] Year 2018 load from data/SD/FastData/2018_30day.npz
2025-05-10 05:58:07,544 - Secure SignIn[*] load from res/SD/trafficStream2025-05-10-05:52:15.289535/2017/26.7385.pkl
2025-05-10 05:58:07,555 - [*] replay node number 64
2025-05-10 05:58:12,932 - number of increase nodes:61, nodes after 2 hop:torch.Size([518]), total nodes this year 716
2025-05-10 05:58:35,157 - [*] Year 2018 Dataset load!
2025-05-10 05:58:35,158 - Secure SignIn[*] load from res/SD/trafficStream2025-05-10-05:52:15.289535/2017/26.7385.pkl
2025-05-10 05:58:35,166 - [*] EWC! lambda 0.000100
2025-05-10 05:58:49,035 - [*] Model parameter count: 8842
2025-05-10 05:58:49,035 - [*] Year 2018 Training start
2025-05-10 05:58:49,875 - node number torch.Size([66304, 24])
2025-05-10 05:59:03,401 - epoch:0, training loss:1963.5455 validation loss:27.4875, moco loss:3.6747
2025-05-10 05:59:16,866 - epoch:1, training loss:1946.4403 validation loss:27.3528, moco loss:2.7556
2025-05-10 05:59:30,027 - epoch:2, training loss:1947.3371 validation loss:27.5113, moco loss:3.4205
2025-05-10 05:59:43,518 - epoch:3, training loss:1945.4057 validation loss:27.3899, moco loss:21.9878
2025-05-10 05:59:57,612 - epoch:4, training loss:1947.7685 validation loss:27.6083, moco loss:4.6652
2025-05-10 06:00:10,459 - epoch:5, training loss:1947.5355 validation loss:27.7126, moco loss:1.4015
2025-05-10 06:00:23,873 - epoch:6, training loss:1945.9758 validation loss:27.4579, moco loss:4.1992
2025-05-10 06:00:37,781 - epoch:7, training loss:1948.2790 validation loss:27.9141, moco loss:4.9998
2025-05-10 06:00:40,405 - [*]Test--basic_loss:1917.4031, event_loss:138.9939, test_loss:1656.1162
2025-05-10 06:00:40,464 - [*] Evaluating all samples:
2025-05-10 06:00:40,464 - [*] year 2018, testing
2025-05-10 06:00:40,522 - T:3	MAE	23.1548	RMSE	33.3301	MAPE	40.7076
2025-05-10 06:00:40,592 - T:6	MAE	23.9714	RMSE	34.6104	MAPE	31.1236
2025-05-10 06:00:40,694 - T:12	MAE	25.4917	RMSE	37.4557	MAPE	24.7077
2025-05-10 06:00:40,724 - [*] Evaluating basic traffic samples (prediction=0):
2025-05-10 06:00:40,724 - [*] year 2018, testing
2025-05-10 06:00:40,728 - T:3	MAE	16.3165	RMSE	21.0610	MAPE	13.0849
2025-05-10 06:00:40,731 - T:6	MAE	18.1008	RMSE	23.5065	MAPE	14.6966
2025-05-10 06:00:40,735 - T:12	MAE	21.9844	RMSE	29.2094	MAPE	18.6245
2025-05-10 06:00:40,741 - [*] Evaluating event traffic samples (prediction=1):
2025-05-10 06:00:40,741 - [*] year 2018, testing
2025-05-10 06:00:40,742 - T:3	MAE	11.7253	RMSE	15.4072	MAPE	15.7482
2025-05-10 06:00:40,742 - T:6	MAE	13.5290	RMSE	18.1804	MAPE	17.8433
2025-05-10 06:00:40,743 - T:12	MAE	17.6848	RMSE	24.5638	MAPE	22.7366
2025-05-10 06:00:40,744 - Finished optimization, total time:91.52 s, best model:res/SD/trafficStream2025-05-10-05:52:15.289535/2018/27.3528.pkl
2025-05-10 06:00:40,820 - [*] Year 2019 load from data/SD/FastData/2019_30day.npz
2025-05-10 06:00:40,826 - Secure SignIn[*] load from res/SD/trafficStream2025-05-10-05:52:15.289535/2018/27.3528.pkl
2025-05-10 06:00:40,838 - [*] replay node number 64
2025-05-10 06:00:46,294 - number of increase nodes:60, nodes after 2 hop:torch.Size([527]), total nodes this year 716
2025-05-10 06:01:09,230 - [*] Year 2019 Dataset load!
2025-05-10 06:01:09,230 - Secure SignIn[*] load from res/SD/trafficStream2025-05-10-05:52:15.289535/2018/27.3528.pkl
2025-05-10 06:01:09,237 - [*] EWC! lambda 0.000100
2025-05-10 06:01:23,045 - [*] Model parameter count: 8842
2025-05-10 06:01:23,046 - [*] Year 2019 Training start
2025-05-10 06:01:23,824 - node number torch.Size([67456, 24])
2025-05-10 06:01:37,347 - epoch:0, training loss:1590.2511 validation loss:26.7261, moco loss:1.1804
2025-05-10 06:01:50,402 - epoch:1, training loss:1583.3343 validation loss:26.9266, moco loss:1.2371
2025-05-10 06:02:05,308 - epoch:2, training loss:1583.3977 validation loss:27.8221, moco loss:2.5683
2025-05-10 06:02:19,122 - epoch:3, training loss:1585.9174 validation loss:26.6451, moco loss:11.6211
2025-05-10 06:02:31,595 - epoch:4, training loss:1584.4972 validation loss:27.2937, moco loss:2.9151
2025-05-10 06:02:43,619 - epoch:5, training loss:1583.3528 validation loss:26.6487, moco loss:6.0654
2025-05-10 06:02:56,861 - epoch:6, training loss:1582.4040 validation loss:26.8465, moco loss:6.7378
2025-05-10 06:03:09,464 - epoch:7, training loss:1581.9478 validation loss:26.6711, moco loss:1.7193
2025-05-10 06:03:22,546 - epoch:8, training loss:1585.0804 validation loss:27.0615, moco loss:4.5252
2025-05-10 06:03:35,957 - epoch:9, training loss:1585.4546 validation loss:26.8389, moco loss:9.7376
2025-05-10 06:03:38,560 - [*]Test--basic_loss:1576.9899, event_loss:0.0000, test_loss:1576.9899
2025-05-10 06:03:38,629 - [*] Evaluating all samples:
2025-05-10 06:03:38,629 - [*] year 2019, testing
2025-05-10 06:03:38,684 - T:3	MAE	19.4905	RMSE	27.5195	MAPE	17.7359
2025-05-10 06:03:38,751 - T:6	MAE	21.3810	RMSE	30.4952	MAPE	19.4118
2025-05-10 06:03:38,850 - T:12	MAE	24.7364	RMSE	35.6608	MAPE	22.9770
2025-05-10 06:03:38,896 - [*] Evaluating basic traffic samples (prediction=0):
2025-05-10 06:03:38,897 - [*] year 2019, testing
2025-05-10 06:03:38,901 - T:3	MAE	24.5247	RMSE	33.5233	MAPE	10.8302
2025-05-10 06:03:38,905 - T:6	MAE	26.0531	RMSE	35.9976	MAPE	11.5172
2025-05-10 06:03:38,910 - T:12	MAE	29.0156	RMSE	40.8084	MAPE	12.8024
2025-05-10 06:03:38,911 - Finished optimization, total time:111.11 s, best model:res/SD/trafficStream2025-05-10-05:52:15.289535/2019/26.6451.pkl
2025-05-10 06:03:38,989 - [*] Year 2020 load from data/SD/FastData/2020_30day.npz
2025-05-10 06:03:38,996 - Secure SignIn[*] load from res/SD/trafficStream2025-05-10-05:52:15.289535/2019/26.6451.pkl
2025-05-10 06:03:39,006 - [*] replay node number 64
2025-05-10 06:03:44,499 - number of increase nodes:61, nodes after 2 hop:torch.Size([547]), total nodes this year 716
2025-05-10 06:04:08,157 - [*] Year 2020 Dataset load!
2025-05-10 06:04:08,157 - Secure SignIn[*] load from res/SD/trafficStream2025-05-10-05:52:15.289535/2019/26.6451.pkl
2025-05-10 06:04:08,165 - [*] EWC! lambda 0.000100
2025-05-10 06:04:22,085 - [*] Model parameter count: 8842
2025-05-10 06:04:22,086 - [*] Year 2020 Training start
2025-05-10 06:04:23,302 - node number torch.Size([70016, 24])
2025-05-10 06:04:35,858 - epoch:0, training loss:1986.4602 validation loss:24.6551, moco loss:31.7791
2025-05-10 06:04:48,435 - epoch:1, training loss:1965.8411 validation loss:24.4715, moco loss:5.8756
2025-05-10 06:05:01,845 - epoch:2, training loss:1961.4833 validation loss:24.4455, moco loss:101.8454
2025-05-10 06:05:13,927 - epoch:3, training loss:1965.2732 validation loss:23.6690, moco loss:16.2940
2025-05-10 06:05:28,154 - epoch:4, training loss:1961.1486 validation loss:23.8199, moco loss:11.3071
2025-05-10 06:05:41,817 - epoch:5, training loss:1965.2104 validation loss:23.6916, moco loss:8.7509
2025-05-10 06:05:55,614 - epoch:6, training loss:1961.6097 validation loss:23.8120, moco loss:7.3372
2025-05-10 06:06:09,245 - epoch:7, training loss:1960.8175 validation loss:24.2157, moco loss:5.4516
2025-05-10 06:06:24,359 - epoch:8, training loss:1965.2032 validation loss:24.2119, moco loss:9.0165
2025-05-10 06:06:37,865 - epoch:9, training loss:1963.0252 validation loss:23.9939, moco loss:2.4305
2025-05-10 06:06:40,552 - [*]Test--basic_loss:1506.3861, event_loss:0.0000, test_loss:1506.3861
2025-05-10 06:06:40,611 - [*] Evaluating all samples:
2025-05-10 06:06:40,611 - [*] year 2020, testing
2025-05-10 06:06:40,668 - T:3	MAE	23.6158	RMSE	33.8490	MAPE	44.6443
2025-05-10 06:06:40,737 - T:6	MAE	23.5837	RMSE	33.5619	MAPE	46.5727
2025-05-10 06:06:40,837 - T:12	MAE	23.7889	RMSE	33.4662	MAPE	41.2466
2025-05-10 06:06:40,872 - [*] Evaluating basic traffic samples (prediction=0):
2025-05-10 06:06:40,873 - [*] year 2020, testing
2025-05-10 06:06:40,877 - T:3	MAE	18.6307	RMSE	23.4056	MAPE	29.6898
2025-05-10 06:06:40,881 - T:6	MAE	19.8027	RMSE	25.2767	MAPE	31.0076
2025-05-10 06:06:40,887 - T:12	MAE	22.2889	RMSE	29.3010	MAPE	34.3172
2025-05-10 06:06:40,887 - Finished optimization, total time:113.57 s, best model:res/SD/trafficStream2025-05-10-05:52:15.289535/2020/23.669.pkl
2025-05-10 06:06:40,935 - year	2017	total_time	219.653433	average_time	8.448220115384615	epoch	26
2025-05-10 06:06:40,935 - year	2018	total_time	91.51779300000001	average_time	11.439739125000001	epoch	8
2025-05-10 06:06:40,935 - year	2019	total_time	111.114511	average_time	11.111469699999999	epoch	10
2025-05-10 06:06:40,935 - year	2020	total_time	113.57014799999999	average_time	11.3570281	epoch	10
