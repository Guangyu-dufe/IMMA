2025-05-09 02:41:35,531 - logger name:res/SD/trafficStream2025-05-09-02:41:35.529882/trafficStream.log
2025-05-09 02:41:35,531 - params : {'conf': 'conf/trafficStream_SD.json', 'paral': 0, 'gpuid': 5, 'logname': 'trafficStream', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/SD/linear-moco/2017/26.5761.pkl', 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/SD/finaldata/', 'save_data_path': 'data/SD/FastData/', 'graph_path': 'data/SD/graph/', 'model_path': 'res/SD/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'classifier': {'hidden_dim': 128}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': False, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 300, 'extra_feature': True, 'momentum_type': 'linear', 'time': '2025-05-09-02:41:35.529882', 'path': 'res/SD/trafficStream2025-05-09-02:41:35.529882', 'device': device(type='cuda', index=5), 'logger': <Logger __main__ (INFO)>}
2025-05-09 02:41:35,560 - [*] Year 2017 load from data/SD/FastData/2017_30day.npz
2025-05-09 02:41:48,790 - [*] Year 2017 Dataset load!
2025-05-09 02:41:48,794 - [*] Model parameter count: 8842
2025-05-09 02:41:48,794 - [*] Year 2017 Training start
2025-05-09 02:41:49,236 - node number torch.Size([91648, 24])
2025-05-09 02:42:01,224 - epoch:0, training loss:8964.0225 validation loss:30.3738, moco loss:18406.3848
2025-05-09 02:42:12,873 - epoch:1, training loss:2072.1488 validation loss:29.1716, moco loss:7785.1006
2025-05-09 02:42:24,600 - epoch:2, training loss:1969.9709 validation loss:29.0725, moco loss:2637.0845
2025-05-09 02:42:36,757 - epoch:3, training loss:1922.8756 validation loss:28.8817, moco loss:1180.2308
2025-05-09 02:42:48,766 - epoch:4, training loss:1901.4862 validation loss:28.2673, moco loss:227.1751
2025-05-09 02:43:00,823 - epoch:5, training loss:1885.6185 validation loss:29.3323, moco loss:69.0016
2025-05-09 02:43:12,784 - epoch:6, training loss:1876.5806 validation loss:28.1025, moco loss:57.7324
2025-05-09 02:43:24,690 - epoch:7, training loss:1871.0372 validation loss:29.2624, moco loss:11.0543
2025-05-09 02:43:36,459 - epoch:8, training loss:1861.5698 validation loss:27.9896, moco loss:25.4317
2025-05-09 02:43:48,335 - epoch:9, training loss:1853.8826 validation loss:28.1324, moco loss:9.7623
2025-05-09 02:44:00,177 - epoch:10, training loss:1849.8128 validation loss:27.8135, moco loss:12.8097
2025-05-09 02:44:11,970 - epoch:11, training loss:1848.0847 validation loss:27.9740, moco loss:9.7139
2025-05-09 02:44:24,276 - epoch:12, training loss:1842.8585 validation loss:27.6499, moco loss:9.2839
2025-05-09 02:44:36,163 - epoch:13, training loss:1830.3995 validation loss:27.4677, moco loss:73.4853
2025-05-09 02:44:48,359 - epoch:14, training loss:1779.8663 validation loss:27.9454, moco loss:86.2984
2025-05-09 02:45:00,365 - epoch:15, training loss:1747.1884 validation loss:27.8499, moco loss:56.8856
2025-05-09 02:45:12,554 - epoch:16, training loss:1722.8841 validation loss:27.5305, moco loss:60.9203
2025-05-09 02:45:24,567 - epoch:17, training loss:1719.3953 validation loss:27.6425, moco loss:83.8248
2025-05-09 02:45:36,966 - epoch:18, training loss:1709.5580 validation loss:27.1683, moco loss:9.7829
2025-05-09 02:45:48,916 - epoch:19, training loss:1704.6421 validation loss:27.0674, moco loss:9.1581
2025-05-09 02:46:00,996 - epoch:20, training loss:1700.0451 validation loss:27.2863, moco loss:4.0697
2025-05-09 02:46:13,009 - epoch:21, training loss:1698.5849 validation loss:26.9195, moco loss:7.7956
2025-05-09 02:46:25,040 - epoch:22, training loss:1701.8650 validation loss:26.7370, moco loss:86.2693
2025-05-09 02:46:37,311 - epoch:23, training loss:1691.2436 validation loss:27.4144, moco loss:107.2112
2025-05-09 02:46:49,486 - epoch:24, training loss:1688.3028 validation loss:27.4060, moco loss:28.8714
2025-05-09 02:47:01,677 - epoch:25, training loss:1695.3816 validation loss:27.0346, moco loss:19.5723
2025-05-09 02:47:13,986 - epoch:26, training loss:1688.0044 validation loss:26.6248, moco loss:44.0337
2025-05-09 02:47:26,062 - epoch:27, training loss:1690.2610 validation loss:27.8613, moco loss:76.9799
2025-05-09 02:47:38,268 - epoch:28, training loss:1682.2320 validation loss:26.7265, moco loss:16.5411
2025-05-09 02:47:50,370 - epoch:29, training loss:1685.1041 validation loss:28.5194, moco loss:4.0596
2025-05-09 02:48:02,474 - epoch:30, training loss:1684.6874 validation loss:27.2966, moco loss:30.9980
2025-05-09 02:48:14,461 - epoch:31, training loss:1683.1235 validation loss:27.8012, moco loss:41.2425
2025-05-09 02:48:26,443 - epoch:32, training loss:1677.7167 validation loss:27.2720, moco loss:12.6507
2025-05-09 02:48:29,720 - [*]Test--basic_loss:873.3651, event_loss:2413.7245, test_loss:1629.6993
2025-05-09 02:48:30,330 - [*] Evaluating all samples:
2025-05-09 02:48:30,330 - [*] year 2017, testing
2025-05-09 02:48:32,598 - T:3	MAE	20.0768	RMSE	29.9837	MAPE	13.2342
2025-05-09 02:48:36,159 - T:6	MAE	22.2673	RMSE	33.5317	MAPE	14.9968
2025-05-09 02:48:41,593 - T:12	MAE	26.4258	RMSE	40.1460	MAPE	18.6146
2025-05-09 02:48:41,884 - [*] Evaluating basic traffic samples (prediction=0):
2025-05-09 02:48:41,884 - [*] year 2017, testing
2025-05-09 02:48:42,902 - T:3	MAE	13.4371	RMSE	20.1459	MAPE	17.4455
2025-05-09 02:48:44,589 - T:6	MAE	14.7400	RMSE	22.2363	MAPE	19.9900
2025-05-09 02:48:47,147 - T:12	MAE	17.4776	RMSE	26.6112	MAPE	25.6539
2025-05-09 02:48:47,471 - [*] Evaluating event traffic samples (prediction=1):
2025-05-09 02:48:47,471 - [*] year 2017, testing
2025-05-09 02:48:48,458 - T:3	MAE	25.9548	RMSE	36.5459	MAPE	9.5063
2025-05-09 02:48:50,037 - T:6	MAE	28.9309	RMSE	41.0124	MAPE	10.5765
2025-05-09 02:48:52,620 - T:12	MAE	34.3447	RMSE	49.1061	MAPE	12.3816
2025-05-09 02:48:52,626 - Finished optimization, total time:281.46 s, best model:res/SD/trafficStream2025-05-09-02:41:35.529882/2017/26.6248.pkl
2025-05-09 02:48:52,706 - [*] Year 2018 load from data/SD/FastData/2018_30day.npz
2025-05-09 02:48:52,734 - Secure SignIn[*] load from res/SD/trafficStream2025-05-09-02:41:35.529882/2017/26.6248.pkl
2025-05-09 02:48:52,747 - [*] replay node number 64
2025-05-09 02:48:58,095 - number of increase nodes:61, nodes after 2 hop:torch.Size([518]), total nodes this year 716
2025-05-09 02:49:21,035 - [*] Year 2018 Dataset load!
2025-05-09 02:49:21,035 - Secure SignIn[*] load from res/SD/trafficStream2025-05-09-02:41:35.529882/2017/26.6248.pkl
2025-05-09 02:49:21,043 - [*] EWC! lambda 0.000100
2025-05-09 02:49:35,317 - [*] Model parameter count: 8842
2025-05-09 02:49:35,319 - [*] Year 2018 Training start
2025-05-09 02:49:36,209 - node number torch.Size([66304, 24])
2025-05-09 02:49:50,130 - epoch:0, training loss:1951.1894 validation loss:27.2888, moco loss:60.2699
2025-05-09 02:50:05,426 - epoch:1, training loss:1947.1477 validation loss:27.6079, moco loss:29.5816
2025-05-09 02:50:20,596 - epoch:2, training loss:1942.0242 validation loss:27.3353, moco loss:34.7943
2025-05-09 02:50:34,739 - epoch:3, training loss:1945.5740 validation loss:27.9029, moco loss:34.0222
2025-05-09 02:50:48,385 - epoch:4, training loss:1948.9366 validation loss:27.4228, moco loss:34.1492
2025-05-09 02:51:05,271 - epoch:5, training loss:1937.4111 validation loss:27.2805, moco loss:5.0498
2025-05-09 02:51:17,730 - epoch:6, training loss:1944.4224 validation loss:27.3231, moco loss:11.1516
2025-05-09 02:51:33,314 - epoch:7, training loss:1943.3912 validation loss:27.4504, moco loss:5.9074
2025-05-09 02:51:48,291 - epoch:8, training loss:1944.5624 validation loss:27.2700, moco loss:10.5407
2025-05-09 02:52:01,325 - epoch:9, training loss:1943.4836 validation loss:27.3409, moco loss:106.8549
2025-05-09 02:52:14,788 - epoch:10, training loss:1943.7609 validation loss:27.4665, moco loss:3.7296
2025-05-09 02:52:29,625 - epoch:11, training loss:1943.6163 validation loss:27.2160, moco loss:12.5368
2025-05-09 02:52:42,436 - epoch:12, training loss:1943.0229 validation loss:27.4568, moco loss:58.4623
2025-05-09 02:52:57,540 - epoch:13, training loss:1944.1009 validation loss:27.4029, moco loss:52.6429
2025-05-09 02:53:13,488 - epoch:14, training loss:1942.1938 validation loss:27.2463, moco loss:8.1482
2025-05-09 02:53:27,825 - epoch:15, training loss:1947.6338 validation loss:27.8927, moco loss:5.5188
2025-05-09 02:53:42,373 - epoch:16, training loss:1942.8436 validation loss:27.9336, moco loss:31.3860
2025-05-09 02:53:58,084 - epoch:17, training loss:1947.9462 validation loss:27.3825, moco loss:8.8020
2025-05-09 02:54:00,891 - [*]Test--basic_loss:945.8751, event_loss:2714.3457, test_loss:1755.6915
2025-05-09 02:54:00,947 - [*] Evaluating all samples:
2025-05-09 02:54:00,947 - [*] year 2018, testing
2025-05-09 02:54:01,004 - T:3	MAE	23.2347	RMSE	33.9847	MAPE	34.1740
2025-05-09 02:54:01,073 - T:6	MAE	24.1055	RMSE	35.3512	MAPE	26.7340
2025-05-09 02:54:01,174 - T:12	MAE	25.7880	RMSE	38.3729	MAPE	21.8777
2025-05-09 02:54:01,195 - [*] Evaluating basic traffic samples (prediction=0):
2025-05-09 02:54:01,195 - [*] year 2018, testing
2025-05-09 02:54:01,197 - T:3	MAE	14.0950	RMSE	18.4202	MAPE	14.3004
2025-05-09 02:54:01,200 - T:6	MAE	15.7203	RMSE	20.6727	MAPE	16.2834
2025-05-09 02:54:01,203 - T:12	MAE	19.2327	RMSE	25.7420	MAPE	20.8641
2025-05-09 02:54:01,227 - [*] Evaluating event traffic samples (prediction=1):
2025-05-09 02:54:01,227 - [*] year 2018, testing
2025-05-09 02:54:01,229 - T:3	MAE	17.3448	RMSE	22.3324	MAPE	11.0549
2025-05-09 02:54:01,230 - T:6	MAE	19.1157	RMSE	24.7079	MAPE	12.1696
2025-05-09 02:54:01,233 - T:12	MAE	23.2046	RMSE	30.7140	MAPE	14.7336
2025-05-09 02:54:01,233 - Finished optimization, total time:221.43 s, best model:res/SD/trafficStream2025-05-09-02:41:35.529882/2018/27.216.pkl
2025-05-09 02:54:01,309 - [*] Year 2019 load from data/SD/FastData/2019_30day.npz
2025-05-09 02:54:01,314 - Secure SignIn[*] load from res/SD/trafficStream2025-05-09-02:41:35.529882/2018/27.216.pkl
2025-05-09 02:54:01,326 - [*] replay node number 64
2025-05-09 02:54:06,771 - number of increase nodes:60, nodes after 2 hop:torch.Size([527]), total nodes this year 716
2025-05-09 02:54:30,083 - [*] Year 2019 Dataset load!
2025-05-09 02:54:30,083 - Secure SignIn[*] load from res/SD/trafficStream2025-05-09-02:41:35.529882/2018/27.216.pkl
2025-05-09 02:54:30,091 - [*] EWC! lambda 0.000100
2025-05-09 02:54:44,427 - [*] Model parameter count: 8842
2025-05-09 02:54:44,427 - [*] Year 2019 Training start
2025-05-09 02:54:45,248 - node number torch.Size([67456, 24])
2025-05-09 02:55:00,568 - epoch:0, training loss:1597.5909 validation loss:26.7153, moco loss:5.4933
2025-05-09 02:55:16,011 - epoch:1, training loss:1583.3463 validation loss:26.9204, moco loss:3.1722
2025-05-09 02:55:29,278 - epoch:2, training loss:1585.2136 validation loss:26.8218, moco loss:12.5888
2025-05-09 02:55:42,677 - epoch:3, training loss:1588.7109 validation loss:26.7491, moco loss:22.0298
2025-05-09 02:55:57,031 - epoch:4, training loss:1584.2046 validation loss:26.8477, moco loss:22.9709
2025-05-09 02:56:10,847 - epoch:5, training loss:1589.5860 validation loss:27.1698, moco loss:72.9088
2025-05-09 02:56:27,103 - epoch:6, training loss:1587.5299 validation loss:29.0635, moco loss:21.9071
2025-05-09 02:56:30,069 - [*]Test--basic_loss:757.6603, event_loss:2263.8898, test_loss:1552.3190
2025-05-09 02:56:30,182 - [*] Evaluating all samples:
2025-05-09 02:56:30,182 - [*] year 2019, testing
2025-05-09 02:56:30,238 - T:3	MAE	20.9491	RMSE	28.6899	MAPE	21.2697
2025-05-09 02:56:30,305 - T:6	MAE	22.1515	RMSE	30.8989	MAPE	21.8318
2025-05-09 02:56:30,403 - T:12	MAE	25.0660	RMSE	35.6256	MAPE	24.2297
2025-05-09 02:56:30,410 - [*] Evaluating basic traffic samples (prediction=0):
2025-05-09 02:56:30,410 - [*] year 2019, testing
2025-05-09 02:56:30,412 - T:3	MAE	17.4265	RMSE	23.1393	MAPE	15.1089
2025-05-09 02:56:30,414 - T:6	MAE	18.3106	RMSE	24.7544	MAPE	15.3123
2025-05-09 02:56:30,417 - T:12	MAE	21.1399	RMSE	30.1861	MAPE	16.6901
2025-05-09 02:56:30,444 - [*] Evaluating event traffic samples (prediction=1):
2025-05-09 02:56:30,444 - [*] year 2019, testing
2025-05-09 02:56:30,446 - T:3	MAE	32.0727	RMSE	41.4122	MAPE	8.0734
2025-05-09 02:56:30,448 - T:6	MAE	33.3955	RMSE	43.8224	MAPE	8.4146
2025-05-09 02:56:30,451 - T:12	MAE	35.9637	RMSE	47.9997	MAPE	9.0674
2025-05-09 02:56:30,451 - Finished optimization, total time:86.37 s, best model:res/SD/trafficStream2025-05-09-02:41:35.529882/2019/26.7153.pkl
2025-05-09 02:56:30,526 - [*] Year 2020 load from data/SD/FastData/2020_30day.npz
2025-05-09 02:56:30,531 - Secure SignIn[*] load from res/SD/trafficStream2025-05-09-02:41:35.529882/2019/26.7153.pkl
2025-05-09 02:56:30,542 - [*] replay node number 64
2025-05-09 02:56:35,893 - number of increase nodes:61, nodes after 2 hop:torch.Size([547]), total nodes this year 716
2025-05-09 02:56:59,290 - [*] Year 2020 Dataset load!
2025-05-09 02:56:59,290 - Secure SignIn[*] load from res/SD/trafficStream2025-05-09-02:41:35.529882/2019/26.7153.pkl
2025-05-09 02:56:59,298 - [*] EWC! lambda 0.000100
2025-05-09 02:57:13,471 - [*] Model parameter count: 8842
2025-05-09 02:57:13,471 - [*] Year 2020 Training start
2025-05-09 02:57:14,299 - node number torch.Size([70016, 24])
2025-05-09 02:57:26,660 - epoch:0, training loss:1953.0064 validation loss:24.1785, moco loss:17.0005
2025-05-09 02:57:39,987 - epoch:1, training loss:1924.9599 validation loss:23.9772, moco loss:52.6304
2025-05-09 02:57:54,245 - epoch:2, training loss:1926.6940 validation loss:24.0243, moco loss:29.7164
2025-05-09 02:58:09,188 - epoch:3, training loss:1930.7539 validation loss:24.2182, moco loss:61.7628
2025-05-09 02:58:23,702 - epoch:4, training loss:1939.0172 validation loss:24.1019, moco loss:11.2156
2025-05-09 02:58:36,787 - epoch:5, training loss:1928.2283 validation loss:24.5982, moco loss:38.1145
2025-05-09 02:58:53,312 - epoch:6, training loss:1925.5608 validation loss:23.9441, moco loss:43.2602
2025-05-09 02:59:08,890 - epoch:7, training loss:1932.8694 validation loss:24.6487, moco loss:51.7455
2025-05-09 02:59:22,248 - epoch:8, training loss:1926.5785 validation loss:24.2084, moco loss:14.7213
2025-05-09 02:59:39,186 - epoch:9, training loss:1930.9226 validation loss:24.5155, moco loss:20.6324
2025-05-09 02:59:54,348 - epoch:10, training loss:1930.0276 validation loss:23.9166, moco loss:5.8629
2025-05-09 03:00:08,258 - epoch:11, training loss:1928.9010 validation loss:23.8958, moco loss:5.2954
2025-05-09 03:00:24,592 - epoch:12, training loss:1929.4151 validation loss:24.5868, moco loss:9.4502
2025-05-09 03:00:37,995 - epoch:13, training loss:1930.1732 validation loss:24.0691, moco loss:11.0849
2025-05-09 03:00:52,040 - epoch:14, training loss:1923.8296 validation loss:24.2838, moco loss:25.1062
2025-05-09 03:01:05,349 - epoch:15, training loss:1937.3543 validation loss:24.0753, moco loss:7.3423
2025-05-09 03:01:20,468 - epoch:16, training loss:1928.0310 validation loss:24.5291, moco loss:16.1664
2025-05-09 03:01:35,080 - epoch:17, training loss:1934.8461 validation loss:24.5799, moco loss:29.0126
2025-05-09 03:01:37,919 - [*]Test--basic_loss:927.1601, event_loss:2404.2387, test_loss:1526.2154
2025-05-09 03:01:37,976 - [*] Evaluating all samples:
2025-05-09 03:01:37,977 - [*] year 2020, testing
2025-05-09 03:01:38,034 - T:3	MAE	23.4611	RMSE	34.3450	MAPE	32.7687
2025-05-09 03:01:38,104 - T:6	MAE	23.3231	RMSE	33.9664	MAPE	33.9142
2025-05-09 03:01:38,206 - T:12	MAE	23.4875	RMSE	33.8338	MAPE	30.9464
2025-05-09 03:01:38,215 - [*] Evaluating basic traffic samples (prediction=0):
2025-05-09 03:01:38,215 - [*] year 2020, testing
2025-05-09 03:01:38,217 - T:3	MAE	13.4190	RMSE	16.4692	MAPE	35.9796
2025-05-09 03:01:38,219 - T:6	MAE	12.9324	RMSE	16.2837	MAPE	33.5657
2025-05-09 03:01:38,223 - T:12	MAE	14.1129	RMSE	18.0635	MAPE	36.6530
2025-05-09 03:01:38,250 - [*] Evaluating event traffic samples (prediction=1):
2025-05-09 03:01:38,250 - [*] year 2020, testing
2025-05-09 03:01:38,252 - T:3	MAE	23.2339	RMSE	29.1984	MAPE	15.1767
2025-05-09 03:01:38,254 - T:6	MAE	24.6597	RMSE	31.4760	MAPE	15.9910
2025-05-09 03:01:38,257 - T:12	MAE	28.2381	RMSE	36.8098	MAPE	17.8444
2025-05-09 03:01:38,257 - Finished optimization, total time:219.41 s, best model:res/SD/trafficStream2025-05-09-02:41:35.529882/2020/23.8958.pkl
2025-05-09 03:01:38,307 - year	2017	total_time	281.45909700000004	average_time	8.529075	epoch	33
2025-05-09 03:01:38,307 - year	2018	total_time	221.431529	average_time	12.301766555555554	epoch	18
2025-05-09 03:01:38,307 - year	2019	total_time	86.365276	average_time	12.337911857142856	epoch	7
2025-05-09 03:01:38,307 - year	2020	total_time	219.41485500000002	average_time	12.189728111111112	epoch	18
