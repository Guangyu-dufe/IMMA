2025-05-01 05:52:07,914 - logger name:res/SD/trafficStream2025-05-01-05:52:07.913158/trafficStream.log
2025-05-01 05:52:07,914 - params : {'conf': 'conf/trafficStream_SD.json', 'paral': 0, 'gpuid': 5, 'logname': 'trafficStream', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/SD/trafficStream2025-04-17-12:25:53.499043/2017/26.012.pkl', 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/SD/finaldata/', 'save_data_path': 'data/SD/FastData/', 'graph_path': 'data/SD/graph/', 'model_path': 'res/SD/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': False, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 300, 'extra_feature': True, 'time': '2025-05-01-05:52:07.913158', 'path': 'res/SD/trafficStream2025-05-01-05:52:07.913158', 'device': device(type='cuda', index=5), 'logger': <Logger __main__ (INFO)>}
2025-05-01 05:52:49,599 - [*] Year 2017 load from data/SD/FastData/2017_30day.npz
2025-05-01 05:52:49,851 - [*] Year 2017 Dataset load!
2025-05-01 05:52:49,854 - [*] Model parameter count: 7306
2025-05-01 05:52:49,855 - [*] Year 2017 Training start
2025-05-01 05:52:50,304 - node number torch.Size([91648, 24])
2025-05-01 05:53:07,690 - [*]Train--basic_loss:6870.0088, event_loss:nan, classification_loss:0.3744
2025-05-01 05:53:07,690 - [*]Validation--basic_loss:1596.3349, event_loss:nan
2025-05-01 05:53:07,690 - epoch:0, training loss:8885.2055 validation loss:30.0838
2025-05-01 05:53:24,566 - [*]Train--basic_loss:1499.7510, event_loss:nan, classification_loss:0.3405
2025-05-01 05:53:24,566 - [*]Validation--basic_loss:1448.5335, event_loss:nan
2025-05-01 05:53:24,566 - epoch:1, training loss:2068.9100 validation loss:28.9627
2025-05-01 05:53:41,419 - [*]Train--basic_loss:1410.8629, event_loss:nan, classification_loss:0.3306
2025-05-01 05:53:41,419 - [*]Validation--basic_loss:1513.4419, event_loss:nan
2025-05-01 05:53:41,420 - epoch:2, training loss:1963.4051 validation loss:28.5079
2025-05-01 05:53:58,090 - [*]Train--basic_loss:1398.1212, event_loss:nan, classification_loss:0.3246
2025-05-01 05:53:58,090 - [*]Validation--basic_loss:1452.2605, event_loss:nan
2025-05-01 05:53:58,090 - epoch:3, training loss:1920.0257 validation loss:28.3694
2025-05-01 05:54:15,061 - [*]Train--basic_loss:1397.5263, event_loss:nan, classification_loss:0.3232
2025-05-01 05:54:15,061 - [*]Validation--basic_loss:1370.4333, event_loss:nan
2025-05-01 05:54:15,061 - epoch:4, training loss:1900.2976 validation loss:28.3654
2025-05-01 05:54:32,030 - [*]Train--basic_loss:1391.1930, event_loss:nan, classification_loss:0.3184
2025-05-01 05:54:32,031 - [*]Validation--basic_loss:1408.7628, event_loss:nan
2025-05-01 05:54:32,031 - epoch:5, training loss:1885.5126 validation loss:28.4686
2025-05-01 05:54:48,939 - [*]Train--basic_loss:1397.4574, event_loss:nan, classification_loss:0.3187
2025-05-01 05:54:48,939 - [*]Validation--basic_loss:1442.4439, event_loss:nan
2025-05-01 05:54:48,939 - epoch:6, training loss:1874.1379 validation loss:28.0576
2025-05-01 05:55:06,020 - [*]Train--basic_loss:1398.4461, event_loss:nan, classification_loss:0.3156
2025-05-01 05:55:06,020 - [*]Validation--basic_loss:1465.7729, event_loss:nan
2025-05-01 05:55:06,020 - epoch:7, training loss:1868.7485 validation loss:28.4013
2025-05-01 05:55:22,844 - [*]Train--basic_loss:1402.5269, event_loss:nan, classification_loss:0.3153
2025-05-01 05:55:22,844 - [*]Validation--basic_loss:1471.2969, event_loss:nan
2025-05-01 05:55:22,844 - epoch:8, training loss:1858.5852 validation loss:28.8350
2025-05-01 05:55:39,723 - [*]Train--basic_loss:1395.6818, event_loss:nan, classification_loss:0.3107
2025-05-01 05:55:39,723 - [*]Validation--basic_loss:1371.5636, event_loss:nan
2025-05-01 05:55:39,723 - epoch:9, training loss:1853.5470 validation loss:27.8459
2025-05-01 05:55:56,454 - [*]Train--basic_loss:1398.4017, event_loss:nan, classification_loss:0.3090
2025-05-01 05:55:56,455 - [*]Validation--basic_loss:1433.7872, event_loss:nan
2025-05-01 05:55:56,455 - epoch:10, training loss:1852.2645 validation loss:28.2657
2025-05-01 05:56:13,362 - [*]Train--basic_loss:1406.4902, event_loss:nan, classification_loss:0.3172
2025-05-01 05:56:13,362 - [*]Validation--basic_loss:1430.0307, event_loss:nan
2025-05-01 05:56:13,362 - epoch:11, training loss:1850.3212 validation loss:28.1727
2025-05-01 05:56:30,331 - [*]Train--basic_loss:1392.5577, event_loss:nan, classification_loss:0.3137
2025-05-01 05:56:30,331 - [*]Validation--basic_loss:1504.0720, event_loss:nan
2025-05-01 05:56:30,332 - epoch:12, training loss:1845.1908 validation loss:28.8411
2025-05-01 05:56:47,295 - [*]Train--basic_loss:1374.3857, event_loss:nan, classification_loss:0.3091
2025-05-01 05:56:47,296 - [*]Validation--basic_loss:1404.2802, event_loss:nan
2025-05-01 05:56:47,296 - epoch:13, training loss:1816.8795 validation loss:27.8436
2025-05-01 05:57:04,143 - [*]Train--basic_loss:1340.4129, event_loss:nan, classification_loss:0.3096
2025-05-01 05:57:04,144 - [*]Validation--basic_loss:1361.9617, event_loss:nan
2025-05-01 05:57:04,144 - epoch:14, training loss:1763.3836 validation loss:27.9388
2025-05-01 05:57:21,093 - [*]Train--basic_loss:1329.1179, event_loss:nan, classification_loss:0.3096
2025-05-01 05:57:21,093 - [*]Validation--basic_loss:1310.4064, event_loss:nan
2025-05-01 05:57:21,093 - epoch:15, training loss:1739.8522 validation loss:27.0243
2025-05-01 05:57:37,910 - [*]Train--basic_loss:1306.7688, event_loss:nan, classification_loss:0.3048
2025-05-01 05:57:37,910 - [*]Validation--basic_loss:1361.2999, event_loss:nan
2025-05-01 05:57:37,910 - epoch:16, training loss:1720.9861 validation loss:27.8292
2025-05-01 05:57:54,839 - [*]Train--basic_loss:1289.5633, event_loss:nan, classification_loss:0.3062
2025-05-01 05:57:54,839 - [*]Validation--basic_loss:1318.5694, event_loss:nan
2025-05-01 05:57:54,840 - epoch:17, training loss:1710.5023 validation loss:27.2308
2025-05-01 05:58:11,736 - [*]Train--basic_loss:1291.3103, event_loss:nan, classification_loss:0.3059
2025-05-01 05:58:11,736 - [*]Validation--basic_loss:1338.4939, event_loss:nan
2025-05-01 05:58:11,736 - epoch:18, training loss:1709.8397 validation loss:27.1085
2025-05-01 05:58:28,579 - [*]Train--basic_loss:1291.6639, event_loss:nan, classification_loss:0.3046
2025-05-01 05:58:28,579 - [*]Validation--basic_loss:1283.4837, event_loss:nan
2025-05-01 05:58:28,579 - epoch:19, training loss:1701.9950 validation loss:27.0770
2025-05-01 05:58:45,108 - [*]Train--basic_loss:1271.2090, event_loss:nan, classification_loss:0.3101
2025-05-01 05:58:45,108 - [*]Validation--basic_loss:1352.0441, event_loss:nan
2025-05-01 05:58:45,108 - epoch:20, training loss:1695.9783 validation loss:27.4570
2025-05-01 05:59:02,028 - [*]Train--basic_loss:1284.8837, event_loss:nan, classification_loss:0.3060
2025-05-01 05:59:02,028 - [*]Validation--basic_loss:1280.0461, event_loss:nan
2025-05-01 05:59:02,029 - epoch:21, training loss:1698.7392 validation loss:26.8744
2025-05-01 05:59:18,960 - [*]Train--basic_loss:1279.9612, event_loss:nan, classification_loss:0.3046
2025-05-01 05:59:18,960 - [*]Validation--basic_loss:1356.1870, event_loss:nan
2025-05-01 05:59:18,960 - epoch:22, training loss:1689.3649 validation loss:27.1146
2025-05-01 05:59:35,847 - [*]Train--basic_loss:1275.7014, event_loss:nan, classification_loss:0.3052
2025-05-01 05:59:35,848 - [*]Validation--basic_loss:1304.1165, event_loss:nan
2025-05-01 05:59:35,848 - epoch:23, training loss:1685.5212 validation loss:26.9711
2025-05-01 05:59:52,799 - [*]Train--basic_loss:1278.9477, event_loss:nan, classification_loss:0.3048
2025-05-01 05:59:52,799 - [*]Validation--basic_loss:1367.7636, event_loss:nan
2025-05-01 05:59:52,799 - epoch:24, training loss:1685.5945 validation loss:27.5999
2025-05-01 06:00:09,690 - [*]Train--basic_loss:1267.7483, event_loss:nan, classification_loss:0.3043
2025-05-01 06:00:09,690 - [*]Validation--basic_loss:1349.1745, event_loss:nan
2025-05-01 06:00:09,690 - epoch:25, training loss:1683.4076 validation loss:27.5167
2025-05-01 06:00:26,653 - [*]Train--basic_loss:1256.3309, event_loss:nan, classification_loss:0.3061
2025-05-01 06:00:26,653 - [*]Validation--basic_loss:1261.2984, event_loss:nan
2025-05-01 06:00:26,653 - epoch:26, training loss:1678.4766 validation loss:26.9936
2025-05-01 06:00:43,610 - [*]Train--basic_loss:1246.3897, event_loss:nan, classification_loss:0.3058
2025-05-01 06:00:43,611 - [*]Validation--basic_loss:1375.7035, event_loss:nan
2025-05-01 06:00:43,611 - epoch:27, training loss:1675.4315 validation loss:27.1480
2025-05-01 06:00:46,500 - [*]Test--basic_loss:1233.1263, event_loss:nan, test_loss:1616.2767
2025-05-01 06:00:46,923 - [*] Evaluating all samples:
2025-05-01 06:00:46,923 - [*] year 2017, testing
2025-05-01 06:00:49,306 - T:3	MAE	20.3367	RMSE	30.3508	MAPE	12.8129
2025-05-01 06:00:53,036 - T:6	MAE	22.2660	RMSE	33.5594	MAPE	14.5851
2025-05-01 06:00:58,819 - T:12	MAE	26.2759	RMSE	39.9755	MAPE	18.6794
2025-05-01 06:00:59,324 - [*] Evaluating basic traffic samples (prediction=0):
2025-05-01 06:00:59,324 - [*] year 2017, testing
2025-05-01 06:01:01,075 - T:3	MAE	18.2390	RMSE	27.1707	MAPE	13.3688
2025-05-01 06:01:03,969 - T:6	MAE	19.6646	RMSE	29.4341	MAPE	15.2384
2025-05-01 06:01:08,463 - T:12	MAE	22.7855	RMSE	34.1530	MAPE	19.8303
2025-05-01 06:01:08,609 - [*] Evaluating event traffic samples (prediction=1):
2025-05-01 06:01:08,609 - [*] year 2017, testing
2025-05-01 06:01:09,019 - T:3	MAE	27.6411	RMSE	39.4728	MAPE	10.8774
2025-05-01 06:01:09,635 - T:6	MAE	31.3233	RMSE	45.0670	MAPE	12.3108
2025-05-01 06:01:10,509 - T:12	MAE	38.4237	RMSE	55.6809	MAPE	14.6709
2025-05-01 06:01:10,515 - Finished optimization, total time:406.18 s, best model:res/SD/trafficStream2025-05-01-05:52:07.913158/2017/26.8744.pkl
2025-05-01 06:01:49,379 - [*] Year 2018 load from data/SD/FastData/2018_30day.npz
2025-05-01 06:01:49,394 - Secure SignIn[*] load from res/SD/trafficStream2025-05-01-05:52:07.913158/2017/26.8744.pkl
2025-05-01 06:01:49,410 - [*] replay node number 64
2025-05-01 06:01:49,477 - number of increase nodes:61, nodes after 2 hop:torch.Size([518]), total nodes this year 716
2025-05-01 06:01:59,441 - [*] Year 2018 Dataset load!
2025-05-01 06:01:59,441 - Secure SignIn[*] load from res/SD/trafficStream2025-05-01-05:52:07.913158/2017/26.8744.pkl
2025-05-01 06:01:59,448 - [*] EWC! lambda 0.000100
