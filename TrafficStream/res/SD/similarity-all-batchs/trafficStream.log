2025-05-03 11:11:48,995 - logger name:res/SD/trafficStream2025-05-03-11:11:48.994633/trafficStream.log
2025-05-03 11:11:48,995 - params : {'conf': 'conf/trafficStream_SD.json', 'paral': 0, 'gpuid': 5, 'logname': 'trafficStream', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/SD/trafficStream2025-04-17-12:25:53.499043/2017/26.012.pkl', 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/SD/finaldata/', 'save_data_path': 'data/SD/FastData/', 'graph_path': 'data/SD/graph/', 'model_path': 'res/SD/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': False, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 300, 'extra_feature': True, 'time': '2025-05-03-11:11:48.994633', 'path': 'res/SD/trafficStream2025-05-03-11:11:48.994633', 'device': device(type='cuda', index=5), 'logger': <Logger __main__ (INFO)>}
2025-05-03 11:11:49,023 - [*] Year 2017 load from data/SD/FastData/2017_30day.npz
2025-05-03 11:12:02,433 - [*] Year 2017 Dataset load!
2025-05-03 11:12:02,436 - [*] Model parameter count: 8842
2025-05-03 11:12:02,436 - [*] Classifier parameter count: 4994
2025-05-03 11:12:02,436 - [*] Year 2017 Training start
2025-05-03 11:12:02,885 - node number torch.Size([91648, 24])
2025-05-03 11:12:18,889 - epoch:0, training loss:9040.8884 validation loss:30.1236, similarity:[0.4626885652542114, 0.4664885997772217, 0.4751549959182739, 0.5260555744171143, 0.5376365780830383]
2025-05-03 11:12:34,748 - epoch:1, training loss:2073.2868 validation loss:28.5095, similarity:[0.7739782333374023, 0.7631105780601501, 0.7631608247756958, 0.7687910795211792, 0.7624298334121704]
2025-05-03 11:12:50,898 - epoch:2, training loss:1967.8962 validation loss:28.2960, similarity:[0.7656400203704834, 0.7655683755874634, 0.7601768374443054, 0.7533578872680664, 0.766364336013794]
2025-05-03 11:13:06,698 - epoch:3, training loss:1918.5342 validation loss:28.3264, similarity:[0.7735458016395569, 0.7731928825378418, 0.7585378885269165, 0.7730653285980225, 0.7574719190597534]
2025-05-03 11:13:22,857 - epoch:4, training loss:1897.2633 validation loss:28.8622, similarity:[0.7555669546127319, 0.7526066899299622, 0.7398195266723633, 0.7362390160560608, 0.7393432259559631]
2025-05-03 11:13:38,721 - epoch:5, training loss:1887.8711 validation loss:28.4435, similarity:[0.7650495767593384, 0.7600948810577393, 0.7557736039161682, 0.743364691734314, 0.744249701499939]
2025-05-03 11:13:54,674 - epoch:6, training loss:1873.8148 validation loss:28.2728, similarity:[0.7119374871253967, 0.7205992937088013, 0.7216949462890625, 0.724807858467102, 0.727971076965332]
2025-05-03 11:14:10,542 - epoch:7, training loss:1864.2706 validation loss:28.7013, similarity:[0.7127564549446106, 0.7028933763504028, 0.7112376689910889, 0.7025139927864075, 0.7159340977668762]
2025-05-03 11:14:26,482 - epoch:8, training loss:1859.8152 validation loss:27.8096, similarity:[0.7089883089065552, 0.7164438962936401, 0.7032897472381592, 0.7182403206825256, 0.7083714008331299]
2025-05-03 11:14:42,384 - epoch:9, training loss:1855.4208 validation loss:28.3252, similarity:[0.6914645433425903, 0.6814756393432617, 0.6958767175674438, 0.6981915831565857, 0.680573582649231]
2025-05-03 11:14:58,395 - epoch:10, training loss:1851.4029 validation loss:27.8221, similarity:[0.684975266456604, 0.6970447301864624, 0.6907581090927124, 0.7014344334602356, 0.7117760181427002]
2025-05-03 11:15:14,516 - epoch:11, training loss:1845.9039 validation loss:28.9021, similarity:[0.6755841374397278, 0.6824427843093872, 0.6856228113174438, 0.6889785528182983, 0.6870473623275757]
2025-05-03 11:15:30,662 - epoch:12, training loss:1839.5369 validation loss:28.5344, similarity:[0.665459930896759, 0.6643733382225037, 0.6588947176933289, 0.6829553842544556, 0.6562124490737915]
2025-05-03 11:15:46,728 - epoch:13, training loss:1840.4295 validation loss:28.4863, similarity:[0.6623592376708984, 0.6564300060272217, 0.6563599109649658, 0.6379210948944092, 0.6541261672973633]
2025-05-03 11:16:02,824 - epoch:14, training loss:1839.4346 validation loss:28.5046, similarity:[0.6536585688591003, 0.6457770466804504, 0.6509160995483398, 0.6457345485687256, 0.648593544960022]
2025-05-03 11:16:05,413 - [*]Test--basic_loss:1361.8077, event_loss:nan, test_loss:1786.0820
2025-05-03 11:16:05,948 - [*] Evaluating all samples:
2025-05-03 11:16:05,948 - [*] year 2017, testing
2025-05-03 11:16:08,237 - T:3	MAE	20.4989	RMSE	30.6001	MAPE	14.5213
2025-05-03 11:16:11,902 - T:6	MAE	22.7584	RMSE	34.3460	MAPE	17.1766
2025-05-03 11:16:17,518 - T:12	MAE	27.4030	RMSE	41.9806	MAPE	22.5089
2025-05-03 11:16:18,044 - [*] Evaluating basic traffic samples (prediction=0):
2025-05-03 11:16:18,045 - [*] year 2017, testing
2025-05-03 11:16:19,858 - T:3	MAE	19.0923	RMSE	28.4070	MAPE	14.7167
2025-05-03 11:16:22,855 - T:6	MAE	20.7918	RMSE	31.0136	MAPE	17.4768
2025-05-03 11:16:27,577 - T:12	MAE	24.4741	RMSE	36.4358	MAPE	23.2273
2025-05-03 11:16:27,680 - [*] Evaluating event traffic samples (prediction=1):
2025-05-03 11:16:27,681 - [*] year 2017, testing
2025-05-03 11:16:27,965 - T:3	MAE	27.8911	RMSE	40.2048	MAPE	13.4944
2025-05-03 11:16:28,382 - T:6	MAE	33.0915	RMSE	48.2088	MAPE	15.5992
2025-05-03 11:16:28,976 - T:12	MAE	42.7870	RMSE	63.6123	MAPE	18.7319
2025-05-03 11:16:28,981 - Finished optimization, total time:197.04 s, best model:res/SD/trafficStream2025-05-03-11:11:48.994633/2017/27.8096.pkl
2025-05-03 11:16:29,054 - [*] Year 2018 load from data/SD/FastData/2018_30day.npz
2025-05-03 11:16:29,072 - Secure SignIn[*] load from res/SD/trafficStream2025-05-03-11:11:48.994633/2017/27.8096.pkl
2025-05-03 11:16:29,081 - [*] replay node number 64
