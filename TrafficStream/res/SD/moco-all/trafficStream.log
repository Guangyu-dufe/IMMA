2025-05-09 02:12:45,949 - logger name:res/SD/trafficStream2025-05-09-02:12:45.948873/trafficStream.log
2025-05-09 02:12:45,950 - params : {'conf': 'conf/trafficStream_SD.json', 'paral': 0, 'gpuid': 5, 'logname': 'trafficStream', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/SD/linear-moco/2017/26.5761.pkl', 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/SD/finaldata/', 'save_data_path': 'data/SD/FastData/', 'graph_path': 'data/SD/graph/', 'model_path': 'res/SD/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'classifier': {'hidden_dim': 128}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': False, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 300, 'extra_feature': True, 'momentum_type': 'linear', 'time': '2025-05-09-02:12:45.948873', 'path': 'res/SD/trafficStream2025-05-09-02:12:45.948873', 'device': device(type='cuda', index=5), 'logger': <Logger __main__ (INFO)>}
2025-05-09 02:12:45,977 - [*] Year 2017 load from data/SD/FastData/2017_30day.npz
2025-05-09 02:12:59,708 - [*] Year 2017 Dataset load!
2025-05-09 02:12:59,712 - [*] Model parameter count: 8842
2025-05-09 02:12:59,712 - [*] Year 2017 Training start
2025-05-09 02:13:00,014 - node number torch.Size([91648, 24])
2025-05-09 02:13:12,378 - epoch:0, training loss:10334.1427 validation loss:35.3824, moco loss:3790.6719
2025-05-09 02:13:24,085 - epoch:1, training loss:2466.8055 validation loss:30.2414, moco loss:745.7204
2025-05-09 02:13:35,612 - epoch:2, training loss:1965.6107 validation loss:28.2824, moco loss:57.8271
2025-05-09 02:13:47,657 - epoch:3, training loss:1914.8795 validation loss:28.7850, moco loss:20.2067
2025-05-09 02:13:59,626 - epoch:4, training loss:1900.1524 validation loss:28.2107, moco loss:5.7891
2025-05-09 02:14:11,479 - epoch:5, training loss:1885.1265 validation loss:28.4444, moco loss:34.2825
2025-05-09 02:14:23,541 - epoch:6, training loss:1874.5385 validation loss:28.1106, moco loss:44.2666
2025-05-09 02:14:35,618 - epoch:7, training loss:1865.7411 validation loss:28.0666, moco loss:25.8992
2025-05-09 02:14:47,442 - epoch:8, training loss:1859.4812 validation loss:27.8764, moco loss:11.2048
2025-05-09 02:14:59,379 - epoch:9, training loss:1851.8010 validation loss:28.2382, moco loss:30.9525
2025-05-09 02:15:11,274 - epoch:10, training loss:1838.3273 validation loss:27.6903, moco loss:19.4805
2025-05-09 02:15:23,725 - epoch:11, training loss:1802.5387 validation loss:27.4202, moco loss:27.2400
2025-05-09 02:15:35,484 - epoch:12, training loss:1767.3695 validation loss:26.9532, moco loss:37.0133
2025-05-09 02:15:47,501 - epoch:13, training loss:1745.2755 validation loss:27.0247, moco loss:25.5607
2025-05-09 02:15:59,432 - epoch:14, training loss:1729.8466 validation loss:26.9809, moco loss:28.8432
2025-05-09 02:16:11,553 - epoch:15, training loss:1724.1094 validation loss:27.8609, moco loss:7.9847
2025-05-09 02:16:23,626 - epoch:16, training loss:1708.5972 validation loss:27.6186, moco loss:30.9174
2025-05-09 02:16:35,689 - epoch:17, training loss:1704.5013 validation loss:27.3491, moco loss:3.6390
2025-05-09 02:16:47,795 - epoch:18, training loss:1701.1097 validation loss:28.0425, moco loss:8.3365
2025-05-09 02:16:51,000 - [*]Test--basic_loss:963.4750, event_loss:2500.6262, test_loss:1696.6357
2025-05-09 02:16:51,452 - [*] Evaluating all samples:
2025-05-09 02:16:51,452 - [*] year 2017, testing
2025-05-09 02:16:53,807 - T:3	MAE	20.5186	RMSE	30.6116	MAPE	13.8876
2025-05-09 02:16:57,554 - T:6	MAE	22.6697	RMSE	34.0414	MAPE	16.2426
2025-05-09 02:17:03,292 - T:12	MAE	27.1021	RMSE	40.9252	MAPE	21.3879
2025-05-09 02:17:03,617 - [*] Evaluating basic traffic samples (prediction=0):
2025-05-09 02:17:03,617 - [*] year 2017, testing
2025-05-09 02:17:04,746 - T:3	MAE	14.3447	RMSE	21.5658	MAPE	17.8129
2025-05-09 02:17:06,643 - T:6	MAE	15.8128	RMSE	23.7046	MAPE	21.4283
2025-05-09 02:17:09,547 - T:12	MAE	19.0530	RMSE	28.4113	MAPE	29.6786
2025-05-09 02:17:09,860 - [*] Evaluating event traffic samples (prediction=1):
2025-05-09 02:17:09,860 - [*] year 2017, testing
2025-05-09 02:17:10,760 - T:3	MAE	26.8437	RMSE	37.6910	MAPE	9.8664
2025-05-09 02:17:12,093 - T:6	MAE	29.6943	RMSE	42.0752	MAPE	10.9301
2025-05-09 02:17:14,228 - T:12	MAE	35.3455	RMSE	50.6318	MAPE	12.8924
2025-05-09 02:17:14,233 - Finished optimization, total time:163.42 s, best model:res/SD/trafficStream2025-05-09-02:12:45.948873/2017/26.9532.pkl
2025-05-09 02:17:14,299 - [*] Year 2018 load from data/SD/FastData/2018_30day.npz
2025-05-09 02:17:14,324 - Secure SignIn[*] load from res/SD/trafficStream2025-05-09-02:12:45.948873/2017/26.9532.pkl
2025-05-09 02:17:14,336 - [*] replay node number 64
2025-05-09 02:17:19,606 - number of increase nodes:61, nodes after 2 hop:torch.Size([518]), total nodes this year 716
2025-05-09 02:17:42,323 - [*] Year 2018 Dataset load!
2025-05-09 02:17:42,324 - Secure SignIn[*] load from res/SD/trafficStream2025-05-09-02:12:45.948873/2017/26.9532.pkl
2025-05-09 02:17:42,331 - [*] EWC! lambda 0.000100
2025-05-09 02:17:56,293 - [*] Model parameter count: 8842
2025-05-09 02:17:56,293 - [*] Year 2018 Training start
2025-05-09 02:17:56,977 - node number torch.Size([66304, 24])
2025-05-09 02:18:09,861 - epoch:0, training loss:2011.6576 validation loss:27.8543, moco loss:26.4179
2025-05-09 02:18:23,819 - epoch:1, training loss:1995.6182 validation loss:27.7296, moco loss:5.8619
2025-05-09 02:18:37,505 - epoch:2, training loss:1998.7964 validation loss:27.6260, moco loss:2.4234
2025-05-09 02:18:52,317 - epoch:3, training loss:1995.2940 validation loss:27.9706, moco loss:9.3861
2025-05-09 02:19:04,891 - epoch:4, training loss:1991.2243 validation loss:27.6274, moco loss:5.8240
2025-05-09 02:19:15,415 - epoch:5, training loss:1993.8279 validation loss:27.6307, moco loss:1.7840
2025-05-09 02:19:28,571 - epoch:6, training loss:2003.9926 validation loss:27.6576, moco loss:1.8595
2025-05-09 02:19:45,257 - epoch:7, training loss:1993.2458 validation loss:27.9886, moco loss:1.6031
2025-05-09 02:20:00,334 - epoch:8, training loss:1993.6334 validation loss:27.7504, moco loss:8.3921
2025-05-09 02:20:03,139 - [*]Test--basic_loss:934.6739, event_loss:2740.3212, test_loss:1705.0374
2025-05-09 02:20:03,259 - [*] Evaluating all samples:
2025-05-09 02:20:03,259 - [*] year 2018, testing
2025-05-09 02:20:03,333 - T:3	MAE	23.5422	RMSE	33.7284	MAPE	41.9263
2025-05-09 02:20:03,423 - T:6	MAE	24.3083	RMSE	34.9900	MAPE	31.9299
2025-05-09 02:20:03,550 - T:12	MAE	25.8024	RMSE	37.8143	MAPE	25.2092
2025-05-09 02:20:03,591 - [*] Evaluating basic traffic samples (prediction=0):
2025-05-09 02:20:03,592 - [*] year 2018, testing
2025-05-09 02:20:03,594 - T:3	MAE	14.1785	RMSE	18.5102	MAPE	15.6903
2025-05-09 02:20:03,596 - T:6	MAE	15.6337	RMSE	20.5240	MAPE	17.3219
2025-05-09 02:20:03,599 - T:12	MAE	18.7894	RMSE	25.0248	MAPE	21.6607
2025-05-09 02:20:03,655 - [*] Evaluating event traffic samples (prediction=1):
2025-05-09 02:20:03,655 - [*] year 2018, testing
2025-05-09 02:20:03,657 - T:3	MAE	17.0176	RMSE	21.8203	MAPE	11.0101
2025-05-09 02:20:03,659 - T:6	MAE	18.5124	RMSE	23.8049	MAPE	11.9651
2025-05-09 02:20:03,661 - T:12	MAE	21.9992	RMSE	28.8374	MAPE	14.1895
2025-05-09 02:20:03,661 - Finished optimization, total time:103.93 s, best model:res/SD/trafficStream2025-05-09-02:12:45.948873/2018/27.626.pkl
2025-05-09 02:20:03,757 - [*] Year 2019 load from data/SD/FastData/2019_30day.npz
2025-05-09 02:20:03,765 - Secure SignIn[*] load from res/SD/trafficStream2025-05-09-02:12:45.948873/2018/27.626.pkl
2025-05-09 02:20:03,778 - [*] replay node number 64
2025-05-09 02:20:09,213 - number of increase nodes:60, nodes after 2 hop:torch.Size([527]), total nodes this year 716
2025-05-09 02:20:33,577 - [*] Year 2019 Dataset load!
2025-05-09 02:20:33,577 - Secure SignIn[*] load from res/SD/trafficStream2025-05-09-02:12:45.948873/2018/27.626.pkl
2025-05-09 02:20:33,586 - [*] EWC! lambda 0.000100
2025-05-09 02:20:47,736 - [*] Model parameter count: 8842
2025-05-09 02:20:47,737 - [*] Year 2019 Training start
2025-05-09 02:20:48,615 - node number torch.Size([67456, 24])
2025-05-09 02:21:02,447 - epoch:0, training loss:1644.2472 validation loss:27.0051, moco loss:45.5100
2025-05-09 02:21:18,939 - epoch:1, training loss:1625.0422 validation loss:27.1184, moco loss:8.5005
2025-05-09 02:21:34,374 - epoch:2, training loss:1629.4008 validation loss:27.1128, moco loss:25.8877
2025-05-09 02:21:50,466 - epoch:3, training loss:1626.4975 validation loss:27.3749, moco loss:3.1926
2025-05-09 02:22:06,381 - epoch:4, training loss:1627.5696 validation loss:27.1005, moco loss:12.1049
2025-05-09 02:22:22,203 - epoch:5, training loss:1626.3808 validation loss:27.2243, moco loss:18.5134
2025-05-09 02:22:37,921 - epoch:6, training loss:1625.9910 validation loss:27.2167, moco loss:22.8583
2025-05-09 02:22:40,898 - [*]Test--basic_loss:968.1189, event_loss:2367.3892, test_loss:1677.8329
2025-05-09 02:22:41,000 - [*] Evaluating all samples:
2025-05-09 02:22:41,000 - [*] year 2019, testing
2025-05-09 02:22:41,066 - T:3	MAE	20.3870	RMSE	28.2349	MAPE	20.9454
2025-05-09 02:22:41,142 - T:6	MAE	22.3012	RMSE	31.2746	MAPE	22.7422
2025-05-09 02:22:41,250 - T:12	MAE	26.1549	RMSE	37.0462	MAPE	27.4439
2025-05-09 02:22:41,275 - [*] Evaluating basic traffic samples (prediction=0):
2025-05-09 02:22:41,275 - [*] year 2019, testing
2025-05-09 02:22:41,277 - T:3	MAE	18.4837	RMSE	24.6114	MAPE	14.3723
2025-05-09 02:22:41,279 - T:6	MAE	19.6442	RMSE	26.2700	MAPE	15.2037
2025-05-09 02:22:41,282 - T:12	MAE	22.4446	RMSE	30.6659	MAPE	17.4087
2025-05-09 02:22:41,310 - [*] Evaluating event traffic samples (prediction=1):
2025-05-09 02:22:41,310 - [*] year 2019, testing
2025-05-09 02:22:41,312 - T:3	MAE	29.9272	RMSE	39.4928	MAPE	7.8172
2025-05-09 02:22:41,314 - T:6	MAE	32.4777	RMSE	43.4464	MAPE	8.4436
2025-05-09 02:22:41,316 - T:12	MAE	36.8230	RMSE	50.0651	MAPE	9.4888
2025-05-09 02:22:41,317 - Finished optimization, total time:93.31 s, best model:res/SD/trafficStream2025-05-09-02:12:45.948873/2019/27.0051.pkl
2025-05-09 02:22:41,391 - [*] Year 2020 load from data/SD/FastData/2020_30day.npz
2025-05-09 02:22:41,397 - Secure SignIn[*] load from res/SD/trafficStream2025-05-09-02:12:45.948873/2019/27.0051.pkl
2025-05-09 02:22:41,409 - [*] replay node number 64
2025-05-09 02:22:46,828 - number of increase nodes:61, nodes after 2 hop:torch.Size([547]), total nodes this year 716
2025-05-09 02:23:11,216 - [*] Year 2020 Dataset load!
2025-05-09 02:23:11,217 - Secure SignIn[*] load from res/SD/trafficStream2025-05-09-02:12:45.948873/2019/27.0051.pkl
2025-05-09 02:23:11,225 - [*] EWC! lambda 0.000100
2025-05-09 02:23:25,588 - [*] Model parameter count: 8842
2025-05-09 02:23:25,589 - [*] Year 2020 Training start
2025-05-09 02:23:26,558 - node number torch.Size([70016, 24])
2025-05-09 02:23:39,725 - epoch:0, training loss:2583.0712 validation loss:23.9749, moco loss:840.9497
2025-05-09 02:23:55,526 - epoch:1, training loss:2230.5302 validation loss:23.8175, moco loss:139.7185
2025-05-09 02:24:11,432 - epoch:2, training loss:2135.3678 validation loss:24.1935, moco loss:36.7993
2025-05-09 02:24:25,687 - epoch:3, training loss:2126.8095 validation loss:23.6983, moco loss:15.5473
2025-05-09 02:24:39,353 - epoch:4, training loss:2126.4695 validation loss:24.9543, moco loss:2.2166
2025-05-09 02:24:57,415 - epoch:5, training loss:2123.2169 validation loss:24.1515, moco loss:3.5124
2025-05-09 02:25:13,972 - epoch:6, training loss:2129.7623 validation loss:23.8760, moco loss:1.2988
2025-05-09 02:25:29,364 - epoch:7, training loss:2127.3785 validation loss:24.1908, moco loss:20.0683
2025-05-09 02:25:44,393 - epoch:8, training loss:2122.5081 validation loss:23.9063, moco loss:0.2840
2025-05-09 02:26:01,595 - epoch:9, training loss:2126.6260 validation loss:24.7502, moco loss:18.4512
2025-05-09 02:26:04,457 - [*]Test--basic_loss:906.4462, event_loss:2361.3749, test_loss:1614.8747
2025-05-09 02:26:04,523 - [*] Evaluating all samples:
2025-05-09 02:26:04,523 - [*] year 2020, testing
2025-05-09 02:26:04,590 - T:3	MAE	24.4138	RMSE	34.9289	MAPE	45.0515
2025-05-09 02:26:04,669 - T:6	MAE	24.3392	RMSE	34.5580	MAPE	46.9364
2025-05-09 02:26:04,779 - T:12	MAE	24.7120	RMSE	34.5288	MAPE	42.3581
2025-05-09 02:26:04,798 - [*] Evaluating basic traffic samples (prediction=0):
2025-05-09 02:26:04,798 - [*] year 2020, testing
2025-05-09 02:26:04,800 - T:3	MAE	16.3013	RMSE	18.7464	MAPE	49.7423
2025-05-09 02:26:04,802 - T:6	MAE	16.3003	RMSE	18.9582	MAPE	49.5597
2025-05-09 02:26:04,805 - T:12	MAE	17.4320	RMSE	20.6104	MAPE	53.9906
2025-05-09 02:26:04,839 - [*] Evaluating event traffic samples (prediction=1):
2025-05-09 02:26:04,839 - [*] year 2020, testing
2025-05-09 02:26:04,842 - T:3	MAE	22.5932	RMSE	28.4487	MAPE	16.7731
2025-05-09 02:26:04,844 - T:6	MAE	24.1980	RMSE	30.9410	MAPE	17.6904
2025-05-09 02:26:04,847 - T:12	MAE	27.6720	RMSE	36.1935	MAPE	19.5541
2025-05-09 02:26:04,848 - Finished optimization, total time:131.37 s, best model:res/SD/trafficStream2025-05-09-02:12:45.948873/2020/23.6983.pkl
2025-05-09 02:26:04,899 - 3	mae	26.84	17.02	29.93	22.59	
2025-05-09 02:26:04,899 - 3	rmse	37.69	21.82	39.49	28.45	
2025-05-09 02:26:04,899 - 3	mape	9.87	11.01	7.82	16.77	
2025-05-09 02:26:04,899 - 6	mae	29.69	18.51	32.48	24.20	
2025-05-09 02:26:04,899 - 6	rmse	42.08	23.80	43.45	30.94	
2025-05-09 02:26:04,899 - 6	mape	10.93	11.97	8.44	17.69	
2025-05-09 02:26:04,899 - 12	mae	35.35	22.00	36.82	27.67	
2025-05-09 02:26:04,899 - 12	rmse	50.63	28.84	50.07	36.19	
2025-05-09 02:26:04,899 - 12	mape	12.89	14.19	9.49	19.55	
2025-05-09 02:26:04,899 - year	2017	total_time	163.42436500000002	average_time	8.60129305263158	epoch	19
2025-05-09 02:26:04,899 - year	2018	total_time	103.932336	average_time	11.548052888888888	epoch	9
2025-05-09 02:26:04,899 - year	2019	total_time	93.31105400000001	average_time	13.330173	epoch	7
2025-05-09 02:26:04,899 - year	2020	total_time	131.37283200000002	average_time	13.1373001	epoch	10
