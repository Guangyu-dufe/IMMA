2025-06-09 04:59:30,980 - logger name:res/GLA/gla2025-06-09-04:59:30.979629/gla.log
2025-06-09 04:59:30,981 - params : {'conf': 'conf/gla.json', 'paral': 0, 'gpuid': 4, 'logname': 'gla', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/SD/all-com2025-05-26-12:20:16.113789/2017/25.9924.pkl', 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/GLA/finaldata/', 'save_data_path': 'data/GLA/FastData/', 'graph_path': 'data/GLA/graph/', 'model_path': 'res/GLA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'classifier': {'hidden_dim': 128}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'replay_num_samples': 300, 'extra_feature': False, 'moco': True, 'momentum_type': 'linear', 'memory_size': 128, 'expand': True, 'time': '2025-06-09-04:59:30.979629', 'path': 'res/GLA/gla2025-06-09-04:59:30.979629', 'device': device(type='cuda', index=4), 'logger': <Logger __main__ (INFO)>}
2025-06-09 04:59:31,071 - [*] Year 2017 load from data/GLA/FastData/2017_30day.npz
2025-06-09 05:00:33,095 - [*] Year 2017 Dataset load!
2025-06-09 05:00:33,133 - [*] Model parameter count: 9994
2025-06-09 05:00:33,134 - [*] Year 2017 Training start
2025-06-09 05:00:33,987 - node number torch.Size([232960, 24])
2025-06-09 05:01:14,347 - epoch:0, training loss:14670.6973 validation loss:33.5147, moco loss:4.1267
2025-06-09 05:01:54,527 - epoch:1, training loss:2640.5698 validation loss:31.2442, moco loss:5.8127
2025-06-09 05:02:35,995 - epoch:2, training loss:2433.6784 validation loss:29.9578, moco loss:1.7898
2025-06-09 05:03:16,437 - epoch:3, training loss:2390.3026 validation loss:29.9171, moco loss:11.1285
2025-06-09 05:03:56,472 - epoch:4, training loss:2363.2606 validation loss:29.8834, moco loss:14.8642
2025-06-09 05:04:36,486 - epoch:5, training loss:2345.2500 validation loss:30.3128, moco loss:6.7197
2025-06-09 05:05:17,848 - epoch:6, training loss:2328.1386 validation loss:29.3001, moco loss:4.1568
2025-06-09 05:05:58,044 - epoch:7, training loss:2314.3334 validation loss:29.0121, moco loss:3.3622
2025-06-09 05:06:38,211 - epoch:8, training loss:2310.3131 validation loss:28.9700, moco loss:5.7090
2025-06-09 05:07:18,298 - epoch:9, training loss:2306.3041 validation loss:28.8956, moco loss:5.1263
2025-06-09 05:07:58,190 - epoch:10, training loss:2297.9759 validation loss:28.8675, moco loss:1.6315
2025-06-09 05:08:38,095 - epoch:11, training loss:2273.3478 validation loss:28.8917, moco loss:13.8511
2025-06-09 05:09:18,324 - epoch:12, training loss:2257.7511 validation loss:28.7313, moco loss:6.3363
2025-06-09 05:09:58,350 - epoch:13, training loss:2239.0821 validation loss:28.6142, moco loss:3.9159
2025-06-09 05:10:38,673 - epoch:14, training loss:2236.3270 validation loss:28.9737, moco loss:52.4164
2025-06-09 05:11:18,827 - epoch:15, training loss:2220.0731 validation loss:29.0025, moco loss:7.8271
2025-06-09 05:11:58,842 - epoch:16, training loss:2205.7885 validation loss:28.6170, moco loss:18.1106
2025-06-09 05:12:38,996 - epoch:17, training loss:2200.7666 validation loss:28.4482, moco loss:18.5863
2025-06-09 05:13:19,117 - epoch:18, training loss:2192.7680 validation loss:29.0038, moco loss:71.0790
2025-06-09 05:13:59,054 - epoch:19, training loss:2184.4398 validation loss:28.3895, moco loss:19.8941
2025-06-09 05:14:38,964 - epoch:20, training loss:2180.5146 validation loss:28.3007, moco loss:4.1918
2025-06-09 05:15:19,066 - epoch:21, training loss:2174.8750 validation loss:28.3171, moco loss:8.5707
2025-06-09 05:15:59,219 - epoch:22, training loss:2169.1209 validation loss:28.8375, moco loss:18.8523
2025-06-09 05:16:39,299 - epoch:23, training loss:2171.2194 validation loss:28.7980, moco loss:13.4412
2025-06-09 05:17:19,463 - epoch:24, training loss:2170.5265 validation loss:28.4364, moco loss:5.0108
2025-06-09 05:17:59,546 - epoch:25, training loss:2166.1500 validation loss:28.1772, moco loss:4.9023
2025-06-09 05:18:39,875 - epoch:26, training loss:2164.4640 validation loss:29.3335, moco loss:18.8912
2025-06-09 05:19:19,859 - epoch:27, training loss:2163.9072 validation loss:28.0821, moco loss:2.5673
2025-06-09 05:19:59,661 - epoch:28, training loss:2161.3968 validation loss:28.4615, moco loss:22.1400
2025-06-09 05:20:39,783 - epoch:29, training loss:2162.6464 validation loss:28.5495, moco loss:8.6860
2025-06-09 05:21:19,832 - epoch:30, training loss:2152.1909 validation loss:28.0301, moco loss:1.6783
2025-06-09 05:21:59,990 - epoch:31, training loss:2161.6310 validation loss:28.3543, moco loss:4.0253
2025-06-09 05:22:39,994 - epoch:32, training loss:2159.8674 validation loss:28.0789, moco loss:2.3667
2025-06-09 05:23:20,139 - epoch:33, training loss:2152.4940 validation loss:28.0672, moco loss:9.2299
2025-06-09 05:23:59,685 - epoch:34, training loss:2152.1217 validation loss:28.1052, moco loss:5.9231
2025-06-09 05:24:39,605 - epoch:35, training loss:2151.5614 validation loss:28.4653, moco loss:30.4130
2025-06-09 05:25:19,874 - epoch:36, training loss:2148.7798 validation loss:28.0609, moco loss:16.1564
2025-06-09 05:25:30,043 - [*]Test--basic_loss:1933.0129, event_loss:2209.6774, test_loss:2140.5645
2025-06-09 05:25:37,340 - [*] Evaluating all samples:
2025-06-09 05:25:37,340 - [*] year 2017, testing
2025-06-09 05:25:52,865 - T:3	MAE	22.0079	RMSE	35.0609	MAPE	9.4162
2025-06-09 05:26:16,862 - T:6	MAE	24.1232	RMSE	38.1606	MAPE	10.2747
2025-06-09 05:26:48,687 - T:12	MAE	27.8877	RMSE	43.5199	MAPE	11.9758
2025-06-09 05:26:48,698 - Finished optimization, total time:1171.05 s, best model:res/GLA/gla2025-06-09-04:59:30.979629/2017/28.0301.pkl
2025-06-09 05:26:48,919 - [*] Year 2018 load from data/GLA/FastData/2018_30day.npz
2025-06-09 05:26:48,970 - Secure SignIn[*] load from res/GLA/gla2025-06-09-04:59:30.979629/2017/28.0301.pkl
2025-06-09 05:26:49,063 - [*] detect strategy feature
2025-06-09 05:26:56,285 - [*] replay node number 165
2025-06-09 05:27:10,673 - number of increase nodes:184, nodes after 2 hop:torch.Size([1454]), total nodes this year 1843
2025-06-09 05:28:43,817 - [*] Year 2018 Dataset load!
2025-06-09 05:28:43,817 - Secure SignIn[*] load from res/GLA/gla2025-06-09-04:59:30.979629/2017/28.0301.pkl
2025-06-09 05:28:43,878 - [*] EWC! lambda 0.000100
2025-06-09 05:29:49,403 - [*] Model parameter count: 9994
2025-06-09 05:29:49,403 - [*] Year 2018 Training start
2025-06-09 05:29:51,500 - node number torch.Size([186112, 24])
2025-06-09 05:30:24,456 - epoch:0, training loss:1957.0913 validation loss:28.8106, moco loss:0.8657
2025-06-09 05:30:58,769 - epoch:1, training loss:1905.9847 validation loss:28.6810, moco loss:4.6101
2025-06-09 05:31:33,533 - epoch:2, training loss:1904.1457 validation loss:28.6996, moco loss:6.1575
2025-06-09 05:32:07,818 - epoch:3, training loss:1910.5722 validation loss:28.8393, moco loss:11.4631
2025-06-09 05:32:42,323 - epoch:4, training loss:1911.8993 validation loss:29.1720, moco loss:32.9824
2025-06-09 05:33:15,525 - epoch:5, training loss:1908.6200 validation loss:28.9264, moco loss:13.6877
2025-06-09 05:33:48,569 - epoch:6, training loss:1909.1703 validation loss:28.7248, moco loss:5.1962
2025-06-09 05:34:21,040 - epoch:7, training loss:1912.9590 validation loss:28.6906, moco loss:3.3424
2025-06-09 05:34:31,204 - [*]Test--basic_loss:1490.2495, event_loss:1825.6476, test_loss:1754.6178
2025-06-09 05:34:31,344 - [*] Evaluating all samples:
2025-06-09 05:34:31,344 - [*] year 2018, testing
2025-06-09 05:34:31,411 - T:3	MAE	26.4337	RMSE	39.7845	MAPE	13.3943
2025-06-09 05:34:31,486 - T:6	MAE	26.6185	RMSE	40.1799	MAPE	13.6127
2025-06-09 05:34:31,622 - T:12	MAE	27.6246	RMSE	41.1231	MAPE	13.6702
2025-06-09 05:34:31,623 - Finished optimization, total time:219.54 s, best model:res/GLA/gla2025-06-09-04:59:30.979629/2018/28.681.pkl
2025-06-09 05:34:31,901 - [*] Year 2019 load from data/GLA/FastData/2019_30day.npz
2025-06-09 05:34:31,925 - Secure SignIn[*] load from res/GLA/gla2025-06-09-04:59:30.979629/2018/28.681.pkl
2025-06-09 05:34:32,014 - [*] detect strategy feature
2025-06-09 05:34:39,765 - [*] replay node number 167
2025-06-09 05:35:05,910 - number of increase nodes:185, nodes after 2 hop:torch.Size([1529]), total nodes this year 1859
2025-06-09 05:36:45,225 - [*] Year 2019 Dataset load!
2025-06-09 05:36:45,225 - Secure SignIn[*] load from res/GLA/gla2025-06-09-04:59:30.979629/2018/28.681.pkl
2025-06-09 05:36:45,289 - [*] EWC! lambda 0.000100
2025-06-09 05:37:52,420 - [*] Model parameter count: 9994
2025-06-09 05:37:52,421 - [*] Year 2019 Training start
2025-06-09 05:37:55,509 - node number torch.Size([195712, 24])
2025-06-09 05:38:29,336 - epoch:0, training loss:1895.6616 validation loss:27.2675, moco loss:12.0160
2025-06-09 05:39:06,185 - epoch:1, training loss:1836.3064 validation loss:27.0832, moco loss:0.6012
2025-06-09 05:39:42,089 - epoch:2, training loss:1833.1103 validation loss:27.1215, moco loss:2.1358
2025-06-09 05:40:17,671 - epoch:3, training loss:1839.9108 validation loss:26.9822, moco loss:8.1997
2025-06-09 05:40:51,907 - epoch:4, training loss:1845.5577 validation loss:27.3639, moco loss:10.3420
2025-06-09 05:41:27,869 - epoch:5, training loss:1841.1952 validation loss:27.1688, moco loss:15.3278
2025-06-09 05:42:05,293 - epoch:6, training loss:1837.3592 validation loss:27.3156, moco loss:2.4603
2025-06-09 05:42:41,659 - epoch:7, training loss:1833.1983 validation loss:27.0796, moco loss:5.8473
2025-06-09 05:43:18,010 - epoch:8, training loss:1836.8152 validation loss:27.2814, moco loss:1.7523
2025-06-09 05:43:54,231 - epoch:9, training loss:1838.6972 validation loss:27.1209, moco loss:8.0324
2025-06-09 05:44:02,437 - [*]Test--basic_loss:1384.2470, event_loss:1717.5888, test_loss:1647.8657
2025-06-09 05:44:02,824 - [*] Evaluating all samples:
2025-06-09 05:44:02,824 - [*] year 2019, testing
2025-06-09 05:44:02,888 - T:3	MAE	28.5849	RMSE	42.0023	MAPE	12.7085
2025-06-09 05:44:02,967 - T:6	MAE	28.0328	RMSE	41.5525	MAPE	12.9490
2025-06-09 05:44:03,098 - T:12	MAE	26.4685	RMSE	39.1165	MAPE	12.8386
2025-06-09 05:44:03,100 - Finished optimization, total time:295.58 s, best model:res/GLA/gla2025-06-09-04:59:30.979629/2019/26.9822.pkl
2025-06-09 05:44:03,377 - [*] Year 2020 load from data/GLA/FastData/2020_30day.npz
2025-06-09 05:44:03,403 - Secure SignIn[*] load from res/GLA/gla2025-06-09-04:59:30.979629/2019/26.9822.pkl
2025-06-09 05:44:03,489 - [*] detect strategy feature
2025-06-09 05:44:11,259 - [*] replay node number 167
2025-06-09 05:44:35,587 - number of increase nodes:174, nodes after 2 hop:torch.Size([1591]), total nodes this year 1859
2025-06-09 05:46:23,424 - [*] Year 2020 Dataset load!
2025-06-09 05:46:23,425 - Secure SignIn[*] load from res/GLA/gla2025-06-09-04:59:30.979629/2019/26.9822.pkl
2025-06-09 05:46:23,483 - [*] EWC! lambda 0.000100
2025-06-09 05:47:29,971 - [*] Model parameter count: 9994
2025-06-09 05:47:29,973 - [*] Year 2020 Training start
2025-06-09 05:47:32,913 - node number torch.Size([203648, 24])
2025-06-09 05:48:08,948 - epoch:0, training loss:1619.9962 validation loss:26.1147, moco loss:1.7212
2025-06-09 05:48:46,462 - epoch:1, training loss:1571.5907 validation loss:27.1601, moco loss:4.4788
2025-06-09 05:49:28,482 - epoch:2, training loss:1576.7636 validation loss:25.0931, moco loss:18.0081
2025-06-09 05:50:07,017 - epoch:3, training loss:1578.1407 validation loss:26.6110, moco loss:4.7451
2025-06-09 05:50:45,069 - epoch:4, training loss:1575.5341 validation loss:27.3938, moco loss:28.8540
2025-06-09 05:51:23,593 - epoch:5, training loss:1574.8329 validation loss:26.1041, moco loss:4.3143
2025-06-09 05:52:01,800 - epoch:6, training loss:1574.4556 validation loss:25.9698, moco loss:2.5189
2025-06-09 05:52:40,100 - epoch:7, training loss:1566.7031 validation loss:25.7324, moco loss:10.6116
2025-06-09 05:53:18,460 - epoch:8, training loss:1567.2956 validation loss:25.5109, moco loss:11.6848
2025-06-09 05:53:26,898 - [*]Test--basic_loss:1147.3414, event_loss:1377.8851, test_loss:1323.1959
2025-06-09 05:53:27,158 - [*] Evaluating all samples:
2025-06-09 05:53:27,158 - [*] year 2020, testing
2025-06-09 05:53:27,217 - T:3	MAE	20.2382	RMSE	30.5063	MAPE	15.1944
2025-06-09 05:53:27,288 - T:6	MAE	21.3552	RMSE	32.1360	MAPE	16.1375
2025-06-09 05:53:27,401 - T:12	MAE	20.6203	RMSE	31.3322	MAPE	17.2780
2025-06-09 05:53:27,402 - Finished optimization, total time:277.15 s, best model:res/GLA/gla2025-06-09-04:59:30.979629/2020/25.0931.pkl
2025-06-09 05:53:27,573 - 3	mae	22.01	26.43	28.58	20.24	
2025-06-09 05:53:27,573 - 3	rmse	35.06	39.78	42.00	30.51	
2025-06-09 05:53:27,573 - 3	mape	9.42	13.39	12.71	15.19	
2025-06-09 05:53:27,573 - 6	mae	24.12	26.62	28.03	21.36	
2025-06-09 05:53:27,573 - 6	rmse	38.16	40.18	41.55	32.14	
2025-06-09 05:53:27,573 - 6	mape	10.27	13.61	12.95	16.14	
2025-06-09 05:53:27,573 - 12	mae	27.89	27.62	26.47	20.62	
2025-06-09 05:53:27,573 - 12	rmse	43.52	41.12	39.12	31.33	
2025-06-09 05:53:27,573 - 12	mape	11.98	13.67	12.84	17.28	
2025-06-09 05:53:27,573 - year	2017	total_time	1171.0451110000004	average_time	31.64988067567568	epoch	37
2025-06-09 05:53:27,573 - year	2018	total_time	219.542394	average_time	27.442840500000003	epoch	8
2025-06-09 05:53:27,574 - year	2019	total_time	295.580183	average_time	29.558071599999998	epoch	10
2025-06-09 05:53:27,574 - year	2020	total_time	277.151552	average_time	30.794684333333333	epoch	9
