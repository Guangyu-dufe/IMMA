2025-06-09 02:03:57,241 - logger name:res/GLA/gla2025-06-09-02:03:57.239561/gla.log
2025-06-09 02:03:57,241 - params : {'conf': 'conf/gla.json', 'paral': 0, 'gpuid': 4, 'logname': 'gla', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/SD/all-com2025-05-26-12:20:16.113789/2017/25.9924.pkl', 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/GLA/finaldata/', 'save_data_path': 'data/GLA/FastData/', 'graph_path': 'data/GLA/graph/', 'model_path': 'res/GLA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'classifier': {'hidden_dim': 128}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'replay_num_samples': 300, 'extra_feature': False, 'moco': True, 'momentum_type': 'linear', 'memory_size': 4, 'expand': True, 'time': '2025-06-09-02:03:57.239561', 'path': 'res/GLA/gla2025-06-09-02:03:57.239561', 'device': device(type='cuda', index=4), 'logger': <Logger __main__ (INFO)>}
2025-06-09 02:03:57,361 - [*] Year 2017 load from data/GLA/FastData/2017_30day.npz
2025-06-09 02:05:25,156 - [*] Year 2017 Dataset load!
2025-06-09 02:05:25,169 - [*] Model parameter count: 8506
2025-06-09 02:05:25,169 - [*] Year 2017 Training start
2025-06-09 02:05:26,049 - node number torch.Size([232960, 24])
2025-06-09 02:06:07,492 - epoch:0, training loss:14247.8814 validation loss:31.7233, moco loss:0.9532
2025-06-09 02:06:48,290 - epoch:1, training loss:2463.0232 validation loss:30.5886, moco loss:12.5361
2025-06-09 02:07:32,026 - epoch:2, training loss:2342.0363 validation loss:29.7144, moco loss:1.1324
2025-06-09 02:08:12,513 - epoch:3, training loss:2289.2678 validation loss:29.5347, moco loss:7.9785
2025-06-09 02:08:53,484 - epoch:4, training loss:2260.0514 validation loss:29.5969, moco loss:11.7207
2025-06-09 02:09:34,567 - epoch:5, training loss:2236.9993 validation loss:29.3455, moco loss:4.7211
2025-06-09 02:10:16,008 - epoch:6, training loss:2222.4027 validation loss:28.9121, moco loss:3.6816
2025-06-09 02:10:56,440 - epoch:7, training loss:2201.2093 validation loss:28.6390, moco loss:8.2369
2025-06-09 02:11:36,969 - epoch:8, training loss:2184.4702 validation loss:29.4364, moco loss:6.4724
2025-06-09 02:12:17,600 - epoch:9, training loss:2173.5749 validation loss:28.5119, moco loss:3.2917
2025-06-09 02:12:58,176 - epoch:10, training loss:2165.5653 validation loss:28.7754, moco loss:6.3195
2025-06-09 02:13:39,159 - epoch:11, training loss:2157.5847 validation loss:28.3138, moco loss:3.9905
2025-06-09 02:14:19,965 - epoch:12, training loss:2150.0705 validation loss:28.3917, moco loss:2.7595
2025-06-09 02:15:00,690 - epoch:13, training loss:2142.4984 validation loss:28.3607, moco loss:3.3284
2025-06-09 02:15:41,698 - epoch:14, training loss:2139.3927 validation loss:28.3633, moco loss:6.1607
2025-06-09 02:16:22,610 - epoch:15, training loss:2133.0025 validation loss:28.5095, moco loss:8.5689
2025-06-09 02:17:04,044 - epoch:16, training loss:2132.3932 validation loss:28.5363, moco loss:5.5798
2025-06-09 02:17:44,941 - epoch:17, training loss:2128.6249 validation loss:28.6542, moco loss:8.9648
2025-06-09 02:17:53,624 - [*]Test--basic_loss:1766.5758, event_loss:2591.4274, test_loss:2155.5727
2025-06-09 02:17:57,641 - [*] Evaluating all samples:
2025-06-09 02:17:57,641 - [*] year 2017, testing
2025-06-09 02:18:11,309 - T:3	MAE	22.4673	RMSE	35.6597	MAPE	9.4077
2025-06-09 02:18:35,986 - T:6	MAE	24.5377	RMSE	38.6768	MAPE	10.2191
2025-06-09 02:19:20,091 - T:12	MAE	28.1785	RMSE	43.8559	MAPE	11.7382
2025-06-09 02:19:22,539 - [*] Evaluating basic traffic samples (prediction=0):
2025-06-09 02:19:22,540 - [*] year 2017, testing
2025-06-09 02:19:29,591 - T:3	MAE	19.1974	RMSE	31.0715	MAPE	11.7058
2025-06-09 02:19:42,411 - T:6	MAE	21.2202	RMSE	34.3630	MAPE	12.6807
2025-06-09 02:20:05,839 - T:12	MAE	24.9182	RMSE	40.3326	MAPE	14.5658
2025-06-09 02:20:08,091 - [*] Evaluating event traffic samples (prediction=1):
2025-06-09 02:20:08,091 - [*] year 2017, testing
2025-06-09 02:20:10,582 - T:3	MAE	26.1041	RMSE	40.1516	MAPE	6.8518
2025-06-09 02:20:17,003 - T:6	MAE	28.2277	RMSE	42.9689	MAPE	7.4814
2025-06-09 02:20:33,637 - T:12	MAE	31.8069	RMSE	47.4699	MAPE	8.5948
2025-06-09 02:20:33,654 - Finished optimization, total time:583.19 s, best model:res/GLA/gla2025-06-09-02:03:57.239561/2017/28.3138.pkl
2025-06-09 02:20:33,907 - [*] Year 2018 load from data/GLA/FastData/2018_30day.npz
2025-06-09 02:20:33,941 - Secure SignIn[*] load from res/GLA/gla2025-06-09-02:03:57.239561/2017/28.3138.pkl
2025-06-09 02:20:34,030 - [*] detect strategy feature
2025-06-09 02:20:41,812 - [*] replay node number 165
2025-06-09 02:21:21,311 - number of increase nodes:184, nodes after 2 hop:torch.Size([1460]), total nodes this year 1843
2025-06-09 02:23:31,021 - [*] Year 2018 Dataset load!
2025-06-09 02:23:31,021 - Secure SignIn[*] load from res/GLA/gla2025-06-09-02:03:57.239561/2017/28.3138.pkl
2025-06-09 02:23:31,103 - [*] EWC! lambda 0.000100
2025-06-09 02:24:36,470 - [*] Model parameter count: 8506
2025-06-09 02:24:36,471 - [*] Year 2018 Training start
2025-06-09 02:24:38,192 - node number torch.Size([186880, 24])
2025-06-09 02:25:09,882 - epoch:0, training loss:1982.5982 validation loss:28.7180, moco loss:5.0995
2025-06-09 02:25:42,586 - epoch:1, training loss:1897.5858 validation loss:28.6927, moco loss:2.0622
2025-06-09 02:26:15,325 - epoch:2, training loss:1898.5633 validation loss:28.6092, moco loss:1.4926
2025-06-09 02:26:47,938 - epoch:3, training loss:1897.9119 validation loss:28.9790, moco loss:7.5080
2025-06-09 02:27:20,687 - epoch:4, training loss:1898.6675 validation loss:28.5875, moco loss:0.8663
2025-06-09 02:27:53,345 - epoch:5, training loss:1904.2853 validation loss:28.7749, moco loss:6.1414
2025-06-09 02:28:26,018 - epoch:6, training loss:1899.9994 validation loss:29.0248, moco loss:1.9030
2025-06-09 02:28:59,318 - epoch:7, training loss:1902.0279 validation loss:28.6692, moco loss:1.5928
2025-06-09 02:29:32,503 - epoch:8, training loss:1901.9779 validation loss:28.7026, moco loss:2.0538
2025-06-09 02:30:05,350 - epoch:9, training loss:1900.4784 validation loss:28.6160, moco loss:2.0201
2025-06-09 02:30:38,018 - epoch:10, training loss:1899.9657 validation loss:28.7913, moco loss:1.4477
2025-06-09 02:30:45,905 - [*]Test--basic_loss:1606.2490, event_loss:2061.7509, test_loss:1680.9500
2025-06-09 02:30:46,089 - [*] Evaluating all samples:
2025-06-09 02:30:46,089 - [*] year 2018, testing
2025-06-09 02:30:46,147 - T:3	MAE	24.4811	RMSE	35.9564	MAPE	13.0646
2025-06-09 02:30:46,225 - T:6	MAE	24.7966	RMSE	36.7678	MAPE	13.3198
2025-06-09 02:30:46,341 - T:12	MAE	25.6125	RMSE	37.8595	MAPE	13.2596
2025-06-09 02:30:46,508 - [*] Evaluating basic traffic samples (prediction=0):
2025-06-09 02:30:46,508 - [*] year 2018, testing
2025-06-09 02:30:46,512 - T:3	MAE	26.3271	RMSE	38.0135	MAPE	8.8929
2025-06-09 02:30:46,515 - T:6	MAE	29.1935	RMSE	42.2423	MAPE	9.7436
2025-06-09 02:30:46,520 - T:12	MAE	34.1386	RMSE	49.6229	MAPE	11.3820
2025-06-09 02:30:46,547 - [*] Evaluating event traffic samples (prediction=1):
2025-06-09 02:30:46,547 - [*] year 2018, testing
2025-06-09 02:30:46,548 - T:3	MAE	29.6928	RMSE	39.8281	MAPE	5.7422
2025-06-09 02:30:46,548 - T:6	MAE	31.8215	RMSE	43.0544	MAPE	6.1813
2025-06-09 02:30:46,549 - T:12	MAE	35.5015	RMSE	47.5640	MAPE	6.8622
2025-06-09 02:30:46,550 - Finished optimization, total time:295.64 s, best model:res/GLA/gla2025-06-09-02:03:57.239561/2018/28.5875.pkl
2025-06-09 02:30:46,853 - [*] Year 2019 load from data/GLA/FastData/2019_30day.npz
2025-06-09 02:30:46,882 - Secure SignIn[*] load from res/GLA/gla2025-06-09-02:03:57.239561/2018/28.5875.pkl
2025-06-09 02:30:46,964 - [*] detect strategy feature
2025-06-09 02:30:54,933 - [*] replay node number 167
2025-06-09 02:31:31,230 - number of increase nodes:185, nodes after 2 hop:torch.Size([1533]), total nodes this year 1859
2025-06-09 02:33:43,221 - [*] Year 2019 Dataset load!
2025-06-09 02:33:43,222 - Secure SignIn[*] load from res/GLA/gla2025-06-09-02:03:57.239561/2018/28.5875.pkl
2025-06-09 02:33:43,284 - [*] EWC! lambda 0.000100
2025-06-09 02:34:50,133 - [*] Model parameter count: 8506
2025-06-09 02:34:50,134 - [*] Year 2019 Training start
2025-06-09 02:34:52,114 - node number torch.Size([196224, 24])
2025-06-09 02:35:24,494 - epoch:0, training loss:1926.1204 validation loss:27.1619, moco loss:0.6280
2025-06-09 02:35:59,089 - epoch:1, training loss:1836.1447 validation loss:27.7447, moco loss:22.6419
2025-06-09 02:36:33,739 - epoch:2, training loss:1836.4491 validation loss:27.2230, moco loss:4.1211
2025-06-09 02:37:08,715 - epoch:3, training loss:1841.0561 validation loss:27.1201, moco loss:6.3242
2025-06-09 02:37:43,238 - epoch:4, training loss:1839.7794 validation loss:27.1896, moco loss:0.7398
2025-06-09 02:38:18,703 - epoch:5, training loss:1844.4483 validation loss:27.2379, moco loss:5.5282
2025-06-09 02:38:53,786 - epoch:6, training loss:1839.1773 validation loss:27.1671, moco loss:3.4367
2025-06-09 02:39:29,395 - epoch:7, training loss:1841.0348 validation loss:27.4416, moco loss:7.5987
2025-06-09 02:40:04,928 - epoch:8, training loss:1841.4099 validation loss:27.0415, moco loss:6.3037
2025-06-09 02:40:39,726 - epoch:9, training loss:1840.1316 validation loss:27.0642, moco loss:2.1323
2025-06-09 02:41:15,249 - epoch:10, training loss:1840.6151 validation loss:27.3255, moco loss:2.1341
2025-06-09 02:41:51,002 - epoch:11, training loss:1840.1492 validation loss:27.7013, moco loss:1.6833
2025-06-09 02:42:25,919 - epoch:12, training loss:1840.5068 validation loss:27.1707, moco loss:0.7059
2025-06-09 02:43:00,183 - epoch:13, training loss:1839.1047 validation loss:27.1225, moco loss:7.1301
2025-06-09 02:43:34,838 - epoch:14, training loss:1842.9965 validation loss:27.1760, moco loss:6.2235
2025-06-09 02:43:43,764 - [*]Test--basic_loss:1644.5065, event_loss:119.5089, test_loss:1645.0399
2025-06-09 02:43:43,874 - [*] Evaluating all samples:
2025-06-09 02:43:43,874 - [*] year 2019, testing
2025-06-09 02:43:43,929 - T:3	MAE	26.8108	RMSE	39.0431	MAPE	10.3158
2025-06-09 02:43:44,002 - T:6	MAE	26.4149	RMSE	38.4585	MAPE	10.8088
2025-06-09 02:43:44,112 - T:12	MAE	26.1644	RMSE	38.0144	MAPE	11.8388
2025-06-09 02:43:44,212 - [*] Evaluating basic traffic samples (prediction=0):
2025-06-09 02:43:44,212 - [*] year 2019, testing
2025-06-09 02:43:44,217 - T:3	MAE	10.8697	RMSE	14.8039	MAPE	11.5675
2025-06-09 02:43:44,221 - T:6	MAE	11.6176	RMSE	15.9754	MAPE	12.3017
2025-06-09 02:43:44,226 - T:12	MAE	13.7608	RMSE	19.0538	MAPE	15.0028
2025-06-09 02:43:44,226 - [*] Evaluating event traffic samples (prediction=1):
2025-06-09 02:43:44,226 - [*] year 2019, testing
2025-06-09 02:43:44,226 - T:3	MAE	21.0887	RMSE	33.5235	MAPE	15.0631
2025-06-09 02:43:44,226 - T:6	MAE	23.7316	RMSE	36.2692	MAPE	15.1568
2025-06-09 02:43:44,226 - T:12	MAE	38.1651	RMSE	57.7960	MAPE	23.1934
2025-06-09 02:43:44,228 - Finished optimization, total time:427.41 s, best model:res/GLA/gla2025-06-09-02:03:57.239561/2019/27.0415.pkl
2025-06-09 02:43:44,530 - [*] Year 2020 load from data/GLA/FastData/2020_30day.npz
2025-06-09 02:43:44,560 - Secure SignIn[*] load from res/GLA/gla2025-06-09-02:03:57.239561/2019/27.0415.pkl
2025-06-09 02:43:44,648 - [*] detect strategy feature
2025-06-09 02:43:52,565 - [*] replay node number 167
2025-06-09 02:44:44,645 - number of increase nodes:176, nodes after 2 hop:torch.Size([1591]), total nodes this year 1859
2025-06-09 02:46:28,521 - [*] Year 2020 Dataset load!
2025-06-09 02:46:28,521 - Secure SignIn[*] load from res/GLA/gla2025-06-09-02:03:57.239561/2019/27.0415.pkl
2025-06-09 02:46:28,589 - [*] EWC! lambda 0.000100
2025-06-09 02:47:13,910 - [*] Model parameter count: 8506
2025-06-09 02:47:13,911 - [*] Year 2020 Training start
2025-06-09 02:47:16,008 - node number torch.Size([203648, 24])
2025-06-09 02:47:51,252 - epoch:0, training loss:1682.5913 validation loss:27.2658, moco loss:15.5562
2025-06-09 02:48:29,367 - epoch:1, training loss:1587.0919 validation loss:25.9370, moco loss:0.7982
2025-06-09 02:49:07,324 - epoch:2, training loss:1582.8565 validation loss:26.1850, moco loss:0.9614
2025-06-09 02:49:46,279 - epoch:3, training loss:1580.5122 validation loss:26.2095, moco loss:0.5881
2025-06-09 02:50:24,095 - epoch:4, training loss:1583.5441 validation loss:26.1009, moco loss:5.4035
2025-06-09 02:51:02,931 - epoch:5, training loss:1584.5039 validation loss:26.6284, moco loss:3.0430
2025-06-09 02:51:40,858 - epoch:6, training loss:1584.2075 validation loss:26.7671, moco loss:4.9688
2025-06-09 02:52:19,033 - epoch:7, training loss:1582.0952 validation loss:26.1982, moco loss:0.4596
2025-06-09 02:52:28,307 - [*]Test--basic_loss:1788.8651, event_loss:0.0000, test_loss:1788.8651
2025-06-09 02:52:28,609 - [*] Evaluating all samples:
2025-06-09 02:52:28,609 - [*] year 2020, testing
2025-06-09 02:52:28,686 - T:3	MAE	28.0868	RMSE	42.5218	MAPE	11.3080
2025-06-09 02:52:28,784 - T:6	MAE	28.6588	RMSE	43.5467	MAPE	11.6043
2025-06-09 02:52:28,912 - T:12	MAE	27.7081	RMSE	42.0222	MAPE	12.1587
2025-06-09 02:52:29,102 - [*] Evaluating basic traffic samples (prediction=0):
2025-06-09 02:52:29,102 - [*] year 2020, testing
2025-06-09 02:52:29,107 - T:3	MAE	30.3107	RMSE	42.6841	MAPE	11.2325
2025-06-09 02:52:29,113 - T:6	MAE	32.2197	RMSE	45.3728	MAPE	12.2951
2025-06-09 02:52:29,119 - T:12	MAE	35.9032	RMSE	50.1845	MAPE	13.2299
2025-06-09 02:52:29,119 - Finished optimization, total time:248.76 s, best model:res/GLA/gla2025-06-09-02:03:57.239561/2020/25.937.pkl
2025-06-09 02:52:29,273 - 3	mae	22.47	24.48	26.81	28.09	
2025-06-09 02:52:29,273 - 3	rmse	35.66	35.96	39.04	42.52	
2025-06-09 02:52:29,273 - 3	mape	9.41	13.06	10.32	11.31	
2025-06-09 02:52:29,273 - 6	mae	24.54	24.80	26.41	28.66	
2025-06-09 02:52:29,273 - 6	rmse	38.68	36.77	38.46	43.55	
2025-06-09 02:52:29,274 - 6	mape	10.22	13.32	10.81	11.60	
2025-06-09 02:52:29,274 - 12	mae	28.18	25.61	26.16	27.71	
2025-06-09 02:52:29,274 - 12	rmse	43.86	37.86	38.01	42.02	
2025-06-09 02:52:29,274 - 12	mape	11.74	13.26	11.84	12.16	
2025-06-09 02:52:29,274 - year	2017	total_time	583.193879	average_time	32.39967288888889	epoch	18
2025-06-09 02:52:29,274 - year	2018	total_time	295.63702600000005	average_time	26.876105909090906	epoch	11
2025-06-09 02:52:29,274 - year	2019	total_time	427.414925	average_time	28.4943442	epoch	15
2025-06-09 02:52:29,274 - year	2020	total_time	248.76280100000002	average_time	31.09536575	epoch	8
