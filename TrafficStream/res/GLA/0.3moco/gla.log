2025-06-07 12:01:19,820 - logger name:res/GLA/gla2025-06-07-12:01:19.819696/gla.log
2025-06-07 12:01:19,820 - params : {'conf': 'conf/gla.json', 'paral': 0, 'gpuid': 7, 'logname': 'gla', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/GLA/gla2025-06-04-08:59:11.852056/2017/28.633.pkl', 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 0, 'auto_test': 1, 'raw_data_path': 'data/GLA/finaldata/', 'save_data_path': 'data/GLA/FastData/', 'graph_path': 'data/GLA/graph/', 'model_path': 'res/GLA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'classifier': {'hidden_dim': 128}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'replay_num_samples': 300, 'extra_feature': False, 'moco': True, 'momentum_type': 'linear', 'memory_size': 32, 'expand': True, 'time': '2025-06-07-12:01:19.819696', 'path': 'res/GLA/gla2025-06-07-12:01:19.819696', 'device': device(type='cuda', index=7), 'logger': <Logger __main__ (INFO)>}
2025-06-07 12:01:19,938 - [*] Year 2017 load from data/GLA/FastData/2017_30day.npz
2025-06-07 12:02:12,549 - [*] Year 2017 Dataset load!
2025-06-07 12:02:12,583 - [*] Model parameter count: 8842
2025-06-07 12:02:12,583 - [*] Year 2017 Training start
2025-06-07 12:02:13,433 - node number torch.Size([232960, 24])
2025-06-07 12:02:52,959 - epoch:0, training loss:8802.5757 validation loss:32.7280, moco loss:0.8358
2025-06-07 12:03:32,480 - epoch:1, training loss:2640.2533 validation loss:31.3234, moco loss:15.1498
2025-06-07 12:04:12,193 - epoch:2, training loss:2476.1444 validation loss:30.6997, moco loss:48.8543
2025-06-07 12:04:52,179 - epoch:3, training loss:2440.5419 validation loss:30.1389, moco loss:49.2910
2025-06-07 12:05:32,184 - epoch:4, training loss:2426.0083 validation loss:29.8258, moco loss:64.7175
2025-06-07 12:06:12,304 - epoch:5, training loss:2420.9177 validation loss:30.0246, moco loss:85.3249
2025-06-07 12:06:52,548 - epoch:6, training loss:2417.6951 validation loss:30.3719, moco loss:113.3536
2025-06-07 12:07:32,554 - epoch:7, training loss:2412.1204 validation loss:29.7887, moco loss:222.9395
2025-06-07 12:08:12,963 - epoch:8, training loss:2401.2742 validation loss:29.5673, moco loss:175.5110
2025-06-07 12:08:53,600 - epoch:9, training loss:2390.2870 validation loss:29.5580, moco loss:66.6079
2025-06-07 12:09:33,866 - epoch:10, training loss:2370.9791 validation loss:29.1873, moco loss:127.4675
2025-06-07 12:10:13,895 - epoch:11, training loss:2360.5994 validation loss:29.5958, moco loss:56.7873
2025-06-07 12:10:54,370 - epoch:12, training loss:2351.2017 validation loss:29.2628, moco loss:80.1771
2025-06-07 12:11:34,461 - epoch:13, training loss:2352.6361 validation loss:29.3200, moco loss:53.4377
2025-06-07 12:12:14,689 - epoch:14, training loss:2343.0466 validation loss:29.6457, moco loss:92.6991
2025-06-07 12:12:54,771 - epoch:15, training loss:2337.9579 validation loss:29.2920, moco loss:63.9622
2025-06-07 12:13:35,292 - epoch:16, training loss:2331.2491 validation loss:29.4521, moco loss:29.0259
2025-06-07 12:13:44,038 - [*]Test--basic_loss:2453.3133, event_loss:757.7188, test_loss:2339.0380
2025-06-07 12:13:45,055 - [*] Evaluating all samples:
2025-06-07 12:13:45,055 - [*] year 2017, testing
2025-06-07 12:13:50,854 - T:3	MAE	22.6450	RMSE	35.6668	MAPE	9.8372
2025-06-07 12:14:00,006 - T:6	MAE	24.9038	RMSE	39.1970	MAPE	10.9336
2025-06-07 12:14:20,764 - T:12	MAE	29.0517	RMSE	45.4099	MAPE	13.0491
2025-06-07 12:14:20,773 - Finished optimization, total time:535.28 s, best model:res/GLA/gla2025-06-07-12:01:19.819696/2017/29.1873.pkl
2025-06-07 12:14:21,006 - [*] Year 2018 load from data/GLA/FastData/2018_30day.npz
2025-06-07 12:14:21,057 - Secure SignIn[*] load from res/GLA/gla2025-06-07-12:01:19.819696/2017/29.1873.pkl
2025-06-07 12:14:21,147 - [*] detect strategy feature
2025-06-07 12:14:29,224 - [*] replay node number 300
2025-06-07 12:14:50,911 - number of increase nodes:319, nodes after 2 hop:torch.Size([1696]), total nodes this year 1843
2025-06-07 12:16:13,702 - [*] Year 2018 Dataset load!
2025-06-07 12:16:13,702 - Secure SignIn[*] load from res/GLA/gla2025-06-07-12:01:19.819696/2017/29.1873.pkl
2025-06-07 12:16:13,758 - [*] EWC! lambda 0.000100
2025-06-07 12:16:57,503 - [*] Model parameter count: 8842
2025-06-07 12:16:57,504 - [*] Year 2018 Training start
2025-06-07 12:16:59,470 - node number torch.Size([217088, 24])
2025-06-07 12:17:36,694 - epoch:0, training loss:2078.8647 validation loss:29.3834, moco loss:88.3373
2025-06-07 12:18:16,801 - epoch:1, training loss:2034.4338 validation loss:29.3363, moco loss:66.8547
2025-06-07 12:18:56,204 - epoch:2, training loss:2018.4131 validation loss:29.7452, moco loss:10.5388
2025-06-07 12:19:35,350 - epoch:3, training loss:2013.2925 validation loss:29.4557, moco loss:6.8657
2025-06-07 12:20:14,685 - epoch:4, training loss:2010.8571 validation loss:29.1722, moco loss:9.8743
2025-06-07 12:20:53,577 - epoch:5, training loss:2012.5119 validation loss:29.7417, moco loss:4.9749
2025-06-07 12:21:32,406 - epoch:6, training loss:2005.4595 validation loss:29.1946, moco loss:3.4040
2025-06-07 12:22:11,444 - epoch:7, training loss:2011.6789 validation loss:29.7517, moco loss:14.1363
2025-06-07 12:22:50,722 - epoch:8, training loss:2006.9606 validation loss:29.3262, moco loss:5.9271
2025-06-07 12:23:29,729 - epoch:9, training loss:2006.2975 validation loss:29.6878, moco loss:9.8042
2025-06-07 12:24:08,614 - epoch:10, training loss:2003.2407 validation loss:29.1572, moco loss:16.3228
2025-06-07 12:24:47,742 - epoch:11, training loss:2007.4041 validation loss:29.2769, moco loss:6.2044
2025-06-07 12:25:26,828 - epoch:12, training loss:2006.2191 validation loss:29.2604, moco loss:1.4763
2025-06-07 12:26:09,863 - epoch:13, training loss:2000.3593 validation loss:29.1665, moco loss:20.7331
2025-06-07 12:26:49,290 - epoch:14, training loss:2003.9642 validation loss:29.2177, moco loss:8.4081
2025-06-07 12:27:31,975 - epoch:15, training loss:2000.2863 validation loss:29.2693, moco loss:5.3240
2025-06-07 12:28:14,794 - epoch:16, training loss:2004.0285 validation loss:29.5158, moco loss:17.3081
2025-06-07 12:28:24,392 - [*]Test--basic_loss:2191.4252, event_loss:731.8358, test_loss:2130.3051
2025-06-07 12:28:24,776 - [*] Evaluating all samples:
2025-06-07 12:28:24,776 - [*] year 2018, testing
2025-06-07 12:28:24,833 - T:3	MAE	27.5100	RMSE	42.9069	MAPE	12.2736
2025-06-07 12:28:24,909 - T:6	MAE	27.3477	RMSE	42.9128	MAPE	12.7217
2025-06-07 12:28:25,021 - T:12	MAE	27.5029	RMSE	42.4980	MAPE	12.3087
2025-06-07 12:28:25,023 - Finished optimization, total time:551.09 s, best model:res/GLA/gla2025-06-07-12:01:19.819696/2018/29.1572.pkl
2025-06-07 12:28:25,326 - [*] Year 2019 load from data/GLA/FastData/2019_30day.npz
2025-06-07 12:28:25,352 - Secure SignIn[*] load from res/GLA/gla2025-06-07-12:01:19.819696/2018/29.1572.pkl
2025-06-07 12:28:25,450 - [*] detect strategy feature
2025-06-07 12:28:33,197 - [*] replay node number 300
2025-06-07 12:28:54,832 - number of increase nodes:304, nodes after 2 hop:torch.Size([1707]), total nodes this year 1859
2025-06-07 12:30:16,585 - [*] Year 2019 Dataset load!
2025-06-07 12:30:16,585 - Secure SignIn[*] load from res/GLA/gla2025-06-07-12:01:19.819696/2018/29.1572.pkl
2025-06-07 12:30:16,641 - [*] EWC! lambda 0.000100
2025-06-07 12:31:04,244 - [*] Model parameter count: 8842
2025-06-07 12:31:04,245 - [*] Year 2019 Training start
2025-06-07 12:31:06,247 - node number torch.Size([218496, 24])
2025-06-07 12:31:45,094 - epoch:0, training loss:1864.2086 validation loss:28.1540, moco loss:5.0814
2025-06-07 12:32:29,024 - epoch:1, training loss:1811.7464 validation loss:27.8700, moco loss:20.4592
2025-06-07 12:33:11,633 - epoch:2, training loss:1815.7832 validation loss:27.9423, moco loss:6.3450
2025-06-07 12:33:56,422 - epoch:3, training loss:1813.0701 validation loss:28.2068, moco loss:13.1321
2025-06-07 12:34:39,428 - epoch:4, training loss:1812.8039 validation loss:27.8880, moco loss:10.1032
2025-06-07 12:35:27,475 - epoch:5, training loss:1813.4573 validation loss:28.1434, moco loss:7.0225
2025-06-07 12:36:11,093 - epoch:6, training loss:1811.7151 validation loss:27.8705, moco loss:7.1863
2025-06-07 12:36:52,887 - epoch:7, training loss:1813.8713 validation loss:27.7816, moco loss:5.8314
2025-06-07 12:37:35,526 - epoch:8, training loss:1813.9219 validation loss:27.8336, moco loss:11.8609
2025-06-07 12:38:21,604 - epoch:9, training loss:1810.0764 validation loss:28.4033, moco loss:9.6163
2025-06-07 12:39:02,577 - epoch:10, training loss:1813.4367 validation loss:28.0094, moco loss:2.2973
2025-06-07 12:39:49,973 - epoch:11, training loss:1811.3461 validation loss:28.1989, moco loss:14.3366
2025-06-07 12:40:32,682 - epoch:12, training loss:1808.7544 validation loss:27.9730, moco loss:4.5511
2025-06-07 12:41:15,623 - epoch:13, training loss:1812.5053 validation loss:27.9609, moco loss:12.1330
2025-06-07 12:41:25,199 - [*]Test--basic_loss:1840.9651, event_loss:153.1344, test_loss:1840.3853
2025-06-07 12:41:25,562 - [*] Evaluating all samples:
2025-06-07 12:41:25,562 - [*] year 2019, testing
2025-06-07 12:41:25,621 - T:3	MAE	27.7489	RMSE	42.3689	MAPE	12.4754
2025-06-07 12:41:25,695 - T:6	MAE	27.7641	RMSE	42.2572	MAPE	12.5369
2025-06-07 12:41:25,801 - T:12	MAE	28.3625	RMSE	42.7175	MAPE	13.0149
2025-06-07 12:41:25,802 - Finished optimization, total time:501.99 s, best model:res/GLA/gla2025-06-07-12:01:19.819696/2019/27.7816.pkl
2025-06-07 12:41:26,095 - [*] Year 2020 load from data/GLA/FastData/2020_30day.npz
2025-06-07 12:41:26,122 - Secure SignIn[*] load from res/GLA/gla2025-06-07-12:01:19.819696/2019/27.7816.pkl
2025-06-07 12:41:26,217 - [*] detect strategy feature
2025-06-07 12:41:34,360 - [*] replay node number 300
2025-06-07 12:41:55,849 - number of increase nodes:288, nodes after 2 hop:torch.Size([1744]), total nodes this year 1859
2025-06-07 12:43:57,986 - [*] Year 2020 Dataset load!
2025-06-07 12:43:57,986 - Secure SignIn[*] load from res/GLA/gla2025-06-07-12:01:19.819696/2019/27.7816.pkl
2025-06-07 12:43:58,055 - [*] EWC! lambda 0.000100
2025-06-07 12:44:46,401 - [*] Model parameter count: 8842
2025-06-07 12:44:46,402 - [*] Year 2020 Training start
2025-06-07 12:44:48,177 - node number torch.Size([223232, 24])
2025-06-07 12:45:31,698 - epoch:0, training loss:1539.2516 validation loss:26.0537, moco loss:5.4104
2025-06-07 12:46:18,627 - epoch:1, training loss:1488.3087 validation loss:25.6205, moco loss:2.2847
2025-06-07 12:47:06,397 - epoch:2, training loss:1489.2025 validation loss:26.0862, moco loss:7.0154
2025-06-07 12:47:54,247 - epoch:3, training loss:1484.4906 validation loss:24.6969, moco loss:16.6864
2025-06-07 12:48:41,199 - epoch:4, training loss:1484.1919 validation loss:25.8945, moco loss:1.5136
2025-06-07 12:49:27,480 - epoch:5, training loss:1482.5472 validation loss:25.3235, moco loss:11.9083
2025-06-07 12:50:11,264 - epoch:6, training loss:1478.0996 validation loss:25.1301, moco loss:0.9282
2025-06-07 12:50:59,778 - epoch:7, training loss:1482.0921 validation loss:25.9101, moco loss:1.3978
2025-06-07 12:51:51,049 - epoch:8, training loss:1480.2759 validation loss:26.9159, moco loss:3.6225
2025-06-07 12:52:39,660 - epoch:9, training loss:1481.7530 validation loss:26.5546, moco loss:2.7336
2025-06-07 12:52:48,029 - [*]Test--basic_loss:1547.2423, event_loss:9.4629, test_loss:1547.2429
2025-06-07 12:52:48,368 - [*] Evaluating all samples:
2025-06-07 12:52:48,368 - [*] year 2020, testing
2025-06-07 12:52:48,429 - T:3	MAE	21.3239	RMSE	31.8215	MAPE	10.1225
2025-06-07 12:52:48,502 - T:6	MAE	22.9918	RMSE	34.5060	MAPE	10.7174
2025-06-07 12:52:48,609 - T:12	MAE	26.3219	RMSE	39.4491	MAPE	12.4078
2025-06-07 12:52:48,610 - Finished optimization, total time:389.71 s, best model:res/GLA/gla2025-06-07-12:01:19.819696/2020/24.6969.pkl
2025-06-07 12:52:48,769 - 3	mae	22.65	27.51	27.75	21.32	
2025-06-07 12:52:48,769 - 3	rmse	35.67	42.91	42.37	31.82	
2025-06-07 12:52:48,769 - 3	mape	9.84	12.27	12.48	10.12	
2025-06-07 12:52:48,769 - 6	mae	24.90	27.35	27.76	22.99	
2025-06-07 12:52:48,769 - 6	rmse	39.20	42.91	42.26	34.51	
2025-06-07 12:52:48,770 - 6	mape	10.93	12.72	12.54	10.72	
2025-06-07 12:52:48,770 - 12	mae	29.05	27.50	28.36	26.32	
2025-06-07 12:52:48,770 - 12	rmse	45.41	42.50	42.72	39.45	
2025-06-07 12:52:48,770 - 12	mape	13.05	12.31	13.01	12.41	
2025-06-07 12:52:48,770 - year	2017	total_time	535.2778000000001	average_time	31.486940823529412	epoch	17
2025-06-07 12:52:48,770 - year	2018	total_time	551.090187	average_time	32.41708335294118	epoch	17
2025-06-07 12:52:48,770 - year	2019	total_time	501.98609100000004	average_time	35.85616457142857	epoch	14
2025-06-07 12:52:48,770 - year	2020	total_time	389.708832	average_time	38.9708979	epoch	10
