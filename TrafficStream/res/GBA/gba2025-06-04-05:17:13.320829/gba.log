2025-06-04 05:17:13,321 - logger name:res/GBA/gba2025-06-04-05:17:13.320829/gba.log
2025-06-04 05:17:13,322 - params : {'conf': 'conf/gba.json', 'paral': 0, 'gpuid': 0, 'logname': 'gba', 'load_first_year': 0, 'first_year_model_path': '/home/bd2/ANATS/TrafficStream/res/GBA/gba2025-06-04-03:03:30.637631/2018/26.2626.pkl', 'begin_year': 2017, 'end_year': 2020, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'train': 1, 'y_len': 12, 'x_len': 12, 'data_process': 1, 'auto_test': 1, 'raw_data_path': 'data/GBA/finaldata/', 'save_data_path': 'data/GBA/FastData/', 'graph_path': 'data/GBA/graph/', 'model_path': 'res/GBA/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'classifier': {'hidden_dim': 128}, 'strategy': 'incremental', 'init': True, 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'random', 'replay_num_samples': 300, 'extra_feature': False, 'moco': True, 'momentum_type': 'linear', 'memory_size': 32, 'expand': True, 'time': '2025-06-04-05:17:13.320829', 'path': 'res/GBA/gba2025-06-04-05:17:13.320829', 'device': device(type='cuda', index=0), 'logger': <Logger __main__ (INFO)>}
2025-06-04 05:20:20,215 - [*] Year 2017 load from data/GBA/FastData/2017_30day.npz
2025-06-04 05:20:20,499 - [*] Year 2017 Dataset load!
2025-06-04 05:20:20,503 - [*] Model parameter count: 8842
2025-06-04 05:20:20,503 - [*] Year 2017 Training start
2025-06-04 05:20:21,431 - node number torch.Size([293632, 24])
2025-06-04 05:21:16,246 - epoch:0, training loss:5639.1089 validation loss:30.1254, moco loss:0.7859
2025-06-04 05:22:12,152 - epoch:1, training loss:1980.7918 validation loss:28.8989, moco loss:2.5907
2025-06-04 05:23:09,308 - epoch:2, training loss:1841.5260 validation loss:28.5426, moco loss:6.5878
2025-06-04 05:24:07,139 - epoch:3, training loss:1811.6350 validation loss:27.9197, moco loss:29.0964
2025-06-04 05:25:05,680 - epoch:4, training loss:1792.6959 validation loss:27.6550, moco loss:5.7587
2025-06-04 05:26:04,171 - epoch:5, training loss:1785.0132 validation loss:27.8726, moco loss:27.8724
2025-06-04 05:27:02,792 - epoch:6, training loss:1785.6073 validation loss:27.7458, moco loss:58.9065
2025-06-04 05:28:00,674 - epoch:7, training loss:1778.9337 validation loss:27.7841, moco loss:106.3618
2025-06-04 05:29:01,985 - epoch:8, training loss:1769.2455 validation loss:27.5985, moco loss:93.2373
2025-06-04 05:30:08,499 - epoch:9, training loss:1765.4774 validation loss:27.4290, moco loss:30.2620
2025-06-04 05:31:08,618 - epoch:10, training loss:1758.3304 validation loss:27.7747, moco loss:33.1350
2025-06-04 05:32:09,565 - epoch:11, training loss:1751.0343 validation loss:27.7559, moco loss:35.5751
2025-06-04 05:33:11,771 - epoch:12, training loss:1743.9403 validation loss:27.1818, moco loss:21.5216
2025-06-04 05:34:11,995 - epoch:13, training loss:1725.9669 validation loss:27.1283, moco loss:5.2432
2025-06-04 05:35:13,549 - epoch:14, training loss:1717.6438 validation loss:27.4598, moco loss:11.2461
2025-06-04 05:36:12,568 - epoch:15, training loss:1705.3636 validation loss:27.2958, moco loss:2.6226
2025-06-04 05:37:10,560 - epoch:16, training loss:1702.3227 validation loss:27.6884, moco loss:6.8838
2025-06-04 05:38:08,694 - epoch:17, training loss:1699.8527 validation loss:27.3300, moco loss:2.5842
2025-06-04 05:39:06,159 - epoch:18, training loss:1697.1007 validation loss:27.1284, moco loss:3.0422
2025-06-04 05:40:06,078 - epoch:19, training loss:1692.7494 validation loss:27.3675, moco loss:4.1744
2025-06-04 05:40:18,413 - [*]Test--basic_loss:1756.3328, event_loss:61.3527, test_loss:1756.6389
2025-06-04 05:40:26,051 - [*] Evaluating all samples:
2025-06-04 05:40:26,051 - [*] year 2017, testing
2025-06-04 05:40:42,456 - T:3	MAE	21.7947	RMSE	33.9299	MAPE	13.7522
2025-06-04 05:41:05,081 - T:6	MAE	23.5696	RMSE	36.5976	MAPE	15.1577
2025-06-04 05:41:51,856 - T:12	MAE	26.9148	RMSE	41.5911	MAPE	17.9953
2025-06-04 05:41:53,990 - [*] Evaluating basic traffic samples (prediction=0):
2025-06-04 05:41:53,991 - [*] year 2017, testing
2025-06-04 05:42:00,662 - T:3	MAE	21.7931	RMSE	33.9273	MAPE	13.7522
2025-06-04 05:42:20,620 - T:6	MAE	23.5675	RMSE	36.5944	MAPE	15.1576
2025-06-04 05:43:02,992 - T:12	MAE	26.9123	RMSE	41.5875	MAPE	17.9950
2025-06-04 05:43:02,993 - [*] Evaluating event traffic samples (prediction=1):
2025-06-04 05:43:02,993 - [*] year 2017, testing
2025-06-04 05:43:02,994 - T:3	MAE	40.1695	RMSE	54.8312	MAPE	13.8854
2025-06-04 05:43:02,995 - T:6	MAE	44.4666	RMSE	60.6929	MAPE	16.4464
2025-06-04 05:43:02,996 - T:12	MAE	51.2273	RMSE	70.3179	MAPE	19.6783
2025-06-04 05:43:03,015 - Finished optimization, total time:894.72 s, best model:res/GBA/gba2025-06-04-05:17:13.320829/2017/27.1283.pkl
2025-06-04 05:47:37,345 - [*] Year 2018 load from data/GBA/FastData/2018_30day.npz
2025-06-04 05:47:37,425 - Secure SignIn[*] load from res/GBA/gba2025-06-04-05:17:13.320829/2017/27.1283.pkl
2025-06-04 05:47:37,551 - [*] detect strategy feature
2025-06-04 05:47:47,288 - [*] replay node number 300
2025-06-04 05:47:47,656 - number of increase nodes:313, nodes after 2 hop:torch.Size([2071]), total nodes this year 2321
2025-06-04 05:48:38,598 - [*] Year 2018 Dataset load!
2025-06-04 05:48:38,598 - Secure SignIn[*] load from res/GBA/gba2025-06-04-05:17:13.320829/2017/27.1283.pkl
2025-06-04 05:48:38,685 - [*] EWC! lambda 0.000100
2025-06-04 05:49:08,866 - [*] Model parameter count: 8842
2025-06-04 05:49:08,867 - [*] Year 2018 Training start
2025-06-04 05:49:11,780 - node number torch.Size([265088, 24])
2025-06-04 05:50:03,359 - epoch:0, training loss:1789.3034 validation loss:26.0187, moco loss:5.5370
2025-06-04 05:50:57,453 - epoch:1, training loss:1762.3669 validation loss:26.0960, moco loss:9.7834
2025-06-04 05:51:50,712 - epoch:2, training loss:1764.9671 validation loss:26.1856, moco loss:6.7533
2025-06-04 05:52:44,912 - epoch:3, training loss:1767.4882 validation loss:26.0999, moco loss:2.1521
2025-06-04 05:53:38,835 - epoch:4, training loss:1762.8850 validation loss:26.0527, moco loss:2.3356
2025-06-04 05:54:32,597 - epoch:5, training loss:1760.1222 validation loss:26.1550, moco loss:0.7632
2025-06-04 05:55:26,060 - epoch:6, training loss:1765.4293 validation loss:25.8121, moco loss:10.0233
2025-06-04 05:56:19,446 - epoch:7, training loss:1760.9349 validation loss:26.3003, moco loss:2.0277
2025-06-04 05:57:12,564 - epoch:8, training loss:1763.7618 validation loss:26.1984, moco loss:5.4336
2025-06-04 05:58:05,157 - epoch:9, training loss:1761.3257 validation loss:25.7530, moco loss:6.3449
2025-06-04 05:58:58,217 - epoch:10, training loss:1756.7803 validation loss:26.5381, moco loss:11.4436
2025-06-04 05:59:51,921 - epoch:11, training loss:1759.7036 validation loss:25.5298, moco loss:11.3630
2025-06-04 06:00:45,084 - epoch:12, training loss:1759.5446 validation loss:25.8752, moco loss:3.6547
2025-06-04 06:01:38,048 - epoch:13, training loss:1758.7826 validation loss:25.6820, moco loss:3.1422
2025-06-04 06:02:30,431 - epoch:14, training loss:1758.2321 validation loss:26.1414, moco loss:6.7363
2025-06-04 06:03:24,005 - epoch:15, training loss:1759.9199 validation loss:25.6454, moco loss:7.2986
2025-06-04 06:04:18,494 - epoch:16, training loss:1758.7380 validation loss:25.5056, moco loss:3.0576
2025-06-04 06:05:12,407 - epoch:17, training loss:1761.6611 validation loss:26.1556, moco loss:24.3011
2025-06-04 06:06:05,800 - epoch:18, training loss:1756.8548 validation loss:25.9188, moco loss:3.2346
2025-06-04 06:06:59,179 - epoch:19, training loss:1757.5832 validation loss:25.8435, moco loss:0.7642
2025-06-04 06:07:52,424 - epoch:20, training loss:1758.7213 validation loss:25.5143, moco loss:1.2378
2025-06-04 06:08:45,968 - epoch:21, training loss:1754.9207 validation loss:25.6236, moco loss:6.5952
2025-06-04 06:09:40,625 - epoch:22, training loss:1755.1056 validation loss:26.9573, moco loss:1.7046
2025-06-04 06:09:52,404 - [*]Test--basic_loss:1835.6796, event_loss:399.6631, test_loss:1838.6175
2025-06-04 06:09:52,665 - [*] Evaluating all samples:
2025-06-04 06:09:52,665 - [*] year 2018, testing
2025-06-04 06:09:52,730 - T:3	MAE	24.2396	RMSE	39.1473	MAPE	20.6101
2025-06-04 06:09:52,812 - T:6	MAE	23.2356	RMSE	37.4123	MAPE	17.4001
2025-06-04 06:09:52,943 - T:12	MAE	22.9139	RMSE	36.7636	MAPE	15.6321
2025-06-04 06:09:53,206 - [*] Evaluating basic traffic samples (prediction=0):
2025-06-04 06:09:53,206 - [*] year 2018, testing
2025-06-04 06:09:53,211 - T:3	MAE	6.4871	RMSE	8.4672	MAPE	8.4486
2025-06-04 06:09:53,216 - T:6	MAE	7.0906	RMSE	9.5262	MAPE	8.7991
2025-06-04 06:09:53,221 - T:12	MAE	8.6084	RMSE	12.0111	MAPE	10.2180
2025-06-04 06:09:53,221 - [*] Evaluating event traffic samples (prediction=1):
2025-06-04 06:09:53,221 - [*] year 2018, testing
2025-06-04 06:09:53,221 - T:3	MAE	17.2148	RMSE	24.3079	MAPE	6.1344
2025-06-04 06:09:53,222 - T:6	MAE	22.7336	RMSE	30.3197	MAPE	8.4423
2025-06-04 06:09:53,222 - T:12	MAE	32.6361	RMSE	40.0181	MAPE	13.5213
2025-06-04 06:09:53,222 - Finished optimization, total time:996.96 s, best model:res/GBA/gba2025-06-04-05:17:13.320829/2018/25.5056.pkl
2025-06-04 06:14:57,104 - [*] Year 2019 load from data/GBA/FastData/2019_30day.npz
2025-06-04 06:14:57,192 - Secure SignIn[*] load from res/GBA/gba2025-06-04-05:17:13.320829/2018/25.5056.pkl
2025-06-04 06:14:57,326 - [*] detect strategy feature
2025-06-04 06:15:07,180 - [*] replay node number 300
2025-06-04 06:15:07,527 - number of increase nodes:324, nodes after 2 hop:torch.Size([2078]), total nodes this year 2352
2025-06-04 06:16:23,339 - [*] Year 2019 Dataset load!
2025-06-04 06:16:23,339 - Secure SignIn[*] load from res/GBA/gba2025-06-04-05:17:13.320829/2018/25.5056.pkl
2025-06-04 06:16:23,431 - [*] EWC! lambda 0.000100
2025-06-04 06:16:53,737 - [*] Model parameter count: 8842
2025-06-04 06:16:53,737 - [*] Year 2019 Training start
2025-06-04 06:16:56,559 - node number torch.Size([265984, 24])
2025-06-04 06:17:50,647 - epoch:0, training loss:1752.5441 validation loss:25.6075, moco loss:25.1797
2025-06-04 06:18:46,259 - epoch:1, training loss:1735.4343 validation loss:25.1973, moco loss:19.4158
2025-06-04 06:19:42,166 - epoch:2, training loss:1732.4039 validation loss:25.6024, moco loss:2.5223
2025-06-04 06:20:37,017 - epoch:3, training loss:1732.2012 validation loss:26.2328, moco loss:4.2078
2025-06-04 06:21:32,334 - epoch:4, training loss:1730.5315 validation loss:25.6248, moco loss:4.1073
2025-06-04 06:22:25,638 - epoch:5, training loss:1731.8933 validation loss:25.3218, moco loss:14.0908
2025-06-04 06:23:19,460 - epoch:6, training loss:1732.3133 validation loss:25.2152, moco loss:24.5745
2025-06-04 06:24:13,927 - epoch:7, training loss:1735.1873 validation loss:26.4072, moco loss:14.7224
2025-06-04 06:24:26,497 - [*]Test--basic_loss:1792.0855, event_loss:0.0000, test_loss:1792.0855
2025-06-04 06:24:26,829 - [*] Evaluating all samples:
2025-06-04 06:24:26,829 - [*] year 2019, testing
2025-06-04 06:24:26,898 - T:3	MAE	24.0194	RMSE	38.3032	MAPE	16.2772
2025-06-04 06:24:26,989 - T:6	MAE	26.0038	RMSE	41.3931	MAPE	18.0197
2025-06-04 06:24:27,162 - T:12	MAE	29.8963	RMSE	47.0327	MAPE	21.6354
2025-06-04 06:24:27,567 - [*] Evaluating basic traffic samples (prediction=0):
2025-06-04 06:24:27,567 - [*] year 2019, testing
2025-06-04 06:24:27,572 - T:3	MAE	27.4171	RMSE	38.9494	MAPE	9.3502
2025-06-04 06:24:27,576 - T:6	MAE	30.1314	RMSE	42.7339	MAPE	10.3088
2025-06-04 06:24:27,582 - T:12	MAE	35.9343	RMSE	51.1789	MAPE	12.3860
2025-06-04 06:24:27,582 - Finished optimization, total time:356.12 s, best model:res/GBA/gba2025-06-04-05:17:13.320829/2019/25.1973.pkl
2025-06-04 06:44:29,560 - [*] Year 2020 load from data/GBA/FastData/2020_30day.npz
2025-06-04 06:44:29,660 - Secure SignIn[*] load from res/GBA/gba2025-06-04-05:17:13.320829/2019/25.1973.pkl
2025-06-04 06:44:29,792 - [*] detect strategy feature
2025-06-04 06:44:39,756 - [*] replay node number 300
2025-06-04 06:44:40,079 - number of increase nodes:293, nodes after 2 hop:torch.Size([2092]), total nodes this year 2352
2025-06-04 06:46:54,319 - [*] Year 2020 Dataset load!
2025-06-04 06:46:54,320 - Secure SignIn[*] load from res/GBA/gba2025-06-04-05:17:13.320829/2019/25.1973.pkl
2025-06-04 06:46:54,421 - [*] EWC! lambda 0.000100
2025-06-04 06:47:26,370 - [*] Model parameter count: 8842
2025-06-04 06:47:26,372 - [*] Year 2020 Training start
2025-06-04 06:47:29,552 - node number torch.Size([267776, 24])
2025-06-04 06:48:24,416 - epoch:0, training loss:1199.9130 validation loss:22.8453, moco loss:4.2083
2025-06-04 06:49:23,022 - epoch:1, training loss:1179.4703 validation loss:23.2877, moco loss:1.4392
2025-06-04 06:50:19,079 - epoch:2, training loss:1177.1829 validation loss:22.6841, moco loss:11.6624
2025-06-04 06:51:18,901 - epoch:3, training loss:1175.5737 validation loss:22.3857, moco loss:3.3803
2025-06-04 06:52:17,240 - epoch:4, training loss:1179.9108 validation loss:21.6541, moco loss:19.3460
2025-06-04 06:53:16,535 - epoch:5, training loss:1177.8731 validation loss:22.9541, moco loss:2.6428
2025-06-04 06:54:17,131 - epoch:6, training loss:1176.0228 validation loss:21.7376, moco loss:8.3206
2025-06-04 06:55:16,762 - epoch:7, training loss:1179.6669 validation loss:21.2665, moco loss:3.8858
2025-06-04 06:56:17,606 - epoch:8, training loss:1177.2453 validation loss:21.9396, moco loss:1.2541
2025-06-04 06:57:15,463 - epoch:9, training loss:1173.0944 validation loss:22.8390, moco loss:6.1862
2025-06-04 06:58:14,822 - epoch:10, training loss:1175.9830 validation loss:22.3642, moco loss:13.3816
2025-06-04 06:59:13,269 - epoch:11, training loss:1173.9497 validation loss:22.4269, moco loss:2.8635
2025-06-04 07:00:13,623 - epoch:12, training loss:1177.7103 validation loss:22.5707, moco loss:6.7510
2025-06-04 07:01:11,393 - epoch:13, training loss:1170.6596 validation loss:21.4473, moco loss:20.7189
2025-06-04 07:01:26,204 - [*]Test--basic_loss:1011.5950, event_loss:0.0000, test_loss:1011.5950
2025-06-04 07:01:27,116 - [*] Evaluating all samples:
2025-06-04 07:01:27,116 - [*] year 2020, testing
2025-06-04 07:01:27,198 - T:3	MAE	17.4365	RMSE	26.8522	MAPE	25.5955
2025-06-04 07:01:27,311 - T:6	MAE	18.3183	RMSE	28.3007	MAPE	21.3566
2025-06-04 07:01:27,468 - T:12	MAE	19.5488	RMSE	30.5438	MAPE	19.4099
2025-06-04 07:01:28,335 - [*] Evaluating basic traffic samples (prediction=0):
2025-06-04 07:01:28,336 - [*] year 2020, testing
2025-06-04 07:01:28,344 - T:3	MAE	9.4011	RMSE	10.9845	MAPE	11.1336
2025-06-04 07:01:28,348 - T:6	MAE	9.3484	RMSE	11.4165	MAPE	9.8227
2025-06-04 07:01:28,355 - T:12	MAE	10.0962	RMSE	12.9633	MAPE	9.6343
2025-06-04 07:01:28,355 - Finished optimization, total time:665.17 s, best model:res/GBA/gba2025-06-04-05:17:13.320829/2020/21.2665.pkl
2025-06-04 07:01:28,464 - 3	mae	21.79	24.24	24.02	17.44	
2025-06-04 07:01:28,465 - 3	rmse	33.93	39.15	38.30	26.85	
2025-06-04 07:01:28,465 - 3	mape	13.75	20.61	16.28	25.60	
2025-06-04 07:01:28,465 - 6	mae	23.57	23.24	26.00	18.32	
2025-06-04 07:01:28,465 - 6	rmse	36.60	37.41	41.39	28.30	
2025-06-04 07:01:28,465 - 6	mape	15.16	17.40	18.02	21.36	
2025-06-04 07:01:28,465 - 12	mae	26.91	22.91	29.90	19.55	
2025-06-04 07:01:28,465 - 12	rmse	41.59	36.76	47.03	30.54	
2025-06-04 07:01:28,465 - 12	mape	18.00	15.63	21.64	19.41	